/*! For license information please see main.657a008d.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,s)=>{e.exports=s(202)},153:(e,t,s)=>{var a=s(43),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var a,n={},c=null,d=null;for(a in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:d,props:n,_owner:o.current}}t.Fragment=n,t.jsx=c,t.jsxs=c},202:(e,t)=>{var s=Symbol.for("react.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),h=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,f={};function x(e,t,s){this.props=e,this.context=t,this.refs=f,this.updater=s||g}function y(){}function b(e,t,s){this.props=e,this.context=t,this.refs=f,this.updater=s||g}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var v=b.prototype=new y;v.constructor=b,p(v,x.prototype),v.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,a){var r,n={},i=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(n[r]=t[r]);var l=arguments.length-2;if(1===l)n.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===n[r]&&(n[r]=l[r]);return{$$typeof:s,type:e,key:i,ref:o,props:n,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,r,n,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case s:case a:l=!0}}if(l)return i=i(l=e),e=""===n?"."+E(l,0):n,j(i)?(r="",null!=e&&(r=e.replace(_,"$&/")+"/"),T(i,t,r,"",(function(e){return e}))):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+e)),t.push(i)),1;if(l=0,n=""===n?".":n+":",j(e))for(var c=0;c<e.length;c++){var d=n+E(o=e[c],c);l+=T(o,t,r,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=T(o=o.value,t,r,d=n+E(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,s){if(null==e)return e;var a=[],r=0;return T(e,a,"","",(function(e){return t.call(s,e,r++)})),a}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},$={transition:null},M={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:$,ReactCurrentOwner:N};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,s){I(e,(function(){t.apply(this,arguments)}),s)},count:function(e){var t=0;return I(e,(function(){t++})),t},toArray:function(e){return I(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=r,t.Profiler=i,t.PureComponent=b,t.StrictMode=n,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=P,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=p({},e.props),n=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=N.current),void 0!==t.key&&(n=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:s,type:e.type,key:n,ref:i,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=$.transition;$.transition={};try{e()}finally{$.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,s){return A.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,s){return A.current.useReducer(e,t,s)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return A.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var a=s-1>>>1,r=e[a];if(!(0<n(r,t)))break e;e[a]=t,e[s]=r,s=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>n(l,s))c<r&&0>n(d,l)?(e[a]=d,e[c]=s,a=c):(e[a]=l,e[o]=s,a=o);else{if(!(c<r&&0>n(d,s)))break e;e[a]=d,e[c]=s,a=c}}}return t}function n(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,m=null,h=3,g=!1,p=!1,f=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=a(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,s(c,t)}t=a(d)}}function j(e){if(f=!1,v(e),!p)if(null!==a(c))p=!0,$(w);else{var t=a(d);null!==t&&M(j,t.startTime-e)}}function w(e,s){p=!1,f&&(f=!1,y(C),C=-1),g=!0;var n=h;try{for(v(s),m=a(c);null!==m&&(!(m.expirationTime>s)||e&&!T());){var i=m.callback;if("function"===typeof i){m.callback=null,h=m.priorityLevel;var o=i(m.expirationTime<=s);s=t.unstable_now(),"function"===typeof o?m.callback=o:m===a(c)&&r(c),v(s)}else r(c);m=a(c)}if(null!==m)var l=!0;else{var u=a(d);null!==u&&M(j,u.startTime-s),l=!1}return l}finally{m=null,h=n,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,S=null,C=-1,_=5,E=-1;function T(){return!(t.unstable_now()-E<_)}function I(){if(null!==S){var e=t.unstable_now();E=e;var s=!0;try{s=S(!0,e)}finally{s?N():(k=!1,S=null)}}else k=!1}if("function"===typeof b)N=function(){b(I)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,A=O.port2;O.port1.onmessage=I,N=function(){A.postMessage(null)}}else N=function(){x(I,0)};function $(e){S=e,k||(k=!0,N())}function M(e,s){C=x((function(){e(t.unstable_now())}),s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,$(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var s=h;h=t;try{return e()}finally{h=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=h;h=e;try{return t()}finally{h=s}},t.unstable_scheduleCallback=function(e,r,n){var i=t.unstable_now();switch("object"===typeof n&&null!==n?n="number"===typeof(n=n.delay)&&0<n?i+n:i:n=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:n,expirationTime:o=n+o,sortIndex:-1},n>i?(e.sortIndex=n,s(d,e),null===a(c)&&e===a(d)&&(f?(y(C),C=-1):f=!0,M(j,n-i))):(e.sortIndex=o,s(c,e),p||g||(p=!0,$(w))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=h;return function(){var s=h;h=t;try{return e.apply(this,arguments)}finally{h=s}}}},358:(e,t)=>{const s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,a=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,s){do{const s=e.charCodeAt(t);if(32!==s&&9!==s)return t}while(++t<s);return s}function c(e,t,s){for(;t>s;){const s=e.charCodeAt(--t);if(32!==s&&9!==s)return t+1}return s}function d(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},391:(e,t,s)=>{var a=s(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},395:(e,t,s)=>{var a;s.r(t),s.d(t,{default:()=>m});var r=new Uint8Array(16);function n(){if(!a&&!(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(r)}const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const o=function(e){return"string"===typeof e&&i.test(e)};for(var l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!o(s))throw TypeError("Stringified UUID is invalid");return s};const u=function(e,t,s){var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){s=s||0;for(var r=0;r<16;++r)t[s+r]=a[r];return t}return d(a)};const m=new class{constructor(){this.storage=localStorage,this.storagePrefix="coffee_cue_demo_",this.latency=300,this.debugMode=!0,this._initializeData()}setLatency(e){this.latency=e}setDebugMode(e){this.debugMode=e}resetDemoData(){this._clearStorage(),this._initializeData(),this.debugMode&&console.log("Demo data has been reset to initial values")}async get(e){this.debugMode&&console.log(`[MockDataService] GET ${e}`),await this._simulateLatency();const t=(e.startsWith("/")?e.substring(1):e).split("/");return"inventory"===t[0]?this._handleInventoryGet(t):"orders"===t[0]?this._handleOrdersGet(t):"settings"===t[0]?this._handleSettingsGet(t):"chat"===t[0]?this._handleChatGet(t):"schedule"===t[0]?this._handleScheduleGet(t):[]}async post(e,t){this.debugMode&&console.log(`[MockDataService] POST ${e}`,t),await this._simulateLatency();const s=(e.startsWith("/")?e.substring(1):e).split("/");return"inventory"===s[0]?this._handleInventoryPost(s,t):"orders"===s[0]?this._handleOrdersPost(s,t):"settings"===s[0]?this._handleSettingsPost(s,t):"chat"===s[0]?this._handleChatPost(s,t):"schedule"===s[0]?this._handleSchedulePost(s,t):{success:!0,id:u()}}async put(e,t){this.debugMode&&console.log(`[MockDataService] PUT ${e}`,t),await this._simulateLatency();const s=(e.startsWith("/")?e.substring(1):e).split("/");return"inventory"===s[0]?this._handleInventoryPut(s,t):"orders"===s[0]?this._handleOrdersPut(s,t):"settings"===s[0]?this._handleSettingsPut(s,t):{success:!0}}async patch(e,t){this.debugMode&&console.log(`[MockDataService] PATCH ${e}`,t),await this._simulateLatency();const s=(e.startsWith("/")?e.substring(1):e).split("/");if(s.length>=3&&"inventory"===s[0]&&"quantity"===s[2]){const e=parseInt(s[1]);return this._updateInventoryQuantity(e,t.amount,t.reason)}return{success:!0}}async delete(e){this.debugMode&&console.log(`[MockDataService] DELETE ${e}`),await this._simulateLatency();const t=(e.startsWith("/")?e.substring(1):e).split("/");if(t.length>=2&&"inventory"===t[0]){const e=parseInt(t[1]);return this._deleteInventoryItem(e)}return{success:!0}}_initializeData(){if(this.storage.getItem(`${this.storagePrefix}initialized`))return;const e={milk:[{id:1,name:"Full Cream",amount:4,unit:"L",capacity:5,status:"good",category:"milk",lastUpdated:(new Date).toISOString()},{id:2,name:"Skim",amount:1.5,unit:"L",capacity:5,status:"warning",category:"milk",lastUpdated:(new Date).toISOString()},{id:3,name:"Soy",amount:.5,unit:"L",capacity:5,status:"danger",category:"milk",lastUpdated:(new Date).toISOString()},{id:4,name:"Almond",amount:2,unit:"L",capacity:5,status:"good",category:"milk",lastUpdated:(new Date).toISOString()},{id:5,name:"Oat",amount:3,unit:"L",capacity:5,status:"good",category:"milk",lastUpdated:(new Date).toISOString()}],coffee:[{id:6,name:"House Blend",amount:1.2,unit:"kg",capacity:2,status:"warning",category:"coffee",lastUpdated:(new Date).toISOString()},{id:7,name:"Single Origin",amount:.8,unit:"kg",capacity:2,status:"warning",category:"coffee",lastUpdated:(new Date).toISOString()}],cups:[{id:8,name:"Small",amount:45,unit:"",capacity:50,status:"good",category:"cups",lastUpdated:(new Date).toISOString()},{id:9,name:"Regular",amount:37,unit:"",capacity:100,status:"good",category:"cups",lastUpdated:(new Date).toISOString()},{id:10,name:"Large",amount:12,unit:"",capacity:50,status:"warning",category:"cups",lastUpdated:(new Date).toISOString()}]},t={pending:[{id:"order_1",orderNumber:"45284",customerName:"Emma Davis",coffeeType:"Large Latte",milkType:"Soy milk",sugar:"1 sugar",priority:!1,createdAt:new Date(Date.now()-48e4).toISOString(),waitTime:8,promisedTime:15,batchGroup:"latte-soy",stationId:1},{id:"order_2",orderNumber:"45285",customerName:"Thomas Brown",coffeeType:"Large Latte",milkType:"Soy milk",sugar:"0 sugar",priority:!1,createdAt:new Date(Date.now()-54e4).toISOString(),waitTime:9,promisedTime:15,batchGroup:"latte-soy",stationId:1},{id:"order_3",orderNumber:"45282",customerName:"Sarah Williams",coffeeType:"Regular Flat White",milkType:"Full cream",sugar:"2 sugars",priority:!1,createdAt:new Date(Date.now()-3e5).toISOString(),waitTime:5,promisedTime:15,stationId:1},{id:"order_4",orderNumber:"45289",customerName:"Dr. Mark Wilson",coffeeType:"Double Espresso",milkType:"No milk",sugar:"No sugar",priority:!0,createdAt:new Date(Date.now()-12e4).toISOString(),waitTime:2,promisedTime:10,stationId:1},{id:"order_5",orderNumber:"45290",customerName:"Alex Johnson",coffeeType:"Mocha",milkType:"Full cream",sugar:"1 sugar",priority:!1,createdAt:new Date(Date.now()-42e4).toISOString(),waitTime:7,promisedTime:15,stationId:2},{id:"order_6",orderNumber:"45291",customerName:"Jessica Lee",coffeeType:"Americano",milkType:"No milk",sugar:"No sugar",priority:!1,createdAt:new Date(Date.now()-36e4).toISOString(),waitTime:6,promisedTime:15,stationId:2}],inProgress:[{id:"order_in_progress_1",orderNumber:"45281",customerName:"Michael Johnson",phoneNumber:"+61 423 555 789",coffeeType:"Large Cappuccino",milkType:"Oat milk",sugar:"1 sugar",extraHot:!0,priority:!0,createdAt:new Date(Date.now()-18e4).toISOString(),startedAt:(new Date).toISOString(),waitTime:3,promisedTime:15,stationId:1},{id:"order_in_progress_2",orderNumber:"45283",customerName:"Emily Carter",phoneNumber:"+61 423 777 888",coffeeType:"Flat White",milkType:"Almond milk",sugar:"No sugar",priority:!1,createdAt:new Date(Date.now()-24e4).toISOString(),startedAt:(new Date).toISOString(),waitTime:4,promisedTime:15,stationId:2}],completed:[{id:"order_completed_1",orderNumber:"45266",customerName:"Emma Johnson",phoneNumber:"+61 423 456 789",coffeeType:"Large Flat White",milkType:"Almond milk",completedAt:new Date(Date.now()-6e5).toISOString(),stationId:1},{id:"order_completed_2",orderNumber:"45270",customerName:"James Cooper",phoneNumber:"+61 432 987 654",coffeeType:"Regular Cappuccino",milkType:"Full cream milk",completedAt:new Date(Date.now()-3e5).toISOString(),stationId:1},{id:"order_completed_3",orderNumber:"45275",customerName:"David Smith",phoneNumber:"+61 432 111 222",coffeeType:"Long Black",milkType:"No milk",completedAt:new Date(Date.now()-48e4).toISOString(),stationId:2},{id:"order_completed_4",orderNumber:"45276",customerName:"Sophia Wang",phoneNumber:"+61 432 333 444",coffeeType:"Chai Latte",milkType:"Oat milk",completedAt:new Date(Date.now()-36e4).toISOString(),stationId:2}]},s=[{id:1,sender:"System",content:"Welcome to the barista interface",createdAt:new Date(Date.now()-72e5).toISOString(),isUrgent:!1},{id:2,sender:"Station Manager",content:"Remember to check milk levels frequently today",createdAt:new Date(Date.now()-36e5).toISOString(),isUrgent:!1},{id:3,sender:"Support",content:"New batches of specialty beans have arrived",createdAt:new Date(Date.now()-9e5).toISOString(),isUrgent:!1}];this.storage.setItem(`${this.storagePrefix}inventory`,JSON.stringify(e)),this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(t)),this.storage.setItem(`${this.storagePrefix}settings`,JSON.stringify({system:{displayMode:"landscape",soundEnabled:!0,autoPrintLabels:!1,stationName:"Station #3 - Main Hall",baristaName:"Alex Johnson",waitTimeWarning:10,displayTimeout:5,autoSendSmsOnComplete:!0,remindAfterDelay:!0,reminderDelay:30,showNameOnDisplay:!0},notification:{orderReadyTemplate:"Your coffee is ready for pickup at {station}.",reminderTemplate:"Your coffee has been waiting for {minutes} minutes. Please collect it soon.",delayTemplate:"We're running a bit behind. Your coffee will be ready in about {minutes} more minutes."}})),this.storage.setItem(`${this.storagePrefix}chat`,JSON.stringify(s)),this.storage.setItem(`${this.storagePrefix}schedule`,JSON.stringify({today:[{id:1,start:"08:00",end:"10:30",barista:"Alex Johnson",status:"active",isDemoData:!0},{id:2,start:"10:30",end:"13:00",barista:"Sarah Williams",status:"upcoming",isDemoData:!0},{id:3,start:"13:00",end:"15:30",barista:"Michael Chen",status:"upcoming",isDemoData:!0},{id:4,start:"15:30",end:"18:00",barista:"Alex Johnson",status:"upcoming",isDemoData:!0}],breaks:[{id:1,start:"10:00",end:"10:15",barista:"Alex Johnson",status:"completed",isDemoData:!0},{id:2,start:"12:30",end:"12:45",barista:"Sarah Williams",status:"upcoming",isDemoData:!0},{id:3,start:"15:00",end:"15:15",barista:"Michael Chen",status:"upcoming",isDemoData:!0},{id:4,start:"17:00",end:"17:15",barista:"Alex Johnson",status:"upcoming",isDemoData:!0}],rushPeriods:[{id:1,start:"10:30",end:"11:00",reason:"Morning Tea Break",isDemoData:!0},{id:2,start:"12:30",end:"13:30",reason:"Lunch Break",isDemoData:!0},{id:3,start:"15:30",end:"16:00",reason:"Afternoon Tea Break",isDemoData:!0}]})),this.storage.setItem(`${this.storagePrefix}inventory_history`,JSON.stringify([])),this.storage.setItem(`${this.storagePrefix}initialized`,"true"),this.debugMode&&console.log("Demo data initialized")}_clearStorage(){Object.keys(this.storage).forEach((e=>{e.startsWith(this.storagePrefix)&&this.storage.removeItem(e)}))}_simulateLatency(){return new Promise((e=>setTimeout(e,this.latency)))}_calculateStockStatus(e,t){const s=e/t*100;return s<=10?"danger":s<=25?"warning":"good"}_handleInventoryGet(e){const t=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory`));if(e.length>=2&&"history"!==e[1]){const s=parseInt(e[1]);let a=null;for(const e in t){const r=t[e].find((e=>e.id===s));if(r){a={...r};break}}if(a)return a;throw new Error("Item not found")}if(e.length>=2&&"history"===e[1]){return JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory_history`)||"[]")}const s=new URLSearchParams(e[1]||"").get("category");return s&&t[s]?t[s]:Object.values(t).flat()}_handleInventoryPost(e,t){if(1===e.length){const e=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory`)),s={id:Object.values(e).flat().reduce(((e,t)=>Math.max(e,t.id)),0)+1,name:t.name,category:t.category,amount:t.amount||0,unit:t.unit||"",capacity:t.capacity,status:this._calculateStockStatus(t.amount||0,t.capacity),lastUpdated:(new Date).toISOString(),notes:t.notes||""};return e[t.category]||(e[t.category]=[]),e[t.category].push(s),this.storage.setItem(`${this.storagePrefix}inventory`,JSON.stringify(e)),{success:!0,item:s}}return 2===e.length&&"report-low-stock"===e[1]?{success:!0,alert_id:u(),message:`Low stock report submitted for item ID: ${t.itemId}`}:2===e.length&&"restock-request"===e[1]?{success:!0,restock_id:u(),message:`Restock request submitted for ${t.items.length} items`}:{success:!0}}_handleInventoryPut(e,t){if(2===e.length){const s=parseInt(e[1]),a=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory`));let r=!1;for(const e in a){const n=a[e].findIndex((e=>e.id===s));if(-1!==n){Object.keys(t).forEach((s=>{"id"!==s&&"category"!==s&&(a[e][n][s]=t[s])})),a[e][n].lastUpdated=(new Date).toISOString(),a[e][n].status=this._calculateStockStatus(a[e][n].amount,a[e][n].capacity),r=!0;break}}if(r)return this.storage.setItem(`${this.storagePrefix}inventory`,JSON.stringify(a)),{success:!0,item_id:s};throw new Error("Item not found")}return{success:!0}}_updateInventoryQuantity(e,t,s){const a=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory`)),r=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory_history`)||"[]");let n=!1,i=0;for(const o in a){const s=a[o].findIndex((t=>t.id===e));if(-1!==s){i=a[o][s].amount,a[o][s].amount=t,a[o][s].lastUpdated=(new Date).toISOString(),a[o][s].status=this._calculateStockStatus(t,a[o][s].capacity),n=!0;break}}if(n){this.storage.setItem(`${this.storagePrefix}inventory`,JSON.stringify(a));const n=(new Date).toISOString();return r.push({id:r.length+1,itemId:e,previousAmount:i,newAmount:t,changeAmount:t-i,reason:s||"manual_adjustment",timestamp:n,createdBy:"demo_user"}),this.storage.setItem(`${this.storagePrefix}inventory_history`,JSON.stringify(r.slice(-100))),{success:!0,item_id:e,amount:t,updated_at:n}}throw new Error("Item not found")}_deleteInventoryItem(e){const t=JSON.parse(this.storage.getItem(`${this.storagePrefix}inventory`));let s=!1;for(const a in t){const r=t[a].findIndex((t=>t.id===e));if(-1!==r){t[a].splice(r,1),s=!0;break}}if(s)return this.storage.setItem(`${this.storagePrefix}inventory`,JSON.stringify(t)),{success:!0,item_id:e};throw new Error("Item not found")}_handleOrdersGet(e){const t=JSON.parse(this.storage.getItem(`${this.storagePrefix}orders`));let s=null;if(e.length>1){const t=e[1].split("?")[1];if(t){const e=new URLSearchParams(t);s=e.get("stationId"),s&&console.log(`[MockDataService] Filtering orders by station ID: ${s}`)}}const a=e=>s?e.filter((e=>e.stationId===s||e.station_id===s||e.assignedStation===s||e.assigned_station===s||e.assigned_to_station===s||e.station===s||e.barista_station===s||e.stationId===parseInt(s)||e.station_id===parseInt(s))):e;return e.length>=2&&e[1].startsWith("pending")?a(t.pending):e.length>=2&&e[1].startsWith("in-progress")?a(t.inProgress):e.length>=2&&e[1].startsWith("completed")?a(t.completed):a([...t.pending,...t.inProgress,...t.completed])}_handleOrdersPost(e,t){const s=JSON.parse(this.storage.getItem(`${this.storagePrefix}orders`));if(3===e.length&&"start"===e[2]){const t=e[1],a=s.pending.findIndex((e=>e.id===t||e.orderNumber===t));if(-1!==a){const e=s.pending[a];return e.startedAt=(new Date).toISOString(),s.pending.splice(a,1),s.inProgress.push(e),this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(s)),{success:!0}}return{success:!1,message:"Order not found"}}if(3===e.length&&"complete"===e[2]){const t=e[1],a=s.inProgress.findIndex((e=>e.id===t||e.orderNumber===t));if(-1!==a){const e=s.inProgress[a];return e.completedAt=(new Date).toISOString(),s.inProgress.splice(a,1),s.completed.push(e),this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(s)),{success:!0}}return{success:!1,message:"Order not found"}}if(3===e.length&&"pickup"===e[2]){const t=e[1],a=s.completed.findIndex((e=>e.id===t||e.orderNumber===t));return-1!==a?(s.completed[a].pickedUpAt=(new Date).toISOString(),this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(s)),{success:!0}):{success:!1,message:"Order not found"}}if(2===e.length&&"batch"===e[1]){const e=t.order_ids,a=t.action||"start";if(!e||!Array.isArray(e))return{success:!1,message:"No order IDs provided"};let r=0;if("start"===a){const t=[],a=[...s.inProgress];s.pending.forEach((s=>{const n=s.id||s.orderNumber;e.includes(n)?(s.startedAt=(new Date).toISOString(),a.push(s),r++):t.push(s)})),s.pending=t,s.inProgress=a}else if("complete"===a){const t=[],a=[...s.completed];s.inProgress.forEach((s=>{const n=s.id||s.orderNumber;e.includes(n)?(s.completedAt=(new Date).toISOString(),a.push(s),r++):t.push(s)})),s.inProgress=t,s.completed=a}return this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(s)),{success:!0,processed:r,total:e.length}}if(2===e.length&&"walk-in"===e[1]){const e=`45${290+s.pending.length}`,a={id:`order_${s.pending.length+1}`,orderNumber:e,customerName:t.customerName,coffeeType:t.coffeeType,milkType:t.milkType,sugar:t.sugar,priority:t.priority||!1,createdAt:(new Date).toISOString(),waitTime:0,promisedTime:15};return s.pending.push(a),this.storage.setItem(`${this.storagePrefix}orders`,JSON.stringify(s)),{success:!0,id:e,message:`Walk-in order added for ${t.customerName}`}}return 3===e.length&&"message"===e[2]?{success:!0,message:"Message sent to customer"}:{success:!0}}_handleSettingsGet(e){const t=JSON.parse(this.storage.getItem(`${this.storagePrefix}settings`));return 2===e.length&&"system"===e[1]?t.system:2===e.length&&"notification"===e[1]?t.notification:t}_handleSettingsPost(e,t){const s=JSON.parse(this.storage.getItem(`${this.storagePrefix}settings`));return 2===e.length&&"wait-time"===e[1]?{success:!0,waitTime:t.waitTime}:2===e.length&&"system"===e[1]?(s.system={...s.system,...t},this.storage.setItem(`${this.storagePrefix}settings`,JSON.stringify(s)),{success:!0,settings:s.system}):2===e.length&&"notification"===e[1]?(s.notification={...s.notification,...t},this.storage.setItem(`${this.storagePrefix}settings`,JSON.stringify(s)),{success:!0,settings:s.notification}):{success:!0}}_handleChatGet(e){if(2===e.length&&"messages"===e[1]){return JSON.parse(this.storage.getItem(`${this.storagePrefix}chat`))}return[]}_handleChatPost(e,t){if(2===e.length&&"messages"===e[1]){const e=JSON.parse(this.storage.getItem(`${this.storagePrefix}chat`)),s={id:e.length+1,sender:t.sender||"User",content:t.content,createdAt:(new Date).toISOString(),isUrgent:t.isUrgent||!1};return e.push(s),this.storage.setItem(`${this.storagePrefix}chat`,JSON.stringify(e)),{success:!0,message:s}}return{success:!0}}_handleScheduleGet(e){const t=JSON.parse(this.storage.getItem(`${this.storagePrefix}schedule`)),s=JSON.parse(localStorage.getItem("coffee_cue_hidden_demo_items")||"[]"),a=e=>e.filter((e=>!e.isDemoData||!s.includes(e.id)));return 2===e.length&&"today"===e[1]?a(t.today):2===e.length&&"breaks"===e[1]?a(t.breaks):2===e.length&&"rush-periods"===e[1]?a(t.rushPeriods):{today:a(t.today),breaks:a(t.breaks),rushPeriods:a(t.rushPeriods)}}_handleSchedulePost(e,t){const s=JSON.parse(this.storage.getItem(`${this.storagePrefix}schedule`));if(2===e.length&&"shifts"===e[1]){const e={id:Math.max(0,...s.today.map((e=>e.id)))+1,start:t.start,end:t.end,barista:t.barista,status:"upcoming"};return s.today.push(e),this.storage.setItem(`${this.storagePrefix}schedule`,JSON.stringify(s)),{success:!0,shift:e}}if(2===e.length&&"breaks"===e[1]){const e={id:Math.max(0,...s.breaks.map((e=>e.id)))+1,start:t.start,end:t.end,barista:t.barista,status:"upcoming"};return s.breaks.push(e),this.storage.setItem(`${this.storagePrefix}schedule`,JSON.stringify(s)),{success:!0,break:e}}return{success:!0}}}},504:(e,t,s)=>{s.d(t,{A:()=>a});const a=new class{constructor(){this.categoryMapping={milk:"milk",coffee:"coffee",cups:"cups",syrups:"syrups",sweeteners:"other",extras:"other"},this.syncTimeoutId=null}syncInventoryToStations(){try{const e=this.getEventInventory();if(!e)return void console.log("No event inventory found");const t=this.getStationConfigs();this.getStations().forEach((s=>{this.syncInventoryToStation(s.id,e,t)})),console.log("Inventory sync to stations completed")}catch(e){console.error("Error syncing inventory to stations:",e)}}syncInventoryToStation(e,t,s){try{const a=s[e]||{},r={},n=this.getStationInventoryQuantities();Object.keys(t).forEach((s=>{var i;const o=this.categoryMapping[s]||s;r[o]||(r[o]=[]),null===(i=t[s])||void 0===i||i.forEach((t=>{var i;const l=(null===(i=a[s])||void 0===i?void 0:i[t.id])||!1;if(t.enabled&&l){const s=this.convertInventoryItemToStock(t,o,e,n);r[o].push(s)}}))})),this.saveStationStock(e,r),console.log(`Synced inventory to station ${e}:`,r)}catch(a){console.error(`Error syncing inventory to station ${e}:`,a)}}convertInventoryItemToStock(e,t,s,a){var r,n,i;const o=this.getStockDefaults(t,e.name),l=(null===(r=a[s])||void 0===r||null===(n=r[e.category])||void 0===n||null===(i=n[e.id])||void 0===i?void 0:i.quantity)||0,c=l>0?l:o.amount,d=Math.max(c,o.capacity);return{id:e.id,name:e.name,amount:c,capacity:d,unit:e.unit||o.unit,status:c<=o.criticalThreshold?"critical":c<=o.lowThreshold?"low":"good",lowThreshold:Math.max(1,.25*d),criticalThreshold:Math.max(1,.1*d),description:e.description,category:e.category,enabled:!0}}getStockDefaults(e,t){const s=t.toUpperCase();switch(e){case"milk":return s.includes("REGULAR")||s.includes("WHOLE")?{amount:20,capacity:20,unit:"L",lowThreshold:5,criticalThreshold:2}:{amount:5,capacity:5,unit:"L",lowThreshold:2,criticalThreshold:1};case"coffee":return s.includes("HOUSE")||s.includes("MAIN")?{amount:5,capacity:5,unit:"kg",lowThreshold:1.5,criticalThreshold:.5}:{amount:3,capacity:3,unit:"kg",lowThreshold:1,criticalThreshold:.3};case"cups":return s.includes("SMALL")?{amount:200,capacity:200,unit:"pcs",lowThreshold:50,criticalThreshold:20}:s.includes("LARGE")?{amount:100,capacity:100,unit:"pcs",lowThreshold:30,criticalThreshold:10}:{amount:150,capacity:150,unit:"pcs",lowThreshold:40,criticalThreshold:15};case"syrups":return{amount:2,capacity:2,unit:"L",lowThreshold:.5,criticalThreshold:.2};case"other":return s.includes("SUGAR")?{amount:5,capacity:5,unit:"kg",lowThreshold:1,criticalThreshold:.5}:s.includes("PACKET")||s.includes("PCS")?{amount:500,capacity:500,unit:"pcs",lowThreshold:100,criticalThreshold:50}:{amount:1,capacity:1,unit:"kg",lowThreshold:.3,criticalThreshold:.1};default:return{amount:1,capacity:1,unit:"unit",lowThreshold:.3,criticalThreshold:.1}}}getEventInventory(){try{const e=localStorage.getItem("event_inventory");return e?JSON.parse(e):null}catch(e){return console.error("Error loading event inventory:",e),null}}getStationConfigs(){try{const e=localStorage.getItem("station_inventory_configs");return e?JSON.parse(e):{}}catch(e){return console.error("Error loading station configs:",e),{}}}getStationInventoryQuantities(){try{const e=localStorage.getItem("station_inventory_quantities");return e?JSON.parse(e):{}}catch(e){return console.error("Error loading station inventory quantities:",e),{}}}getStations(){return[{id:1,name:"Station 1"},{id:2,name:"Station 2"},{id:3,name:"Station 3"}]}saveStationStock(e,t){try{const s=`coffee_stock_station_${e}`;localStorage.setItem(s,JSON.stringify(t)),window.dispatchEvent(new CustomEvent("stock:updated",{detail:{stationId:e,stockData:t}})),console.log(`Saved stock data for station ${e} to key: ${s}`)}catch(s){console.error(`Error saving stock data for station ${e}:`,s)}}getStationStock(e){try{const t=`coffee_stock_station_${e}`,s=localStorage.getItem(t);return s?JSON.parse(s):null}catch(t){return console.error(`Error loading stock data for station ${e}:`,t),null}}throttledSyncInventoryToStations(){this.syncTimeoutId&&clearTimeout(this.syncTimeoutId),this.syncTimeoutId=setTimeout((()=>{console.log("Throttled sync: Syncing inventory to stations..."),this.syncInventoryToStations(),this.syncTimeoutId=null}),500)}initializeStockServiceIntegration(){window.addEventListener("inventory:updated",(()=>{console.log("Inventory updated, scheduling throttled sync..."),this.throttledSyncInventoryToStations()})),window.addEventListener("stationConfig:updated",(()=>{console.log("Station configuration updated, scheduling throttled sync..."),this.throttledSyncInventoryToStations()})),console.log("Initial inventory sync..."),this.syncInventoryToStations()}getAvailableItemsForStation(e){const t=this.getEventInventory(),s=this.getStationConfigs()[e]||{},a={};return t&&Object.keys(t).forEach((e=>{var r;a[e]=(null===(r=t[e])||void 0===r?void 0:r.filter((t=>{var a;return t.enabled&&((null===(a=s[e])||void 0===a?void 0:a[t.id])||!1)})))||[]})),a}notifyInventoryUpdated(){setTimeout((()=>{window.dispatchEvent(new CustomEvent("inventory:updated"))}),100)}notifyStationConfigUpdated(){window.dispatchEvent(new CustomEvent("stationConfig:updated")),console.log("Station config updated event dispatched (sync disabled to prevent config loss)")}forceSyncAllStations(){console.log("Force syncing all station inventories..."),this.syncInventoryToStations()}forceSyncStation(e){console.log(`\ud83d\udd04 Force syncing station ${e}...`);const t=this.getEventInventory(),s=this.getStationConfigs(),a=this.getStationInventoryQuantities();if(console.log("\ud83d\udce6 Event Inventory:",t),console.log("\u2699\ufe0f Station Configs:",s),console.log("\ud83d\udd22 Station Quantities:",a),console.log(`\ud83c\udfaf Station ${e} Config:`,s[e]),console.log(`\ud83c\udfaf Station ${e} Quantities:`,a[e]),!t||0===Object.keys(t).length)return console.warn("\u274c No event inventory found! You need to set up inventory in Organiser \u2192 Event Setup \u2192 Inventory Management"),!1;if(!s[e])return console.warn(`\u274c No station configuration found for station ${e}! You need to configure items in Organiser \u2192 Stations \u2192 Station Inventory`),!1;return[`stock_data_${e}`,`stock_data_station_${e}`,`coffee_stock_station_${e}`].forEach((t=>{localStorage.getItem(t)&&(console.log(`\ud83e\uddf9 Clearing old stock data (${t}) for station ${e}`),localStorage.removeItem(t))})),this.syncInventoryToStation(e,t,s),!0}clearAllStockAndResync(){console.log("\ud83e\uddf9 Clearing all stock data and resyncing...");for(let e=1;e<=10;e++){const t=`stock_data_${e}`,s=`stock_data_station_${e}`,a=`coffee_stock_station_${e}`;localStorage.getItem(t)&&(console.log(`Clearing old stock data (v1) for station ${e}`),localStorage.removeItem(t)),localStorage.getItem(s)&&(console.log(`Clearing old stock data (v2) for station ${e}`),localStorage.removeItem(s)),localStorage.getItem(a)&&(console.log(`Clearing current stock data for station ${e}`),localStorage.removeItem(a))}this.syncInventoryToStations(),window.dispatchEvent(new CustomEvent("stock:cleared")),console.log("\u2705 All stock data cleared and resynced")}}},579:(e,t,s)=>{e.exports=s(153)},580:(e,t,s)=>{s.d(t,{Dv:()=>o,Pg:()=>i,q:()=>l});var a=s(43),r=s(579);const n=(0,a.createContext)(),i={PRODUCTION:"production",DEMO:"demo"},o=e=>{let{children:t}=e;const[o,l]=(0,a.useState)((()=>localStorage.getItem("coffee_cue_app_mode")||i.PRODUCTION));(0,a.useEffect)((()=>{localStorage.setItem("coffee_cue_app_mode",o)}),[o]);return(0,r.jsx)(n.Provider,{value:{appMode:o,setAppMode:l,toggleAppMode:()=>{const e=o===i.PRODUCTION?i.DEMO:i.PRODUCTION,t=localStorage.getItem("coffee_cue_stations"),s=localStorage.getItem("coffee_cue_selected_station");e===i.PRODUCTION&&(localStorage.removeItem("coffee_cue_schedule"),Object.keys(localStorage).forEach((e=>{e.startsWith("coffee_cue_demo_")&&localStorage.removeItem(e)})),console.log("Cleared cached demo data from localStorage")),l(e),t&&(localStorage.setItem("coffee_cue_stations",t),console.log("Restored custom stations configuration after mode toggle")),s&&(localStorage.setItem("coffee_cue_selected_station",s),console.log("Restored selected station after mode toggle"))},resetDemoData:()=>{o===i.DEMO&&Promise.resolve().then(s.bind(s,395)).then((e=>{e.default.resetDemoData(),window.location.reload()}))},isDemoMode:o===i.DEMO,isProductionMode:o===i.PRODUCTION},children:t})},l=()=>{const e=(0,a.useContext)(n);if(!e)throw new Error("useAppMode must be used within an AppProvider");return e}},602:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(776),r=s(625);const n=new class{constructor(){this.apiService=new a.A,this.debugMode=!0,this.cacheTimeout=6e4,this.cache=new Map,this.setupWebSocketHandlers(),console.log("OrderDataService (refactored) initialized")}setToken(e){this.apiService.setToken(e),this.apiService.updateSocketAuth(e),this.cache.clear(),this.debugMode&&console.log("OrderDataService: Token updated")}setupWebSocketHandlers(){window.addEventListener("order_created",(e=>{console.log("New order created:",e.detail),this.invalidateCache("orders"),window.dispatchEvent(new CustomEvent("orderCreated",{detail:e.detail}))})),window.addEventListener("order_updated",(e=>{console.log("Order updated:",e.detail),this.invalidateCache("orders"),window.dispatchEvent(new CustomEvent("orderUpdated",{detail:e.detail}))})),window.addEventListener("order_completed",(e=>{console.log("Order completed:",e.detail),this.invalidateCache("orders"),window.dispatchEvent(new CustomEvent("orderCompleted",{detail:e.detail}))}))}async getOrders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=`orders_${e||"all"}`,s=this.getFromCache(t);if(s)return s;try{const s=new URLSearchParams;e&&s.append("station_id",e);const a=await this.apiService.get(`/orders?${s.toString()}`);if("success"===a.status){const s=a.data||[],r={pendingOrders:s.filter((e=>"pending"===e.status)),inProgressOrders:s.filter((e=>"in_progress"===e.status)),completedOrders:s.filter((e=>"completed"===e.status))};return this.setCache(t,r),this.updateLocalStorageBackup(e,r),r}}catch(a){return console.error("Error fetching orders from API:",a),this.getOrdersFromLocalStorage(e)}return{pendingOrders:[],inProgressOrders:[],completedOrders:[]}}async createOrder(e){try{const t=await this.apiService.post("/orders",e);if("success"===t.status)return this.invalidateCache("orders"),this.apiService.sendMessage("order_created",t.data),t.data;throw new Error(t.message||"Failed to create order")}catch(t){return console.error("Error creating order:",t),this.createOrderLocally(e)}}async updateOrderStatus(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const a=await this.apiService.put(`/orders/${e}/status`,{status:t,...s});if("success"===a.status)return this.invalidateCache("orders"),this.apiService.sendMessage("order_updated",{order_id:e,status:t,...s}),a.data;throw new Error(a.message||"Failed to update order")}catch(a){return console.error("Error updating order:",a),this.updateOrderLocally(e,{status:t,...s})}}async claimOrder(e,t,s){return this.updateOrderStatus(e,"in_progress",{barista_id:t,station_id:s,started_at:(new Date).toISOString()})}async completeOrder(e){return this.updateOrderStatus(e,"completed",{completed_at:(new Date).toISOString()})}async getWalkInSettings(){try{const e=await this.apiService.get("/settings/walkin");if("success"===e.status)return e.data}catch(e){console.error("Error fetching walk-in settings:",e)}return{milkTypes:r.en,coffeeTypes:["Flat White","Cappuccino","Latte","Long Black","Short Black"],sizes:["Small","Regular","Large"]}}async createWalkInOrder(e){return this.createOrder({...e,source:"walkin",priority:!0})}getFromCache(e){const t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.cacheTimeout?(this.debugMode&&console.log(`Cache hit for ${e}`),t.data):null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}invalidateCache(e){for(const t of this.cache.keys())t.startsWith(e)&&this.cache.delete(t)}updateLocalStorageBackup(e,t){try{const s=`orders_backup_${e||"all"}`;localStorage.setItem(s,JSON.stringify({data:t,timestamp:Date.now()}))}catch(s){console.error("Error updating localStorage backup:",s)}}getOrdersFromLocalStorage(e){try{const t=`orders_backup_${e||"all"}`,s=localStorage.getItem(t);if(s){const{data:e}=JSON.parse(s);return console.warn("Using localStorage fallback for orders"),e}}catch(t){console.error("Error reading from localStorage:",t)}return{pendingOrders:[],inProgressOrders:[],completedOrders:[]}}createOrderLocally(e){const t={...e,id:`local_${Date.now()}`,orderNumber:`L${Date.now().toString().slice(-6)}`,createdAt:(new Date).toISOString(),status:"pending",syncPending:!0};return this.queueForSync("create",t),t}updateOrderLocally(e,t){return this.queueForSync("update",{orderId:e,updates:t}),{id:e,...t}}queueForSync(e,t){try{const s=JSON.parse(localStorage.getItem("sync_queue")||"[]");s.push({operation:e,data:t,timestamp:Date.now()}),localStorage.setItem("sync_queue",JSON.stringify(s))}catch(s){console.error("Error queuing for sync:",s)}}async processSyncQueue(){try{const t=JSON.parse(localStorage.getItem("sync_queue")||"[]");for(const s of t)try{"create"===s.operation?await this.createOrder(s.data):"update"===s.operation&&await this.updateOrderStatus(s.data.orderId,s.data.updates.status,s.data.updates)}catch(e){console.error("Error processing sync item:",e)}localStorage.removeItem("sync_queue")}catch(e){console.error("Error processing sync queue:",e)}}async checkConnection(){try{return"success"===(await this.apiService.get("/health")).status}catch(e){return!1}}async getPendingOrders(){return(await this.getOrders()).pendingOrders||[]}async getInProgressOrders(){return(await this.getOrders()).inProgressOrders||[]}async getCompletedOrders(){return(await this.getOrders()).completedOrders||[]}async updateWaitTime(e){try{return{success:"success"===(await this.apiService.put("/settings/wait-time",e)).status}}catch(t){return console.error("Error updating wait time:",t),{success:!1,error:t.message}}}async startOrder(e,t){try{return{success:!0,data:await this.claimOrder(e.id||e.order_id,null,t)}}catch(s){return console.error("Error starting order:",s),{success:!1,error:s.message}}}async markOrderPickedUp(e){try{return{success:!0,data:await this.updateOrderStatus(e,"picked_up")}}catch(t){return console.error("Error marking order as picked up:",t),{success:!1,error:t.message}}}async processBatch(e){try{const t=await this.apiService.post("/orders/batch/process",{order_ids:e});return{success:"success"===t.status,data:t.data}}catch(t){return console.error("Error processing batch:",t),{success:!1,error:t.message}}}async processBatchSelection(e){return this.processBatch(e)}async addWalkInOrder(e){try{return{success:!0,data:await this.createWalkInOrder(e)}}catch(t){return console.error("Error adding walk-in order:",t),{success:!1,error:t.message}}}async sendMessageToCustomer(e,t){try{return{success:"success"===(await this.apiService.post(`/orders/${e}/message`,{message:t})).status}}catch(s){return console.error("Error sending message:",s),{success:!1,error:s.message}}}async delayOrder(e,t){try{const s=await this.apiService.post(`/orders/${e}/delay`,{minutes:t});return{success:"success"===s.status,data:s.data}}catch(s){return console.error("Error delaying order:",s),{success:!1,error:s.message}}}async getYesterdayOrders(e){try{const t=new URLSearchParams({station_id:e,date:"yesterday"}),s=await this.apiService.get(`/orders?${t.toString()}`);return{success:"success"===s.status,data:s.data||[]}}catch(t){return console.error("Error getting yesterday orders:",t),{success:!1,data:[]}}}async getThisWeekOrders(e){try{const t=new URLSearchParams({station_id:e,date:"week"}),s=await this.apiService.get(`/orders?${t.toString()}`);return{success:"success"===s.status,data:s.data||[]}}catch(t){return console.error("Error getting week orders:",t),{success:!1,data:[]}}}async searchOrders(e,t){try{const s=new URLSearchParams({q:e,station_id:t}),a=await this.apiService.get(`/orders/search?${s.toString()}`);return{success:"success"===a.status,data:a.data||[]}}catch(s){return console.error("Error searching orders:",s),{success:!1,data:[]}}}async getOrderHistory(e){try{const t=new URLSearchParams(e),s=await this.apiService.get(`/orders/history?${t.toString()}`);return{success:"success"===s.status,data:s.data||[]}}catch(t){return console.error("Error getting order history:",t),{success:!1,data:[]}}}},i=n},625:(e,t,s)=>{s.d(t,{en:()=>a,iC:()=>r,ke:()=>n});const a=[{id:"full_cream",name:"Full Cream Milk",category:"standard",available:!0,properties:{dairyFree:!1,lactoseFree:!1,vegan:!1,lowFat:!1}},{id:"skim",name:"Skim Milk",category:"standard",available:!0,properties:{dairyFree:!1,lactoseFree:!1,vegan:!1,lowFat:!0}},{id:"reduced_fat",name:"Reduced Fat Milk",category:"standard",available:!0,properties:{dairyFree:!1,lactoseFree:!1,vegan:!1,lowFat:!0}},{id:"lactose_free",name:"Lactose-Free Milk",category:"standard",available:!0,properties:{dairyFree:!1,lactoseFree:!0,vegan:!1,lowFat:!1}},{id:"soy",name:"Soy Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"oat",name:"Oat Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"almond",name:"Almond Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!0}},{id:"coconut",name:"Coconut Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"macadamia",name:"Macadamia Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"rice",name:"Rice Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"hemp",name:"Hemp Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!0}},{id:"cashew",name:"Cashew Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!1}},{id:"pea",name:"Pea Milk",category:"alternative",available:!0,properties:{dairyFree:!0,lactoseFree:!0,vegan:!0,lowFat:!0}}],r=e=>a.find((t=>t.id===e))||null,n=e=>a.find((t=>t.name===e))||null},700:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var a=s(776),r=s(504);const n=new class{constructor(){this.apiService=new a.A,this.baseUrl="http://localhost:5001/api",this.debugMode=!0,this.enableFallback=!1,this.stationId=null,this.stationName=null,this.initialized=!1,this.listeners=[],this.milkTypeMap={full_cream:"milk_regular",skim:"milk_skim",reduced_fat:"milk_reduced_fat",lactose_free:"milk_lactose_free",soy:"milk_soy",oat:"milk_oat",almond:"milk_almond",coconut:"milk_coconut",macadamia:"milk_macadamia",rice:"milk_rice",hemp:"milk_hemp",cashew:"milk_cashew",pea:"milk_pea",milk_regular:"full_cream",milk_skim:"skim",milk_reduced_fat:"reduced_fat",milk_lactose_free:"lactose_free",milk_soy:"soy",milk_oat:"oat",milk_almond:"almond",milk_coconut:"coconut",milk_macadamia:"macadamia",milk_rice:"rice",milk_hemp:"hemp",milk_cashew:"cashew",milk_pea:"pea"},this.defaultStockItems={milk:[{id:"milk_regular",name:"Regular Milk",amount:20,capacity:20,unit:"L",status:"good",lowThreshold:5,criticalThreshold:2},{id:"milk_skim",name:"Skim Milk",amount:10,capacity:10,unit:"L",status:"good",lowThreshold:3,criticalThreshold:1},{id:"milk_almond",name:"Almond Milk",amount:5,capacity:5,unit:"L",status:"good",lowThreshold:2,criticalThreshold:1},{id:"milk_soy",name:"Soy Milk",amount:5,capacity:5,unit:"L",status:"good",lowThreshold:2,criticalThreshold:1}],coffee:[{id:"coffee_house",name:"House Blend",amount:5,capacity:5,unit:"kg",status:"good",lowThreshold:1.5,criticalThreshold:.5},{id:"coffee_dark",name:"Dark Roast",amount:3,capacity:3,unit:"kg",status:"good",lowThreshold:1,criticalThreshold:.3},{id:"coffee_decaf",name:"Decaf Blend",amount:2,capacity:2,unit:"kg",status:"good",lowThreshold:.5,criticalThreshold:.2}],cups:[{id:"cups_small",name:"Small Cups",amount:200,capacity:200,unit:"pcs",status:"good",lowThreshold:50,criticalThreshold:20},{id:"cups_medium",name:"Medium Cups",amount:200,capacity:200,unit:"pcs",status:"good",lowThreshold:50,criticalThreshold:20},{id:"cups_large",name:"Large Cups",amount:100,capacity:100,unit:"pcs",status:"good",lowThreshold:30,criticalThreshold:10}],syrups:[{id:"syrup_vanilla",name:"Vanilla Syrup",amount:2,capacity:2,unit:"L",status:"good",lowThreshold:.5,criticalThreshold:.2},{id:"syrup_caramel",name:"Caramel Syrup",amount:2,capacity:2,unit:"L",status:"good",lowThreshold:.5,criticalThreshold:.2},{id:"syrup_hazelnut",name:"Hazelnut Syrup",amount:1,capacity:1,unit:"L",status:"good",lowThreshold:.3,criticalThreshold:.1}],other:[{id:"sugar_white",name:"White Sugar",amount:5,capacity:5,unit:"kg",status:"good",lowThreshold:1,criticalThreshold:.5},{id:"sugar_brown",name:"Brown Sugar",amount:3,capacity:3,unit:"kg",status:"good",lowThreshold:.8,criticalThreshold:.3},{id:"sweetener",name:"Sweetener",amount:500,capacity:500,unit:"pcs",status:"good",lowThreshold:100,criticalThreshold:50}]}}initialize(e,t){console.log(`Initializing StockService for station: ${e} (${t})`),this.stationId="string"===typeof e?parseInt(e,10):e,this.stationName=t,this.initialized=!0,this._loadLocalStockData()}_normalizeMilkId(e){const t=new Set;return e?(t.add(e),this.milkTypeMap[e]&&t.add(this.milkTypeMap[e]),e.startsWith("milk_")||t.add(`milk_${e}`),e.startsWith("milk_")&&t.add(e.substring(5)),Array.from(t)):Array.from(t)}_getStationStockKey(){return`coffee_stock_station_${this.stationId}`}_loadLocalStockData(){if(!this.initialized)return console.warn("StockService not initialized for a station, cannot load local stock data"),null;try{console.log(`\ud83d\udd0d Loading stock data for station ${this.stationId} (${this.stationName})`);let e=r.A.getStationStock(this.stationId);if(console.log(`\ud83d\udce6 Integration service stock for station ${this.stationId}:`,e),e)console.log(`\u2705 Loaded pre-existing integrated stock data for station ${this.stationId}`);else{console.log(`\ud83d\udd04 No integration stock found, trying manual sync for station ${this.stationId}`);if(r.A.forceSyncStation(this.stationId)&&(e=r.A.getStationStock(this.stationId),console.log(`\ud83d\udce6 Post-sync stock for station ${this.stationId}:`,e)),e)console.log(`\u2705 Successfully loaded integrated stock data for station ${this.stationId}`),this._saveLocalStockData(e);else{const t=this._getStationStockKey(),s=localStorage.getItem(t);console.log(`\ud83d\udcbe Local storage stock key: ${t}, data:`,s?"exists":"not found"),s?(e=JSON.parse(s),console.log(`\u2705 Loaded existing local stock data for station ${this.stationId}`)):(e={...this.defaultStockItems},console.log(`\u26a0\ufe0f Using default stock items for station ${this.stationId} - no organiser data found`),this._saveLocalStockData(e))}}return console.log(`\ud83d\udcca Final stock data for station ${this.stationId}:`,e),this._notifyListeners(e),e}catch(e){console.error(`\u274c Error loading stock data for station ${this.stationId}:`,e);const t={...this.defaultStockItems};return console.log(`\ud83d\udd27 Using fallback stock for station ${this.stationId}:`,t),t}}_saveLocalStockData(e){if(!this.initialized)return console.warn("StockService not initialized for a station, cannot save local stock data"),!1;try{const t=this._getStationStockKey();return localStorage.setItem(t,JSON.stringify(e)),this._notifyListeners(e),console.log(`Saved stock data for station ${this.stationId}`),!0}catch(t){return console.error("Error saving local stock data:",t),!1}}addListener(e){return"function"!==typeof e||this.listeners.includes(e)||this.listeners.push(e),()=>{this.removeListener(e)}}removeListener(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}_notifyListeners(e){this.listeners.forEach((t=>{try{t(e)}catch(s){console.error("Error notifying stock listener:",s)}}))}getLocalStock(){return this._loadLocalStockData()}getLocalCategoryStock(e){return this._loadLocalStockData()[e]||[]}updateLocalStockAmount(e,t,s){try{const a=this._loadLocalStockData();if(!a[e])return console.error(`Category ${e} not found`),!1;const r=a[e].findIndex((e=>e.id===t));if(-1===r)return console.error(`Item ${t} not found in ${e}`),!1;let n;if("string"===typeof s){if(n=parseFloat(s),isNaN(n))return console.error("Invalid amount value:",s),!1}else n=s;return n=Math.max(0,Math.min(n,a[e][r].capacity)),a[e][r].amount=n,n<=a[e][r].criticalThreshold?a[e][r].status="danger":n<=a[e][r].lowThreshold?a[e][r].status="warning":a[e][r].status="good",this._saveLocalStockData(a),!0}catch(a){return console.error("Error updating local stock amount:",a),!1}}getAvailableMilkTypes(){if(!this.initialized)return console.warn("StockService not initialized for a station, cannot get available milk types"),[];try{const e=this._loadLocalStockData();if(!e.milk||!Array.isArray(e.milk))return console.warn(`StockService: Station ${this.stationId} has no milk inventory!`),[];console.log(`StockService: Station ${this.stationId} has ${e.milk.length} total milk items:`,e.milk.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`)));const t=e.milk.filter((e=>"number"===typeof e.amount&&e.amount>0)),s=e.milk.filter((e=>"number"!==typeof e.amount||e.amount<=0));return s.length>0&&console.log(`StockService: Station ${this.stationId} has ${s.length} milk types with zero quantity:`,s.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`))),console.log(`StockService: Station ${this.stationId} has ${t.length} milk types AVAILABLE:`,t.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`))),t}catch(e){return console.error("Error getting available milk types:",e),[]}}getAvailableCoffeeTypes(){if(!this.initialized)return console.warn("StockService not initialized for a station, cannot get available coffee types"),[];try{const e=this._loadLocalStockData();if(!e.coffee||!Array.isArray(e.coffee))return console.warn(`StockService: Station ${this.stationId} has no coffee inventory!`),[];console.log(`StockService: Station ${this.stationId} has ${e.coffee.length} total coffee items:`,e.coffee.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`)));const t=e.coffee.filter((e=>"number"===typeof e.amount&&e.amount>0)),s=e.coffee.filter((e=>"number"!==typeof e.amount||e.amount<=0));return s.length>0&&console.log(`StockService: Station ${this.stationId} has ${s.length} coffee types with zero quantity:`,s.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`))),console.log(`StockService: Station ${this.stationId} has ${t.length} coffee types AVAILABLE:`,t.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`))),t}catch(e){return console.error("Error getting available coffee types:",e),[]}}getAvailableCupSizes(){if(!this.initialized)return console.warn("StockService not initialized for a station, cannot get available cup sizes"),{small:!0,regular:!0,large:!0};try{const e=this._loadLocalStockData(),t={small:!1,regular:!1,large:!1};if(!e.cups||!Array.isArray(e.cups))return console.warn(`StockService: Station ${this.stationId} has no cups inventory!`),{small:!1,regular:!0,large:!1};console.log(`StockService: Station ${this.stationId} has ${e.cups.length} total cup items:`,e.cups.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`)));const s=e.cups.filter((e=>"number"===typeof e.amount&&e.amount>0)),a=e.cups.filter((e=>"number"!==typeof e.amount||e.amount<=0));a.length>0&&console.log(`StockService: Station ${this.stationId} has ${a.length} cup types with zero quantity:`,a.map((e=>`${e.name} (${e.id}): ${e.amount} ${e.unit}`))),s.forEach((e=>{"cups_small"===e.id&&(t.small=!0),"cups_medium"===e.id&&(t.regular=!0),"cups_large"===e.id&&(t.large=!0);const s=e.name.toLowerCase();s.includes("small")&&(t.small=!0),(s.includes("medium")||s.includes("regular"))&&(t.regular=!0),s.includes("large")&&(t.large=!0)}));return t.small||t.regular||t.large||(console.warn("No cup sizes available, defaulting to Regular"),t.regular=!0),console.log(`StockService: Station ${this.stationId} has these cup sizes available:`,Object.entries(t).filter((e=>{let[t,s]=e;return s})).map((e=>{let[t]=e;return t})).join(", ")),t}catch(e){return console.error("Error getting available cup sizes:",e),{small:!1,regular:!0,large:!1}}}addLocalStockItem(e,t){try{const s=this._loadLocalStockData();s[e]||(s[e]=[]),t.id||(t.id=`${e}_${Date.now()}`);const a={capacity:t.amount||0,status:"good",lowThreshold:t.capacity?.25*t.capacity:0,criticalThreshold:t.capacity?.1*t.capacity:0,...t};return s[e].push(a),this._saveLocalStockData(s),!0}catch(s){return console.error("Error adding local stock item:",s),!1}}deleteLocalStockItem(e,t){try{const s=this._loadLocalStockData();return s[e]?(s[e]=s[e].filter((e=>e.id!==t)),this._saveLocalStockData(s),!0):(console.error(`Category ${e} not found`),!1)}catch(s){return console.error("Error deleting local stock item:",s),!1}}resetStationStock(){try{return this._saveLocalStockData({...this.defaultStockItems}),!0}catch(e){return console.error("Error resetting station stock data:",e),!1}}depleteStockForOrder(e){if(!this.initialized)return console.warn("StockService not initialized, cannot deplete stock"),!1;try{console.log(`Depleting stock for order: ${e.customerName} - ${e.coffeeType}`);const t=this._loadLocalStockData();if(!t)return console.warn("No stock data available for depletion"),!1;let s=!1;const a=e.shots||1,r=.01*a;if(t.coffee&&t.coffee.length>0){const e=t.coffee[0];e.amount>=r&&(e.amount=Math.max(0,e.amount-r),s=!0,console.log(`Depleted ${r}kg coffee (${a} shots). Remaining: ${e.amount}kg`))}if(e.milkType&&"No milk"!==e.milkType&&"no_milk"!==e.milkTypeId){const a=this._getMilkUsageForSize(e.coffeeType);if(t.milk&&t.milk.length>0){let r=t.milk.find((t=>t.id===e.milkTypeId||t.name.toLowerCase().includes(e.milkType.toLowerCase())));r||(r=t.milk[0]),r&&r.amount>=a&&(r.amount=Math.max(0,r.amount-a),s=!0,console.log(`Depleted ${a}L ${r.name}. Remaining: ${r.amount}L`))}}const n=1,i=this._getCupSizeFromOrder(e.coffeeType);if(t.cups&&t.cups.length>0){let e=t.cups.find((e=>e.name.toLowerCase().includes(i.toLowerCase())));e||(e=t.cups[0]),e&&e.amount>=n&&(e.amount=Math.max(0,e.amount-n),s=!0,console.log(`Depleted ${n} ${e.name}. Remaining: ${e.amount} cups`))}return s?(this._saveLocalStockData(t),console.log("Stock depletion completed successfully"),!0):(console.log("No stock items were depleted (insufficient stock or items not found)"),!1)}catch(t){return console.error("Error depleting stock for order:",t),!1}}_getMilkUsageForSize(e){const t=e.toLowerCase();return t.includes("large")?.25:t.includes("small")?.15:.2}_getCupSizeFromOrder(e){const t=e.toLowerCase();return t.includes("large")?"large":t.includes("small")?"small":"medium"}setToken(e){super.setToken(e),this.debugMode&&console.log(e?"Token set successfully in StockService":"Token cleared in StockService")}async getInventoryItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let s="/inventory";const a=[];e&&a.push(`category=${encodeURIComponent(e)}`),t&&a.push(`station_id=${encodeURIComponent(t)}`),a.length>0&&(s+="?"+a.join("&")),this.debugMode&&console.log(`Fetching inventory items from: ${s}`);const r=await this.get(s);return r&&r.success&&Array.isArray(r.items)?(this.debugMode&&console.log(`Received ${r.items.length} inventory items`),r.items):(this.debugMode&&r&&console.warn("Unexpected API response format:",r),Array.isArray(r)?r:[])}catch(s){return console.error("Failed to fetch inventory items:",s),this.enableFallback?(console.log("Using fallback inventory data"),this._getFallbackInventory(e)):[]}}async getInventoryItem(e){try{const t=await this.get(`/inventory/${e}`);if(t&&t.success)return t;throw new Error((null===t||void 0===t?void 0:t.error)||"Failed to fetch inventory item")}catch(t){throw console.error(`Failed to fetch inventory item ${e}:`,t),t}}async getLowStockItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let t="/inventory/low-stock";e&&(t+=`?station_id=${encodeURIComponent(e)}`),this.debugMode&&console.log(`Fetching low stock items from: ${t}`);const s=await this.get(t);return s&&s.success&&Array.isArray(s.items)?(this.debugMode&&console.log(`Received ${s.items.length} low stock items`),s.items):(this.debugMode&&s&&console.warn("Unexpected API response format for low stock items:",s),Array.isArray(s)?s:[])}catch(t){return console.error("Failed to fetch low stock items:",t),[]}}async getCategories(){try{const e=await this.get("/inventory/categories");return e&&e.success&&Array.isArray(e.categories)?e.categories:["milk","coffee","cups","syrups","other"]}catch(e){return console.error("Failed to fetch inventory categories:",e),["milk","coffee","cups","syrups","other"]}}async updateItemQuantity(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"manual_adjustment",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{const r=await this.post(`/inventory/${e}/adjust`,{new_amount:t,change_reason:s,notes:a});if(r&&r.success)return r.item;throw new Error((null===r||void 0===r?void 0:r.error)||"Failed to update item quantity")}catch(r){throw console.error(`Failed to update quantity for item ${e}:`,r),r}}async addInventoryItem(e){try{const t=await this.post("/inventory",e);if(t&&t.success)return t.item;throw new Error((null===t||void 0===t?void 0:t.error)||"Failed to create inventory item")}catch(t){throw console.error("Failed to create inventory item:",t),t}}async updateItemProperties(e,t){try{const s=await this.put(`/inventory/${e}`,t);if(s&&s.success)return s.item;throw new Error((null===s||void 0===s?void 0:s.error)||"Failed to update item properties")}catch(s){throw console.error(`Failed to update properties for item ${e}:`,s),s}}async deleteInventoryItem(e){try{const t=await this.delete(`/inventory/${e}`);if(t&&t.success)return!0;throw new Error((null===t||void 0===t?void 0:t.error)||"Failed to delete inventory item")}catch(t){throw console.error(`Failed to delete item ${e}:`,t),t}}async reportLowStock(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const a=await this.post(`/inventory/${e}/report-low`,{urgency:t,notes:s});if(a&&a.success)return!0;throw new Error((null===a||void 0===a?void 0:a.error)||"Failed to report low stock")}catch(a){throw console.error(`Failed to report low stock for item ${e}:`,a),a}}async requestRestock(e){try{const t=await this.post("/inventory/restock-request",{items:e});if(t)return{success:t.success||!1,message:t.message||"",requestId:t.requestId};throw new Error("Failed to request restock")}catch(t){throw console.error("Failed to request restock:",t),t}}}},730:(e,t,s)=>{var a=s(43),r=s(853);function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function p(e,t,s,a,r,n,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=i}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){f[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];f[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){f[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){f[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){f[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){f[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){f[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){f[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){f[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,s,a){var r=f.hasOwnProperty(t)?f[t]:null;(null!==r?0!==r.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,a){if(null===t||"undefined"===typeof t||function(e,t,s,a){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,a))return!0;if(a)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,r,a)&&(s=null),a||null===r?function(e){return!!u.call(g,e)||!u.call(h,e)&&(m.test(e)?g[e]=!0:(h[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=null===s?3!==r.type&&"":s:(t=r.attributeName,a=r.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(r=r.type)||4===r&&!0===s?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(x,y);f[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(x,y);f[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(x,y);f[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),f.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){f[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var v=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var $=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var D,z=Object.assign;function L(e){if(void 0===D)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var R=!1;function F(e,t){if(!e||R)return"";R=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),n=a.stack.split("\n"),i=r.length-1,o=n.length-1;1<=i&&0<=o&&r[i]!==n[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==n[o]){if(1!==i||1!==o)do{if(i--,0>--o||r[i]!==n[o]){var l="\n"+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{R=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?L(e):""}function U(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case S:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return B(e(t))}catch(s){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function J(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var r=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,n.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=H(e)?e.checked?"true":"false":e.value),(e=a)!==s&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var s=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Y(e,t){var s=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;s=q(null!=t.value?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){K(e,t);var s=q(t.value),a=t.type;if(null!=s)"number"===a?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&G(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,a){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&a&&(e[s].defaultSelected=!0)}else{for(s=""+q(s),t=null,r=0;r<e.length;r++){if(e[r].value===s)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(n(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(n(92));if(te(s)){if(1<s.length)throw Error(n(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:q(s)}}function ne(e,t){var s=q(t.value),a=q(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,a){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function me(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function pe(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var a=0===s.indexOf("--"),r=pe(s,t[s],a);"float"===s&&(s="cssFloat"),a?e.setProperty(s,r):e[s]=r}}Object.keys(he).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var xe=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(n(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(n(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(n(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,ke=null;function Se(e){if(e=yr(e)){if("function"!==typeof we)throw Error(n(280));var t=e.stateNode;t&&(t=vr(t),we(e.stateNode,e.type,t))}}function Ce(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Te(){}var Ie=!1;function Oe(e,t,s){if(Ie)return e(t,s);Ie=!0;try{return Ee(e,t,s)}finally{Ie=!1,(null!==Ne||null!==ke)&&(Te(),_e())}}function Ae(e,t){var s=e.stateNode;if(null===s)return null;var a=vr(s);if(null===a)return null;s=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(n(231,t,typeof s));return s}var $e=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){$e=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){$e=!1}function Pe(e,t,s,a,r,n,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var De=!1,ze=null,Le=!1,Re=null,Fe={onError:function(e){De=!0,ze=e}};function Ue(e,t,s,a,r,n,i,o,l){De=!1,ze=null,Pe.apply(Fe,arguments)}function Be(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(n(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(n(188));return t!==e?null:e}for(var s=e,a=t;;){var r=s.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(a=r.return)){s=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===s)return qe(r),e;if(i===a)return qe(r),t;i=i.sibling}throw Error(n(188))}if(s.return!==a.return)s=r,a=i;else{for(var o=!1,l=r.child;l;){if(l===s){o=!0,s=r,a=i;break}if(l===a){o=!0,a=r,s=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===s){o=!0,s=i,a=r;break}if(l===a){o=!0,a=i,s=r;break}l=l.sibling}if(!o)throw Error(n(189))}}if(s.alternate!==a)throw Error(n(190))}if(3!==s.tag)throw Error(n(188));return s.stateNode.current===s?e:t}(e))?Je(e):null}function Je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Je(e);if(null!==t)return t;e=e.sibling}return null}var Ve=r.unstable_scheduleCallback,Ge=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ye=r.unstable_requestPaint,Ke=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,st=r.unstable_LowPriority,at=r.unstable_IdlePriority,rt=null,nt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mt(e,t){var s=e.pendingLanes;if(0===s)return 0;var a=0,r=e.suspendedLanes,n=e.pingedLanes,i=268435455&s;if(0!==i){var o=i&~r;0!==o?a=ut(o):0!==(n&=i)&&(a=ut(n))}else 0!==(i=s&~r)?a=ut(i):0!==n&&(a=ut(n));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&r)&&((r=a&-a)>=(n=t&-t)||16===r&&0!==(4194240&n)))return t;if(0!==(4&a)&&(a|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)r=1<<(s=31-it(t)),a|=e[s],t&=~r;return a}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function ft(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function xt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=s}function yt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-it(s),r=1<<a;r&t|e[a]&t&&(e[a]|=t),s&=~r}}var bt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,wt,Nt,kt,St,Ct=!1,_t=[],Et=null,Tt=null,It=null,Ot=new Map,At=new Map,$t=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Dt(e,t,s,a,r,n){return null===e||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:n,targetContainers:[r]},null!==t&&(null!==(t=yr(t))&&wt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function zt(e){var t=xr(e.target);if(null!==t){var s=Be(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=We(s)))return e.blockedOn=t,void St(e.priority,(function(){Nt(s)}))}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=yr(s))&&wt(t),e.blockedOn=s,!1;var a=new(s=e.nativeEvent).constructor(s.type,s);ve=a,s.target.dispatchEvent(a),ve=null,t.shift()}return!0}function Rt(e,t,s){Lt(e)&&s.delete(t)}function Ft(){Ct=!1,null!==Et&&Lt(Et)&&(Et=null),null!==Tt&&Lt(Tt)&&(Tt=null),null!==It&&Lt(It)&&(It=null),Ot.forEach(Rt),At.forEach(Rt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ft)))}function Bt(e){function t(t){return Ut(t,e)}if(0<_t.length){Ut(_t[0],e);for(var s=1;s<_t.length;s++){var a=_t[s];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==Et&&Ut(Et,e),null!==Tt&&Ut(Tt,e),null!==It&&Ut(It,e),Ot.forEach(t),At.forEach(t),s=0;s<$t.length;s++)(a=$t[s]).blockedOn===e&&(a.blockedOn=null);for(;0<$t.length&&null===(s=$t[0]).blockedOn;)zt(s),null===s.blockedOn&&$t.shift()}var Wt=v.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,s,a){var r=bt,n=Wt.transition;Wt.transition=null;try{bt=1,Vt(e,t,s,a)}finally{bt=r,Wt.transition=n}}function Jt(e,t,s,a){var r=bt,n=Wt.transition;Wt.transition=null;try{bt=4,Vt(e,t,s,a)}finally{bt=r,Wt.transition=n}}function Vt(e,t,s,a){if(qt){var r=Qt(e,t,s,a);if(null===r)Wa(e,t,a,Gt,s),Pt(e,a);else if(function(e,t,s,a,r){switch(t){case"focusin":return Et=Dt(Et,e,t,s,a,r),!0;case"dragenter":return Tt=Dt(Tt,e,t,s,a,r),!0;case"mouseover":return It=Dt(It,e,t,s,a,r),!0;case"pointerover":var n=r.pointerId;return Ot.set(n,Dt(Ot.get(n)||null,e,t,s,a,r)),!0;case"gotpointercapture":return n=r.pointerId,At.set(n,Dt(At.get(n)||null,e,t,s,a,r)),!0}return!1}(r,e,t,s,a))a.stopPropagation();else if(Pt(e,a),4&t&&-1<Mt.indexOf(e)){for(;null!==r;){var n=yr(r);if(null!==n&&jt(n),null===(n=Qt(e,t,s,a))&&Wa(e,t,a,Gt,s),n===r)break;r=n}null!==r&&a.stopPropagation()}else Wa(e,t,a,null,s)}}var Gt=null;function Qt(e,t,s,a){if(Gt=null,null!==(e=xr(e=je(a))))if(null===(t=Be(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case st:return 16;case at:return 536870912;default:return 16}default:return 16}}var Kt=null,Xt=null,Zt=null;function es(){if(Zt)return Zt;var e,t,s=Xt,a=s.length,r="value"in Kt?Kt.value:Kt.textContent,n=r.length;for(e=0;e<a&&s[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&s[a-t]===r[n-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function ts(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ss(){return!0}function as(){return!1}function rs(e){function t(t,s,a,r,n){for(var i in this._reactName=t,this._targetInst=a,this.type=s,this.nativeEvent=r,this.target=n,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ss:as,this.isPropagationStopped=as,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),t}var ns,is,os,ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=rs(ls),ds=z({},ls,{view:0,detail:0}),us=rs(ds),ms=z({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ks,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==os&&(os&&"mousemove"===e.type?(ns=e.screenX-os.screenX,is=e.screenY-os.screenY):is=ns=0,os=e),ns)},movementY:function(e){return"movementY"in e?e.movementY:is}}),hs=rs(ms),gs=rs(z({},ms,{dataTransfer:0})),ps=rs(z({},ds,{relatedTarget:0})),fs=rs(z({},ls,{animationName:0,elapsedTime:0,pseudoElement:0})),xs=z({},ls,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ys=rs(xs),bs=rs(z({},ls,{data:0})),vs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ws={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ns(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ws[e])&&!!t[e]}function ks(){return Ns}var Ss=z({},ds,{key:function(e){if(e.key){var t=vs[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ts(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?js[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ks,charCode:function(e){return"keypress"===e.type?ts(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ts(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cs=rs(Ss),_s=rs(z({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Es=rs(z({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ks})),Ts=rs(z({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0})),Is=z({},ms,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Os=rs(Is),As=[9,13,27,32],$s=d&&"CompositionEvent"in window,Ms=null;d&&"documentMode"in document&&(Ms=document.documentMode);var Ps=d&&"TextEvent"in window&&!Ms,Ds=d&&(!$s||Ms&&8<Ms&&11>=Ms),zs=String.fromCharCode(32),Ls=!1;function Rs(e,t){switch(e){case"keyup":return-1!==As.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fs(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Us=!1;var Bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ws(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bs[e.type]:"textarea"===t}function qs(e,t,s,a){Ce(a),0<(t=Ha(t,"onChange")).length&&(s=new cs("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var Hs=null,Js=null;function Vs(e){za(e,0)}function Gs(e){if(V(br(e)))return e}function Qs(e,t){if("change"===e)return t}var Ys=!1;if(d){var Ks;if(d){var Xs="oninput"in document;if(!Xs){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),Xs="function"===typeof Zs.oninput}Ks=Xs}else Ks=!1;Ys=Ks&&(!document.documentMode||9<document.documentMode)}function ea(){Hs&&(Hs.detachEvent("onpropertychange",ta),Js=Hs=null)}function ta(e){if("value"===e.propertyName&&Gs(Js)){var t=[];qs(t,Js,e,je(e)),Oe(Vs,t)}}function sa(e,t,s){"focusin"===e?(ea(),Js=s,(Hs=t).attachEvent("onpropertychange",ta)):"focusout"===e&&ea()}function aa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gs(Js)}function ra(e,t){if("click"===e)return Gs(t)}function na(e,t){if("input"===e||"change"===e)return Gs(t)}var ia="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function oa(e,t){if(ia(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var r=s[a];if(!u.call(t,r)||!ia(e[r],t[r]))return!1}return!0}function la(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ca(e,t){var s,a=la(e);for(e=0;a;){if(3===a.nodeType){if(s=e+a.textContent.length,e<=t&&s>=t)return{node:a,offset:t-e};e=s}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=la(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ua(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(a){s=!1}if(!s)break;t=G((e=t.contentWindow).document)}return t}function ma(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ha(e){var t=ua(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&da(s.ownerDocument.documentElement,s)){if(null!==a&&ma(s))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=s.textContent.length,n=Math.min(a.start,r);a=void 0===a.end?n:Math.min(a.end,r),!e.extend&&n>a&&(r=a,a=n,n=r),r=ca(s,n);var i=ca(s,a);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),n>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ga=d&&"documentMode"in document&&11>=document.documentMode,pa=null,fa=null,xa=null,ya=!1;function ba(e,t,s){var a=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;ya||null==pa||pa!==G(a)||("selectionStart"in(a=pa)&&ma(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},xa&&oa(xa,a)||(xa=a,0<(a=Ha(fa,"onSelect")).length&&(t=new cs("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=pa)))}function va(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var ja={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionend:va("Transition","TransitionEnd")},wa={},Na={};function ka(e){if(wa[e])return wa[e];if(!ja[e])return e;var t,s=ja[e];for(t in s)if(s.hasOwnProperty(t)&&t in Na)return wa[e]=s[t];return e}d&&(Na=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);var Sa=ka("animationend"),Ca=ka("animationiteration"),_a=ka("animationstart"),Ea=ka("transitionend"),Ta=new Map,Ia="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(e,t){Ta.set(e,t),l(t,[e])}for(var Aa=0;Aa<Ia.length;Aa++){var $a=Ia[Aa];Oa($a.toLowerCase(),"on"+($a[0].toUpperCase()+$a.slice(1)))}Oa(Sa,"onAnimationEnd"),Oa(Ca,"onAnimationIteration"),Oa(_a,"onAnimationStart"),Oa("dblclick","onDoubleClick"),Oa("focusin","onFocus"),Oa("focusout","onBlur"),Oa(Ea,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function Da(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,a,r,i,o,l,c){if(Ue.apply(this,arguments),De){if(!De)throw Error(n(198));var d=ze;De=!1,ze=null,Le||(Le=!0,Re=d)}}(a,t,void 0,e),e.currentTarget=null}function za(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var a=e[s],r=a.event;a=a.listeners;e:{var n=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==n&&r.isPropagationStopped())break e;Da(r,o,c),n=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==n&&r.isPropagationStopped())break e;Da(r,o,c),n=l}}}if(Le)throw e=Re,Le=!1,Re=null,e}function La(e,t){var s=t[gr];void 0===s&&(s=t[gr]=new Set);var a=e+"__bubble";s.has(a)||(Ba(t,e,2,!1),s.add(a))}function Ra(e,t,s){var a=0;t&&(a|=4),Ba(s,e,a,t)}var Fa="_reactListening"+Math.random().toString(36).slice(2);function Ua(e){if(!e[Fa]){e[Fa]=!0,i.forEach((function(t){"selectionchange"!==t&&(Pa.has(t)||Ra(t,!1,e),Ra(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fa]||(t[Fa]=!0,Ra("selectionchange",!1,t))}}function Ba(e,t,s,a){switch(Yt(t)){case 1:var r=Ht;break;case 4:r=Jt;break;default:r=Vt}s=r.bind(null,t,s,e),r=void 0,!$e||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):void 0!==r?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function Wa(e,t,s,a,r){var n=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===i)for(i=a.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;i=i.return}for(;null!==o;){if(null===(i=xr(o)))return;if(5===(l=i.tag)||6===l){a=n=i;continue e}o=o.parentNode}}a=a.return}Oe((function(){var a=n,r=je(s),i=[];e:{var o=Ta.get(e);if(void 0!==o){var l=cs,c=e;switch(e){case"keypress":if(0===ts(s))break e;case"keydown":case"keyup":l=Cs;break;case"focusin":c="focus",l=ps;break;case"focusout":c="blur",l=ps;break;case"beforeblur":case"afterblur":l=ps;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Es;break;case Sa:case Ca:case _a:l=fs;break;case Ea:l=Ts;break;case"scroll":l=us;break;case"wheel":l=Os;break;case"copy":case"cut":case"paste":l=ys;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_s}var d=0!==(4&t),u=!d&&"scroll"===e,m=d?null!==o?o+"Capture":null:o;d=[];for(var h,g=a;null!==g;){var p=(h=g).stateNode;if(5===h.tag&&null!==p&&(h=p,null!==m&&(null!=(p=Ae(g,m))&&d.push(qa(g,p,h)))),u)break;g=g.return}0<d.length&&(o=new l(o,c,null,s,r),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||s===ve||!(c=s.relatedTarget||s.fromElement)||!xr(c)&&!c[hr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=a,null!==(c=(c=s.relatedTarget||s.toElement)?xr(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(d=hs,p="onMouseLeave",m="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=_s,p="onPointerLeave",m="onPointerEnter",g="pointer"),u=null==l?o:br(l),h=null==c?o:br(c),(o=new d(p,g+"leave",l,s,r)).target=u,o.relatedTarget=h,p=null,xr(r)===a&&((d=new d(m,g+"enter",c,s,r)).target=h,d.relatedTarget=u,p=d),u=p,l&&c)e:{for(m=c,g=0,h=d=l;h;h=Ja(h))g++;for(h=0,p=m;p;p=Ja(p))h++;for(;0<g-h;)d=Ja(d),g--;for(;0<h-g;)m=Ja(m),h--;for(;g--;){if(d===m||null!==m&&d===m.alternate)break e;d=Ja(d),m=Ja(m)}d=null}else d=null;null!==l&&Va(i,o,l,d,!1),null!==c&&null!==u&&Va(i,u,c,d,!0)}if("select"===(l=(o=a?br(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var f=Qs;else if(Ws(o))if(Ys)f=na;else{f=aa;var x=sa}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(f=ra);switch(f&&(f=f(e,a))?qs(i,f,s,r):(x&&x(e,o,a),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=a?br(a):window,e){case"focusin":(Ws(x)||"true"===x.contentEditable)&&(pa=x,fa=a,xa=null);break;case"focusout":xa=fa=pa=null;break;case"mousedown":ya=!0;break;case"contextmenu":case"mouseup":case"dragend":ya=!1,ba(i,s,r);break;case"selectionchange":if(ga)break;case"keydown":case"keyup":ba(i,s,r)}var y;if($s)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Us?Rs(e,s)&&(b="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(b="onCompositionStart");b&&(Ds&&"ko"!==s.locale&&(Us||"onCompositionStart"!==b?"onCompositionEnd"===b&&Us&&(y=es()):(Xt="value"in(Kt=r)?Kt.value:Kt.textContent,Us=!0)),0<(x=Ha(a,b)).length&&(b=new bs(b,e,null,s,r),i.push({event:b,listeners:x}),y?b.data=y:null!==(y=Fs(s))&&(b.data=y))),(y=Ps?function(e,t){switch(e){case"compositionend":return Fs(t);case"keypress":return 32!==t.which?null:(Ls=!0,zs);case"textInput":return(e=t.data)===zs&&Ls?null:e;default:return null}}(e,s):function(e,t){if(Us)return"compositionend"===e||!$s&&Rs(e,t)?(e=es(),Zt=Xt=Kt=null,Us=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ds&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(a=Ha(a,"onBeforeInput")).length&&(r=new bs("onBeforeInput","beforeinput",null,s,r),i.push({event:r,listeners:a}),r.data=y))}za(i,t)}))}function qa(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Ha(e,t){for(var s=t+"Capture",a=[];null!==e;){var r=e,n=r.stateNode;5===r.tag&&null!==n&&(r=n,null!=(n=Ae(e,s))&&a.unshift(qa(e,n,r)),null!=(n=Ae(e,t))&&a.push(qa(e,n,r))),e=e.return}return a}function Ja(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Va(e,t,s,a,r){for(var n=t._reactName,i=[];null!==s&&s!==a;){var o=s,l=o.alternate,c=o.stateNode;if(null!==l&&l===a)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Ae(s,n))&&i.unshift(qa(s,l,o)):r||null!=(l=Ae(s,n))&&i.push(qa(s,l,o))),s=s.return}0!==i.length&&e.push({event:t,listeners:i})}var Ga=/\r\n?/g,Qa=/\u0000|\uFFFD/g;function Ya(e){return("string"===typeof e?e:""+e).replace(Ga,"\n").replace(Qa,"")}function Ka(e,t,s){if(t=Ya(t),Ya(e)!==t&&s)throw Error(n(425))}function Xa(){}var Za=null,er=null;function tr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sr="function"===typeof setTimeout?setTimeout:void 0,ar="function"===typeof clearTimeout?clearTimeout:void 0,rr="function"===typeof Promise?Promise:void 0,nr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rr?function(e){return rr.resolve(null).then(e).catch(ir)}:sr;function ir(e){setTimeout((function(){throw e}))}function or(e,t){var s=t,a=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&8===r.nodeType)if("/$"===(s=r.data)){if(0===a)return e.removeChild(r),void Bt(t);a--}else"$"!==s&&"$?"!==s&&"$!"!==s||a++;s=r}while(s);Bt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),ur="__reactFiber$"+dr,mr="__reactProps$"+dr,hr="__reactContainer$"+dr,gr="__reactEvents$"+dr,pr="__reactListeners$"+dr,fr="__reactHandles$"+dr;function xr(e){var t=e[ur];if(t)return t;for(var s=e.parentNode;s;){if(t=s[hr]||s[ur]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=cr(e);null!==e;){if(s=e[ur])return s;e=cr(e)}return t}s=(e=s).parentNode}return null}function yr(e){return!(e=e[ur]||e[hr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(n(33))}function vr(e){return e[mr]||null}var jr=[],wr=-1;function Nr(e){return{current:e}}function kr(e){0>wr||(e.current=jr[wr],jr[wr]=null,wr--)}function Sr(e,t){wr++,jr[wr]=e.current,e.current=t}var Cr={},_r=Nr(Cr),Er=Nr(!1),Tr=Cr;function Ir(e,t){var s=e.type.contextTypes;if(!s)return Cr;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r,n={};for(r in s)n[r]=t[r];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Or(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ar(){kr(Er),kr(_r)}function $r(e,t,s){if(_r.current!==Cr)throw Error(n(168));Sr(_r,t),Sr(Er,s)}function Mr(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return s;for(var r in a=a.getChildContext())if(!(r in t))throw Error(n(108,W(e)||"Unknown",r));return z({},s,a)}function Pr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Tr=_r.current,Sr(_r,e),Sr(Er,Er.current),!0}function Dr(e,t,s){var a=e.stateNode;if(!a)throw Error(n(169));s?(e=Mr(e,t,Tr),a.__reactInternalMemoizedMergedChildContext=e,kr(Er),kr(_r),Sr(_r,e)):kr(Er),Sr(Er,s)}var zr=null,Lr=!1,Rr=!1;function Fr(e){null===zr?zr=[e]:zr.push(e)}function Ur(){if(!Rr&&null!==zr){Rr=!0;var e=0,t=bt;try{var s=zr;for(bt=1;e<s.length;e++){var a=s[e];do{a=a(!0)}while(null!==a)}zr=null,Lr=!1}catch(r){throw null!==zr&&(zr=zr.slice(e+1)),Ve(Ze,Ur),r}finally{bt=t,Rr=!1}}return null}var Br=[],Wr=0,qr=null,Hr=0,Jr=[],Vr=0,Gr=null,Qr=1,Yr="";function Kr(e,t){Br[Wr++]=Hr,Br[Wr++]=qr,qr=e,Hr=t}function Xr(e,t,s){Jr[Vr++]=Qr,Jr[Vr++]=Yr,Jr[Vr++]=Gr,Gr=e;var a=Qr;e=Yr;var r=32-it(a)-1;a&=~(1<<r),s+=1;var n=32-it(t)+r;if(30<n){var i=r-r%5;n=(a&(1<<i)-1).toString(32),a>>=i,r-=i,Qr=1<<32-it(t)+r|s<<r|a,Yr=n+e}else Qr=1<<n|s<<r|a,Yr=e}function Zr(e){null!==e.return&&(Kr(e,1),Xr(e,1,0))}function en(e){for(;e===qr;)qr=Br[--Wr],Br[Wr]=null,Hr=Br[--Wr],Br[Wr]=null;for(;e===Gr;)Gr=Jr[--Vr],Jr[Vr]=null,Yr=Jr[--Vr],Jr[Vr]=null,Qr=Jr[--Vr],Jr[Vr]=null}var tn=null,sn=null,an=!1,rn=null;function nn(e,t){var s=Oc(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function on(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,tn=e,sn=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,tn=e,sn=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Gr?{id:Qr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Oc(18,null,null,0)).stateNode=t,s.return=e,e.child=s,tn=e,sn=null,!0);default:return!1}}function ln(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cn(e){if(an){var t=sn;if(t){var s=t;if(!on(e,t)){if(ln(e))throw Error(n(418));t=lr(s.nextSibling);var a=tn;t&&on(e,t)?nn(a,s):(e.flags=-4097&e.flags|2,an=!1,tn=e)}}else{if(ln(e))throw Error(n(418));e.flags=-4097&e.flags|2,an=!1,tn=e}}}function dn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;tn=e}function un(e){if(e!==tn)return!1;if(!an)return dn(e),an=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tr(e.type,e.memoizedProps)),t&&(t=sn)){if(ln(e))throw mn(),Error(n(418));for(;t;)nn(e,t),t=lr(t.nextSibling)}if(dn(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){sn=lr(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}sn=null}}else sn=tn?lr(e.stateNode.nextSibling):null;return!0}function mn(){for(var e=sn;e;)e=lr(e.nextSibling)}function hn(){sn=tn=null,an=!1}function gn(e){null===rn?rn=[e]:rn.push(e)}var pn=v.ReactCurrentBatchConfig;function fn(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(n(309));var a=s.stateNode}if(!a)throw Error(n(147,e));var r=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(n(284));if(!s._owner)throw Error(n(290,e))}return e}function xn(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yn(e){return(0,e._init)(e._payload)}function bn(e){function t(t,s){if(e){var a=t.deletions;null===a?(t.deletions=[s],t.flags|=16):a.push(s)}}function s(s,a){if(!e)return null;for(;null!==a;)t(s,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=$c(e,t)).index=0,e.sibling=null,e}function i(t,s,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<s?(t.flags|=2,s):a:(t.flags|=2,s):(t.flags|=1048576,s)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,s,a){return null===t||6!==t.tag?((t=zc(s,e.mode,a)).return=e,t):((t=r(t,s)).return=e,t)}function c(e,t,s,a){var n=s.type;return n===N?u(e,t,s.props.children,a,s.key):null!==t&&(t.elementType===n||"object"===typeof n&&null!==n&&n.$$typeof===A&&yn(n)===t.type)?((a=r(t,s.props)).ref=fn(e,t,s),a.return=e,a):((a=Mc(s.type,s.key,s.props,null,e.mode,a)).ref=fn(e,t,s),a.return=e,a)}function d(e,t,s,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Lc(s,e.mode,a)).return=e,t):((t=r(t,s.children||[])).return=e,t)}function u(e,t,s,a,n){return null===t||7!==t.tag?((t=Pc(s,e.mode,a,n)).return=e,t):((t=r(t,s)).return=e,t)}function m(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=zc(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(s=Mc(t.type,t.key,t.props,null,e.mode,s)).ref=fn(e,null,t),s.return=e,s;case w:return(t=Lc(t,e.mode,s)).return=e,t;case A:return m(e,(0,t._init)(t._payload),s)}if(te(t)||P(t))return(t=Pc(t,e.mode,s,null)).return=e,t;xn(e,t)}return null}function h(e,t,s,a){var r=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==r?null:l(e,t,""+s,a);if("object"===typeof s&&null!==s){switch(s.$$typeof){case j:return s.key===r?c(e,t,s,a):null;case w:return s.key===r?d(e,t,s,a):null;case A:return h(e,t,(r=s._init)(s._payload),a)}if(te(s)||P(s))return null!==r?null:u(e,t,s,a,null);xn(e,s)}return null}function g(e,t,s,a,r){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(s)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case j:return c(t,e=e.get(null===a.key?s:a.key)||null,a,r);case w:return d(t,e=e.get(null===a.key?s:a.key)||null,a,r);case A:return g(e,t,s,(0,a._init)(a._payload),r)}if(te(a)||P(a))return u(t,e=e.get(s)||null,a,r,null);xn(t,a)}return null}function p(r,n,o,l){for(var c=null,d=null,u=n,p=n=0,f=null;null!==u&&p<o.length;p++){u.index>p?(f=u,u=null):f=u.sibling;var x=h(r,u,o[p],l);if(null===x){null===u&&(u=f);break}e&&u&&null===x.alternate&&t(r,u),n=i(x,n,p),null===d?c=x:d.sibling=x,d=x,u=f}if(p===o.length)return s(r,u),an&&Kr(r,p),c;if(null===u){for(;p<o.length;p++)null!==(u=m(r,o[p],l))&&(n=i(u,n,p),null===d?c=u:d.sibling=u,d=u);return an&&Kr(r,p),c}for(u=a(r,u);p<o.length;p++)null!==(f=g(u,r,p,o[p],l))&&(e&&null!==f.alternate&&u.delete(null===f.key?p:f.key),n=i(f,n,p),null===d?c=f:d.sibling=f,d=f);return e&&u.forEach((function(e){return t(r,e)})),an&&Kr(r,p),c}function f(r,o,l,c){var d=P(l);if("function"!==typeof d)throw Error(n(150));if(null==(l=d.call(l)))throw Error(n(151));for(var u=d=null,p=o,f=o=0,x=null,y=l.next();null!==p&&!y.done;f++,y=l.next()){p.index>f?(x=p,p=null):x=p.sibling;var b=h(r,p,y.value,c);if(null===b){null===p&&(p=x);break}e&&p&&null===b.alternate&&t(r,p),o=i(b,o,f),null===u?d=b:u.sibling=b,u=b,p=x}if(y.done)return s(r,p),an&&Kr(r,f),d;if(null===p){for(;!y.done;f++,y=l.next())null!==(y=m(r,y.value,c))&&(o=i(y,o,f),null===u?d=y:u.sibling=y,u=y);return an&&Kr(r,f),d}for(p=a(r,p);!y.done;f++,y=l.next())null!==(y=g(p,r,f,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?f:y.key),o=i(y,o,f),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach((function(e){return t(r,e)})),an&&Kr(r,f),d}return function e(a,n,i,l){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case j:e:{for(var c=i.key,d=n;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){s(a,d.sibling),(n=r(d,i.props.children)).return=a,a=n;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&yn(c)===d.type){s(a,d.sibling),(n=r(d,i.props)).ref=fn(a,d,i),n.return=a,a=n;break e}s(a,d);break}t(a,d),d=d.sibling}i.type===N?((n=Pc(i.props.children,a.mode,l,i.key)).return=a,a=n):((l=Mc(i.type,i.key,i.props,null,a.mode,l)).ref=fn(a,n,i),l.return=a,a=l)}return o(a);case w:e:{for(d=i.key;null!==n;){if(n.key===d){if(4===n.tag&&n.stateNode.containerInfo===i.containerInfo&&n.stateNode.implementation===i.implementation){s(a,n.sibling),(n=r(n,i.children||[])).return=a,a=n;break e}s(a,n);break}t(a,n),n=n.sibling}(n=Lc(i,a.mode,l)).return=a,a=n}return o(a);case A:return e(a,n,(d=i._init)(i._payload),l)}if(te(i))return p(a,n,i,l);if(P(i))return f(a,n,i,l);xn(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==n&&6===n.tag?(s(a,n.sibling),(n=r(n,i)).return=a,a=n):(s(a,n),(n=zc(i,a.mode,l)).return=a,a=n),o(a)):s(a,n)}}var vn=bn(!0),jn=bn(!1),wn=Nr(null),Nn=null,kn=null,Sn=null;function Cn(){Sn=kn=Nn=null}function _n(e){var t=wn.current;kr(wn),e._currentValue=t}function En(e,t,s){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function Tn(e,t){Nn=e,Sn=kn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function In(e){var t=e._currentValue;if(Sn!==e)if(e={context:e,memoizedValue:t,next:null},null===kn){if(null===Nn)throw Error(n(308));kn=e,Nn.dependencies={lanes:0,firstContext:e}}else kn=kn.next=e;return t}var On=null;function An(e){null===On?On=[e]:On.push(e)}function $n(e,t,s,a){var r=t.interleaved;return null===r?(s.next=s,An(t)):(s.next=r.next,r.next=s),t.interleaved=s,Mn(e,a)}function Mn(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Pn=!1;function Dn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ln(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rn(e,t,s){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&El)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Mn(e,s)}return null===(r=a.interleaved)?(t.next=t,An(a)):(t.next=r.next,r.next=t),a.interleaved=t,Mn(e,s)}function Fn(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,yt(e,s)}}function Un(e,t){var s=e.updateQueue,a=e.alternate;if(null!==a&&s===(a=a.updateQueue)){var r=null,n=null;if(null!==(s=s.firstBaseUpdate)){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===n?r=n=i:n=n.next=i,s=s.next}while(null!==s);null===n?r=n=t:n=n.next=t}else r=n=t;return s={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:a.shared,effects:a.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Bn(e,t,s,a){var r=e.updateQueue;Pn=!1;var n=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?n=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==n){var u=r.baseState;for(i=0,d=c=l=null,o=n;;){var m=o.lane,h=o.eventTime;if((a&m)===m){null!==d&&(d=d.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,p=o;switch(m=t,h=s,p.tag){case 1:if("function"===typeof(g=p.payload)){u=g.call(h,u,m);break e}u=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(m="function"===typeof(g=p.payload)?g.call(h,u,m):g)||void 0===m)break e;u=z({},u,m);break e;case 2:Pn=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(m=r.effects)?r.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=h,l=u):d=d.next=h,i|=m;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(m=o).next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===n&&(r.shared.lanes=0);Dl|=i,e.lanes=i,e.memoizedState=u}}function Wn(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(null!==r){if(a.callback=null,a=s,"function"!==typeof r)throw Error(n(191,r));r.call(a)}}}var qn={},Hn=Nr(qn),Jn=Nr(qn),Vn=Nr(qn);function Gn(e){if(e===qn)throw Error(n(174));return e}function Qn(e,t){switch(Sr(Vn,t),Sr(Jn,e),Sr(Hn,qn),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}kr(Hn),Sr(Hn,t)}function Yn(){kr(Hn),kr(Jn),kr(Vn)}function Kn(e){Gn(Vn.current);var t=Gn(Hn.current),s=le(t,e.type);t!==s&&(Sr(Jn,e),Sr(Hn,s))}function Xn(e){Jn.current===e&&(kr(Hn),kr(Jn))}var Zn=Nr(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function si(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ai=v.ReactCurrentDispatcher,ri=v.ReactCurrentBatchConfig,ni=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,mi=0;function hi(){throw Error(n(321))}function gi(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!ia(e[s],t[s]))return!1;return!0}function pi(e,t,s,a,r,i){if(ni=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=null===e||null===e.memoizedState?Xi:Zi,e=s(a,r),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(n(301));i+=1,li=oi=null,t.updateQueue=null,ai.current=eo,e=s(a,r)}while(di)}if(ai.current=Ki,t=null!==oi&&null!==oi.next,ni=0,li=oi=ii=null,ci=!1,t)throw Error(n(300));return e}function fi(){var e=0!==ui;return ui=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function yi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(n(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function bi(e,t){return"function"===typeof t?t(e):t}function vi(e){var t=yi(),s=t.queue;if(null===s)throw Error(n(311));s.lastRenderedReducer=e;var a=oi,r=a.baseQueue,i=s.pending;if(null!==i){if(null!==r){var o=r.next;r.next=i.next,i.next=o}a.baseQueue=r=i,s.pending=null}if(null!==r){i=r.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((ni&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=m,o=a):c=c.next=m,ii.lanes|=u,Dl|=u}d=d.next}while(null!==d&&d!==i);null===c?o=a:c.next=l,ia(a,t.memoizedState)||(bo=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,s.lastRenderedState=a}if(null!==(e=s.interleaved)){r=e;do{i=r.lane,ii.lanes|=i,Dl|=i,r=r.next}while(r!==e)}else null===r&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function ji(e){var t=yi(),s=t.queue;if(null===s)throw Error(n(311));s.lastRenderedReducer=e;var a=s.dispatch,r=s.pending,i=t.memoizedState;if(null!==r){s.pending=null;var o=r=r.next;do{i=e(i,o.action),o=o.next}while(o!==r);ia(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),s.lastRenderedState=i}return[i,a]}function wi(){}function Ni(e,t){var s=ii,a=yi(),r=t(),i=!ia(a.memoizedState,r);if(i&&(a.memoizedState=r,bo=!0),a=a.queue,Pi(Ci.bind(null,s,a,e),[e]),a.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(s.flags|=2048,Ii(9,Si.bind(null,s,a,r,t),void 0,null),null===Tl)throw Error(n(349));0!==(30&ni)||ki(s,t,r)}return r}function ki(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function Si(e,t,s,a){t.value=s,t.getSnapshot=a,_i(t)&&Ei(e)}function Ci(e,t,s){return s((function(){_i(t)&&Ei(e)}))}function _i(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!ia(e,s)}catch(a){return!0}}function Ei(e){var t=Mn(e,1);null!==t&&sc(t,e,1,-1)}function Ti(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=Vi.bind(null,ii,e),[t.memoizedState,e]}function Ii(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e),e}function Oi(){return yi().memoizedState}function Ai(e,t,s,a){var r=xi();ii.flags|=e,r.memoizedState=Ii(1|t,s,void 0,void 0===a?null:a)}function $i(e,t,s,a){var r=yi();a=void 0===a?null:a;var n=void 0;if(null!==oi){var i=oi.memoizedState;if(n=i.destroy,null!==a&&gi(a,i.deps))return void(r.memoizedState=Ii(t,s,n,a))}ii.flags|=e,r.memoizedState=Ii(1|t,s,n,a)}function Mi(e,t){return Ai(8390656,8,e,t)}function Pi(e,t){return $i(2048,8,e,t)}function Di(e,t){return $i(4,2,e,t)}function zi(e,t){return $i(4,4,e,t)}function Li(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ri(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,$i(4,4,Li.bind(null,t,e),s)}function Fi(){}function Ui(e,t){var s=yi();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&gi(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function Bi(e,t){var s=yi();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&gi(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function Wi(e,t,s){return 0===(21&ni)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=s):(ia(s,t)||(s=pt(),ii.lanes|=s,Dl|=s,e.baseState=!0),t)}function qi(e,t){var s=bt;bt=0!==s&&4>s?s:4,e(!0);var a=ri.transition;ri.transition={};try{e(!1),t()}finally{bt=s,ri.transition=a}}function Hi(){return yi().memoizedState}function Ji(e,t,s){var a=tc(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},Gi(e))Qi(t,s);else if(null!==(s=$n(e,t,s,a))){sc(s,e,a,ec()),Yi(s,t,a)}}function Vi(e,t,s){var a=tc(e),r={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(Gi(e))Qi(t,r);else{var n=e.alternate;if(0===e.lanes&&(null===n||0===n.lanes)&&null!==(n=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=n(i,s);if(r.hasEagerState=!0,r.eagerState=o,ia(o,i)){var l=t.interleaved;return null===l?(r.next=r,An(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(s=$n(e,t,r,a))&&(sc(s,e,a,r=ec()),Yi(s,t,a))}}function Gi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Qi(e,t){di=ci=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Yi(e,t,s){if(0!==(4194240&s)){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,yt(e,s)}}var Ki={readContext:In,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},Xi={readContext:In,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:In,useEffect:Mi,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ai(4194308,4,Li.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ai(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ai(4,2,e,t)},useMemo:function(e,t){var s=xi();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=xi();return t=void 0!==s?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Ji.bind(null,ii,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ti,useDebugValue:Fi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=qi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=ii,r=xi();if(an){if(void 0===s)throw Error(n(407));s=s()}else{if(s=t(),null===Tl)throw Error(n(349));0!==(30&ni)||ki(a,t,s)}r.memoizedState=s;var i={value:s,getSnapshot:t};return r.queue=i,Mi(Ci.bind(null,a,i,e),[e]),a.flags|=2048,Ii(9,Si.bind(null,a,i,s,t),void 0,null),s},useId:function(){var e=xi(),t=Tl.identifierPrefix;if(an){var s=Yr;t=":"+t+"R"+(s=(Qr&~(1<<32-it(Qr)-1)).toString(32)+s),0<(s=ui++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=mi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:In,useCallback:Ui,useContext:In,useEffect:Pi,useImperativeHandle:Ri,useInsertionEffect:Di,useLayoutEffect:zi,useMemo:Bi,useReducer:vi,useRef:Oi,useState:function(){return vi(bi)},useDebugValue:Fi,useDeferredValue:function(e){return Wi(yi(),oi.memoizedState,e)},useTransition:function(){return[vi(bi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1},eo={readContext:In,useCallback:Ui,useContext:In,useEffect:Pi,useImperativeHandle:Ri,useInsertionEffect:Di,useLayoutEffect:zi,useMemo:Bi,useReducer:ji,useRef:Oi,useState:function(){return ji(bi)},useDebugValue:Fi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:Wi(t,oi.memoizedState,e)},useTransition:function(){return[ji(bi)[0],yi().memoizedState]},useMutableSource:wi,useSyncExternalStore:Ni,useId:Hi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var s in t=z({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function so(e,t,s,a){s=null===(s=s(a,t=e.memoizedState))||void 0===s?t:z({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var ao={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=ec(),r=tc(e),n=Ln(a,r);n.payload=t,void 0!==s&&null!==s&&(n.callback=s),null!==(t=Rn(e,n,r))&&(sc(t,e,r,a),Fn(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=ec(),r=tc(e),n=Ln(a,r);n.tag=1,n.payload=t,void 0!==s&&null!==s&&(n.callback=s),null!==(t=Rn(e,n,r))&&(sc(t,e,r,a),Fn(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ec(),a=tc(e),r=Ln(s,a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Rn(e,r,a))&&(sc(t,e,a,s),Fn(t,e,a))}};function ro(e,t,s,a,r,n,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,n,i):!t.prototype||!t.prototype.isPureReactComponent||(!oa(s,a)||!oa(r,n))}function no(e,t,s){var a=!1,r=Cr,n=t.contextType;return"object"===typeof n&&null!==n?n=In(n):(r=Or(t)?Tr:_r.current,n=(a=null!==(a=t.contextTypes)&&void 0!==a)?Ir(e,r):Cr),t=new t(s,n),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=n),t}function io(e,t,s,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function oo(e,t,s,a){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Dn(e);var n=t.contextType;"object"===typeof n&&null!==n?r.context=In(n):(n=Or(t)?Tr:_r.current,r.context=Ir(e,n)),r.state=e.memoizedState,"function"===typeof(n=t.getDerivedStateFromProps)&&(so(e,t,n,s),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ao.enqueueReplaceState(r,r.state,null),Bn(e,s,r,a),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var s="",a=t;do{s+=U(a),a=a.return}while(a);var r=s}catch(n){r="\nError generating stack: "+n.message+"\n"+n.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(s){setTimeout((function(){throw s}))}}var mo="function"===typeof WeakMap?WeakMap:Map;function ho(e,t,s){(s=Ln(-1,s)).tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){ql||(ql=!0,Hl=a),uo(0,t)},s}function go(e,t,s){(s=Ln(-1,s)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var r=t.value;s.payload=function(){return a(r)},s.callback=function(){uo(0,t)}}var n=e.stateNode;return null!==n&&"function"===typeof n.componentDidCatch&&(s.callback=function(){uo(0,t),"function"!==typeof a&&(null===Jl?Jl=new Set([this]):Jl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function po(e,t,s){var a=e.pingCache;if(null===a){a=e.pingCache=new mo;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(s)||(r.add(s),e=Sc.bind(null,e,t,s),t.then(e,e))}function fo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,s,a,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Ln(-1,1)).tag=2,Rn(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var yo=v.ReactCurrentOwner,bo=!1;function vo(e,t,s,a){t.child=null===e?jn(t,null,s,a):vn(t,e.child,s,a)}function jo(e,t,s,a,r){s=s.render;var n=t.ref;return Tn(t,r),a=pi(e,t,s,a,n,r),s=fi(),null===e||bo?(an&&s&&Zr(t),t.flags|=1,vo(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function wo(e,t,s,a,r){if(null===e){var n=s.type;return"function"!==typeof n||Ac(n)||void 0!==n.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Mc(s.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=n,No(e,t,n,a,r))}if(n=e.child,0===(e.lanes&r)){var i=n.memoizedProps;if((s=null!==(s=s.compare)?s:oa)(i,a)&&e.ref===t.ref)return qo(e,t,r)}return t.flags|=1,(e=$c(n,a)).ref=t.ref,e.return=t,t.child=e}function No(e,t,s,a,r){if(null!==e){var n=e.memoizedProps;if(oa(n,a)&&e.ref===t.ref){if(bo=!1,t.pendingProps=a=n,0===(e.lanes&r))return t.lanes=e.lanes,qo(e,t,r);0!==(131072&e.flags)&&(bo=!0)}}return Co(e,t,s,a,r)}function ko(e,t,s){var a=t.pendingProps,r=a.children,n=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr($l,Al),Al|=s;else{if(0===(1073741824&s))return e=null!==n?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sr($l,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==n?n.baseLanes:s,Sr($l,Al),Al|=a}else null!==n?(a=n.baseLanes|s,t.memoizedState=null):a=s,Sr($l,Al),Al|=a;return vo(e,t,r,s),t.child}function So(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,s,a,r){var n=Or(s)?Tr:_r.current;return n=Ir(t,n),Tn(t,r),s=pi(e,t,s,a,n,r),a=fi(),null===e||bo?(an&&a&&Zr(t),t.flags|=1,vo(e,t,s,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function _o(e,t,s,a,r){if(Or(s)){var n=!0;Pr(t)}else n=!1;if(Tn(t,r),null===t.stateNode)Wo(e,t),no(t,s,a),oo(t,s,a,r),a=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=s.contextType;"object"===typeof c&&null!==c?c=In(c):c=Ir(t,c=Or(s)?Tr:_r.current);var d=s.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==a||l!==c)&&io(t,i,a,c),Pn=!1;var m=t.memoizedState;i.state=m,Bn(t,a,i,r),l=t.memoizedState,o!==a||m!==l||Er.current||Pn?("function"===typeof d&&(so(t,s,d,a),l=t.memoizedState),(o=Pn||ro(t,s,o,a,m,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=c,a=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,zn(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,m=i.context,"object"===typeof(l=s.contextType)&&null!==l?l=In(l):l=Ir(t,l=Or(s)?Tr:_r.current);var h=s.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||m!==l)&&io(t,i,a,l),Pn=!1,m=t.memoizedState,i.state=m,Bn(t,a,i,r);var g=t.memoizedState;o!==u||m!==g||Er.current||Pn?("function"===typeof h&&(so(t,s,h,a),g=t.memoizedState),(c=Pn||ro(t,s,c,a,m,g,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,g,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,g,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=g),i.props=a,i.state=g,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),a=!1)}return Eo(e,t,s,a,n,r)}function Eo(e,t,s,a,r,n){So(e,t);var i=0!==(128&t.flags);if(!a&&!i)return r&&Dr(t,s,!1),qo(e,t,n);a=t.stateNode,yo.current=t;var o=i&&"function"!==typeof s.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=vn(t,e.child,null,n),t.child=vn(t,null,o,n)):vo(e,t,o,n),t.memoizedState=a.state,r&&Dr(t,s,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?$r(0,t.pendingContext,t.pendingContext!==t.context):t.context&&$r(0,t.context,!1),Qn(e,t.containerInfo)}function Io(e,t,s,a,r){return hn(),gn(r),t.flags|=256,vo(e,t,s,a),t.child}var Oo,Ao,$o,Mo,Po={dehydrated:null,treeContext:null,retryLane:0};function Do(e){return{baseLanes:e,cachePool:null,transitions:null}}function zo(e,t,s){var a,r=t.pendingProps,i=Zn.current,o=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Sr(Zn,1&i),null===e)return cn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Dc(l,r,0,null),e=Pc(e,r,s,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Do(s),t.memoizedState=Po,e):Lo(t,l));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,s,a,r,i,o){if(s)return 256&t.flags?(t.flags&=-257,Ro(e,t,o,a=co(Error(n(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,r=t.mode,a=Dc({mode:"visible",children:a.children},r,0,null),(i=Pc(i,r,o,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&vn(t,e.child,null,o),t.child.memoizedState=Do(o),t.memoizedState=Po,i);if(0===(1&t.mode))return Ro(e,t,o,null);if("$!"===r.data){if(a=r.nextSibling&&r.nextSibling.dataset)var l=a.dgst;return a=l,Ro(e,t,o,a=co(i=Error(n(419)),a,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(a=Tl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(a.suspendedLanes|o))?0:r)&&r!==i.retryLane&&(i.retryLane=r,Mn(e,r),sc(a,e,r,-1))}return pc(),Ro(e,t,o,a=co(Error(n(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,sn=lr(r.nextSibling),tn=t,an=!0,rn=null,null!==e&&(Jr[Vr++]=Qr,Jr[Vr++]=Yr,Jr[Vr++]=Gr,Qr=e.id,Yr=e.overflow,Gr=t),t=Lo(t,a.children),t.flags|=4096,t)}(e,t,l,r,a,i,s);if(o){o=r.fallback,l=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==i?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=$c(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?o=$c(a,o):(o=Pc(o,l,s,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Do(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~s,t.memoizedState=Po,r}return e=(o=e.child).sibling,r=$c(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=s),r.return=t,r.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r}function Lo(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ro(e,t,s,a){return null!==a&&gn(a),vn(t,e.child,null,s),(e=Lo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fo(e,t,s){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),En(e.return,t,s)}function Uo(e,t,s,a,r){var n=e.memoizedState;null===n?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:r}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=a,n.tail=s,n.tailMode=r)}function Bo(e,t,s){var a=t.pendingProps,r=a.revealOrder,n=a.tail;if(vo(e,t,a.children,s),0!==(2&(a=Zn.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fo(e,s,t);else if(19===e.tag)Fo(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Sr(Zn,a),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;null!==s;)null!==(e=s.alternate)&&null===ei(e)&&(r=s),s=s.sibling;null===(s=r)?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),Uo(t,!1,r,s,n);break;case"backwards":for(s=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ei(e)){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}Uo(t,!0,s,null,n);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(n(153));if(null!==t.child){for(s=$c(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=$c(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Ho(e,t){if(!an)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;null!==s;)null!==s.alternate&&(a=s),s=s.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Jo(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,a=0;if(t)for(var r=e.child;null!==r;)s|=r.lanes|r.childLanes,a|=14680064&r.subtreeFlags,a|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)s|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function Vo(e,t,s){var a=t.pendingProps;switch(en(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jo(t),null;case 1:case 17:return Or(t.type)&&Ar(),Jo(t),null;case 3:return a=t.stateNode,Yn(),kr(Er),kr(_r),si(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(un(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rn&&(ic(rn),rn=null))),Ao(e,t),Jo(t),null;case 5:Xn(t);var r=Gn(Vn.current);if(s=t.type,null!==e&&null!=t.stateNode)$o(e,t,s,a,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(n(166));return Jo(t),null}if(e=Gn(Hn.current),un(t)){a=t.stateNode,s=t.type;var i=t.memoizedProps;switch(a[ur]=t,a[mr]=i,e=0!==(1&t.mode),s){case"dialog":La("cancel",a),La("close",a);break;case"iframe":case"object":case"embed":La("load",a);break;case"video":case"audio":for(r=0;r<Ma.length;r++)La(Ma[r],a);break;case"source":La("error",a);break;case"img":case"image":case"link":La("error",a),La("load",a);break;case"details":La("toggle",a);break;case"input":Y(a,i),La("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},La("invalid",a);break;case"textarea":re(a,i),La("invalid",a)}for(var l in ye(s,i),r=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Ka(a.textContent,c,e),r=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Ka(a.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&La("scroll",a)}switch(s){case"input":J(a),Z(a,i,!0);break;case"textarea":J(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=Xa)}a=r,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(s,{is:a.is}):(e=l.createElement(s),"select"===s&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,s),e[ur]=t,e[mr]=a,Oo(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(s,a),s){case"dialog":La("cancel",e),La("close",e),r=a;break;case"iframe":case"object":case"embed":La("load",e),r=a;break;case"video":case"audio":for(r=0;r<Ma.length;r++)La(Ma[r],e);r=a;break;case"source":La("error",e),r=a;break;case"img":case"image":case"link":La("error",e),La("load",e),r=a;break;case"details":La("toggle",e),r=a;break;case"input":Y(e,a),r=Q(e,a),La("invalid",e);break;case"option":default:r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=z({},a,{value:void 0}),La("invalid",e);break;case"textarea":re(e,a),r=ae(e,a),La("invalid",e)}for(i in ye(s,r),c=r)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?fe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==s||""!==d)&&me(e,d):"number"===typeof d&&me(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&La("scroll",e):null!=d&&b(e,i,d,l))}switch(s){case"input":J(e),Z(e,a,!1);break;case"textarea":J(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+q(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?se(e,!!a.multiple,i,!1):null!=a.defaultValue&&se(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Xa)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Jo(t),null;case 6:if(e&&null!=t.stateNode)Mo(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(n(166));if(s=Gn(Vn.current),Gn(Hn.current),un(t)){if(a=t.stateNode,s=t.memoizedProps,a[ur]=t,(i=a.nodeValue!==s)&&null!==(e=tn))switch(e.tag){case 3:Ka(a.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ka(a.nodeValue,s,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===s.nodeType?s:s.ownerDocument).createTextNode(a))[ur]=t,t.stateNode=a}return Jo(t),null;case 13:if(kr(Zn),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(an&&null!==sn&&0!==(1&t.mode)&&0===(128&t.flags))mn(),hn(),t.flags|=98560,i=!1;else if(i=un(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(n(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(n(317));i[ur]=t}else hn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Jo(t),i=!1}else null!==rn&&(ic(rn),rn=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zn.current)?0===Ml&&(Ml=3):pc())),null!==t.updateQueue&&(t.flags|=4),Jo(t),null);case 4:return Yn(),Ao(e,t),null===e&&Ua(t.stateNode.containerInfo),Jo(t),null;case 10:return _n(t.type._context),Jo(t),null;case 19:if(kr(Zn),null===(i=t.memoizedState))return Jo(t),null;if(a=0!==(128&t.flags),null===(l=i.rendering))if(a)Ho(i,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Ho(i,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;null!==s;)e=a,(i=s).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Sr(Zn,1&Zn.current|2),t.child}e=e.sibling}null!==i.tail&&Ke()>Bl&&(t.flags|=128,a=!0,Ho(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ei(l))){if(t.flags|=128,a=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Ho(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!an)return Jo(t),null}else 2*Ke()-i.renderingStartTime>Bl&&1073741824!==s&&(t.flags|=128,a=!0,Ho(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(s=i.last)?s.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ke(),t.sibling=null,s=Zn.current,Sr(Zn,a?1&s|2:1&s),t):(Jo(t),null);case 22:case 23:return uc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Jo(t),6&t.subtreeFlags&&(t.flags|=8192)):Jo(t),null;case 24:case 25:return null}throw Error(n(156,t.tag))}function Go(e,t){switch(en(t),t.tag){case 1:return Or(t.type)&&Ar(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yn(),kr(Er),kr(_r),si(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xn(t),null;case 13:if(kr(Zn),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(n(340));hn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return kr(Zn),null;case 4:return Yn(),null;case 10:return _n(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Oo=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Ao=function(){},$o=function(e,t,s,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,Gn(Hn.current);var n,i=null;switch(s){case"input":r=Q(e,r),a=Q(e,a),i=[];break;case"select":r=z({},r,{value:void 0}),a=z({},a,{value:void 0}),i=[];break;case"textarea":r=ae(e,r),a=ae(e,a),i=[];break;default:"function"!==typeof r.onClick&&"function"===typeof a.onClick&&(e.onclick=Xa)}for(d in ye(s,a),s=null,r)if(!a.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(n in l)l.hasOwnProperty(n)&&(s||(s={}),s[n]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=null!=r?r[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(n in l)!l.hasOwnProperty(n)||c&&c.hasOwnProperty(n)||(s||(s={}),s[n]="");for(n in c)c.hasOwnProperty(n)&&l[n]!==c[n]&&(s||(s={}),s[n]=c[n])}else s||(i||(i=[]),i.push(d,s)),s=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&La("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}s&&(i=i||[]).push("style",s);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Mo=function(e,t,s,a){s!==a&&(t.flags|=4)};var Qo=!1,Yo=!1,Ko="function"===typeof WeakSet?WeakSet:Set,Xo=null;function Zo(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(a){kc(e,t,a)}else s.current=null}function el(e,t,s){try{s()}catch(a){kc(e,t,a)}}var tl=!1;function sl(e,t,s){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var r=a=a.next;do{if((r.tag&e)===e){var n=r.destroy;r.destroy=void 0,void 0!==n&&el(t,s,n)}r=r.next}while(r!==a)}}function al(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function rl(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function nl(e){var t=e.alternate;null!==t&&(e.alternate=null,nl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ur],delete t[mr],delete t[gr],delete t[pr],delete t[fr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=Xa));else if(4!==a&&null!==(e=e.child))for(ll(e,t,s),e=e.sibling;null!==e;)ll(e,t,s),e=e.sibling}function cl(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==a&&null!==(e=e.child))for(cl(e,t,s),e=e.sibling;null!==e;)cl(e,t,s),e=e.sibling}var dl=null,ul=!1;function ml(e,t,s){for(s=s.child;null!==s;)hl(e,t,s),s=s.sibling}function hl(e,t,s){if(nt&&"function"===typeof nt.onCommitFiberUnmount)try{nt.onCommitFiberUnmount(rt,s)}catch(o){}switch(s.tag){case 5:Yo||Zo(s,t);case 6:var a=dl,r=ul;dl=null,ml(e,t,s),ul=r,null!==(dl=a)&&(ul?(e=dl,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):dl.removeChild(s.stateNode));break;case 18:null!==dl&&(ul?(e=dl,s=s.stateNode,8===e.nodeType?or(e.parentNode,s):1===e.nodeType&&or(e,s),Bt(e)):or(dl,s.stateNode));break;case 4:a=dl,r=ul,dl=s.stateNode.containerInfo,ul=!0,ml(e,t,s),dl=a,ul=r;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(a=s.updateQueue)&&null!==(a=a.lastEffect))){r=a=a.next;do{var n=r,i=n.destroy;n=n.tag,void 0!==i&&(0!==(2&n)||0!==(4&n))&&el(s,t,i),r=r.next}while(r!==a)}ml(e,t,s);break;case 1:if(!Yo&&(Zo(s,t),"function"===typeof(a=s.stateNode).componentWillUnmount))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(o){kc(s,t,o)}ml(e,t,s);break;case 21:ml(e,t,s);break;case 22:1&s.mode?(Yo=(a=Yo)||null!==s.memoizedState,ml(e,t,s),Yo=a):ml(e,t,s);break;default:ml(e,t,s)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Ko),t.forEach((function(t){var a=Ec.bind(null,e,t);s.has(t)||(s.add(t),t.then(a,a))}))}}function pl(e,t){var s=t.deletions;if(null!==s)for(var a=0;a<s.length;a++){var r=s[a];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(n(160));hl(i,o,r),dl=null,ul=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){kc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fl(t,e),t=t.sibling}function fl(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),xl(e),4&a){try{sl(3,e,e.return),al(3,e)}catch(f){kc(e,e.return,f)}try{sl(5,e,e.return)}catch(f){kc(e,e.return,f)}}break;case 1:pl(t,e),xl(e),512&a&&null!==s&&Zo(s,s.return);break;case 5:if(pl(t,e),xl(e),512&a&&null!==s&&Zo(s,s.return),32&e.flags){var r=e.stateNode;try{me(r,"")}catch(f){kc(e,e.return,f)}}if(4&a&&null!=(r=e.stateNode)){var i=e.memoizedProps,o=null!==s?s.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&K(r,i),be(l,o);var d=be(l,i);for(o=0;o<c.length;o+=2){var u=c[o],m=c[o+1];"style"===u?fe(r,m):"dangerouslySetInnerHTML"===u?ue(r,m):"children"===u?me(r,m):b(r,u,m,d)}switch(l){case"input":X(r,i);break;case"textarea":ne(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var g=i.value;null!=g?se(r,!!i.multiple,g,!1):h!==!!i.multiple&&(null!=i.defaultValue?se(r,!!i.multiple,i.defaultValue,!0):se(r,!!i.multiple,i.multiple?[]:"",!1))}r[mr]=i}catch(f){kc(e,e.return,f)}}break;case 6:if(pl(t,e),xl(e),4&a){if(null===e.stateNode)throw Error(n(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(f){kc(e,e.return,f)}}break;case 3:if(pl(t,e),xl(e),4&a&&null!==s&&s.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(f){kc(e,e.return,f)}break;case 4:default:pl(t,e),xl(e);break;case 13:pl(t,e),xl(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Ke())),4&a&&gl(e);break;case 22:if(u=null!==s&&null!==s.memoizedState,1&e.mode?(Yo=(d=Yo)||u,pl(t,e),Yo=d):pl(t,e),xl(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xo=e,u=e.child;null!==u;){for(m=Xo=u;null!==Xo;){switch(g=(h=Xo).child,h.tag){case 0:case 11:case 14:case 15:sl(4,h,h.return);break;case 1:Zo(h,h.return);var p=h.stateNode;if("function"===typeof p.componentWillUnmount){a=h,s=h.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(f){kc(a,s,f)}}break;case 5:Zo(h,h.return);break;case 22:if(null!==h.memoizedState){jl(m);continue}}null!==g?(g.return=h,Xo=g):jl(m)}u=u.sibling}e:for(u=null,m=e;;){if(5===m.tag){if(null===u){u=m;try{r=m.stateNode,d?"function"===typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=m.stateNode,o=void 0!==(c=m.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(f){kc(e,e.return,f)}}}else if(6===m.tag){if(null===u)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(f){kc(e,e.return,f)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===e)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;null===m.sibling;){if(null===m.return||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:pl(t,e),xl(e),4&a&&gl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(il(s)){var a=s;break e}s=s.return}throw Error(n(160))}switch(a.tag){case 5:var r=a.stateNode;32&a.flags&&(me(r,""),a.flags&=-33),cl(e,ol(e),r);break;case 3:case 4:var i=a.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(n(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,s){Xo=e,bl(e,t,s)}function bl(e,t,s){for(var a=0!==(1&e.mode);null!==Xo;){var r=Xo,n=r.child;if(22===r.tag&&a){var i=null!==r.memoizedState||Qo;if(!i){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Qo;var c=Yo;if(Qo=i,(Yo=l)&&!c)for(Xo=r;null!==Xo;)l=(i=Xo).child,22===i.tag&&null!==i.memoizedState?wl(r):null!==l?(l.return=i,Xo=l):wl(r);for(;null!==n;)Xo=n,bl(n,t,s),n=n.sibling;Xo=r,Qo=o,Yo=c}vl(e)}else 0!==(8772&r.subtreeFlags)&&null!==n?(n.return=r,Xo=n):vl(e)}}function vl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||al(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Yo)if(null===s)a.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:to(t.type,s.memoizedProps);a.componentDidUpdate(r,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Wn(t,i,a);break;case 3:var o=t.updateQueue;if(null!==o){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}Wn(t,o,s)}break;case 5:var l=t.stateNode;if(null===s&&4&t.flags){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var m=u.dehydrated;null!==m&&Bt(m)}}}break;default:throw Error(n(163))}Yo||512&t.flags&&rl(t)}catch(h){kc(t,t.return,h)}}if(t===e){Xo=null;break}if(null!==(s=t.sibling)){s.return=t.return,Xo=s;break}Xo=t.return}}function jl(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Xo=s;break}Xo=t.return}}function wl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{al(4,t)}catch(l){kc(t,s,l)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var r=t.return;try{a.componentDidMount()}catch(l){kc(t,r,l)}}var n=t.return;try{rl(t)}catch(l){kc(t,n,l)}break;case 5:var i=t.return;try{rl(t)}catch(l){kc(t,i,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Nl,kl=Math.ceil,Sl=v.ReactCurrentDispatcher,Cl=v.ReactCurrentOwner,_l=v.ReactCurrentBatchConfig,El=0,Tl=null,Il=null,Ol=0,Al=0,$l=Nr(0),Ml=0,Pl=null,Dl=0,zl=0,Ll=0,Rl=null,Fl=null,Ul=0,Bl=1/0,Wl=null,ql=!1,Hl=null,Jl=null,Vl=!1,Gl=null,Ql=0,Yl=0,Kl=null,Xl=-1,Zl=0;function ec(){return 0!==(6&El)?Ke():-1!==Xl?Xl:Xl=Ke()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Ol?Ol&-Ol:null!==pn.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function sc(e,t,s,a){if(50<Yl)throw Yl=0,Kl=null,Error(n(185));xt(e,s,a),0!==(2&El)&&e===Tl||(e===Tl&&(0===(2&El)&&(zl|=s),4===Ml&&oc(e,Ol)),ac(e,a),1===s&&0===El&&0===(1&t.mode)&&(Bl=Ke()+500,Lr&&Ur()))}function ac(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,n=e.pendingLanes;0<n;){var i=31-it(n),o=1<<i,l=r[i];-1===l?0!==(o&s)&&0===(o&a)||(r[i]=ht(o,t)):l<=t&&(e.expiredLanes|=o),n&=~o}}(e,t);var a=mt(e,e===Tl?Ol:0);if(0===a)null!==s&&Ge(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=s&&Ge(s),1===t)0===e.tag?function(e){Lr=!0,Fr(e)}(lc.bind(null,e)):Fr(lc.bind(null,e)),nr((function(){0===(6&El)&&Ur()})),s=null;else{switch(vt(a)){case 1:s=Ze;break;case 4:s=et;break;case 16:default:s=tt;break;case 536870912:s=at}s=Tc(s,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function rc(e,t){if(Xl=-1,Zl=0,0!==(6&El))throw Error(n(327));var s=e.callbackNode;if(wc()&&e.callbackNode!==s)return null;var a=mt(e,e===Tl?Ol:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=fc(e,a);else{t=a;var r=El;El|=2;var i=gc();for(Tl===e&&Ol===t||(Wl=null,Bl=Ke()+500,mc(e,t));;)try{yc();break}catch(l){hc(e,l)}Cn(),Sl.current=i,El=r,null!==Il?t=0:(Tl=null,Ol=0,t=Ml)}if(0!==t){if(2===t&&(0!==(r=gt(e))&&(a=r,t=nc(e,r))),1===t)throw s=Pl,mc(e,0),oc(e,a),ac(e,Ke()),s;if(6===t)oc(e,a);else{if(r=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var a=0;a<s.length;a++){var r=s[a],n=r.getSnapshot;r=r.value;try{if(!ia(n(),r))return!1}catch(o){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=fc(e,a))&&(0!==(i=gt(e))&&(a=i,t=nc(e,i))),1===t))throw s=Pl,mc(e,0),oc(e,a),ac(e,Ke()),s;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error(n(345));case 2:case 5:jc(e,Fl,Wl);break;case 3:if(oc(e,a),(130023424&a)===a&&10<(t=Ul+500-Ke())){if(0!==mt(e,0))break;if(((r=e.suspendedLanes)&a)!==a){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=sr(jc.bind(null,e,Fl,Wl),t);break}jc(e,Fl,Wl);break;case 4:if(oc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,r=-1;0<a;){var o=31-it(a);i=1<<o,(o=t[o])>r&&(r=o),a&=~i}if(a=r,10<(a=(120>(a=Ke()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*kl(a/1960))-a)){e.timeoutHandle=sr(jc.bind(null,e,Fl,Wl),a);break}jc(e,Fl,Wl);break;default:throw Error(n(329))}}}return ac(e,Ke()),e.callbackNode===s?rc.bind(null,e):null}function nc(e,t){var s=Rl;return e.current.memoizedState.isDehydrated&&(mc(e,t).flags|=256),2!==(e=fc(e,t))&&(t=Fl,Fl=s,null!==t&&ic(t)),e}function ic(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function oc(e,t){for(t&=~Ll,t&=~zl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-it(t),a=1<<s;e[s]=-1,t&=~a}}function lc(e){if(0!==(6&El))throw Error(n(327));wc();var t=mt(e,0);if(0===(1&t))return ac(e,Ke()),null;var s=fc(e,t);if(0!==e.tag&&2===s){var a=gt(e);0!==a&&(t=a,s=nc(e,a))}if(1===s)throw s=Pl,mc(e,0),oc(e,t),ac(e,Ke()),s;if(6===s)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Fl,Wl),ac(e,Ke()),null}function cc(e,t){var s=El;El|=1;try{return e(t)}finally{0===(El=s)&&(Bl=Ke()+500,Lr&&Ur())}}function dc(e){null!==Gl&&0===Gl.tag&&0===(6&El)&&wc();var t=El;El|=1;var s=_l.transition,a=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=a,_l.transition=s,0===(6&(El=t))&&Ur()}}function uc(){Al=$l.current,kr($l)}function mc(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,ar(s)),null!==Il)for(s=Il.return;null!==s;){var a=s;switch(en(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ar();break;case 3:Yn(),kr(Er),kr(_r),si();break;case 5:Xn(a);break;case 4:Yn();break;case 13:case 19:kr(Zn);break;case 10:_n(a.type._context);break;case 22:case 23:uc()}s=s.return}if(Tl=e,Il=e=$c(e.current,null),Ol=Al=t,Ml=0,Pl=null,Ll=zl=Dl=0,Fl=Rl=null,null!==On){for(t=0;t<On.length;t++)if(null!==(a=(s=On[t]).interleaved)){s.interleaved=null;var r=a.next,n=s.pending;if(null!==n){var i=n.next;n.next=r,a.next=i}s.pending=a}On=null}return e}function hc(e,t){for(;;){var s=Il;try{if(Cn(),ai.current=Ki,ci){for(var a=ii.memoizedState;null!==a;){var r=a.queue;null!==r&&(r.pending=null),a=a.next}ci=!1}if(ni=0,li=oi=ii=null,di=!1,ui=0,Cl.current=null,null===s||null===s.return){Ml=1,Pl=t,Il=null;break}e:{var i=e,o=s.return,l=s,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,m=u.tag;if(0===(1&u.mode)&&(0===m||11===m||15===m)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=fo(o);if(null!==g){g.flags&=-257,xo(g,o,l,0,t),1&g.mode&&po(i,d,t),c=d;var p=(t=g).updateQueue;if(null===p){var f=new Set;f.add(c),t.updateQueue=f}else p.add(c);break e}if(0===(1&t)){po(i,d,t),pc();break e}c=Error(n(426))}else if(an&&1&l.mode){var x=fo(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),gn(lo(c,l));break e}}i=c=lo(c,l),4!==Ml&&(Ml=2),null===Rl?Rl=[i]:Rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Un(i,ho(0,c,t));break e;case 1:l=c;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Jl||!Jl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Un(i,go(i,l,t));break e}}i=i.return}while(null!==i)}vc(s)}catch(v){t=v,Il===s&&null!==s&&(Il=s=s.return);continue}break}}function gc(){var e=Sl.current;return Sl.current=Ki,null===e?Ki:e}function pc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Tl||0===(268435455&Dl)&&0===(268435455&zl)||oc(Tl,Ol)}function fc(e,t){var s=El;El|=2;var a=gc();for(Tl===e&&Ol===t||(Wl=null,mc(e,t));;)try{xc();break}catch(r){hc(e,r)}if(Cn(),El=s,Sl.current=a,null!==Il)throw Error(n(261));return Tl=null,Ol=0,Ml}function xc(){for(;null!==Il;)bc(Il)}function yc(){for(;null!==Il&&!Qe();)bc(Il)}function bc(e){var t=Nl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?vc(e):Il=t,Cl.current=null}function vc(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=Vo(s,t,Al)))return void(Il=s)}else{if(null!==(s=Go(s,t)))return s.flags&=32767,void(Il=s);if(null===e)return Ml=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ml&&(Ml=5)}function jc(e,t,s){var a=bt,r=_l.transition;try{_l.transition=null,bt=1,function(e,t,s,a){do{wc()}while(null!==Gl);if(0!==(6&El))throw Error(n(327));s=e.finishedWork;var r=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var i=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-it(s),n=1<<r;t[r]=0,a[r]=-1,e[r]=-1,s&=~n}}(e,i),e===Tl&&(Il=Tl=null,Ol=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||Vl||(Vl=!0,Tc(tt,(function(){return wc(),null}))),i=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||i){i=_l.transition,_l.transition=null;var o=bt;bt=1;var l=El;El|=4,Cl.current=null,function(e,t){if(Za=qt,ma(e=ua())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(a&&0!==a.rangeCount){s=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{s.nodeType,i.nodeType}catch(j){s=null;break e}var o=0,l=-1,c=-1,d=0,u=0,m=e,h=null;t:for(;;){for(var g;m!==s||0!==r&&3!==m.nodeType||(l=o+r),m!==i||0!==a&&3!==m.nodeType||(c=o+a),3===m.nodeType&&(o+=m.nodeValue.length),null!==(g=m.firstChild);)h=m,m=g;for(;;){if(m===e)break t;if(h===s&&++d===r&&(l=o),h===i&&++u===a&&(c=o),null!==(g=m.nextSibling))break;h=(m=h).parentNode}m=g}s=-1===l||-1===c?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(er={focusedElem:e,selectionRange:s},qt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var f=p.memoizedProps,x=p.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?f:to(t.type,f),x);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(n(163))}}catch(j){kc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}p=tl,tl=!1}(e,s),fl(s,e),ha(er),qt=!!Za,er=Za=null,e.current=s,yl(s,e,r),Ye(),El=l,bt=o,_l.transition=i}else e.current=s;if(Vl&&(Vl=!1,Gl=e,Ql=r),i=e.pendingLanes,0===i&&(Jl=null),function(e){if(nt&&"function"===typeof nt.onCommitFiberRoot)try{nt.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),ac(e,Ke()),null!==t)for(a=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],a(r.value,{componentStack:r.stack,digest:r.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Ql)&&0!==e.tag&&wc(),i=e.pendingLanes,0!==(1&i)?e===Kl?Yl++:(Yl=0,Kl=e):Yl=0,Ur()}(e,t,s,a)}finally{_l.transition=r,bt=a}return null}function wc(){if(null!==Gl){var e=vt(Ql),t=_l.transition,s=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Gl)var a=!1;else{if(e=Gl,Gl=null,Ql=0,0!==(6&El))throw Error(n(331));var r=El;for(El|=4,Xo=e.current;null!==Xo;){var i=Xo,o=i.child;if(0!==(16&Xo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xo=d;null!==Xo;){var u=Xo;switch(u.tag){case 0:case 11:case 15:sl(8,u,i)}var m=u.child;if(null!==m)m.return=u,Xo=m;else for(;null!==Xo;){var h=(u=Xo).sibling,g=u.return;if(nl(u),u===d){Xo=null;break}if(null!==h){h.return=g,Xo=h;break}Xo=g}}}var p=i.alternate;if(null!==p){var f=p.child;if(null!==f){p.child=null;do{var x=f.sibling;f.sibling=null,f=x}while(null!==f)}}Xo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(i=Xo).flags))switch(i.tag){case 0:case 11:case 15:sl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Xo=y;break e}Xo=i.return}}var b=e.current;for(Xo=b;null!==Xo;){var v=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==v)v.return=o,Xo=v;else e:for(o=b;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(w){kc(l,l.return,w)}if(l===o){Xo=null;break e}var j=l.sibling;if(null!==j){j.return=l.return,Xo=j;break e}Xo=l.return}}if(El=r,Ur(),nt&&"function"===typeof nt.onPostCommitFiberRoot)try{nt.onPostCommitFiberRoot(rt,e)}catch(w){}a=!0}return a}finally{bt=s,_l.transition=t}}return!1}function Nc(e,t,s){e=Rn(e,t=ho(0,t=lo(s,t),1),1),t=ec(),null!==e&&(xt(e,1,t),ac(e,t))}function kc(e,t,s){if(3===e.tag)Nc(e,e,s);else for(;null!==t;){if(3===t.tag){Nc(t,e,s);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Jl||!Jl.has(a))){t=Rn(t,e=go(t,e=lo(s,e),1),1),e=ec(),null!==t&&(xt(t,1,e),ac(t,e));break}}t=t.return}}function Sc(e,t,s){var a=e.pingCache;null!==a&&a.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&s,Tl===e&&(Ol&s)===s&&(4===Ml||3===Ml&&(130023424&Ol)===Ol&&500>Ke()-Ul?mc(e,0):Ll|=s),ac(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=ec();null!==(e=Mn(e,t))&&(xt(e,t,s),ac(e,s))}function _c(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Cc(e,s)}function Ec(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(s=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(n(314))}null!==a&&a.delete(t),Cc(e,s)}function Tc(e,t){return Ve(e,t)}function Ic(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,s,a){return new Ic(e,t,s,a)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $c(e,t){var s=e.alternate;return null===s?((s=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Mc(e,t,s,a,r,i){var o=2;if(a=e,"function"===typeof e)Ac(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Pc(s.children,r,i,t);case k:o=8,r|=8;break;case S:return(e=Oc(12,s,t,2|r)).elementType=S,e.lanes=i,e;case T:return(e=Oc(13,s,t,r)).elementType=T,e.lanes=i,e;case I:return(e=Oc(19,s,t,r)).elementType=I,e.lanes=i,e;case $:return Dc(s,r,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case _:o=9;break e;case E:o=11;break e;case O:o=14;break e;case A:o=16,a=null;break e}throw Error(n(130,null==e?e:typeof e,""))}return(t=Oc(o,s,t,r)).elementType=e,t.type=a,t.lanes=i,t}function Pc(e,t,s,a){return(e=Oc(7,e,a,t)).lanes=s,e}function Dc(e,t,s,a){return(e=Oc(22,e,a,t)).elementType=$,e.lanes=s,e.stateNode={isHidden:!1},e}function zc(e,t,s){return(e=Oc(6,e,null,t)).lanes=s,e}function Lc(e,t,s){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Rc(e,t,s,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fc(e,t,s,a,r,n,i,o,l){return e=new Rc(e,t,s,o,l),1===t?(t=1,!0===n&&(t|=8)):t=0,n=Oc(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dn(n),e}function Uc(e){if(!e)return Cr;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(n(171))}if(1===e.tag){var s=e.type;if(Or(s))return Mr(e,s,t)}return t}function Bc(e,t,s,a,r,n,i,o,l){return(e=Fc(s,a,!0,e,0,n,0,o,l)).context=Uc(null),s=e.current,(n=Ln(a=ec(),r=tc(s))).callback=void 0!==t&&null!==t?t:null,Rn(s,n,r),e.current.lanes=r,xt(e,r,a),ac(e,a),e}function Wc(e,t,s,a){var r=t.current,n=ec(),i=tc(r);return s=Uc(s),null===t.context?t.context=s:t.pendingContext=s,(t=Ln(n,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Rn(r,t,i))&&(sc(e,r,i,n),Fn(e,r,i)),i}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function Jc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Er.current)bo=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return bo=!1,function(e,t,s){switch(t.tag){case 3:To(t),hn();break;case 5:Kn(t);break;case 1:Or(t.type)&&Pr(t);break;case 4:Qn(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;Sr(wn,a._currentValue),a._currentValue=r;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Sr(Zn,1&Zn.current),t.flags|=128,null):0!==(s&t.child.childLanes)?zo(e,t,s):(Sr(Zn,1&Zn.current),null!==(e=qo(e,t,s))?e.sibling:null);Sr(Zn,1&Zn.current);break;case 19:if(a=0!==(s&t.childLanes),0!==(128&e.flags)){if(a)return Bo(e,t,s);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sr(Zn,Zn.current),a)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,s)}return qo(e,t,s)}(e,t,s);bo=0!==(131072&e.flags)}else bo=!1,an&&0!==(1048576&t.flags)&&Xr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Wo(e,t),e=t.pendingProps;var r=Ir(t,_r.current);Tn(t,s),r=pi(null,t,a,e,r,s);var i=fi();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(a)?(i=!0,Pr(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Dn(t),r.updater=ao,t.stateNode=r,r._reactInternals=t,oo(t,a,e,s),t=Eo(null,t,a,!0,i,s)):(t.tag=0,an&&i&&Zr(t),vo(null,t,r,s),t=t.child),t;case 16:a=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,a=(r=a._init)(a._payload),t.type=a,r=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===O)return 14}return 2}(a),e=to(a,e),r){case 0:t=Co(null,t,a,e,s);break e;case 1:t=_o(null,t,a,e,s);break e;case 11:t=jo(null,t,a,e,s);break e;case 14:t=wo(null,t,a,to(a.type,e),s);break e}throw Error(n(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,Co(e,t,a,r=t.elementType===a?r:to(a,r),s);case 1:return a=t.type,r=t.pendingProps,_o(e,t,a,r=t.elementType===a?r:to(a,r),s);case 3:e:{if(To(t),null===e)throw Error(n(387));a=t.pendingProps,r=(i=t.memoizedState).element,zn(e,t),Bn(t,a,null,s);var o=t.memoizedState;if(a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Io(e,t,a,s,r=lo(Error(n(423)),t));break e}if(a!==r){t=Io(e,t,a,s,r=lo(Error(n(424)),t));break e}for(sn=lr(t.stateNode.containerInfo.firstChild),tn=t,an=!0,rn=null,s=jn(t,null,a,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(hn(),a===r){t=qo(e,t,s);break e}vo(e,t,a,s)}t=t.child}return t;case 5:return Kn(t),null===e&&cn(t),a=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,o=r.children,tr(a,r)?o=null:null!==i&&tr(a,i)&&(t.flags|=32),So(e,t),vo(e,t,o,s),t.child;case 6:return null===e&&cn(t),null;case 13:return zo(e,t,s);case 4:return Qn(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=vn(t,null,a,s):vo(e,t,a,s),t.child;case 11:return a=t.type,r=t.pendingProps,jo(e,t,a,r=t.elementType===a?r:to(a,r),s);case 7:return vo(e,t,t.pendingProps,s),t.child;case 8:case 12:return vo(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,Sr(wn,a._currentValue),a._currentValue=o,null!==i)if(ia(i.value,o)){if(i.children===r.children&&!Er.current){t=qo(e,t,s);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=Ln(-1,s&-s)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=s,null!==(c=i.alternate)&&(c.lanes|=s),En(i.return,s,t),l.lanes|=s;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(n(341));o.lanes|=s,null!==(l=o.alternate)&&(l.lanes|=s),En(o,s,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}vo(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,Tn(t,s),a=a(r=In(r)),t.flags|=1,vo(e,t,a,s),t.child;case 14:return r=to(a=t.type,t.pendingProps),wo(e,t,a,r=to(a.type,r),s);case 15:return No(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:to(a,r),Wo(e,t),t.tag=1,Or(a)?(e=!0,Pr(t)):e=!1,Tn(t,s),no(t,a,r),oo(t,a,r,s),Eo(null,t,a,!0,e,s);case 19:return Bo(e,t,s);case 22:return ko(e,t,s)}throw Error(n(156,t.tag))};var Vc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,s,a,r){var n=s._reactRootContainer;if(n){var i=n;if("function"===typeof r){var o=r;r=function(){var e=qc(i);o.call(e)}}Wc(t,i,e,r)}else i=function(e,t,s,a,r){if(r){if("function"===typeof a){var n=a;a=function(){var e=qc(i);n.call(e)}}var i=Bc(t,a,e,0,null,!1,0,"",Xc);return e._reactRootContainer=i,e[hr]=i.current,Ua(8===e.nodeType?e.parentNode:e),dc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof a){var o=a;a=function(){var e=qc(l);o.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[hr]=l.current,Ua(8===e.nodeType?e.parentNode:e),dc((function(){Wc(t,l,s,a)})),l}(s,t,e,r,a);return qc(i)}Qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(n(409));Wc(e,t,null,null)},Qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Wc(null,e,null,null)})),t[hr]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var s=0;s<$t.length&&0!==t&&t<$t[s].priority;s++);$t.splice(s,0,e),0===s&&zt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ut(t.pendingLanes);0!==s&&(yt(t,1|s),ac(t,Ke()),0===(6&El)&&(Bl=Ke()+500,Ur()))}break;case 13:dc((function(){var t=Mn(e,1);if(null!==t){var s=ec();sc(t,e,1,s)}})),Jc(e,1)}},wt=function(e){if(13===e.tag){var t=Mn(e,134217728);if(null!==t)sc(t,e,134217728,ec());Jc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),s=Mn(e,t);if(null!==s)sc(s,e,t,ec());Jc(e,t)}},kt=function(){return bt},St=function(e,t){var s=bt;try{return bt=e,t()}finally{bt=s}},we=function(e,t,s){switch(t){case"input":if(X(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var r=vr(a);if(!r)throw Error(n(90));V(a),X(a,r)}}}break;case"textarea":ne(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},Ee=cc,Te=dc;var ed={usingClientEntryPoint:!1,Events:[yr,br,vr,Ce,_e,cc]},td={findFiberByHostInstance:xr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{rt=ad.inject(sd),nt=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(n(200));return function(e,t,s){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==a?null:""+a,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!Yc(e))throw Error(n(299));var s=!1,a="",r=Vc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Fc(e,1,!1,null,0,s,0,a,r),e[hr]=t.current,Ua(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(n(188));throw e=Object.keys(e).join(","),Error(n(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,s){if(!Kc(t))throw Error(n(200));return Zc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!Yc(e))throw Error(n(405));var a=null!=s&&s.hydratedSources||null,r=!1,i="",o=Vc;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(r=!0),void 0!==s.identifierPrefix&&(i=s.identifierPrefix),void 0!==s.onRecoverableError&&(o=s.onRecoverableError)),t=Bc(t,null,e,1,null!=s?s:null,r,0,i,o),e[hr]=t.current,Ua(e),a)for(e=0;e<a.length;e++)r=(r=(s=a[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new Qc(t)},t.render=function(e,t,s){if(!Kc(t))throw Error(n(200));return Zc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(n(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[hr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!Kc(s))throw Error(n(200));if(null==e||void 0===e._reactInternals)throw Error(n(38));return Zc(e,t,s,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},776:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(580);const r=new class{constructor(){const e=localStorage.getItem("coffee_cue_app_mode");this.currentMode=e||a.Pg.PRODUCTION,e||localStorage.setItem("coffee_cue_app_mode",a.Pg.PRODUCTION),this.services={},this.mockServices={},this.realServices={},this.listeners=[],window.addEventListener("storage",(e=>{"coffee_cue_app_mode"===e.key&&e.newValue!==this.currentMode&&(this.currentMode=e.newValue,this._notifyListeners())}))}registerService(e,t,s){return this.realServices[e]=t,this.mockServices[e]=s,this._updateService(e),this}getService(e){if(!this.services[e])throw new Error(`Service ${e} not registered`);return this.services[e]}setMode(e){if(e!==a.Pg.PRODUCTION&&e!==a.Pg.DEMO)throw new Error(`Invalid mode: ${e}`);e!==this.currentMode&&(this.currentMode=e,localStorage.setItem("coffee_cue_app_mode",e),this._updateAllServices(),this._notifyListeners())}getMode(){return this.currentMode}addModeChangeListener(e){this.listeners.push(e)}removeModeChangeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}_updateService(e){this.currentMode===a.Pg.DEMO?this.services[e]=this.mockServices[e]:this.services[e]=this.realServices[e]}_updateAllServices(){Object.keys(this.realServices).forEach((e=>{this._updateService(e)}))}_notifyListeners(){this.listeners.forEach((e=>{try{e(this.currentMode)}catch(t){console.error("Error in mode change listener:",t)}}))}};var n=s(395),i=s(810);const o=new class{constructor(){this.socket=null,this.isConnected=!1,this.eventHandlers=new Map,this.wsUrl="http://localhost:5001",this.initPromise=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,window.addEventListener("tokenRefreshed",(e=>{const t=e.detail.token;t&&this.authenticate(t)})),window.addEventListener("tokenExpired",(()=>{this.disconnect()}))}async initialize(){return this.isConnected&&this.socket?(console.log("WebSocket already connected"),!0):this.initPromise?(console.log("WebSocket initialization already in progress"),this.initPromise):(console.log("Starting WebSocket initialization..."),this.initPromise=this._doInitialize(),this.initPromise)}async _doInitialize(){try{let t;this.socket&&(console.log("Cleaning up existing WebSocket connection"),this.socket.disconnect(),this.socket=null,this.isConnected=!1);try{const e=await s.e(104).then(s.bind(s,104));t=e.default||e.io}catch(e){if(console.error("Failed to load socket.io-client:",e),!window.io)throw new Error("socket.io-client not available");t=window.io}const a=localStorage.getItem("token");let r=null;if(a)try{const e=1e3*JSON.parse(atob(a.split(".")[1])).exp;e>Date.now()?r=a:console.warn("Token expired, connecting without authentication")}catch(e){console.error("Error decoding token:",e)}this.socket=t(this.wsUrl,{transports:["polling","websocket"],reconnection:!0,reconnectionDelay:2e3,reconnectionDelayMax:1e4,reconnectionAttempts:3,timeout:1e4,autoConnect:!0,forceNew:!0,auth:{token:r||""},extraHeaders:{Authorization:r?`Bearer ${r}`:""}}),console.log("WebSocket connection created with config:",{hasToken:!!r,reconnectionAttempts:3,timeout:1e4}),this.setupEventHandlers();const n=await this.waitForConnection();return n||console.log("WebSocket connection timed out - app will continue without real-time updates"),n}catch(t){return console.error("WebSocket initialization failed:",t),this.socket=null,!1}}waitForConnection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;return new Promise((t=>{if(this.isConnected)return void t(!0);const s=setTimeout((()=>{console.warn("WebSocket connection timeout - continuing without WebSocket support"),this.socket.off("connect",a),t(!1)}),e),a=()=>{clearTimeout(s),this.socket.off("connect",a),t(!0)};this.socket.on("connect",a)}))}setupEventHandlers(){this.socket&&(this.socket.removeAllListeners(),this.socket.on("connect",(()=>{console.log("WebSocket connected successfully"),this.isConnected=!0,this.reconnectAttempts=0,this.initPromise=null,this.emit("connected")})),this.socket.on("disconnect",(e=>{console.log("WebSocket disconnected:",e),this.isConnected=!1,this.emit("disconnected",e),"io server disconnect"!==e&&"transport close"!==e||(console.log("Server initiated disconnect - not attempting reconnection"),this.initPromise=null)})),this.socket.on("connect_error",(e=>{console.error("WebSocket connection error:",e.message),this.reconnectAttempts++,this.reconnectAttempts>=3&&(console.error("Max reconnection attempts reached - giving up"),this.socket.disconnect(),this.initPromise=null,this.emit("max_reconnect_failed"))})),this.socket.on("error",(e=>{console.error("WebSocket error:",e),this.emit("error",e)})),this.socket.on("reconnect",(e=>{console.log(`WebSocket reconnected after ${e} attempts`),this.isConnected=!0,this.emit("reconnected")})),this.socket.on("reconnect_failed",(()=>{console.error("WebSocket reconnection failed completely"),this.initPromise=null,this.emit("reconnect_failed")})))}on(e,t){this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t),this.socket&&this.isConnected&&this.socket.on(e,t)}off(e,t){this.eventHandlers.has(e)&&this.eventHandlers.get(e).delete(t),this.socket&&this.socket.off(e,t)}emit(e,t){this.eventHandlers.has(e)&&this.eventHandlers.get(e).forEach((s=>{try{s(t)}catch(a){console.error(`Error in event handler for ${e}:`,a)}}))}send(e,t){return this.socket&&this.isConnected?(this.socket.emit(e,t),!0):(console.warn("Cannot send message - WebSocket not connected"),!1)}joinRoom(e){return this.send("join_room",{room:e})}leaveRoom(e){return this.send("leave_room",{room:e})}authenticate(e){this.socket&&(this.socket.auth={token:e},this.isConnected&&(this.socket.disconnect(),this.socket.io.opts.auth={token:e},this.socket.io.opts.extraHeaders={Authorization:e?`Bearer ${e}`:""},this.socket.connect()))}disconnect(){console.log("Disconnecting WebSocket..."),this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect(),this.socket=null),this.isConnected=!1,this.initPromise=null,this.reconnectAttempts=0,console.log("WebSocket disconnected and cleaned up")}get connected(){return this.isConnected}},l=o;class c{constructor(){if(console.trace("ApiService constructor called"),c.instance)return console.log("ApiService: Returning existing singleton instance"),console.log("ApiService instance count: REUSING EXISTING"),c.instance;console.log("ApiService: Creating new singleton instance"),console.log("ApiService instance count: CREATING NEW"),this.baseUrl="http://localhost:5001/api",this.token=localStorage.getItem("coffee_system_token")||localStorage.getItem("token")||null,this.debugMode=!0,this.enableFallback=!1,this.connectionTimeout=1e4,r.addModeChangeListener(this._handleModeChange.bind(this)),console.log("ApiService: WebSocket completely disabled to prevent connection spam"),c.instance=this}setToken(e){this.token=e,this.debugMode&&console.log(e?"Token set successfully":"Token cleared")}isDemoMode(){return r.getMode()===a.Pg.DEMO}isTokenExpiringSoon(){if(!this.token)return!1;try{const e=1e3*JSON.parse(atob(this.token.split(".")[1])).exp,t=3e5;return e-Date.now()<t}catch(e){return console.error("Token validation error:",e),!1}}async refreshTokenIfNeeded(){const e="coffee_system_token";if(!this.token){const t=localStorage.getItem(e);if(!t)return!1;this.token=t}if(this.isTokenExpiringSoon()){(!this.lastRefreshAttempt||Date.now()-this.lastRefreshAttempt>6e4)&&(console.log("Token is expiring soon, attempting to refresh"),this.lastRefreshAttempt=Date.now());try{const t=localStorage.getItem("coffee_system_refresh_token");if(!t)return!0;const s=this.baseUrl?`${this.baseUrl}/auth/refresh`:"/api/auth/refresh",a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t}),mode:"cors"});if(!a.ok)return!0;const r=await a.json();return!r.token||(this.token=r.token,localStorage.setItem(e,r.token),r.expiresIn&&localStorage.setItem("tokenExpiry",Date.now()+1e3*r.expiresIn),console.log("Token refreshed successfully"),!0)}catch(t){return(!this.lastRefreshError||Date.now()-this.lastRefreshError>3e5)&&(console.warn("Token refresh attempt failed, continuing:",t.message),this.lastRefreshError=Date.now()),!0}}return!0}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(await this.refreshTokenIfNeeded(),!this.isDemoMode())return await this.fetchWithAuth(e,t);{this.debugMode&&console.log(`[DEMO MODE] ${t.method||"GET"} ${e}`);const s=(t.method||"GET").toLowerCase(),a=t.body?JSON.parse(t.body):void 0;switch(localStorage.setItem("coffee_connection_status","online"),s){case"get":return await n.default.get(e);case"post":return await n.default.post(e,a);case"put":return await n.default.put(e,a);case"patch":return await n.default.patch(e,a);case"delete":return await n.default.delete(e);default:throw new Error(`Unsupported method: ${s}`)}}}catch(s){if(this.enableFallback&&!this.isDemoMode()){console.warn(`API error, falling back to demo data: ${s.message}`);const a=(t.method||"GET").toLowerCase(),r=t.body?JSON.parse(t.body):void 0;switch(a){case"get":return await n.default.get(e);case"post":return await n.default.post(e,r);case"put":return await n.default.put(e,r);case"patch":return await n.default.patch(e,r);case"delete":return await n.default.delete(e);default:throw s}}throw s}}async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r,n=e;n.startsWith("/")&&(n=n.substring(1));{const e=this.baseUrl.endsWith("/")?this.baseUrl.slice(0,-1):this.baseUrl;let t=n;t.startsWith("api/")&&(t=t.substring(4)),r=`${e}/${t}`}this.debugMode&&(console.log(`Normalized URL: ${r} (from original: ${e})`),console.log("Environment: production"));const i={"Content-Type":"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...t.headers||{}};this.debugMode&&console.log(`Fetching from: ${r} with method: ${t.method||"GET"}`);const o=new AbortController,l=setTimeout((()=>o.abort()),this.connectionTimeout),c=await fetch(r,{...t,headers:i,signal:o.signal,mode:"cors"});if(clearTimeout(l),!c.ok){let e={};try{e=await c.json()}catch(s){try{e={message:await c.text()}}catch(a){e={message:`HTTP error: ${c.status} ${c.statusText}`}}}throw console.error(`API error: ${c.status}`,e),new Error(e.message||`API error: ${c.status}`)}const d=await c.json();return this.debugMode&&console.log(`Response from ${e}:`,d),localStorage.setItem("coffee_connection_status","online"),d}catch(r){throw console.error(`Error fetching from ${e}:`,r),("AbortError"===r.name||r.message.includes("Failed to fetch")||r.message.includes("NetworkError"))&&localStorage.setItem("coffee_connection_status","offline"),r}}_handleModeChange(e){this.debugMode&&console.log(`[ApiService] App mode changed to: ${e}`)}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{...t,method:"GET"})}async post(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{...s,method:"POST",body:JSON.stringify(t)})}async put(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{...s,method:"PUT",body:JSON.stringify(t)})}async patch(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(e,{...s,method:"PATCH",body:JSON.stringify(t)})}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,{...t,method:"DELETE"})}async directFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n;if(e.startsWith("http")){n=new URL(e).pathname,n.includes("/api/")&&(n=n.substring(n.indexOf("/api/")+4))}else n=e.includes("/api/")?e.substring(e.indexOf("/api/")+4):e.startsWith("/")?e.substring(1):e;const o=`${this.baseUrl}/${n}`;this.debugMode&&console.log(`Using direct URL strategy: ${o}`);const l=await i.A.addAuthorizationHeader({"Content-Type":"application/json",Accept:"application/json",...t.headers||{}});if(this.debugMode){const e=i.A.getToken();console.log(`Authorization header ${e?"set":"NOT set"} for request to ${o}`),e&&console.log(`Token length: ${e.length}, Token prefix: ${e.substring(0,10)}...`),console.log(`Fetching from: ${o} with method: ${t.method||"GET"}`),t.body&&console.log(`Request body: ${t.body}`)}const c=await fetch(o,{...t,headers:l,mode:"cors"});if(401===c.status||403===c.status||422===c.status)try{if(await i.A.refreshToken()){const e=await i.A.addAuthorizationHeader({"Content-Type":"application/json",Accept:"application/json",...t.headers||{}}),s=await fetch(o,{...t,headers:e,mode:"cors"});if(!s.ok)throw new Error(`API error after token refresh: ${s.status}`);return await s.json()}throw new Error("Token refresh failed")}catch(s){throw console.error("Token refresh failed:",s),new Error(`Authentication error: ${c.status}`)}if(!c.ok){let e={};try{e=await c.json()}catch(a){try{e={message:await c.text()}}catch(r){e={message:`HTTP error: ${c.status} ${c.statusText}`}}}throw console.error(`API error: ${c.status}`,e),new Error(e.message||`API error: ${c.status}`)}const d=await c.json();return this.debugMode&&console.log(`Response from ${o}:`,d),d}catch(n){throw console.error(`Error fetching from ${e}:`,n),n}}async initializeWebSocket(){try{console.log("ApiService: Starting WebSocket initialization...");if(!await l.initialize())return void console.log("ApiService: WebSocket connection failed, continuing without real-time updates");const e=i.A.getToken();e&&(console.log("ApiService: Authenticating WebSocket with existing token"),l.authenticate(e)),l.on("connected",(()=>{console.log("ApiService: WebSocket connected");const e=i.A.getToken();e&&l.authenticate(e)})),l.on("authenticated",(()=>{console.log("ApiService: WebSocket authenticated"),this.joinStationRoom()})),this.setupCommonEventHandlers()}catch(e){console.error("Failed to initialize WebSocket:",e),console.log("WebSocket support will be disabled")}}setupCommonEventHandlers(){l.on("order_created",(e=>{window.dispatchEvent(new CustomEvent("order_created",{detail:e}))})),l.on("order_updated",(e=>{window.dispatchEvent(new CustomEvent("order_updated",{detail:e}))})),l.on("order_completed",(e=>{window.dispatchEvent(new CustomEvent("order_completed",{detail:e}))})),l.on("station_updated",(e=>{window.dispatchEvent(new CustomEvent("station_updated",{detail:e}))})),l.on("inventory_updated",(e=>{window.dispatchEvent(new CustomEvent("inventory_updated",{detail:e}))})),l.on("new_message",(e=>{window.dispatchEvent(new CustomEvent("new_message",{detail:e}))}))}joinStationRoom(e){const t=localStorage.getItem("currentStationId");t&&l.send("leave_station",{station_id:t}),e&&(l.send("join_station",{station_id:e}),localStorage.setItem("currentStationId",e.toString()))}on(e,t){l.on(e,t)}off(e,t){l.off(e,t)}sendMessage(e,t){return l.send(e,t)}updateSocketAuth(e){l.authenticate(e)}disconnectSocket(){l.disconnect()}}const d=c},810:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(602);const r=new class{constructor(){this.loadConfig(),this.config={apiBaseUrl:"/api",defaultWaitTime:15,notificationTimeout:30,...this.config},console.log("ConfigService initialized with base URL:",this.config.apiBaseUrl)}loadConfig(){try{const e=localStorage.getItem("coffee_system_config");this.config=e?JSON.parse(e):{}}catch(e){console.error("Failed to load configuration:",e),this.config={}}}saveConfig(){try{localStorage.setItem("coffee_system_config",JSON.stringify(this.config))}catch(e){console.error("Failed to save configuration:",e)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==this.config[e]?this.config[e]:t}set(e,t){return this.config[e]=t,this.saveConfig(),t}getApiUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=e.startsWith("/")?e.substring(1):e;return`${this.config.apiBaseUrl}/${t}`}};const n=new class{constructor(){this.refreshTimer=null,this.refreshThreshold=3e5}startAutoRefresh(){this.stopAutoRefresh();const e=localStorage.getItem("token"),t=localStorage.getItem("tokenExpiresIn");if(!e||!t)return void console.log("No token to refresh");const s=1e3*parseInt(t),a=Math.max(s-this.refreshThreshold,1e4);console.log(`Token refresh scheduled in ${a/1e3} seconds`),this.refreshTimer=setTimeout((async()=>{await this.refreshToken()}),a)}stopAutoRefresh(){this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null)}async refreshToken(){try{const e=localStorage.getItem("refreshToken");if(!e)return console.error("No refresh token available"),this.handleTokenExpired(),!1;const t=await fetch("http://localhost:5001/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();if(e.token)return localStorage.setItem("token",e.token),localStorage.setItem("tokenExpiresIn",e.expiresIn||"3600"),console.log("Token refreshed successfully"),window.dispatchEvent(new CustomEvent("tokenRefreshed",{detail:{token:e.token}})),this.startAutoRefresh(),!0}else if(401===t.status)return console.error("Refresh token invalid or expired"),this.handleTokenExpired(),!1;return console.error("Token refresh failed:",t.status),!1}catch(e){return console.error("Error refreshing token:",e),!1}}handleTokenExpired(){console.log("Token expired - user needs to login again"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiresIn"),localStorage.removeItem("user"),window.dispatchEvent(new CustomEvent("tokenExpired")),"/login"!==window.location.pathname&&(window.location.href="/login")}isTokenExpiringSoon(){const e=localStorage.getItem("token");if(!e)return!0;try{const t=1e3*JSON.parse(atob(e.split(".")[1])).exp,s=Date.now();return t-s<this.refreshThreshold}catch(t){return console.error("Error checking token expiration:",t),!0}}},i=n;const o=new class{constructor(){this.tokenKey="coffee_system_token",this.userKey="coffee_system_user",this.refreshKey="coffee_system_refresh_token",this.expiryKey="coffee_system_token_expiry",this.authErrors=0,this.maxAuthErrors=3,this.debugMode=!0,this.accessToken=localStorage.getItem(this.tokenKey),this.refreshToken=localStorage.getItem(this.refreshKey),this.tokenExpiry=localStorage.getItem(this.expiryKey)?new Date(localStorage.getItem(this.expiryKey)):null,this.useFallbackData="true"===localStorage.getItem("use_fallback_data"),this.useFallbackData&&console.log("AuthService: Fallback mode is already enabled"),this.accessToken&&i.startAutoRefresh()}async login(e,t){try{const n=await fetch(r.getApiUrl("auth/login"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:e,password:t}),mode:"cors"});if(!n.ok){let e;try{e=await n.json()}catch(s){e={message:"Invalid username or password"}}throw new Error(e.message||"Login failed")}const o=await n.json();if(!o||!o.token)throw new Error("Invalid response format from server");if(localStorage.setItem(this.tokenKey,o.token),localStorage.setItem(this.refreshKey,o.refreshToken||""),localStorage.setItem("token",o.token),localStorage.setItem("refreshToken",o.refreshToken||""),localStorage.setItem("tokenExpiresIn",String(o.expiresIn||3600)),o.expiresIn){const e=new Date;e.setSeconds(e.getSeconds()+o.expiresIn),this.tokenExpiry=e,localStorage.setItem(this.expiryKey,e.toISOString())}i.startAutoRefresh();const l=o.user||{id:"unknown",username:e,role:"guest"};return localStorage.setItem(this.userKey,JSON.stringify(l)),a.A.setToken(o.token),this.authErrors=0,localStorage.removeItem("auth_error_count"),localStorage.removeItem("auth_error_refresh_needed"),localStorage.removeItem("use_fallback_data"),this.redirectBasedOnRole(l.role),{token:o.token,refreshToken:o.refreshToken,user:l,expiresIn:o.expiresIn||3600}}catch(n){throw console.error("Login error:",n),n}}logout(){i.stopAutoRefresh();const e=window.location.pathname,t=e&&"/"!==e&&"/login"!==e?`?redirect=${encodeURIComponent(e)}`:"";localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshKey),localStorage.removeItem(this.userKey),localStorage.removeItem(this.expiryKey),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiresIn"),localStorage.removeItem("user"),a.A.setToken(null);try{fetch(r.getApiUrl("auth/logout"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.getToken()}`},mode:"cors"}).catch((e=>{console.log("Logout request error:",e)}))}catch(s){}window.dispatchEvent(new Event("user_logged_out")),window.location.href=`/login${t}`}redirectBasedOnRole(e){let t="/";switch(e){case"admin":t="/admin";break;case"staff":case"event_organizer":t="/staff";break;case"barista":t="/barista";break;case"support":t="/support";break;case"display":t="/display";break;default:t="/"}window.location.pathname===t?window.location.reload():window.location.href=t}getCurrentUser(){const e=localStorage.getItem(this.userKey);if(!e)return null;try{return JSON.parse(e)}catch(t){return console.error("Error parsing user data:",t),null}}getToken(){return localStorage.getItem(this.tokenKey)}isLoggedIn(){return!!this.getToken()}isTokenExpired(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;const t=this.getToken();if(!t)return!0;try{const s=JSON.parse(atob(t.split(".")[1])),a=Math.floor(Date.now()/1e3);return a+e>=s.exp}catch(s){return console.error("Token validation error:",s),!0}}validateToken(){const e=this.getToken();if(!e)return{isValid:!1,error:"No token found"};try{const s=e.split(".");if(3!==s.length)return{isValid:!1,error:"Invalid token format"};try{const e=JSON.parse(atob(s[0]));if(!e.alg||!e.typ)return{isValid:!1,error:"Invalid token header"}}catch(t){return{isValid:!1,error:"Cannot decode token header"}}try{const e=JSON.parse(atob(s[1]));return e.sub?"string"!==typeof e.sub?{isValid:!1,error:"Subject must be a string"}:e.exp&&1e3*e.exp<Date.now()?{isValid:!1,error:"Token has expired",expired:!0}:{isValid:!0,payload:e,expiresAt:e.exp?new Date(1e3*e.exp):null}:{isValid:!1,error:"Token missing subject claim"}}catch(t){return{isValid:!1,error:"Cannot decode token payload"}}}catch(s){return console.error("Token validation error:",s),{isValid:!1,error:s.message}}}async refreshToken(){const e=localStorage.getItem(this.refreshKey);if(!e)return!1;try{const t=await fetch(r.getApiUrl("auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({refreshToken:e}),mode:"cors"});if(!t.ok)throw this.incrementAuthError(),new Error("Token refresh failed");const s=await t.json();if(!s||!s.token)throw this.incrementAuthError(),new Error("Invalid response from refresh endpoint");if(localStorage.setItem(this.tokenKey,s.token),s.expiresIn){const e=new Date;e.setSeconds(e.getSeconds()+s.expiresIn),this.tokenExpiry=e,localStorage.setItem(this.expiryKey,e.toISOString())}return a.A.setToken(s.token),this.authErrors=0,localStorage.removeItem("auth_error_count"),console.log("Token refreshed successfully"),!0}catch(t){return console.error("Token refresh error:",t),this.incrementAuthError(),!1}}async handleAuthentication(){if(console.log("\ud83d\udd27 handleAuthentication called"),!this.isLoggedIn())return console.log("Not logged in - no token found"),!1;const e=this.getToken(),t=this.getCurrentUser();if(!e||!t)return console.log("Missing token or user data"),!1;try{const t=JSON.parse(atob(e.split(".")[1])),s=new Date(1e3*t.exp);return s<=new Date?(console.log("Token is completely expired"),localStorage.removeItem(this.tokenKey),!1):(console.log("\u2705 Token is valid, user authenticated"),a.A.setToken(e),!0)}catch(s){return console.error("Error validating token:",s),localStorage.removeItem(this.tokenKey),!1}}incrementAuthError(){this.authErrors++;const e=parseInt(localStorage.getItem("auth_error_count")||"0");localStorage.setItem("auth_error_count",(e+1).toString()),console.log(`Auth error count: ${this.authErrors}/${this.maxAuthErrors}`),(this.authErrors>=this.maxAuthErrors||e+1>=this.maxAuthErrors)&&(console.warn(`Auth error threshold reached (${this.authErrors}/${this.maxAuthErrors}), enabling fallback mode`),localStorage.setItem("use_fallback_data","true"),localStorage.setItem("auth_error_refresh_needed","true"),this.useFallbackData=!0,window.dispatchEvent(new CustomEvent("fallback-mode-enabled")))}createValidDummyToken(){const e=Math.floor(Date.now()/1e3),t={sub:"demo_user",name:"Demo User",role:"barista",stations:[1,2,3],iat:e,exp:e+86400,permissions:["manage_orders","view_stations"]},s=`${btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/=/g,"")}.${btoa(JSON.stringify(t)).replace(/=/g,"")}.valid_signature_for_offline_demo_mode`;return localStorage.setItem(this.tokenKey,s),localStorage.setItem("coffee_auth_token",s),localStorage.setItem("jwt_token",s),localStorage.setItem("use_fallback_data","true"),localStorage.setItem("auth_error_refresh_needed","true"),localStorage.removeItem("auth_error_count"),this.authErrors=0,console.log("Created and stored valid dummy token for offline/demo mode"),s}enableDemoMode(){this.createValidDummyToken(),localStorage.setItem("use_fallback_data","true"),localStorage.setItem("auth_error_refresh_needed","true"),localStorage.setItem("fallback_data_available","true"),localStorage.setItem("demo_mode_enabled","true"),console.log("Demo mode enabled with valid token and fallback data"),window.dispatchEvent(new CustomEvent("fallback-mode-enabled"))}disableDemoMode(){localStorage.removeItem("use_fallback_data"),localStorage.removeItem("auth_error_refresh_needed"),localStorage.removeItem("fallback_data_available"),localStorage.removeItem("demo_mode_enabled"),localStorage.removeItem(this.tokenKey),localStorage.removeItem("coffee_auth_token"),localStorage.removeItem("jwt_token"),localStorage.removeItem("auth_error_count"),this.authErrors=0,console.log("Demo mode disabled, returning to normal operation"),window.dispatchEvent(new CustomEvent("fallback-mode-disabled"))}async addAuthorizationHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await this.handleAuthentication();const t=this.getToken();return t?{...e,Authorization:`Bearer ${t}`}:e}async refreshAccessToken(){return await this.refreshToken()}}},853:(e,t,s)=>{e.exports=s(234)},950:(e,t,s)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}s.m=e,s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,a)=>(s.f[a](e,t),t)),[])),s.u=e=>"static/js/"+e+".61a4479f.chunk.js",s.miniCssF=e=>{},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="barista-frontend:";s.l=(a,r,n,i)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+n){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+n),o.src=a),e[a]=[r];var m=(t,s)=>{o.onerror=o.onload=null,clearTimeout(h);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(s))),t)return t(s)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="/",(()=>{var e={792:0};s.f.j=(t,a)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var n=new Promise(((s,a)=>r=e[t]=[s,a]));a.push(r[2]=n);var i=s.p+s.u(t),o=new Error;s.l(i,(a=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",o.name="ChunkLoadError",o.type=n,o.request=i,r[1](o)}}),"chunk-"+t,t)}};var t=(t,a)=>{var r,n,i=a[0],o=a[1],l=a[2],c=0;if(i.some((t=>0!==e[t]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);if(l)l(s)}for(t&&t(a);c<i.length;c++)n=i[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},a=self.webpackChunkbarista_frontend=self.webpackChunkbarista_frontend||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s(43),r=s(391),n=(s(358),"popstate");function i(){return h((function(e,t){let{pathname:s,search:a,hash:r}=e.location;return d("",{pathname:s,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:u(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return{pathname:"string"===typeof e?e:e.pathname,search:"",hash:"",..."string"===typeof t?m(t):t,state:s,key:t&&t.key||a||Math.random().toString(36).substring(2,10)}}function u(e){let{pathname:t="/",search:s="",hash:a=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function m(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function h(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:i=!1}=a,l=r.history,m="POP",h=null,g=p();function p(){return(l.state||{idx:null}).idx}function f(){m="POP";let e=p(),t=null==e?null:e-g;g=e,h&&h({action:m,location:y.location,delta:t})}function x(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,s="string"===typeof e?e:u(e);return s=s.replace(/ $/,"%20"),o(t,`No window.location.(origin|href) available to create URL for href: ${s}`),new URL(s,t)}null==g&&(g=0,l.replaceState({...l.state,idx:g},""));let y={get action(){return m},get location(){return e(r,l)},listen(e){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(n,f),h=e,()=>{r.removeEventListener(n,f),h=null}},createHref:e=>t(r,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){m="PUSH";let a=d(y.location,e,t);s&&s(a,e),g=p()+1;let n=c(a,g),o=y.createHref(a);try{l.pushState(n,"",o)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;r.location.assign(o)}i&&h&&h({action:m,location:y.location,delta:1})},replace:function(e,t){m="REPLACE";let a=d(y.location,e,t);s&&s(a,e),g=p();let r=c(a,g),n=y.createHref(a);l.replaceState(r,"",n),i&&h&&h({action:m,location:y.location,delta:0})},go:e=>l.go(e)};return y}new WeakMap;function g(e,t){return p(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function p(e,t,s,a){let r=T(("string"===typeof t?m(t):t).pathname||"/",s);if(null==r)return null;let n=f(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every(((e,s)=>e===t[s]));return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(n);let i=null;for(let o=0;null==i&&o<n.length;++o){let e=E(r);i=C(n[o],e,a)}return i}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=(e,r,n)=>{let i={relativePath:void 0===n?e.path||"":n,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};i.relativePath.startsWith("/")&&(o(i.relativePath.startsWith(a),`Absolute route path "${i.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),i.relativePath=i.relativePath.slice(a.length));let l=M([a,i.relativePath]),c=s.concat(i);e.children&&e.children.length>0&&(o(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),f(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:S(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let s of x(e.path))r(e,t,s);else r(e,t)})),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[s,...a]=t,r=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===a.length)return r?[n,""]:[n];let i=x(a.join("/")),o=[];return o.push(...i.map((e=>""===e?n:[n,e].join("/")))),r&&o.push(...i),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var y=/^:[\w-]+$/,b=3,v=2,j=1,w=10,N=-2,k=e=>"*"===e;function S(e,t){let s=e.split("/"),a=s.length;return s.some(k)&&(a+=N),t&&(a+=v),s.filter((e=>!k(e))).reduce(((e,t)=>e+(y.test(t)?b:""===t?j:w)),a)}function C(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,r={},n="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===n?t:t.slice(n.length)||"/",d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&s&&!a[a.length-1].route.index&&(d=_({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:M([n,d.pathname]),pathnameBase:P(M([n,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(n=M([n,d.pathnameBase]))}return i}function _(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];l("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,s)=>(a.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let n=new RegExp(r,t?void 0:"i");return[n,a]}(e.path,e.caseSensitive,e.end),r=t.match(s);if(!r)return null;let n=r[0],i=n.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:a.reduce(((e,t,s)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=o[s]||"";i=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[a]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:n,pathnameBase:i,pattern:e}}function E(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function T(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=e.charAt(s);return a&&"/"!==a?null:e.slice(s)||"/"}function I(e,t,s,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function O(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function A(e){let t=O(e);return t.map(((e,s)=>s===t.length-1?e.pathname:e.pathnameBase))}function $(e,t,s){let a,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=m(e):(a={...e},o(!a.pathname||!a.pathname.includes("?"),I("?","pathname","search",a)),o(!a.pathname||!a.pathname.includes("#"),I("#","pathname","hash",a)),o(!a.search||!a.search.includes("#"),I("#","search","hash",a)));let n,i=""===e||""===a.pathname,l=i?"/":a.pathname;if(null==l)n=s;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:s,search:a="",hash:r=""}="string"===typeof e?m(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)})),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:D(a),hash:z(r)}}(a,n),d=l&&"/"!==l&&l.endsWith("/"),u=(i||"."===l)&&s.endsWith("/");return c.pathname.endsWith("/")||!d&&!u||(c.pathname+="/"),c}var M=e=>e.join("/").replace(/\/\/+/g,"/"),P=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),D=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function L(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var R=["POST","PUT","PATCH","DELETE"],F=(new Set(R),["GET",...R]);new Set(F),Symbol("ResetLoaderData");var U=a.createContext(null);U.displayName="DataRouter";var B=a.createContext(null);B.displayName="DataRouterState";var W=a.createContext({isTransitioning:!1});W.displayName="ViewTransition";var q=a.createContext(new Map);q.displayName="Fetchers";var H=a.createContext(null);H.displayName="Await";var J=a.createContext(null);J.displayName="Navigation";var V=a.createContext(null);V.displayName="Location";var G=a.createContext({outlet:null,matches:[],isDataRoute:!1});G.displayName="Route";var Q=a.createContext(null);Q.displayName="RouteError";function Y(){return null!=a.useContext(V)}function K(){return o(Y(),"useLocation() may be used only in the context of a <Router> component."),a.useContext(V).location}var X="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Z(e){a.useContext(J).static||a.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=a.useContext(G);return e?function(){let{router:e}=ce("useNavigate"),t=ue("useNavigate"),s=a.useRef(!1);Z((()=>{s.current=!0}));let r=a.useCallback((async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(s.current,X),s.current&&("number"===typeof a?e.navigate(a):await e.navigate(a,{fromRouteId:t,...r}))}),[e,t]);return r}():function(){o(Y(),"useNavigate() may be used only in the context of a <Router> component.");let e=a.useContext(U),{basename:t,navigator:s}=a.useContext(J),{matches:r}=a.useContext(G),{pathname:n}=K(),i=JSON.stringify(A(r)),c=a.useRef(!1);Z((()=>{c.current=!0}));let d=a.useCallback((function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l(c.current,X),!c.current)return;if("number"===typeof a)return void s.go(a);let o=$(a,JSON.parse(i),n,"path"===r.relative);null==e&&"/"!==t&&(o.pathname="/"===o.pathname?t:M([t,o.pathname])),(r.replace?s.replace:s.push)(o,r.state,r)}),[t,s,i,n,e]);return d}()}a.createContext(null);function te(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:s}=a.useContext(G),{pathname:r}=K(),n=JSON.stringify(A(s));return a.useMemo((()=>$(e,JSON.parse(n),r,"path"===t)),[e,n,r,t])}function se(e,t,s,r){o(Y(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:i}=a.useContext(J),{matches:c}=a.useContext(G),d=c[c.length-1],u=d?d.params:{},h=d?d.pathname:"/",p=d?d.pathnameBase:"/",f=d&&d.route;{let e=f&&f.path||"";ge(h,!f||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let x,y=K();if(t){let e="string"===typeof t?m(t):t;o("/"===p||e.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${e.pathname}" was given in the \`location\` prop.`),x=e}else x=y;let b=x.pathname||"/",v=b;if("/"!==p){let e=p.replace(/^\//,"").split("/");v="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let j=!i&&s&&s.matches&&s.matches.length>0?s.matches:g(e,{pathname:v});l(f||null!=j,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),l(null==j||void 0!==j[j.length-1].route.element||void 0!==j[j.length-1].route.Component||void 0!==j[j.length-1].route.lazy,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=oe(j&&j.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:M([p,n.encodeLocation?n.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:M([p,n.encodeLocation?n.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),c,s,r);return t&&w?a.createElement(V.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},w):w}function ae(){let e=me(),t=L(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=a.createElement(a.Fragment,null,a.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),a.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",a.createElement("code",{style:i},"ErrorBoundary")," or"," ",a.createElement("code",{style:i},"errorElement")," prop on your route.")),a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),s?a.createElement("pre",{style:n},s):null,o)}var re=a.createElement(ae,null),ne=class extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(G.Provider,{value:this.props.routeContext},a.createElement(Q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ie(e){let{routeContext:t,match:s,children:r}=e,n=a.useContext(U);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),a.createElement(G.Provider,{value:t},r)}function oe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!s)return null;if(s.errors)e=s.matches;else{if(0!==t.length||s.initialized||!(s.matches.length>0))return null;e=s.matches}}let r=e,n=s?.errors;if(null!=n){let e=r.findIndex((e=>e.route.id&&void 0!==n?.[e.route.id]));o(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(n).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let i=!1,l=-1;if(s)for(let a=0;a<r.length;a++){let e=r[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=a),e.route.id){let{loaderData:t,errors:a}=s,n=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||n){i=!0,r=l>=0?r.slice(0,l+1):[r[0]];break}}}return r.reduceRight(((e,o,c)=>{let d,u=!1,m=null,h=null;s&&(d=n&&o.route.id?n[o.route.id]:void 0,m=o.route.errorElement||re,i&&(l<0&&0===c?(ge("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),u=!0,h=null):l===c&&(u=!0,h=o.route.hydrateFallbackElement||null)));let g=t.concat(r.slice(0,c+1)),p=()=>{let t;return t=d?m:u?h:o.route.Component?a.createElement(o.route.Component,null):o.route.element?o.route.element:e,a.createElement(ie,{match:o,routeContext:{outlet:e,matches:g,isDataRoute:null!=s},children:t})};return s&&(o.route.ErrorBoundary||o.route.errorElement||0===c)?a.createElement(ne,{location:s.location,revalidation:s.revalidation,component:m,error:d,children:p(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):p()}),null)}function le(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ce(e){let t=a.useContext(U);return o(t,le(e)),t}function de(e){let t=a.useContext(B);return o(t,le(e)),t}function ue(e){let t=function(e){let t=a.useContext(G);return o(t,le(e)),t}(e),s=t.matches[t.matches.length-1];return o(s.route.id,`${e} can only be used on routes that contain a unique "id"`),s.route.id}function me(){let e=a.useContext(Q),t=de("useRouteError"),s=ue("useRouteError");return void 0!==e?e:t.errors?.[s]}var he={};function ge(e,t,s){t||he[e]||(he[e]=!0,l(!1,s))}a.memo((function(e){let{routes:t,future:s,state:a}=e;return se(t,void 0,a,s)}));function pe(e){let{to:t,replace:s,state:r,relative:n}=e;o(Y(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=a.useContext(J);l(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=a.useContext(G),{pathname:d}=K(),u=ee(),m=$(t,A(c),d,"path"===n),h=JSON.stringify(m);return a.useEffect((()=>{u(JSON.parse(h),{replace:s,state:r,relative:n})}),[u,h,n,s,r]),null}function fe(e){o(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xe(e){let{basename:t="/",children:s=null,location:r,navigationType:n="POP",navigator:i,static:c=!1}=e;o(!Y(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),u=a.useMemo((()=>({basename:d,navigator:i,static:c,future:{}})),[d,i,c]);"string"===typeof r&&(r=m(r));let{pathname:h="/",search:g="",hash:p="",state:f=null,key:x="default"}=r,y=a.useMemo((()=>{let e=T(h,d);return null==e?null:{location:{pathname:e,search:g,hash:p,state:f,key:x},navigationType:n}}),[d,h,g,p,f,x,n]);return l(null!=y,`<Router basename="${d}"> is not able to match the URL "${h}${g}${p}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:a.createElement(J.Provider,{value:u},a.createElement(V.Provider,{children:s,value:y}))}function ye(e){let{children:t,location:s}=e;return se(be(t),s)}a.Component;function be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=[];return a.Children.forEach(e,((e,r)=>{if(!a.isValidElement(e))return;let n=[...t,r];if(e.type===a.Fragment)return void s.push.apply(s,be(e.props.children,n));o(e.type===fe,`[${"string"===typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),o(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=be(e.props.children,n)),s.push(i)})),s}var ve="get",je="application/x-www-form-urlencoded";function we(e){return null!=e&&"string"===typeof e.tagName}function Ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,s)=>{let a=e[s];return t.concat(Array.isArray(a)?a.map((e=>[s,e])):[[s,a]])}),[]))}var ke=null;var Se=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ce(e){return null==e||Se.has(e)?e:(l(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${je}"`),null)}function _e(e,t){let s,a,r,n,i;if(we(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");a=i?T(i,t):null,s=e.getAttribute("method")||ve,r=Ce(e.getAttribute("enctype"))||je,n=new FormData(e)}else if(function(e){return we(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return we(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(a=o?T(o,t):null,s=e.getAttribute("formmethod")||i.getAttribute("method")||ve,r=Ce(e.getAttribute("formenctype"))||Ce(i.getAttribute("enctype"))||je,n=new FormData(i,e),!function(){if(null===ke)try{new FormData(document.createElement("form"),0),ke=!1}catch(e){ke=!0}return ke}()){let{name:t,type:s,value:a}=e;if("image"===s){let e=t?`${t}.`:"";n.append(`${e}x`,"0"),n.append(`${e}y`,"0")}else t&&n.append(t,a)}}else{if(we(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=ve,a=null,r=je,i=e}var o;return n&&"text/plain"===r&&(i=n,n=void 0),{action:a,method:s.toLowerCase(),encType:r,formData:n,body:i}}function Ee(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Te(e,t){if(e.id in t)return t[e.id];try{let s=await import(e.module);return t[e.id]=s,s}catch(s){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Ie(e){return null!=e&&"string"===typeof e.page}function Oe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ae(e,t,s,a,r,n){let i=(e,t)=>!s[t]||e.route.id!==s[t].route.id,o=(e,t)=>s[t].pathname!==e.pathname||s[t].route.path?.endsWith("*")&&s[t].params["*"]!==e.params["*"];return"assets"===n?t.filter(((e,t)=>i(e,t)||o(e,t))):"data"===n?t.filter(((t,n)=>{let l=a.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,n)||o(t,n))return!0;if(t.route.shouldRevalidate){let a=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0})):[]}function $e(e,t){let{includeHydrateFallback:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map((e=>{let a=t.routes[e.route.id];if(!a)return[];let r=[a.module];return a.clientActionModule&&(r=r.concat(a.clientActionModule)),a.clientLoaderModule&&(r=r.concat(a.clientLoaderModule)),s&&a.hydrateFallbackModule&&(r=r.concat(a.hydrateFallbackModule)),a.imports&&(r=r.concat(a.imports)),r})).flat(1),[...new Set(a)];var a}function Me(e,t){let s=new Set,a=new Set(t);return e.reduce(((e,r)=>{if(t&&!Ie(r)&&"script"===r.as&&r.href&&a.has(r.href))return e;let n=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let a of s)t[a]=e[a];return t}(r));return s.has(n)||(s.add(n),e.push({key:n,link:r})),e}),[])}function Pe(e){return{__html:e}}Symbol("SingleFetchRedirect");function De(e,t){let s="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===s.pathname?s.pathname="_root.data":t&&"/"===T(s.pathname,t)?s.pathname=`${t.replace(/\/$/,"")}/_root.data`:s.pathname=`${s.pathname.replace(/\/$/,"")}.data`,s}a.Component;function ze(e){let{error:t,isOutsideRemixApp:s}=e;console.error(t);let r,n=a.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(L(t))return a.createElement(Le,{title:"Unhandled Thrown Response!"},a.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),n);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return a.createElement(Le,{title:"Application Error!",isOutsideRemixApp:s},a.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),a.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),n)}function Le(e){let{title:t,renderScripts:s,isOutsideRemixApp:r,children:n}=e,{routeModules:i}=We();return i.root?.Layout&&!r?n:a.createElement("html",{lang:"en"},a.createElement("head",null,a.createElement("meta",{charSet:"utf-8"}),a.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),a.createElement("title",null,t)),a.createElement("body",null,a.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},n,s?a.createElement(Ye,null):null)))}function Re(e){return!0===e}function Fe(){let e=a.useContext(U);return Ee(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ue(){let e=a.useContext(B);return Ee(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Be=a.createContext(void 0);function We(){let e=a.useContext(Be);return Ee(e,"You must render this element inside a <HydratedRouter> element"),e}function qe(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function He(e,t,s){if(s&&!Qe)return[e[0]];if(t){let s=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,s+1)}return e}function Je(e){let{page:t,...s}=e,{router:r}=Fe(),n=a.useMemo((()=>g(r.routes,t,r.basename)),[r.routes,t,r.basename]);return n?a.createElement(Ge,{page:t,matches:n,...s}):null}function Ve(e){let{manifest:t,routeModules:s}=We(),[r,n]=a.useState([]);return a.useEffect((()=>{let a=!1;return async function(e,t,s){return Me((await Promise.all(e.map((async e=>{let a=t.routes[e.route.id];if(a){let e=await Te(a,s);return e.links?e.links():[]}return[]})))).flat(1).filter(Oe).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,s).then((e=>{a||n(e)})),()=>{a=!0}}),[e,t,s]),r}function Ge(e){let{page:t,matches:s,...r}=e,n=K(),{manifest:i,routeModules:o}=We(),{basename:l}=Fe(),{loaderData:c,matches:d}=Ue(),u=a.useMemo((()=>Ae(t,s,d,i,n,"data")),[t,s,d,i,n]),m=a.useMemo((()=>Ae(t,s,d,i,n,"assets")),[t,s,d,i,n]),h=a.useMemo((()=>{if(t===n.pathname+n.search+n.hash)return[];let e=new Set,a=!1;if(s.forEach((t=>{let s=i.routes[t.route.id];s&&s.hasLoader&&(!u.some((e=>e.route.id===t.route.id))&&t.route.id in c&&o[t.route.id]?.shouldRevalidate||s.hasClientLoader?a=!0:e.add(t.route.id))})),0===e.size)return[];let r=De(t,l);return a&&e.size>0&&r.searchParams.set("_routes",s.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[r.pathname+r.search]}),[l,c,n,i,u,s,t,o]),g=a.useMemo((()=>$e(m,i)),[m,i]),p=Ve(m);return a.createElement(a.Fragment,null,h.map((e=>a.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r}))),g.map((e=>a.createElement("link",{key:e,rel:"modulepreload",href:e,...r}))),p.map((e=>{let{key:t,link:s}=e;return a.createElement("link",{key:t,...s})})))}Be.displayName="FrameworkContext";var Qe=!1;function Ye(e){let{manifest:t,serverHandoffString:s,isSpaMode:r,ssr:n,renderMeta:i}=We(),{router:o,static:l,staticContext:c}=Fe(),{matches:d}=Ue(),u=Re(n);i&&(i.didRenderScripts=!0);let m=He(d,null,r);a.useEffect((()=>{Qe=!0}),[]);let h=a.useMemo((()=>{let r=c?`window.__reactRouterContext = ${s};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());`:" ",n=l?`${t.hmr?.runtime?`import ${JSON.stringify(t.hmr.runtime)};`:""}${u?"":`import ${JSON.stringify(t.url)}`};\n${m.map(((e,s)=>{let a=`route${s}`,r=t.routes[e.route.id];Ee(r,`Route ${e.route.id} not found in manifest`);let{clientActionModule:n,clientLoaderModule:i,hydrateFallbackModule:o,module:l}=r,c=[...n?[{module:n,varName:`${a}_clientAction`}]:[],...i?[{module:i,varName:`${a}_clientLoader`}]:[],...o?[{module:o,varName:`${a}_HydrateFallback`}]:[],{module:l,varName:`${a}_main`}];return 1===c.length?`import * as ${a} from ${JSON.stringify(l)};`:[c.map((e=>`import * as ${e.varName} from "${e.module}";`)).join("\n"),`const ${a} = {${c.map((e=>`...${e.varName}`)).join(",")}};`].join("\n")})).join("\n")}\n  ${u?`window.__reactRouterManifest = ${JSON.stringify(function(e,t){let s=new Set(t.state.matches.map((e=>e.route.id))),a=t.state.location.pathname.split("/").filter(Boolean),r=["/"];for(a.pop();a.length>0;)r.push(`/${a.join("/")}`),a.pop();r.forEach((e=>{let a=g(t.routes,e,t.basename);a&&a.forEach((e=>s.add(e.route.id)))}));let n=[...s].reduce(((t,s)=>Object.assign(t,{[s]:e.routes[s]})),{});return{...e,routes:n}}(t,o),null,2)};`:""}\n  window.__reactRouterRouteModules = {${m.map(((e,t)=>`${JSON.stringify(e.route.id)}:route${t}`)).join(",")}};\n\nimport(${JSON.stringify(t.entry.module)});`:" ";return a.createElement(a.Fragment,null,a.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Pe(r),type:void 0}),a.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:Pe(n),type:"module",async:!0}))}),[]),p=Qe?[]:t.entry.imports.concat($e(m,t,{includeHydrateFallback:!0}));return Qe?null:a.createElement(a.Fragment,null,u?null:a.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin}),a.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin}),(f=p,[...new Set(f)]).map((t=>a.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin}))),h);var f}function Ke(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var Xe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{Xe&&(window.__reactRouterVersion="7.3.0")}catch(bn){}function Ze(e){let{basename:t,children:s,window:r}=e,n=a.useRef();null==n.current&&(n.current=i({window:r,v5Compat:!0}));let o=n.current,[l,c]=a.useState({action:o.action,location:o.location}),d=a.useCallback((e=>{a.startTransition((()=>c(e)))}),[c]);return a.useLayoutEffect((()=>o.listen(d)),[o,d]),a.createElement(xe,{basename:t,children:s,location:l.location,navigationType:l.action,navigator:o})}var et=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tt=a.forwardRef((function(e,t){let s,{onClick:r,discover:n="render",prefetch:i="none",relative:c,reloadDocument:d,replace:m,state:h,target:g,to:p,preventScrollReset:f,viewTransition:x,...y}=e,{basename:b}=a.useContext(J),v="string"===typeof p&&et.test(p),j=!1;if("string"===typeof p&&v&&(s=p,Xe))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),s=T(t.pathname,b);t.origin===e.origin&&null!=s?p=s+t.search+t.hash:j=!0}catch(bn){l(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(Y(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:r}=a.useContext(J),{hash:n,pathname:i,search:l}=te(e,{relative:t}),c=i;return"/"!==s&&(c="/"===i?s:M([s,i])),r.createHref({pathname:c,search:l,hash:n})}(p,{relative:c}),[N,k,S]=function(e,t){let s=a.useContext(Be),[r,n]=a.useState(!1),[i,o]=a.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:m}=t,h=a.useRef(null);a.useEffect((()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}}),[e]),a.useEffect((()=>{if(r){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[r]);let g=()=>{n(!0)},p=()=>{n(!1),o(!1)};return s?"intent"!==e?[i,h,{}]:[i,h,{onFocus:qe(l,g),onBlur:qe(c,p),onMouseEnter:qe(d,g),onMouseLeave:qe(u,p),onTouchStart:qe(m,g)}]:[!1,h,{}]}(i,y),C=function(e){let{target:t,replace:s,state:r,preventScrollReset:n,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=ee(),c=K(),d=te(e,{relative:i});return a.useCallback((a=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(a,t)){a.preventDefault();let t=void 0!==s?s:u(c)===u(d);l(e,{replace:t,state:r,preventScrollReset:n,relative:i,viewTransition:o})}}),[c,l,d,s,r,t,e,n,i,o])}(p,{replace:m,state:h,target:g,preventScrollReset:f,relative:c,viewTransition:x});let _=a.createElement("a",{...y,...S,href:s||w,onClick:j||d?r:function(e){r&&r(e),e.defaultPrevented||C(e)},ref:Ke(t,k),target:g,"data-discover":v||"render"!==n?void 0:"true"});return N&&!v?a.createElement(a.Fragment,null,_,a.createElement(Je,{page:w})):_}));tt.displayName="Link",a.forwardRef((function(e,t){let{"aria-current":s="page",caseSensitive:r=!1,className:n="",end:i=!1,style:l,to:c,viewTransition:d,children:u,...m}=e,h=te(c,{relative:m.relative}),g=K(),p=a.useContext(B),{navigator:f,basename:x}=a.useContext(J),y=null!=p&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.useContext(W);o(null!=s,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=rt("useViewTransitionState"),n=te(e,{relative:t.relative});if(!s.isTransitioning)return!1;let i=T(s.currentLocation.pathname,r)||s.currentLocation.pathname,l=T(s.nextLocation.pathname,r)||s.nextLocation.pathname;return null!=_(n.pathname,l)||null!=_(n.pathname,i)}(h)&&!0===d,b=f.encodeLocation?f.encodeLocation(h).pathname:h.pathname,v=g.pathname,j=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(v=v.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&x&&(j=T(j,x)||j);const w="/"!==b&&b.endsWith("/")?b.length-1:b.length;let N,k=v===b||!i&&v.startsWith(b)&&"/"===v.charAt(w),S=null!=j&&(j===b||!i&&j.startsWith(b)&&"/"===j.charAt(b.length)),C={isActive:k,isPending:S,isTransitioning:y},E=k?s:void 0;N="function"===typeof n?n(C):[n,k?"active":null,S?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let I="function"===typeof l?l(C):l;return a.createElement(tt,{...m,"aria-current":E,className:N,ref:t,style:I,to:c,viewTransition:d},"function"===typeof u?u(C):u)})).displayName="NavLink";var st=a.forwardRef(((e,t)=>{let{discover:s="render",fetcherKey:r,navigate:n,reloadDocument:i,replace:l,state:c,method:d=ve,action:m,onSubmit:h,relative:g,preventScrollReset:p,viewTransition:f,...x}=e,y=lt(),b=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:s}=a.useContext(J),r=a.useContext(G);o(r,"useFormAction must be used inside a RouteContext");let[n]=r.matches.slice(-1),i={...te(e||".",{relative:t})},l=K();if(null==e){i.search=l.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let s=e.toString();i.search=s?`?${s}`:""}}e&&"."!==e||!n.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==s&&(i.pathname="/"===i.pathname?s:M([s,i.pathname]));return u(i)}(m,{relative:g}),v="get"===d.toLowerCase()?"get":"post",j="string"===typeof m&&et.test(m);return a.createElement("form",{ref:t,method:v,action:b,onSubmit:i?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,s=t?.getAttribute("formmethod")||d;y(t||e.currentTarget,{fetcherKey:r,method:s,navigate:n,replace:l,state:c,relative:g,preventScrollReset:p,viewTransition:f})},...x,"data-discover":j||"render"!==s?void 0:"true"})}));function at(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rt(e){let t=a.useContext(U);return o(t,at(e)),t}function nt(e){l("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=a.useRef(Ne(e)),s=a.useRef(!1),r=K(),n=a.useMemo((()=>function(e,t){let s=Ne(e);return t&&t.forEach(((e,a)=>{s.has(a)||t.getAll(a).forEach((e=>{s.append(a,e)}))})),s}(r.search,s.current?null:t.current)),[r.search]),i=ee(),o=a.useCallback(((e,t)=>{const a=Ne("function"===typeof e?e(n):e);s.current=!0,i("?"+a,t)}),[i,n]);return[n,o]}st.displayName="Form";var it=0,ot=()=>`__${String(++it)}__`;function lt(){let{router:e}=rt("useSubmit"),{basename:t}=a.useContext(J),s=ue("useRouteId");return a.useCallback((async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:n,method:i,encType:o,formData:l,body:c}=_e(a,t);if(!1===r.navigate){let t=r.fetcherKey||ot();await e.fetch(t,s,r.action||n,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,flushSync:r.flushSync})}else await e.navigate(r.action||n,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:s,flushSync:r.flushSync,viewTransition:r.viewTransition})}),[e,t,s])}new TextEncoder;var ct={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var dt=(e,t)=>{const s=(0,a.forwardRef)(((s,r)=>{let{color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:c,...d}=s;return(0,a.createElement)("svg",{ref:r,...ct,width:i,height:i,stroke:n,strokeWidth:l?24*Number(o)/Number(i):o,className:`lucide lucide-${u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,...d},[...t.map((e=>{let[t,s]=e;return(0,a.createElement)(t,s)})),...(Array.isArray(c)?c:[c])||[]]);var u}));return s.displayName=`${e}`,s};const ut=dt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),mt=dt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ht=dt("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),gt=dt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),pt=dt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var ft=s(810);const xt=dt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var yt=s(579);const bt=e=>{let{className:t="",showIcon:s=!0,showText:a=!0,confirmLogout:r=!0}=e;return(0,yt.jsxs)("button",{onClick:()=>{if(r){if(!window.confirm("Are you sure you want to log out?"))return}ft.A.logout()},className:`flex items-center px-3 py-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded ${t}`,title:"Log out",children:[s&&(0,yt.jsx)(xt,{size:18,className:"mr-1"}),a&&(0,yt.jsx)("span",{children:"Sign Out"})]})},vt={companyName:"Coffee Cue",systemName:"Coffee Cue System",shortName:"Coffee Cue",tagline:"Skip the Queue, Get Your Cue",landingTitle:"Coffee Cue Ordering System",landingSubtitle:"Select your role to continue",adminPanelTitle:"Coffee Cue Admin",baristaPanelTitle:"Coffee Cue Barista",footerText:"\xa9 2025 Expresso Coffee System | ANZCA ASM 2025 Cairns",primaryColor:"#D97706",primaryColorHover:"#B45309",accentColor:"#92400E",logo:"/logo.png",favicon:"/favicon.ico",showPoweredBy:!0,poweredByText:"Powered by Coffee Cue",supportEmail:"support@coffeecue.com",supportPhone:"+1-800-COFFEE",customCSS:""},jt=(()=>{try{const e=localStorage.getItem("coffee_system_branding");return e?JSON.parse(e):null}catch(e){return console.error("Error loading branding config:",e),null}})(),wt=jt?{...vt,...jt}:vt,Nt=wt,kt=()=>{var e,t;const s=ee(),[r,n]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(async()=>{const e=await ft.A.handleAuthentication();n(e)})()}),[]);return(0,yt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,yt.jsxs)("div",{className:"max-w-6xl w-full p-6",children:[(0,yt.jsxs)("div",{className:"text-center mb-10",children:[(0,yt.jsx)("h1",{className:"text-4xl font-bold text-amber-800 mb-2",children:Nt.landingTitle}),(0,yt.jsx)("p",{className:"text-xl text-gray-600",children:Nt.landingSubtitle})]}),r?(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-green-200 hover:shadow-lg transition-shadow flex items-center justify-between mb-8",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("div",{className:"w-12 h-12 flex items-center justify-center bg-green-100 rounded-full mr-4",children:(0,yt.jsx)(mt,{size:24,className:"text-green-700"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Currently Logged In"}),(0,yt.jsxs)("p",{className:"text-gray-600",children:[(null===(e=ft.A.getCurrentUser())||void 0===e?void 0:e.username)||"Authenticated User",(null===(t=ft.A.getCurrentUser())||void 0===t?void 0:t.role)&&` (${ft.A.getCurrentUser().role})`]})]})]}),(0,yt.jsx)("div",{className:"flex space-x-3",children:(0,yt.jsx)(bt,{showIcon:!0,showText:!0})})]}):(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-amber-200 hover:shadow-lg transition-shadow flex items-center justify-between mb-8",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("div",{className:"w-12 h-12 flex items-center justify-center bg-amber-100 rounded-full mr-4",children:(0,yt.jsx)(ut,{size:24,className:"text-amber-800"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Authentication Required"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Please log in to access the system"})]})]}),(0,yt.jsx)("button",{className:"px-6 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors",onClick:()=>s("/login"),children:"Log In"})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-gray-200 hover:shadow-lg transition-shadow flex flex-col items-center text-center",children:[(0,yt.jsx)("div",{className:"w-16 h-16 flex items-center justify-center bg-amber-100 rounded-full mb-4",children:(0,yt.jsx)(ht,{size:32,className:"text-amber-800"})}),(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Client/Event Organizer"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Analytics Dashboard & System Configuration"}),(0,yt.jsx)("button",{className:"mt-6 px-6 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors",onClick:()=>r?s("/organiser"):s("/login",{state:{from:"/organiser"}}),children:"Sign In"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-gray-200 hover:shadow-lg transition-shadow flex flex-col items-center text-center",children:[(0,yt.jsx)("div",{className:"w-16 h-16 flex items-center justify-center bg-amber-100 rounded-full mb-4",children:(0,yt.jsx)(ht,{size:32,className:"text-amber-800"})}),(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Barista"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Order Management & Coffee Production"}),(0,yt.jsx)("button",{className:"mt-6 px-6 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors",onClick:()=>r?s("/barista"):s("/login",{state:{from:"/barista"}}),children:"Sign In"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-gray-200 hover:shadow-lg transition-shadow flex flex-col items-center text-center",children:[(0,yt.jsx)("div",{className:"w-16 h-16 flex items-center justify-center bg-gray-100 rounded-full mb-4",children:(0,yt.jsx)(gt,{size:32,className:"text-gray-700"})}),(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Support Staff"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Technical Monitoring & Troubleshooting"}),(0,yt.jsx)("button",{className:"mt-6 px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",onClick:()=>r?s("/support"):s("/login",{state:{from:"/support"}}),children:"Sign In"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 border border-gray-200 hover:shadow-lg transition-shadow flex flex-col items-center text-center",children:[(0,yt.jsx)("div",{className:"w-16 h-16 flex items-center justify-center bg-blue-100 rounded-full mb-4",children:(0,yt.jsx)(pt,{size:32,className:"text-blue-600"})}),(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Display Screen"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Order Status Display"}),(0,yt.jsx)("button",{className:"mt-6 px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:()=>s("/displays"),children:"Access"})]})]}),(0,yt.jsxs)("div",{className:"text-center mt-10 text-gray-500 text-sm",children:[(0,yt.jsx)("p",{children:Nt.footerText}),(0,yt.jsx)("div",{className:"mt-4",children:(0,yt.jsx)("a",{href:"/login",className:"text-amber-600 hover:text-amber-800 hover:underline",children:"Go to Login Page"})})]})]})})},St=dt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Ct=dt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),_t=dt("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Et=dt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Tt=dt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),It=dt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Ot=dt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),At=dt("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),$t=dt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Mt=dt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Pt=dt("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),Dt=dt("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),zt=dt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Lt=dt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Rt=dt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ft=dt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var Ut=s(580),Bt=s(602),Wt=s(700),qt=s(625);const Ht=(e,t)=>{const s=e/t;return s<=.5?"bg-green-500":s<=.8?"bg-yellow-500":"bg-red-500"},Jt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(s&&s.avgPrepTime&&s.avgPrepTime>0){let t=Math.max(2,Math.ceil(e*s.avgPrepTime));return a&&!0===a.high_volume&&(t=Math.max(1,Math.floor(.7*t))),t}let r=t+Math.max(0,e-1);return a&&!0===a.high_volume&&(r=Math.max(1,Math.floor(.7*r))),r},Vt=(e,t)=>{if(e.priority)return"bg-red-50";if(e.batchGroup)return"bg-yellow-50";if(e.milkTypeId||e.milkType||e.milk_type||e.milk){let s="",a=null;if(e.milkTypeId&&(a=(0,qt.iC)(e.milkTypeId),a&&(s=a.name)),a||(s=e.milkType||e.milk_type||e.milk||"",a=(0,qt.ke)(s)),a&&a.properties.lactoseFree||s&&s.toLowerCase().includes("lactose"))return"bg-white border-2 border-blue-200";if(a){const e=`order-milk-${a.id}`;return console.log("Using milk class: ",e,"for milk: ",a),e}const r=((e,t)=>{if(!e||!t||!t.milkColors)return null;let s=null;if(s=(0,qt.iC)(e),s||(s=(0,qt.ke)(e)),s&&t.milkColors[s.name])return t.milkColors[s.name];if(t.milkColors[e])return t.milkColors[e];const a=Object.keys(t.milkColors);for(const r of a)if(e.toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes(e.toLowerCase()))return t.milkColors[r];return s||(s=qt.en.find((t=>t.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.name.toLowerCase())))),s&&"alternative"===s.category?"#E6E6FA":null})(e.milkTypeId||s,t);if(r){return`order-milk-${s.toLowerCase().replace(/\s+/g,"-")}`}if(e.alternativeMilk)return"bg-blue-50 border-l-4 border-blue-300"}return e.allergyWarning?"bg-purple-50":"bg-white"};function Gt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const[t,r]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)([]),[h,g]=(0,a.useState)([]),[p,f]=(0,a.useState)([]),[x,y]=(0,a.useState)([]),[b,v]=(0,a.useState)(e);(0,a.useEffect)((()=>{if(e!==b){if(console.log(`[useOrders] Station ID prop changed from ${b} to ${e}, syncing...`),b){const e={pendingOrders:t,inProgressOrders:n,completedOrders:o,previousOrders:c,timestamp:Date.now()};try{const t=`orders_cache_station_${b}`,s=JSON.stringify(e);localStorage.setItem(t,s),sessionStorage.setItem(t,s),console.log(`Saved orders for station ${b} before switching`)}catch(bn){console.error("Error saving orders before station switch:",bn)}}r([]),i([]),l([]),d([]),v(e);try{const t=`orders_cache_station_${e}`,n=localStorage.getItem(t)||sessionStorage.getItem(t);if(n){var s,a,u;const t=JSON.parse(n);console.log(`Loading cached orders for station ${e}:`,{pending:(null===(s=t.pendingOrders)||void 0===s?void 0:s.length)||0,inProgress:(null===(a=t.inProgressOrders)||void 0===a?void 0:a.length)||0,completed:(null===(u=t.completedOrders)||void 0===u?void 0:u.length)||0}),setTimeout((()=>{t.pendingOrders&&r(t.pendingOrders),t.inProgressOrders&&i(t.inProgressOrders),t.completedOrders&&l(t.completedOrders),t.previousOrders&&d(t.previousOrders)}),0)}else console.log(`No cached orders found for station ${e}`)}catch(bn){console.error("Error loading cached orders for new station:",bn)}}}),[e,b,t,n,o,c]);const[j,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)(null),[S,C]=(0,a.useState)(!0),[_,E]=(0,a.useState)(0),[T,I]=(0,a.useState)(Date.now()),[O,A]=(0,a.useState)(!1),[$,M]=(0,a.useState)("true"===localStorage.getItem("coffee_auto_refresh_enabled")),[P,D]=(0,a.useState)((()=>{const e=parseInt(localStorage.getItem("coffee_auto_refresh_interval"));if(!e||isNaN(e)||e<30){const e=60;return localStorage.setItem("coffee_auto_refresh_interval",e.toString()),e}return e})),[z,L]=(0,a.useState)({avgPrepTime:0,prepTimes:[],totalCompleted:0,lastCalculated:null}),R=(0,a.useCallback)((async e=>{if(!e||isNaN(parseInt(e)))return k("Cannot update wait time: Invalid wait time"),!1;try{const t={waitTime:parseInt(e),stationId:b};console.log(`Updating wait time to ${e} min for station ${b}`);const s=await Bt.A.updateWaitTime(t);return s&&s.success||console.log("Server call failed but updating UI for consistency"),localStorage.setItem(`station_${b}_wait_time`,e),!0}catch(t){return console.error("Update wait time error:",t),localStorage.setItem(`station_${b}_wait_time`,e),!0}}),[b]),F=(0,a.useCallback)((async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const s="true"===localStorage.getItem("use_fallback_data");if("true"===localStorage.getItem("auth_error_refresh_needed")||s){console.log("In fallback/auth error mode - loading fallback data directly");try{const e=JSON.parse(localStorage.getItem("fallback_pending_orders")||"[]"),t=JSON.parse(localStorage.getItem("fallback_in_progress_orders")||"[]"),s=JSON.parse(localStorage.getItem("fallback_completed_orders")||"[]");return console.log("Loaded fallback data:",{pending:e.length,inProgress:t.length,completed:s.length}),void setTimeout((()=>{r(e),i(t),l(s),d([]),w(!1),A(!1),k(null),C(!1)}),0)}catch(a){console.error("Error loading fallback data:",a)}}e&&w(!0),A(!0);try{const s="last_connection_check_time",a=Date.now(),r=a-parseInt(sessionStorage.getItem(s)||"0");if(e||r>5e3||!S){const t=await Bt.A.checkConnection();if(t!==S||e){console.log(`Connection status changed: ${S} -> ${t}`);const e=t;window._tempOnlineStatus=e}sessionStorage.setItem(s,a.toString())}else console.log(`Skipping connection check (last check was ${r}ms ago)`);const n=`orders_cache_station_${b}`;let i=null;try{const e=localStorage.getItem(n);e&&(i=JSON.parse(e),console.log(`Loaded cached orders for station ${b}`))}catch(bn){console.error("Error loading cached orders:",bn)}const[o,l,c]=await Promise.all([Bt.A.getPendingOrders(),Bt.A.getInProgressOrders(),Bt.A.getCompletedOrders()]),d=e=>b?(console.log(`Filtering orders for station ${b}`),(e||[]).filter((e=>{const t=String(b).toLowerCase(),s=[e.stationId,e.station_id,e.assigned_station,e.assignedStation,e.assigned_to_station,e.station,e.barista_station].filter((e=>void 0!==e&&null!==e)).map((e=>String(e).toLowerCase())),a=s.some((e=>e===t));if(console.log(`Order ${e.id} station fields:`,s,`matches current station ${t}:`,a),a)return!0;const r=localStorage.getItem(`order_created_at_station_${e.id}`)===String(b);return r?(console.log(`Order ${e.id} was created at station ${b} - showing here`),!0):!("1"!==t||0!==s.length||r||!e.phoneNumber||"Walk-in"===e.phoneNumber||"Group-Order"===e.phoneNumber||e.isWalkIn)&&(console.log(`Order ${e.id} is an unassigned SMS order - showing only at station 1`),!0)}))):e||[],u=d(o),m=d(l),h=d(c);if(t.length>0){const e=new Set(t.map((e=>e.id))),s=u.filter((t=>!e.has(t.id)));s.length>0&&(console.log(`${s.length} new pending orders detected, triggering sound notification`),window.dispatchEvent(new CustomEvent("app:newOrder")))}let g=[...u];try{const e=`local_orders_station_${b}`,t=JSON.parse(localStorage.getItem(e)||"[]");if(t.length>0){console.log(`Found ${t.length} local orders for station ${b}`);const e=new Set(u.map((e=>e.id))),s=t.filter((t=>!e.has(t.id)));s.length>0&&(console.log(`Adding ${s.length} unique local orders to pending orders`),g=[...u,...s])}}catch(bn){console.error("Error retrieving local orders:",bn)}window._tempPendingOrders=g,window._tempInProgressOrders=m;const p=[],f=[];h.forEach((e=>{e.pickedUpAt?f.push(e):p.push(e)})),window._tempCompletedOrders=p,window._tempPreviousOrders=f;try{const e=`orders_cache_station_${b}`,t={pendingOrders:g,inProgressOrders:m,completedOrders:p,previousOrders:f,timestamp:Date.now()},s=JSON.stringify(t);localStorage.setItem(e,s),sessionStorage.setItem(e,s),localStorage.setItem(`${e}_backup_time`,Date.now().toString()),localStorage.setItem(`${e}_backup`,s),console.log(`Cached orders for station ${b} across all storage locations`),console.log(`Order counts in cache - Pending: ${g.length}, In Progress: ${m.length}, Ready for Pickup: ${p.length}, Completed: ${f.length}`)}catch(bn){console.error("Error caching orders:",bn)}const x=(null===u||void 0===u?void 0:u.length)||0,y=_!==x;window._tempQueueCount=x,y&&setTimeout((()=>{const e=Jt(x,2,z);R(e),console.log(`Auto-updated wait time to ${e}min due to queue change (${x} orders)`)}),250);const v=Date.now();window._tempLastUpdated=v,window._tempError=null}catch(n){window._tempError=`Error fetching orders: ${n.message}`,console.error("Error fetching orders:",n)}finally{const e={onlineStatus:window._tempOnlineStatus,queueCount:window._tempQueueCount,lastUpdated:window._tempLastUpdated,pendingOrders:window._tempPendingOrders,inProgressOrders:window._tempInProgressOrders,completedOrders:window._tempCompletedOrders,previousOrders:window._tempPreviousOrders,error:window._tempError};(()=>{["_tempOnlineStatus","_tempQueueCount","_tempLastUpdated","_tempPendingOrders","_tempInProgressOrders","_tempCompletedOrders","_tempPreviousOrders","_tempError"].forEach((e=>{void 0!==window[e]&&delete window[e]}))})();const t=()=>{void 0!==e.onlineStatus&&C(e.onlineStatus),void 0!==e.queueCount&&E(e.queueCount),void 0!==e.lastUpdated&&I(e.lastUpdated),void 0!==e.pendingOrders&&Array.isArray(e.pendingOrders)&&r(e.pendingOrders),void 0!==e.inProgressOrders&&Array.isArray(e.inProgressOrders)&&i(e.inProgressOrders),void 0!==e.completedOrders&&Array.isArray(e.completedOrders)&&l(e.completedOrders),void 0!==e.previousOrders&&Array.isArray(e.previousOrders)&&d(e.previousOrders),void 0!==e.error?k(e.error):k(null),w(!1),A(!1),"true"!==localStorage.getItem("use_fallback_data")&&"true"!==localStorage.getItem("auth_error_refresh_needed")||(console.log("Using fallback data, ensuring loading state is disabled"),w(!1),k(null))};window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,0)}}),[b,t,z,_,R]),U=(0,a.useCallback)((e=>{console.log(`[useOrders] Updating station ID to ${e}`),v(e);try{localStorage.setItem("last_used_station_id",e.toString())}catch(bn){console.error("Error saving station ID to localStorage:",bn)}try{const t=parseFloat(localStorage.getItem(`station_${e}_avg_prep_time`))||0,s=parseInt(localStorage.getItem(`station_${e}_total_completed`))||0;t>0&&(L((e=>({...e,avgPrepTime:t,totalCompleted:s,lastCalculated:new Date}))),console.log(`Loaded saved stats for station ${e}: avgPrepTime=${t.toFixed(2)}m, completed=${s}`))}catch(bn){console.error(`Error loading stats for station ${e}:`,bn)}console.log(`Station updated to ${e} - data will refresh automatically`)}),[]),B=(0,a.useRef)(!1);(0,a.useEffect)((()=>{if(!B.current){B.current=!0;(async()=>{try{console.log("Checking for order backups before initial fetch");const t="true"===localStorage.getItem("use_fallback_data");if("true"===localStorage.getItem("auth_error_refresh_needed")||t){console.log("In fallback/auth error mode on initial load - loading fallback data directly");const e=JSON.parse(localStorage.getItem("fallback_pending_orders")||"[]"),t=JSON.parse(localStorage.getItem("fallback_in_progress_orders")||"[]"),s=JSON.parse(localStorage.getItem("fallback_completed_orders")||"[]"),a={pendingOrders:e,inProgressOrders:t,completedOrders:s,previousOrders:[]};return console.log("Loaded fallback data for initial render:",{pending:e.length,inProgress:t.length,completed:s.length}),a.pendingOrders&&r(a.pendingOrders),a.inProgressOrders&&i(a.inProgressOrders),a.completedOrders&&l(a.completedOrders),a.previousOrders&&d(a.previousOrders),C(!1),void w(!1)}const s=`orders_cache_station_${b}`,a=`${s}_backup`;let n=null;const o=localStorage.getItem(a);if(o){console.log("Found order backup for quick restore - preparing data");try{n=JSON.parse(o),localStorage.removeItem(a)}catch(e){console.error("Error parsing backup data:",e)}}else{const t=sessionStorage.getItem(s);if(t)try{n=JSON.parse(t),console.log("Using session-cached orders while fetching fresh data")}catch(e){console.error("Error parsing session data:",e)}}n&&setTimeout((()=>{n.pendingOrders&&r(n.pendingOrders),n.inProgressOrders&&i(n.inProgressOrders),n.completedOrders&&l(n.completedOrders),n.previousOrders&&d(n.previousOrders),console.log("Successfully applied cached order data")}),0)}catch(bn){console.error("Error loading orders from storage:",bn)}})()}let e;if(F(),$){console.log(`Auto-refresh enabled with interval ${P} seconds`);const t=Math.max(30,P);t!==P&&(console.warn(`Adjusting auto-refresh interval from ${P}s to ${t}s to prevent flickering`),localStorage.setItem("coffee_auto_refresh_interval",t.toString()),D(t)),e=setInterval((()=>{console.log("Auto-refresh temporarily disabled to fix UI issues")}),1e3*t)}const t=()=>{console.log("Received app:refreshOrders event - refreshing orders"),F(!1)};window.addEventListener("app:refreshOrders",t);const s=()=>{"visible"===document.visibilityState&&(console.log("Tab became visible - refreshing orders"),F(!1))};return document.addEventListener("visibilitychange",s),()=>{e&&clearInterval(e),window.removeEventListener("app:refreshOrders",t),document.removeEventListener("visibilitychange",s)}}),[$,P,b]);const W=(0,a.useRef)(null);(0,a.useEffect)((()=>{const e=()=>{r((e=>e&&0!==e.length?e.map((e=>{try{let t=e.createdAt;"string"===typeof t?t=new Date(t):t instanceof Date||(t=new Date);const s=Math.floor((new Date-t)/6e4);return e.waitTime!==s?{...e,waitTime:s}:e}catch(bn){return console.error("Error calculating wait time:",bn),e}})):e)),i((e=>e&&0!==e.length?e.map((e=>{try{let t=e.createdAt;"string"===typeof t?t=new Date(t):t instanceof Date||(t=new Date);const s=Math.floor((new Date-t)/6e4);return e.waitTime!==s?{...e,waitTime:s}:e}catch(bn){return console.error("Error calculating wait time:",bn),e}})):e))};return W.current&&clearInterval(W.current),W.current=setInterval(e,6e4),e(),()=>{W.current&&(clearInterval(W.current),W.current=null)}}),[]);const q=(0,a.useCallback)((()=>{console.log(`[useOrders] Manual refresh requested for station ${b}`);const e=parseInt(sessionStorage.getItem("last_manual_refresh_time")||"0"),t=Date.now()-e;if(t<5e3)console.log(`Debouncing refresh request (last refresh was ${t}ms ago)`);else{if(sessionStorage.setItem("last_manual_refresh_time",Date.now().toString()),A(!0),b)try{const e=localStorage.getItem("coffee_cue_selected_station");e&&parseInt(e,10)!==b&&(console.log(`[useOrders] Syncing localStorage station ID from ${e} to ${b}`),localStorage.setItem("coffee_cue_selected_station",b.toString()))}catch(bn){console.error("Error syncing station ID to localStorage:",bn)}F(!1)}}),[F,b]),H=(0,a.useCallback)((()=>{const e=!$;M(e),localStorage.setItem("coffee_auto_refresh_enabled",e),!0===e&&P<30&&(console.log("Auto-refresh enabled with too short interval, increasing to 60s for stability"),D(60),localStorage.setItem("coffee_auto_refresh_interval","60"))}),[$,P]),J=(0,a.useCallback)((e=>{if(e&&!isNaN(e)&&e>=30){const t=P;return D(e),localStorage.setItem("coffee_auto_refresh_interval",e),localStorage.setItem("coffee_auto_refresh_enabled","true"),console.log(`Auto-refresh interval updated from ${t}s to ${e}s`),!0}return e&&!isNaN(e)&&e<30&&console.warn(`Auto-refresh interval of ${e}s is too low and might cause UI flickering. Minimum allowed is 30s.`),!1}),[P]),V=(0,a.useCallback)((async()=>{try{w(!0);const e=await Bt.A.getYesterdayOrders(b);return g(e.orders||[]),k(null),e.orders||[]}catch(e){return console.error("Error fetching yesterday's orders:",e),k(`Failed to fetch yesterday's orders: ${e.message}`),[]}finally{w(!1)}}),[b]),G=(0,a.useCallback)((async()=>{try{w(!0);const e=await Bt.A.getThisWeekOrders(b);return f(e.orders||[]),k(null),e.orders||[]}catch(e){return console.error("Error fetching this week's orders:",e),k(`Failed to fetch this week's orders: ${e.message}`),[]}finally{w(!1)}}),[b]),Q=(0,a.useCallback)((async e=>{if(!e||e.trim().length<2)return k("Search term must be at least 2 characters"),[];try{w(!0);const t=await Bt.A.searchOrders(e,b);return y(t.orders||[]),k(null),t.orders||[]}catch(t){return console.error("Error searching orders:",t),k(`Failed to search orders: ${t.message}`),[]}finally{w(!1)}}),[b]),Y=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{w(!0);const t=await Bt.A.getOrderHistory({...e,stationId:b});return m(t.orders||[]),k(null),t}catch(t){return console.error("Error fetching order history:",t),k(`Failed to fetch order history: ${t.message}`),{orders:[],total:0}}finally{w(!1)}}),[b]),K=(0,a.useCallback)((async e=>{if(!e||!e.id)return k("Invalid order: missing ID"),!1;try{if(e.isLocalOrder||e.id.toString().startsWith("local_order_")){console.log("Starting local order without API call:",e.id);try{const t=`local_orders_station_${b}`,s=JSON.parse(localStorage.getItem(t)||"[]").filter((t=>t.id!==e.id));localStorage.setItem(t,JSON.stringify(s)),console.log(`Removed order ${e.id} from local orders collection`)}catch(bn){console.error("Error removing local order from storage:",bn)}r((t=>t.filter((t=>t.id!==e.id))));const t={...e,startedAt:new Date,status:"in-progress",stationId:b,station_id:b,assignedStation:b};i((e=>[...e,t])),E((e=>Math.max(0,e-1)));try{const s=`orders_cache_station_${b}`;let a={};try{const e=localStorage.getItem(s);e&&(a=JSON.parse(e))}catch(bn){console.error("Error parsing orders cache:",bn)}a.pendingOrders||(a.pendingOrders=[]),a.inProgressOrders||(a.inProgressOrders=[]),a.pendingOrders=a.pendingOrders.filter((t=>t.id!==e.id)),a.inProgressOrders.push(t),a.timestamp=Date.now();const r=JSON.stringify(a);localStorage.setItem(s,r),sessionStorage.setItem(s,r),localStorage.setItem(`${s}_backup`,r),localStorage.setItem(`${s}_backup_time`,Date.now().toString()),console.log(`Successfully moved order ${e.id} to in-progress in all storage locations`)}catch(bn){console.error("Error updating orders cache:",bn)}return!0}const t=await Bt.A.startOrder(e,b);if(!t||!t.success){const e=(null===t||void 0===t?void 0:t.message)||"Unknown error";throw new Error(`Failed to start order: ${e}`)}r((t=>t.filter((t=>t.id!==e.id))));const s={...e,startedAt:new Date,status:"in-progress",stationId:b,station_id:b,assignedStation:b};i((e=>[...e,s])),E((e=>Math.max(0,e-1)));try{const t=`orders_cache_station_${b}`;let a={};try{const e=localStorage.getItem(t);e&&(a=JSON.parse(e))}catch(bn){console.error("Error parsing orders cache:",bn)}a.pendingOrders||(a.pendingOrders=[]),a.inProgressOrders||(a.inProgressOrders=[]),a.pendingOrders=a.pendingOrders.filter((t=>t.id!==e.id)),a.inProgressOrders.push(s),a.timestamp=Date.now();const r=JSON.stringify(a);localStorage.setItem(t,r),sessionStorage.setItem(t,r),localStorage.setItem(`${t}_backup`,r),localStorage.setItem(`${t}_backup_time`,Date.now().toString()),console.log(`Successfully moved server order ${e.id} to in-progress in all storage locations`)}catch(bn){console.error("Error updating orders cache for server order:",bn)}return setTimeout(q,500),!0}catch(t){return k(`Failed to start order: ${t.message}`),console.error("Start order error:",t),!1}}),[q,b]),X=(0,a.useCallback)((async e=>{if(!e)return k("Cannot complete order: Missing order ID"),!1;try{const m=n.find((t=>t.id===e));if(!m)throw new Error(`Order with ID ${e} not found in progress orders`);const h=m.isLocalOrder||e.toString().startsWith("local_order_");let g=0;if(m.startedAt){const e=new Date(m.startedAt),t=new Date;g=(t-e)/6e4,g>0&&g<60&&L((e=>{const t=[...e.prepTimes,g],s=t.slice(-20),a=s.reduce(((e,t)=>e+t),0)/s.length;try{localStorage.setItem(`station_${b}_avg_prep_time`,a.toFixed(2)),localStorage.setItem(`station_${b}_total_completed`,e.totalCompleted+1)}catch(bn){console.error("Error saving station stats to localStorage:",bn)}return{prepTimes:t,avgPrepTime:a,totalCompleted:e.totalCompleted+1,lastCalculated:new Date}}))}try{var t,a,r;Wt.default.stationId!==b&&Wt.default.initialize(b,`Station ${b}`),console.log(`Depleting stock for order ${e}:`,m);let s=0;const n=(null===(t=m.coffeeType)||void 0===t?void 0:t.toLowerCase())||"";s=n.includes("small")?.15:n.includes("medium")?.25:n.includes("large")?.35:.25;let i="milk_regular";const o=(null===(a=m.milkType)||void 0===a?void 0:a.toLowerCase())||"";o.includes("skim")?i="milk_skim":o.includes("almond")?i="milk_almond":o.includes("soy")&&(i="milk_soy");const l=Wt.default.getLocalCategoryStock("milk").find((e=>e.id===i));if(l){const e=Math.max(0,l.amount-s);console.log(`Depleting ${i} from ${l.amount}L to ${e}L`),Wt.default.updateLocalStockAmount("milk",i,e)}let c=0;c=n.includes("small")?.008:n.includes("medium")?.015:n.includes("large")?.022:.015;const d="coffee_house",u=Wt.default.getLocalCategoryStock("coffee").find((e=>e.id===d));if(u){const e=Math.max(0,u.amount-c);console.log(`Depleting ${d} from ${u.amount}kg to ${e}kg`),Wt.default.updateLocalStockAmount("coffee",d,e)}let h="cups_medium";n.includes("small")?h="cups_small":n.includes("large")&&(h="cups_large");const g=Wt.default.getLocalCategoryStock("cups").find((e=>e.id===h));if(g){const e=Math.max(0,g.amount-1);console.log(`Depleting ${h} from ${g.amount} to ${e} cups`),Wt.default.updateLocalStockAmount("cups",h,e)}const p=(null===(r=m.sugar)||void 0===r?void 0:r.toLowerCase())||"";let f=0;if(p.includes("1 sugar")?f=.005:p.includes("2 sugar")?f=.01:p.includes("3 sugar")&&(f=.015),f>0){const e=Wt.default.getLocalCategoryStock("other").find((e=>"sugar_white"===e.id));if(e){const t=Math.max(0,e.amount-f);console.log(`Depleting sugar from ${e.amount}kg to ${t}kg`),Wt.default.updateLocalStockAmount("other","sugar_white",t)}}}catch(d){console.error("Error updating stock levels:",d)}if(h){console.log("Completing local order without API call:",e),i((t=>t.filter((t=>t.id!==e))));const t={...m,completedAt:new Date,status:"completed",prepTime:g};try{const e=(await Promise.resolve().then(s.bind(s,700))).default;e.depleteStockForOrder&&e.depleteStockForOrder(t)}catch(d){console.error("Error depleting stock for completed local order:",d)}l((e=>[t,...e]));try{var o;const s=`orders_cache_station_${b}`;let a={};try{const e=localStorage.getItem(s);e&&(a=JSON.parse(e))}catch(bn){console.error("Error parsing orders cache:",bn)}a.inProgressOrders=(null===(o=a.inProgressOrders)||void 0===o?void 0:o.filter((t=>t.id!==e)))||[],a.completedOrders||(a.completedOrders=[]),a.completedOrders.unshift(t),a.timestamp=Date.now();const r=JSON.stringify(a);localStorage.setItem(s,r),sessionStorage.setItem(s,r),localStorage.setItem(`${s}_backup`,r),localStorage.setItem(`${s}_backup_time`,Date.now().toString())}catch(bn){console.error("Error updating orders cache:",bn)}try{window.dispatchEvent(new CustomEvent("app:orderCompleted"))}catch(u){console.error("Error triggering sound notification:",u)}return!0}const p=await Bt.A.completeOrder(e);if(!p||!p.success){const e=(null===p||void 0===p?void 0:p.message)||"Unknown error";throw new Error(`Failed to complete order: ${e}`)}i((t=>t.filter((t=>t.id!==e))));const f={...m,completedAt:new Date,status:"completed",prepTime:g};try{const e=(await Promise.resolve().then(s.bind(s,700))).default;e.depleteStockForOrder&&e.depleteStockForOrder(f)}catch(d){console.error("Error depleting stock for completed order:",d)}l((e=>[f,...e]));try{var c;const t=`orders_cache_station_${b}`;let s={};try{const e=localStorage.getItem(t);e&&(s=JSON.parse(e))}catch(bn){console.error("Error parsing orders cache:",bn)}s.inProgressOrders=(null===(c=s.inProgressOrders)||void 0===c?void 0:c.filter((t=>t.id!==e)))||[],s.completedOrders||(s.completedOrders=[]),s.completedOrders.unshift(f),s.timestamp=Date.now();const a=JSON.stringify(s);localStorage.setItem(t,a),sessionStorage.setItem(t,a),localStorage.setItem(`${t}_backup`,a),localStorage.setItem(`${t}_backup_time`,Date.now().toString())}catch(bn){console.error("Error updating orders cache:",bn)}try{window.dispatchEvent(new CustomEvent("app:orderCompleted"))}catch(u){console.error("Error triggering sound notification:",u)}return window.dispatchEvent(new CustomEvent("app:orderCompleted")),setTimeout(q,500),!0}catch(m){return k(`Failed to complete order: ${m.message}`),console.error("Complete order error:",m),!1}}),[n,q,b]),Z=(0,a.useCallback)((async e=>{if(!e)return k("Cannot mark order as picked up: Missing order ID"),!1;try{const t=o.find((t=>t.id===e));if(!t)throw new Error(`Order with ID ${e} not found in completed orders`);if(t.isLocalOrder||e.toString().startsWith("local_order_")){console.log("Marking local order as picked up without API call:",e),l((t=>t.filter((t=>t.id!==e))));const s={...t,pickedUpAt:new Date};return d((e=>[s,...e])),!0}const s=await Bt.A.markOrderPickedUp(e);if(!s||!s.success){const e=(null===s||void 0===s?void 0:s.message)||"Unknown error";throw new Error(`Failed to mark order as picked up: ${e}`)}l((t=>t.filter((t=>t.id!==e))));const a={...t,pickedUpAt:new Date};return d((e=>[a,...e])),setTimeout(q,500),!0}catch(t){return k(`Failed to mark order as picked up: ${t.message}`),console.error("Mark picked up error:",t),!1}}),[o,q]),ee=(0,a.useCallback)((async e=>{if(!e)return k("Cannot process batch: Invalid batch group"),!1;try{const s=t.filter((t=>t.batchGroup===e));if(0===s.length)return k("No orders found in this batch group"),!1;const a=s.map((e=>e.id)),n=await Bt.A.processBatch(a);if(!n||!n.success){const e=(null===n||void 0===n?void 0:n.message)||"Unknown error";throw new Error(`Failed to process batch: ${e}`)}r((t=>t.filter((t=>t.batchGroup!==e))));const o=s.map((e=>({...e,startedAt:new Date,status:"in-progress"})));return i((e=>[...e,...o])),E((e=>Math.max(0,e-s.length))),setTimeout(q,500),s.length}catch(s){return k(`Failed to process batch: ${s.message}`),console.error("Process batch error:",s),!1}}),[t,q]),te=(0,a.useCallback)((async e=>{if(!e||0===e.size)return k("Cannot process batch: No orders selected"),!1;try{const s=t.filter((t=>e.has(t.id))),a=await Bt.A.processBatchSelection(e);if(!a||!a.success){const e=(null===a||void 0===a?void 0:a.message)||"Unknown error";throw new Error(`Failed to process batch selection: ${e}`)}r((t=>t.filter((t=>!e.has(t.id)))));const n=s.map((e=>({...e,startedAt:new Date,status:"in-progress"})));return i((e=>[...e,...n])),E((t=>Math.max(0,t-e.size))),setTimeout(q,500),e.size}catch(s){return k(`Failed to process batch selection: ${s.message}`),console.error("Process batch selection error:",s),!1}}),[t,q]),se=(0,a.useCallback)((async e=>{if(!e)return k("Cannot add walk-in order: Invalid order details"),!1;try{const a={...e,station_id:b,assigned_to_station:b};console.log(`Adding walk-in order at station ${b}:`,a);const n=Date.now(),i=`local_order_${n}`,o={id:i,orderNumber:`WI${n.toString().slice(-6)}`,createdAt:new Date,waitTime:0,promisedTime:e.promisedTime||15,status:"pending",customerName:a.customer_name||a.customerName,phoneNumber:a.phone_number||a.phoneNumber||"Walk-in",coffeeType:a.coffee_type||a.coffeeType,milkType:a.milk_type||a.milkType,milkTypeId:a.milk_type_id||a.milkTypeId,sugar:a.sugar||"No sugar",extraHot:a.extra_hot||a.extraHot||!1,priority:a.priority||!1,notes:a.notes||"",shots:a.shots||1,isWalkIn:a.is_walk_in||a.isWalkIn||!0,collectionStation:a.collection_station||a.collectionStation,alternativeMilk:a.alternative_milk||a.alternativeMilk||["Soy Milk","Almond Milk","Oat Milk","Coconut Milk","Macadamia Milk","Rice Milk"].includes(a.milk_type||a.milkType),dairyFree:a.dairy_free||a.dairyFree||!1,stationId:b,station_id:b,assignedStation:b,assigned_to_station:b,isLocalOrder:!0};try{const e=`local_orders_station_${b}`;let t=[];try{t=JSON.parse(localStorage.getItem(e)||"[]")}catch(bn){console.error("Error parsing existing local orders:",bn)}t.push(o),localStorage.setItem(e,JSON.stringify(t)),console.log(`Saved local order to localStorage with key ${e}`);const s=`orders_cache_station_${b}`;let a={};try{const e=localStorage.getItem(s);e&&(a=JSON.parse(e))}catch(bn){console.error("Error parsing orders cache:",bn)}a.pendingOrders||(a.pendingOrders=[]),a.pendingOrders.push(o),a.timestamp=Date.now();const r=JSON.stringify(a);localStorage.setItem(s,r),sessionStorage.setItem(s,r),localStorage.setItem(`${s}_backup`,r),localStorage.setItem(`${s}_backup_time`,Date.now().toString()),console.log("Order saved to multiple storage locations for persistence")}catch(bn){console.error("Failed to save local order to storage:",bn)}localStorage.setItem(`order_created_at_station_${i}`,String(b)),r((e=>[...e,o])),E((e=>e+1));try{window.dispatchEvent(new CustomEvent("app:newOrder"))}catch(t){console.error("Error triggering sound notification:",t)}try{const e=await Bt.A.addWalkInOrder(a);e.success&&e.id?(console.log("Server save successful, linking local order to server ID"),localStorage.setItem(`order_created_at_station_${e.id}`,String(b))):console.log("Server call failed but keeping client-side order for UI consistency")}catch(s){console.error("Server save attempt failed but continuing with local order:",s)}return setTimeout((()=>{window.dispatchEvent(new CustomEvent("app:refreshOrders"))}),500),o}catch(a){return k(`Failed to add walk-in order: ${a.message}`),console.error("Add walk-in order error:",a),!1}}),[b]),ae=(0,a.useCallback)((async(e,t)=>{if(!e||!t)return k("Cannot send message: Missing order ID or message"),!1;try{const s=await Bt.A.sendMessageToCustomer(e,t);if(!s||!s.success){const e=(null===s||void 0===s?void 0:s.message)||"Unknown error";throw new Error(`Failed to send message: ${e}`)}return!0}catch(s){return k(`Failed to send message: ${s.message}`),console.error("Send message error:",s),!1}}),[b]),re=(0,a.useCallback)((()=>{const e=Jt(_,2,z);return console.log(`Calculated dynamic wait time: ${e}min based on queue=${_}, avgPrepTime=${z.avgPrepTime.toFixed(2)}`),R(e),e}),[_,z,R]),ne=(0,a.useCallback)((async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(!e||!e.id)return k("Cannot delay order: Missing order ID"),!1;try{if("function"!==typeof Bt.A.delayOrder)return console.log(`Delaying order #${e.id} by ${t} minutes (simulated)`),!0;const s=await Bt.A.delayOrder(e.id,t);if(!s||!s.success){const e=(null===s||void 0===s?void 0:s.message)||"Unknown error";throw new Error(`Failed to delay order: ${e}`)}return setTimeout(q,500),!0}catch(s){return k(`Failed to delay order: ${s.message}`),console.error("Delay order error:",s),!1}}),[q]),ie=(0,a.useCallback)((()=>t.reduce(((e,t)=>(t.batchGroup&&(e[t.batchGroup]||(e[t.batchGroup]=[]),e[t.batchGroup].push(t)),e)),{})),[t]);return{pendingOrders:t,inProgressOrders:n,completedOrders:o,previousOrders:c,historyOrders:u,yesterdayOrders:h,thisWeekOrders:p,searchResults:x,queueCount:_,online:S,loading:j,error:N,lastUpdated:T,isRefreshing:O,currentStationId:b,autoRefreshEnabled:$,autoRefreshInterval:P,toggleAutoRefresh:H,updateAutoRefreshInterval:J,startOrder:K,completeOrder:X,markOrderPickedUp:Z,processBatch:ee,processBatchSelection:te,addWalkInOrder:se,sendMessage:ae,updateWaitTime:R,calculateDynamicWaitTime:re,delayOrder:ne,clearError:()=>k(null),refreshData:q,updateStationId:U,stationStats:z,fetchYesterdayOrders:V,fetchThisWeekOrders:G,searchOrders:Q,getOrderHistory:Y,batchGroups:ie(),vipOrders:t.filter((e=>e.priority)),regularOrders:t.filter((e=>!e.priority))}}var Qt=s(776);class Yt{constructor(){this.apiService=new Qt.A,this.baseUrl="http://localhost:5001/api",this.debugMode=!0,this.enableFallback=!1,this.token=localStorage.getItem("coffee_system_token")||null,console.log("StationsService initialized with direct backend URL:",this.baseUrl),this.token?console.log("Token found in localStorage during StationsService initialization"):console.warn("No token found in localStorage during StationsService initialization")}async directFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log(`DirectFetch called for endpoint: ${e} with method: ${t.method||"GET"}`);try{let r;if(e.startsWith("http")){r=new URL(e).pathname,r.includes("/api/")&&(r=r.substring(r.indexOf("/api/")+4))}else r=e.includes("/api/")?e.substring(e.indexOf("/api/")+4):e.startsWith("/")?e.substring(1):e;r=r.replace(/\/+/g,"/"),r=r.replace(/^\//,"");const n=`${this.baseUrl}/${r}`;if(console.log(`Using direct URL strategy: ${n}`),!this.token){const e=localStorage.getItem("coffee_system_token")||localStorage.getItem("coffee_auth_token")||localStorage.getItem("jwt_token")||null;e&&(console.log("Found token in localStorage but not in memory, using it for request"),this.token=e)}const i={"Content-Type":"application/json",Accept:"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...t.headers||{}};console.log(`Authorization header ${this.token?"set":"NOT set"} for request to ${n}`),this.token&&console.log(`Token length: ${this.token.length}, Token prefix: ${this.token.substring(0,10)}...`),console.log(`Fetching from: ${n} with method: ${t.method||"GET"}`),t.body&&console.log(`Request body: ${t.body}`);const o={...t,headers:i,mode:"cors"};console.log("Making fetch request with options:",JSON.stringify(o,null,2));const l=await fetch(n,o);if(console.log(`Received response with status: ${l.status} ${l.statusText}`),!l.ok){let e={};try{e=await l.json(),console.log("Response error details:",e)}catch(bn){console.warn("Could not parse error response as JSON:",bn);try{const t=await l.text();console.log("Error response text:",t),e={message:t}}catch(s){console.warn("Could not read error response text:",s),e={message:`HTTP error: ${l.status} ${l.statusText}`}}}throw console.error(`API error: ${l.status}`,e),new Error(e.message||`API error: ${l.status}`)}try{const e=await l.json();return console.log(`Response from ${n}:`,e),e}catch(a){throw console.error("Error parsing JSON response:",a),new Error(`Invalid JSON response from server: ${a.message}`)}}catch(r){if(console.error(`Error in directFetch for ${e}:`,r),"TypeError"===r.name&&r.message.includes("Failed to fetch")){console.error("Network error detected. Server might be down or CORS is blocking the request.");try{console.log("Sending test request to check server status...");const e=await fetch("/api/auth-test",{method:"GET",mode:"cors",cache:"no-cache"});console.log(`Server ping response status: ${e.status}`)}catch(n){throw console.error("Server ping test failed:",n),new Error("Cannot connect to server. Please ensure backend is running at http://localhost:5001")}}throw r}}async getStations(){try{const e=(new Error).stack;console.log("STATIONS API CALL STACK:",e);const t=Date.now();return t-Yt.lastFetchTime<Yt.MIN_FETCH_INTERVAL&&Yt.pendingRequest?(console.log(`Reusing existing stations request (throttled, last fetch was ${(t-Yt.lastFetchTime)/1e3}s ago)`),Yt.pendingRequest):Yt.fetchInProgress&&!Yt.pendingRequest?(console.log("A fetch is already in progress, creating new shared promise"),Yt.pendingRequest=new Promise((e=>{const t=setInterval((()=>{if(!Yt.fetchInProgress){clearInterval(t);try{const t=localStorage.getItem("coffee_cue_stations");if(t){const s=JSON.parse(t);e(s)}else e([{id:1,name:"Coffee Station 1",status:"active"},{id:2,name:"Coffee Station 2",status:"active"},{id:3,name:"Coffee Station 3",status:"active"}])}catch(s){e([{id:1,name:"Coffee Station 1",status:"active"},{id:2,name:"Coffee Station 2",status:"active"},{id:3,name:"Coffee Station 3",status:"active"}])}}}),100)})),Yt.pendingRequest):(Yt.lastFetchTime=t,Yt.fetchInProgress=!0,Yt.pendingRequest=this._fetchStationsData().finally((()=>{Yt.fetchInProgress=!1,setTimeout((()=>{Yt.pendingRequest=null}),100)})),Yt.pendingRequest)}catch(e){throw Yt.fetchInProgress=!1,Yt.pendingRequest=null,e}}async _fetchStationsData(){let e;try{const r=`${this.baseUrl}/stations`;console.log(`Using direct URL for stations: ${r}`);try{e=await this.directFetch("stations",{method:"GET"}),console.log("\u2705 Got response from direct URL:",e)}catch(t){console.error("Direct URL approach failed:",t);try{console.log("Falling back to inherited method"),e=await this.get("/stations")}catch(s){throw console.error("Fallback method failed:",s),s}}if(!e)throw new Error("No response received from server");let n=[];if(e.stations&&Array.isArray(e.stations))n=e.stations.map((e=>{const t=e.station_id;let s;try{const a=localStorage.getItem(`coffee_station_name_${t}`);a?(console.log(`Found custom name in localStorage for station ${t}: ${a}`),s=a):s=e.notes||`Coffee Station ${t}`}catch(bn){console.error(`Error getting custom name for station ${t}:`,bn),s=e.notes||`Coffee Station ${t}`}return console.log(`Mapping station ${t}: notes=${e.notes}, name=${s}`),{id:t,name:s,location:e.equipment_notes||null,status:e.status||"active",barista:e.barista_name,currentLoad:e.current_load||0,lastUpdated:e.last_updated}}));else if(Array.isArray(e))n=e;else{if(!e.data||!Array.isArray(e.data))return console.warn("Unexpected response format:",e),[];n=e.data}if(n.length>0)try{localStorage.setItem("coffee_cue_stations",JSON.stringify(n)),console.log("Cached stations to localStorage for fallback usage")}catch(a){console.error("Error caching stations to localStorage:",a)}return n}catch(r){console.error("Failed to fetch stations:",r);const e=localStorage.getItem("coffee_cue_stations");if(e)try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return console.log("Using cached stations from localStorage:",t),t}catch(n){console.error("Error parsing saved stations:",n)}const t=[{id:1,name:"Coffee Station 1",status:"active"},{id:2,name:"Coffee Station 2",status:"active"},{id:3,name:"Coffee Station 3",status:"active"}];try{t.forEach((e=>{localStorage.setItem(`coffee_station_name_${e.id}`,e.name)}))}catch(bn){console.error("Error saving default station names to localStorage:",bn)}return t}}async getStation(e){try{const t=await this.directFetch(`stations/${e}`,{method:"GET"});if(t)return t;throw new Error("Failed to fetch station details")}catch(t){throw console.error(`Failed to fetch station ${e}:`,t),t}}async updateStationStatus(e,t){try{const s=await this.directFetch(`stations/${e}/status`,{method:"PATCH",body:JSON.stringify({status:t})});if(s&&s.success)return s.station;throw new Error((null===s||void 0===s?void 0:s.error)||"Failed to update station status")}catch(s){throw console.error(`Failed to update station ${e} status:`,s),s}}async createStation(e){try{const t=parseInt(Date.now().toString().slice(-6)),s=e.name||`Coffee Station ${t}`,a={station_id:t,status:e.status||"active",barista_name:e.barista||null,equipment_status:"operational",current_load:0,notes:s};e.location&&(a.equipment_notes=e.location),console.log("Formatted station data for API:",a);try{localStorage.setItem(`coffee_station_name_${t}`,s),console.log(`Saved custom station name to localStorage: ${s}`)}catch(bn){console.error(`Error saving custom station name for new station ${t}:`,bn)}const r=await this.directFetch("stations",{method:"POST",body:JSON.stringify(a)});if(r&&r.success){const a=r.station;return{id:t,name:s,location:e.location||null,status:a.status||"active",barista:a.barista_name,currentLoad:a.current_load||0,lastUpdated:a.last_updated}}throw new Error((null===r||void 0===r?void 0:r.error)||"Failed to create station")}catch(t){throw console.error("Failed to create station:",t),t}}async updateStation(e,t){console.log(`Starting station update for ID: ${e} with data:`,t);try{const r="coffee_system_token";if(this.token||(this.token=localStorage.getItem(r),console.log("Retrieved token from localStorage:",this.token?"Token found":"No token found")),!e)throw new Error("Station ID is required");const n=`stations/${e.toString().replace(/^\/?/,"")}`;console.log(`Using API path: ${n}`);const i={...t};t.name&&(i.notes=t.name),t.location&&(i.equipment_notes=t.location),console.log("Mapped updates for API:",i);try{const s=localStorage.getItem("coffee_cue_stations");if(s){const a=JSON.parse(s).map((s=>s.id===parseInt(e)?{...s,...t}:s));localStorage.setItem("coffee_cue_stations",JSON.stringify(a)),console.log("Updated cached stations in localStorage")}}catch(s){console.error("Error updating cached stations:",s)}const o=new AbortController,l=setTimeout((()=>o.abort()),1e4);try{const e=await this.directFetch(n,{method:"PATCH",body:JSON.stringify(i),signal:o.signal});if(clearTimeout(l),!e)throw new Error("Empty response received from server");if(!1===e.success)throw new Error(e.error||"Server returned an error");if(!e.station)return console.warn("No station data in response, using input data:",t),t;const s={id:e.station.station_id,name:e.station.notes||`Station ${e.station.station_id}`,location:e.station.equipment_notes||null,status:e.station.status||"active",barista:e.station.barista_name,currentLoad:e.station.current_load||0,lastUpdated:e.station.last_updated};return console.log("Station updated successfully:",s),s}catch(a){if(clearTimeout(l),"AbortError"===a.name)throw new Error("Request timed out. Please try again.");if(a.message.includes("Failed to fetch"))throw console.error("Network error during station update:",a),new Error("Network error. Please check your connection and try again.");throw a}}catch(r){console.error(`API update failed for station ${e} (type: ${typeof e}):`,r),console.log("Falling back to localStorage update for station");try{const s=localStorage.getItem("coffee_cue_stations");if(s){const a=JSON.parse(s).map((s=>s.id===parseInt(e)?{...s,...t,lastUpdated:(new Date).toISOString()}:s));return localStorage.setItem("coffee_cue_stations",JSON.stringify(a)),console.log("\u2705 Station updated in localStorage successfully"),{id:parseInt(e),...t,lastUpdated:(new Date).toISOString(),_localOnly:!0}}}catch(n){throw console.error("Failed to update localStorage:",n),new Error(`Station update failed: ${r.message} (localStorage also failed)`)}throw new Error(`Station update failed: ${r.message}`)}}async updateStationCapabilities(e,t){try{if(!e)throw new Error("Station ID is required");console.log(`Updating capabilities for station ${e}:`,t);const a=await this.directFetch(`stations/${e}/capabilities`,{method:"POST",body:JSON.stringify({capabilities:t})});if(a&&a.success){try{const s=localStorage.getItem("coffee_cue_stations");if(s){const a=JSON.parse(s).map((s=>s.id===parseInt(e)?{...s,capabilities:t}:s));localStorage.setItem("coffee_cue_stations",JSON.stringify(a))}}catch(s){console.error("Error updating station capabilities in local cache:",s)}return a.station||{success:!0,id:e,capabilities:t}}throw new Error((null===a||void 0===a?void 0:a.error)||"Failed to update station capabilities")}catch(a){if(console.error(`Failed to update capabilities for station ${e}:`,a),a.message.includes("501")||a.message.includes("NOT IMPLEMENTED")){console.log("API endpoint not available, saving capabilities locally as fallback");try{const s=localStorage.getItem("coffee_cue_stations");if(s){const a=JSON.parse(s).map((s=>s.id===parseInt(e)?{...s,capabilities:t}:s));return localStorage.setItem("coffee_cue_stations",JSON.stringify(a)),{success:!0,id:e,capabilities:t,fallback:!0}}}catch(r){console.error("Fallback also failed:",r)}}throw a}}async updateStationSession(e,t){try{if(!e)throw new Error("Station ID is required");if(!t||!t.mode)throw new Error("Session mode is required");t.delay_minutes&&(t.delay_minutes=parseInt(t.delay_minutes,10),isNaN(t.delay_minutes)&&(t.delay_minutes=0)),console.log(`Updating session for station ${e}:`,t);const a=await this.directFetch(`stations/${e}/session`,{method:"POST",body:JSON.stringify(t)});if(a&&a.success){try{const s=localStorage.getItem("coffee_cue_stations");if(s){const a=JSON.parse(s).map((s=>s.id===parseInt(e)?{...s,session_mode:t.mode,session_delay_minutes:t.delay_minutes}:s));localStorage.setItem("coffee_cue_stations",JSON.stringify(a))}}catch(s){console.error("Error updating station session in local cache:",s)}return a.station?a.station:{success:!0,id:e,session_mode:t.mode,session_delay_minutes:t.delay_minutes}}throw new Error((null===a||void 0===a?void 0:a.error)||"Failed to update station session")}catch(a){throw console.error(`Failed to update session for station ${e}:`,a),a}}async deleteStation(e){try{try{const t=await this.directFetch(`stations/${e}`,{method:"DELETE"});if(t&&t.success)return!0}catch(t){return console.warn(`DELETE API not implemented or CORS issue for station ${e}:`,t),console.log("Using client-side deletion fallback since API endpoint may not be implemented"),!0}return console.warn(`Unsuccessful response when deleting station ${e}`),!0}catch(s){return console.error(`Failed to delete station ${e}:`,s),!0}}async getStationStats(e){try{const t=await this.directFetch(`stations/${e}/stats`,{method:"GET"});if(t)return t;throw new Error("Failed to fetch station statistics")}catch(t){throw console.error(`Failed to fetch statistics for station ${e}:`,t),t}}}Yt.lastFetchTime=0,Yt.pendingRequest=null,Yt.MIN_FETCH_INTERVAL=5e3,Yt.fetchInProgress=!1;const Kt=new Yt;function Xt(){const[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(!0),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(Date.now()),[u,m]=(0,a.useState)(!1),{isDemoMode:h}=(0,Ut.q)(),g=(0,a.useRef)(!0),p=(0,a.useRef)(0),f=(0,a.useRef)(!0),x=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!g.current)return;const a=Date.now();if(!e&&a-p.current<5e3)console.log(`[useStations] Throttling loadStations - last call was ${(a-p.current)/1e3}s ago`);else{p.current=a,e?m(!0):i(!0);try{if(console.log("[useStations] Fetching stations data..."),h){const e=localStorage.getItem("coffee_cue_stations");if(e&&g.current){let s=JSON.parse(e);s=s.map((e=>{try{const t=localStorage.getItem(`coffee_station_name_${e.id}`);if(t)return console.log(`[useStations] Applying custom name for station ${e.id}: ${t}`),{...e,name:t}}catch(bn){console.error(`[useStations] Error getting custom name for station ${e.id}:`,bn)}return e})),t(s)}const s=localStorage.getItem("coffee_cue_selected_station");s&&g.current&&r(parseInt(s,10))}else{const e=await Kt.getStations();if(g.current&&e){const a=e.map((e=>{try{const t=localStorage.getItem(`coffee_station_name_${e.id}`);if(t)return console.log(`[useStations] Overriding station ${e.id} name from "${e.name}" to "${t}"`),{...e,name:t}}catch(bn){console.error(`[useStations] Error getting custom name for station ${e.id}:`,bn)}return e}));t(a);const n=localStorage.getItem("last_used_station_id");if(n&&a.some((e=>e.id===parseInt(n,10))))return console.log(`[useStations] Restoring saved station ID: ${n}`),r(parseInt(n,10)),void localStorage.setItem("coffee_cue_selected_station",n.toString());if(a.length>0&&!s){let e=null;try{const t=localStorage.getItem("last_used_station_id");if(t){const s=parseInt(t,10);!isNaN(s)&&a.some((e=>e.id===s))&&(e=s,console.log(`[useStations] Restoring last used station: ${e}`))}if(!e){const t=localStorage.getItem("coffee_cue_selected_station");if(t){const s=parseInt(t,10);!isNaN(s)&&a.some((e=>e.id===s))&&(e=s,console.log(`[useStations] Restoring saved station selection: ${e}`))}}}catch(bn){console.error("[useStations] Error restoring station selection:",bn)}if(!e){const t=a.find((e=>"active"===e.status));e=t?t.id:a[0].id,console.log(`[useStations] Using ${t?"first active":"first"} station: ${e}`)}r(e),localStorage.setItem("coffee_cue_selected_station",e.toString()),localStorage.setItem("last_used_station_id",e.toString())}}}g.current&&(l(null),d(Date.now()))}catch(n){console.error("[useStations] Error loading stations:",n),g.current&&l(`Failed to load stations: ${n.message}`)}finally{g.current&&(i(!1),m(!1))}}}),[h]),y=(0,a.useCallback)((async(s,a)=>{if(!g.current)return!1;try{if(h){const r=e.map((e=>e.id===s?{...e,status:a}:e));localStorage.setItem("coffee_cue_stations",JSON.stringify(r)),t(r)}else{await Kt.updateStationStatus(s,a)&&g.current&&t((e=>e.map((e=>e.id===s?{...e,status:a}:e))))}return g.current&&d(Date.now()),!0}catch(r){return console.error("[useStations] Error updating station status:",r),g.current&&l(`Failed to update station status: ${r.message}`),!1}}),[h,e]),b=(0,a.useCallback)((async(s,a)=>{if(!g.current)return!1;console.log("[useStations] Updating station with ID:",s,"Data:",a);try{if(h){const r=e.map((e=>e.id===s?{...e,...a}:e));localStorage.setItem("coffee_cue_stations",JSON.stringify(r)),t(r)}else{const e=await Kt.updateStation(s,a);e&&g.current&&t((t=>{const a=t.map((t=>t.id===s?{...t,...e,name:e.name||t.name}:t));return localStorage.setItem("coffee_cue_stations",JSON.stringify(a)),a}))}return g.current&&d(Date.now()),!0}catch(r){return console.error("[useStations] Error updating station:",r),g.current&&l(`Failed to update station: ${r.message}`),!1}}),[h,e]),v=(0,a.useCallback)((async s=>{if(!g.current)return null;try{if(h){const a={id:Math.max(0,...e.map((e=>e.id)))+1,...s,currentLoad:0};return g.current&&t((e=>{const t=[...e,a];return localStorage.setItem("coffee_cue_stations",JSON.stringify(t)),t})),a}{const e=await Kt.createStation(s);return e&&g.current&&t((t=>[...t,e])),e}}catch(a){return console.error("[useStations] Error creating station:",a),g.current&&l(`Failed to create station: ${a.message}`),null}}),[h,e]),j=(0,a.useCallback)((async e=>{if(!g.current)return!1;try{if(e===s)throw new Error("Cannot delete the currently selected station");if(h)g.current&&t((t=>{const s=t.filter((t=>t.id!==e));return localStorage.setItem("coffee_cue_stations",JSON.stringify(s)),s}));else{await Kt.deleteStation(e)&&g.current&&t((t=>t.filter((t=>t.id!==e))))}return!0}catch(a){return console.error("[useStations] Error deleting station:",a),g.current&&l(`Failed to delete station: ${a.message}`),!1}}),[h,s]),w=(0,a.useCallback)((async e=>{if(!g.current)return null;try{return h?{ordersToday:Math.floor(50*Math.random())+10,avgWaitTime:Math.floor(10*Math.random())+2,peakHour:"12:00 - 13:00",status:"active"}:await Kt.getStationStats(e)}catch(t){return console.error("[useStations] Error getting station stats:",t),null}}),[h]),N=(0,a.useCallback)((async(s,a)=>{if(!g.current)return!1;try{if(console.log("[useStations] Updating station capabilities:",s,a),h){const r=e.map((e=>e.id===s?{...e,capabilities:a}:e));return localStorage.setItem("coffee_cue_stations",JSON.stringify(r)),t(r),!0}return!(!await Kt.updateStationCapabilities(s,a)||!g.current)&&(t((e=>e.map((e=>e.id===s?{...e,capabilities:a}:e)))),!0)}catch(r){return console.error("[useStations] Error updating station capabilities:",r),g.current&&l(`Failed to update station capabilities: ${r.message}`),!1}}),[h,e]),k=(0,a.useCallback)((async(s,a)=>{if(!g.current)return!1;try{if(console.log("[useStations] Updating station session:",s,a),h){const r=e.map((e=>e.id===s?{...e,session_mode:a.mode,session_delay_minutes:a.delay_minutes}:e));return localStorage.setItem("coffee_cue_stations",JSON.stringify(r)),t(r),!0}return!(!await Kt.updateStationSession(s,a)||!g.current)&&(t((e=>e.map((e=>e.id===s?{...e,session_mode:a.mode,session_delay_minutes:a.delay_minutes}:e)))),!0)}catch(r){return console.error("[useStations] Error updating station session:",r),g.current&&l(`Failed to update station session: ${r.message}`),!1}}),[h,e]),S=(0,a.useCallback)((e=>{g.current&&(console.log(`[useStations] Changing selected station to ${e}`),r(e),localStorage.setItem("coffee_cue_selected_station",e.toString()),localStorage.setItem("last_used_station_id",e.toString()),setTimeout((()=>{console.log(`[useStations] Refreshing data for new station ${e}`),x(!0)}),100))}),[x]),C=(0,a.useCallback)((()=>e.find((e=>e.id===s))||(e.length>0?e[0]:null)),[e,s]),_=(0,a.useCallback)((()=>{if(g.current){if(console.log(`[useStations] Manual refresh requested for station ${s}`),s)try{const e=localStorage.getItem("coffee_cue_selected_station");e&&parseInt(e,10)!==s&&(console.warn(`Station ID mismatch during refresh: current=${s}, saved=${e}. Using current.`),localStorage.setItem("coffee_cue_selected_station",s.toString()))}catch(bn){console.error("Error checking station ID consistency during refresh:",bn)}m(!0),x(!0)}}),[x,s]);return(0,a.useEffect)((()=>{g.current=!0,console.log("[useStations] Initial setup or mode changed, isDemoMode:",h),f.current&&(f.current=!1,x());let e=null;if(h||(e=setInterval((()=>{g.current&&(console.log("[useStations] Scheduled refresh (30s interval)"),x())}),3e4)),!h){const e=localStorage.getItem("coffee_cue_stations");e&&"[]"!==e||(console.log("[useStations] No stations saved in localStorage, saving current stations"),t((e=>(e.length>0&&localStorage.setItem("coffee_cue_stations",JSON.stringify(e)),e))))}return()=>{console.log("[useStations] Component unmounting - cleaning up"),g.current=!1,e&&clearInterval(e)}}),[h]),(0,a.useEffect)((()=>{f.current||x()}),[h,x]),{stations:e,selectedStation:s,loading:n,error:o,lastUpdated:c,isRefreshing:u,updateStationStatus:y,updateStation:b,createStation:v,deleteStation:j,getStationStats:w,changeSelectedStation:S,getCurrentStation:C,refreshData:_,updateStationSession:k,updateStationCapabilities:N,clearError:()=>l(null)}}const Zt=(e,t)=>{const[s,r]=(0,a.useState)({}),[n,i]=(0,a.useState)(!0),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(e&&t){console.log(`useStock: Initializing for station ${e} (${t})`),Wt.default.initialize(e,t),d(!0),u();const s=Wt.default.addListener((e=>{r(e),i(!1)}));return()=>{s()}}}),[e,t]);const u=(0,a.useCallback)((async()=>{try{i(!0);const e=Wt.default.getLocalStock();r(e||{}),l(null)}catch(e){console.error("Error loading stock data:",e),l("Failed to load stock data")}finally{i(!1)}}),[]),m=(0,a.useCallback)((e=>s[e]||[]),[s]),h=(0,a.useCallback)(((e,t,s)=>{try{if(!c)return console.warn("Stock service not initialized, cannot update stock item"),!1;return!!Wt.default.updateLocalStockAmount(e,t,s)}catch(a){return console.error("Error updating stock item:",a),l("Failed to update stock item"),!1}}),[c]),g=(0,a.useCallback)(((e,t)=>{try{if(!c)return console.warn("Stock service not initialized, cannot add stock item"),!1;return!!Wt.default.addLocalStockItem(e,t)}catch(s){return console.error("Error adding stock item:",s),l("Failed to add stock item"),!1}}),[c]),p=(0,a.useCallback)(((e,t)=>{try{if(!c)return console.warn("Stock service not initialized, cannot delete stock item"),!1;return!!Wt.default.deleteLocalStockItem(e,t)}catch(s){return console.error("Error deleting stock item:",s),l("Failed to delete stock item"),!1}}),[c]),f=(0,a.useCallback)((()=>{try{if(!c)return console.warn("Stock service not initialized, cannot reset stock"),!1;return!!Wt.default.resetStationStock()}catch(e){return console.error("Error resetting stock:",e),l("Failed to reset stock"),!1}}),[c]),x=(0,a.useCallback)((()=>{let e=0,t=0;return Object.values(s).forEach((s=>{s.forEach((s=>{"danger"===s.status?t++:"warning"===s.status&&e++}))})),{lowCount:e,criticalCount:t}}),[s]);return{stockItems:s,stockCategories:["milk","coffee","cups","syrups","other"],loading:n,error:o,initialized:c,loadStockData:u,getCategoryStock:m,updateStockItem:h,addStockItem:g,deleteStockItem:p,resetStock:f,getLowStockCount:x}};const es=new class{constructor(){this.apiService=new Qt.A,this.baseUrl="http://localhost:5001/api",this.debugMode=!0,this.enableFallback=!0,this.token=localStorage.getItem("coffee_system_token")||null,console.log("ScheduleService initialized with direct backend URL:",this.baseUrl),this.token?console.log("Token found in localStorage during ScheduleService initialization"):console.warn("No token found in localStorage during ScheduleService initialization"),this._purgeHardcodedData(),window.addEventListener("schedule:updated",(e=>{console.log("Schedule updated from Organiser:",e.detail),window.dispatchEvent(new CustomEvent("schedule:refresh"))}))}async directFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a;if(e.startsWith("http")){a=new URL(e).pathname,a.includes("/api/")&&(a=a.substring(a.indexOf("/api/")+4))}else a=e.includes("/api/")?e.substring(e.indexOf("/api/")+4):e.startsWith("/")?e.substring(1):e;const r=`${this.baseUrl}/${a}`;if(console.log(`Using direct URL strategy: ${r}`),!this.token){const e=localStorage.getItem("coffee_system_token")||localStorage.getItem("coffee_auth_token")||localStorage.getItem("jwt_token")||null;e&&(console.log("Found token in localStorage but not in memory, using it for request"),this.token=e)}const n={"Content-Type":"application/json",Accept:"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...t.headers||{}};this.debugMode&&(console.log(`Authorization header ${this.token?"set":"NOT set"} for request to ${r}`),this.token&&console.log(`Token length: ${this.token.length}, Token prefix: ${this.token.substring(0,10)}...`),console.log(`Fetching from: ${r} with method: ${t.method||"GET"}`),t.body&&console.log(`Request body: ${t.body}`));const i=await fetch(r,{...t,headers:n,mode:"cors"});if(!i.ok){let e={};try{e=await i.json()}catch(bn){try{e={message:await i.text()}}catch(s){e={message:`HTTP error: ${i.status} ${i.statusText}`}}}throw console.error(`API error: ${i.status}`,e),new Error(e.message||`API error: ${i.status}`)}const o=await i.json();return this.debugMode&&console.log(`Response from ${r}:`,o),o}catch(a){throw console.error(`Error fetching from ${e}:`,a),a}}_purgeHardcodedData(){console.log("Initializing schedule data in localStorage");const e="coffee_cue_schedule";localStorage.getItem(e)&&(console.log("Removing old format schedule data"),localStorage.removeItem(e));const t="coffee_cue_local_schedule",s=localStorage.getItem(t);if(s)try{const e=JSON.parse(s);if(Array.isArray(e)){console.log(`Found existing schedule data with ${e.length} item(s)`);const s=e.map((e=>({...e,staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner",notes:e.notes||""})));localStorage.setItem(t,JSON.stringify(s)),console.log("Validated and updated existing schedule data")}else console.log("Local schedule data not in array format, resetting"),localStorage.setItem(t,JSON.stringify([]))}catch(a){console.error("Invalid JSON in local schedule, resetting:",a),localStorage.setItem(t,JSON.stringify([]))}else localStorage.setItem(t,JSON.stringify([])),console.log("Initialized empty local schedule data");console.log("Schedule data initialization complete")}async getTodaySchedule(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const a=localStorage.getItem("event_schedules");if(a){const t=JSON.parse(a),s=(new Date).toISOString().split("T")[0];let r=t.filter((e=>e.date===s));return e&&(r=r.filter((t=>t.station_id===e||t.station_id===String(e)))),console.log(`\u2705 Found ${r.length} schedules from localStorage for ${e?`station ${e}`:"all stations"}`),{success:!0,schedules:r,source:"localStorage"}}let r="schedule/today";e&&(r=`schedule/today?station=${e}`),console.log(`Attempting to fetch today's schedule from API using endpoint: ${r}`);try{const e=await this.directFetch(r,{method:"GET"});console.log("\u2705 Got schedule response from direct URL:",e);const t=(new Date).toISOString().split("T")[0];return e&&e.schedules&&Array.isArray(e.schedules)&&(e.schedules=e.schedules.map((e=>({...e,shift_date:e.shift_date||t,staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner"})))),e}catch(t){console.error("API call failed for today's schedule, using fallback from localStorage:",t);try{const t="coffee_cue_local_schedule",s=localStorage.getItem(t);if(s){const t=JSON.parse(s);if(Array.isArray(t)&&t.length>0){console.log("Retrieved schedule from localStorage:",t);const s=(new Date).toISOString().split("T")[0];console.log(`Filtering schedules for today (${s})`),console.log("Total schedules in localStorage before filtering:",t.length);const a=t.filter((e=>{let t=e.shift_date;t instanceof Date?t=t.toISOString().split("T")[0]:"number"===typeof t&&(t=new Date(t).toISOString().split("T")[0]);const a=!t||t===s;return a?console.log(`Including shift with date ${t} (ID: ${e.id})`):console.log(`Skipping shift with date ${t} (ID: ${e.id})`),a}));console.log(`Found ${a.length} shifts for today after filtering`);const r=(e?a.filter((t=>t.station_id===e||t.station_id===parseInt(e,10))):a).map((e=>({...e,shift_date:e.shift_date||s,staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner"})));return{success:!0,day_name:(new Date).toLocaleDateString("en-US",{weekday:"long"}),day_of_week:(new Date).getDay(),current_time:(new Date).toLocaleTimeString(),schedules:r,stations:[]}}}console.log("No local schedule data found or empty schedule")}catch(s){console.error("Error accessing localStorage schedule:",s)}return{success:!0,day_name:(new Date).toLocaleDateString("en-US",{weekday:"long"}),day_of_week:(new Date).getDay(),current_time:(new Date).toLocaleTimeString(),schedules:[],stations:[]}}}catch(t){return console.error("Failed to fetch today's schedule:",t),{success:!0,day_name:(new Date).toLocaleDateString("en-US",{weekday:"long"}),day_of_week:(new Date).getDay(),current_time:(new Date).toLocaleTimeString(),schedules:[],stations:[]}}}async getScheduleByDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let r=`schedule/date/${e}`;t&&(r=`schedule/date/${e}?station=${t}`),console.log(`Attempting to fetch schedule for date ${e} from API using endpoint: ${r}`);try{const t=await this.directFetch(r,{method:"GET"});return console.log(`\u2705 Got schedule response for date ${e} from direct URL:`,t),t&&t.schedules&&Array.isArray(t.schedules)&&(t.schedules=t.schedules.map((t=>({...t,shift_date:t.shift_date||e,staff_name:t.staff_name||"",staff_contact:t.staff_contact||"",staff_training_level:t.staff_training_level||"beginner"})))),t}catch(s){console.error(`API call failed for schedule by date ${e}, using fallback from localStorage:`,s);try{const s="coffee_cue_local_schedule",a=localStorage.getItem(s);if(a){const s=JSON.parse(a);if(Array.isArray(s)&&s.length>0){console.log("Retrieved schedule from localStorage:",s),console.log(`Filtering schedules for date (${e})`),console.log("Total schedules in localStorage before filtering:",s.length);const a=s.filter((t=>{let s=t.shift_date;s instanceof Date?s=s.toISOString().split("T")[0]:"number"===typeof s&&(s=new Date(s).toISOString().split("T")[0]);const a=s===e;return a?console.log(`Including shift with date ${s} (ID: ${t.id})`):console.log(`Skipping shift with date ${s} (ID: ${t.id})`),a}));console.log(`Found ${a.length} shifts for date ${e} after filtering`);const r=(t?a.filter((e=>e.station_id===t||e.station_id===parseInt(t,10))):a).map((t=>({...t,shift_date:t.shift_date||e,staff_name:t.staff_name||"",staff_contact:t.staff_contact||"",staff_training_level:t.staff_training_level||"beginner"}))),n=new Date(e),i=n.toLocaleDateString("en-US",{weekday:"long"});return{success:!0,day_name:i,day_of_week:n.getDay(),current_time:(new Date).toLocaleTimeString(),schedules:r,stations:[]}}}console.log(`No local schedule data found for date ${e}`)}catch(a){console.error(`Error accessing localStorage schedule for date ${e}:`,a)}const r=new Date(e),n=r.toLocaleDateString("en-US",{weekday:"long"});return{success:!0,day_name:n,day_of_week:r.getDay(),current_time:(new Date).toLocaleTimeString(),schedules:[],stations:[]}}}catch(s){console.error(`Failed to fetch schedule for date ${e}:`,s);const t=new Date(e);return{success:!0,day_name:t.toLocaleDateString("en-US",{weekday:"long"}),day_of_week:t.getDay(),current_time:(new Date).toLocaleTimeString(),schedules:[],stations:[]}}}async getBaristaSchedule(e){try{const s=`schedule/barista/${e}`;console.log(`Attempting to fetch schedule for barista ${e} from API using endpoint: ${s}`);try{const e=await this.directFetch(s,{method:"GET"});return console.log("\u2705 Got barista schedule response from direct URL:",e),e}catch(t){return console.error(`API call failed for barista schedule ${e}, using fallback:`,t),{shifts:[],breaks:[]}}}catch(t){return console.error(`Failed to fetch schedule for barista ${e}:`,t),{shifts:[],breaks:[]}}}async addShift(e){try{console.log("Attempting to add shift to API:",e);try{const t=await this.directFetch("schedule/shifts",{method:"POST",body:JSON.stringify(e)});if(console.log("\u2705 Successfully added shift to API:",t),t&&"object"===typeof t){const s={...t,id:t.id||Date.now(),shift_date:t.shift_date||e.shift_date,staff_name:t.staff_name||e.staff_name,staff_contact:t.staff_contact||e.staff_contact,staff_training_level:t.staff_training_level||e.staff_training_level,status:t.status||"upcoming",station_id:t.station_id||e.station_id||1};return console.log("Enhanced API response with all required fields:",s),s}console.warn("API returned invalid response, creating fallback response");return{...e,id:Date.now(),status:"upcoming",shift_date:e.shift_date||(new Date).toISOString().split("T")[0],staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner"}}catch(t){console.error("API call failed for adding shift, using fallback:",t);try{const t="coffee_cue_local_schedule";let a=[];const r=localStorage.getItem(t);if(r)try{a=JSON.parse(r),Array.isArray(a)?console.log(`Found ${a.length} existing shifts in localStorage`):(console.log("Local schedule data is not an array, resetting"),a=[])}catch(s){console.error("Error parsing local schedule data:",s),a=[]}else console.log("No existing schedule data found, initializing new array");const n={...e,id:Date.now(),status:"upcoming",shift_date:e.shift_date||(new Date).toISOString().split("T")[0],staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner"};return a.push(n),localStorage.setItem(t,JSON.stringify(a)),console.log("Saved shift to localStorage:",n),console.log(`Total shifts in localStorage: ${a.length}`),n}catch(a){return console.error("Error saving to localStorage:",a),{...e,id:Date.now(),status:"upcoming",shift_date:e.shift_date||(new Date).toISOString().split("T")[0],staff_name:e.staff_name||"",staff_contact:e.staff_contact||"",staff_training_level:e.staff_training_level||"beginner"}}}}catch(t){throw console.error("Failed to add shift:",t),t}}async updateShift(e,t){try{console.log(`Attempting to update shift ${e} in API:`,t);try{const s=await this.directFetch(`schedule/shifts/${e}`,{method:"PUT",body:JSON.stringify(t)});console.log("\u2705 Successfully updated shift in API:",s);return{...s,shift_date:s.shift_date||t.shift_date,staff_name:s.staff_name||t.staff_name,staff_contact:s.staff_contact||t.staff_contact,staff_training_level:s.staff_training_level||t.staff_training_level}}catch(s){console.error(`API call failed for updating shift ${e}, using fallback:`,s);try{const s="coffee_cue_local_schedule",a=localStorage.getItem(s);if(a){let r=JSON.parse(a);if(Array.isArray(r)){const a=r.findIndex((t=>t.id===e||t.id===parseInt(e,10)));if(-1!==a){const n={...r[a],...t,id:e,shift_date:t.shift_date||r[a].shift_date,staff_name:t.staff_name||r[a].staff_name,staff_contact:t.staff_contact||r[a].staff_contact,staff_training_level:t.staff_training_level||r[a].staff_training_level};return r[a]=n,localStorage.setItem(s,JSON.stringify(r)),console.log(`Updated shift ${e} in localStorage:`,n),n}console.warn(`Shift with ID ${e} not found in localStorage`)}}}catch(a){console.error("Error updating shift in localStorage:",a)}return{...t,id:e,shift_date:t.shift_date||(new Date).toISOString().split("T")[0],staff_name:t.staff_name||"",staff_contact:t.staff_contact||"",staff_training_level:t.staff_training_level||"beginner"}}}catch(s){throw console.error(`Failed to update shift ${e}:`,s),s}}async removeShift(e){try{console.log(`Attempting to remove shift ${e} from API`);try{const t=await this.directFetch(`schedule/shifts/${e}`,{method:"DELETE"});return console.log("\u2705 Successfully removed shift from API:",t),!0}catch(t){console.warn(`DELETE API not implemented or CORS issue for shift ${e}:`,t),console.log("Using client-side deletion fallback since API endpoint may not be implemented");try{const t="coffee_cue_local_schedule",s=localStorage.getItem(t);if(s){let a=JSON.parse(s);if(Array.isArray(a)){const s=a.filter((t=>t.id!==e&&t.id!==parseInt(e,10)));localStorage.setItem(t,JSON.stringify(s)),console.log(`Removed shift ${e} from localStorage`)}}}catch(s){console.error("Error removing shift from localStorage:",s)}return!0}}catch(t){console.error(`Failed to remove shift ${e}:`,t);try{const t="coffee_cue_local_schedule",s=localStorage.getItem(t);if(s){let a=JSON.parse(s);if(Array.isArray(a)){const s=a.filter((t=>t.id!==e&&t.id!==parseInt(e,10)));localStorage.setItem(t,JSON.stringify(s)),console.log(`Removed shift ${e} from localStorage`)}}}catch(s){console.error("Error removing shift from localStorage:",s)}return!0}}async addBreak(e){try{console.log("Attempting to add break to API:",e);try{const t=await this.directFetch("schedule/breaks",{method:"POST",body:JSON.stringify(e)});return console.log("\u2705 Successfully added break to API:",t),t}catch(t){return console.error("API call failed for adding break, using fallback:",t),{...e,id:Date.now(),status:"upcoming"}}}catch(t){throw console.error("Failed to add break:",t),t}}async updateBreak(e,t){try{console.log(`Attempting to update break ${e} in API:`,t);try{const s=await this.directFetch(`schedule/breaks/${e}`,{method:"PUT",body:JSON.stringify(t)});return console.log("\u2705 Successfully updated break in API:",s),s}catch(s){return console.error(`API call failed for updating break ${e}, using fallback:`,s),{...t,id:e}}}catch(s){throw console.error(`Failed to update break ${e}:`,s),s}}async removeBreak(e){try{console.log(`Attempting to remove break ${e} from API`);try{const t=await this.directFetch(`schedule/breaks/${e}`,{method:"DELETE"});return console.log("\u2705 Successfully removed break from API:",t),!0}catch(t){return console.error(`API call failed for removing break ${e}, using fallback:`,t),!0}}catch(t){throw console.error(`Failed to remove break ${e}:`,t),t}}async addRushPeriod(e){try{console.log("Attempting to add rush period to API:",e);try{const t=await this.directFetch("schedule/rush-periods",{method:"POST",body:JSON.stringify(e)});return console.log("\u2705 Successfully added rush period to API:",t),t}catch(t){return console.error("API call failed for adding rush period, using fallback:",t),{...e,id:Date.now()}}}catch(t){throw console.error("Failed to add rush period:",t),t}}};var ts=s(504);const ss=(e,t)=>{try{console.log("Getting milk color for:",{milkName:e,milkId:t});const s=ts.A.getEventInventory();if(console.log("Inventory data:",s),!s||!s.milk)return console.log("No inventory data found, using default"),as(e);const a=s.milk.find((s=>s.name===e||s.id===t));if(console.log("Found milk item:",a),a&&a.color)return console.log("Using inventory color:",a.color),a.color;const r=JSON.parse(localStorage.getItem("coffee_system_settings")||"{}");if(r.milkColors&&r.milkColors[e])return console.log("Using settings color:",r.milkColors[e]),r.milkColors[e];const n=as(e);return console.log("Using default color:",n),n}catch(s){return console.error("Error getting milk color:",s),as(e)}},as=e=>({"Whole Milk":"#FFFFFF","Full Cream Milk":"#FFFFFF","Skim Milk":"#ADD8E6","Low-fat Milk":"#D3D3D3","Reduced Fat Milk":"#D3D3D3","Lactose-Free Milk":"#FAFAFA","Soy Milk":"#FFEC8B","Oat Milk":"#FF7F7F","Almond Milk":"#87CEEB","Coconut Milk":"#90EE90","Macadamia Milk":"#DEB887","Rice Milk":"#E6E6FA","Hemp Milk":"#D8F8D8","Cashew Milk":"#F5DEB3","Pea Milk":"#CCFFCC"}[e]||rs(e)),rs=e=>`hsl(${e.split("").reduce(((e,t)=>e+t.charCodeAt(0)),0)%360}, 70%, 80%)`,ns=(e,t)=>({borderLeftColor:ss(e,t),borderLeftWidth:"8px",borderLeftStyle:"solid"}),is=(e,t)=>({backgroundColor:ss(e,t),width:"12px",height:"12px",borderRadius:"50%",display:"inline-block",marginRight:"8px",border:e&&e.toLowerCase().includes("lactose-free")?"2px dashed #666":"2px solid #666"}),os=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Your {coffeeType} is ready for pickup at Station {stationId}! Track your order: {trackingLink}";if(!e)return{smsText:"",qrCodeUrl:""};const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://order.expresso.cafe";if(!e||!e.id)return null;const s=new URLSearchParams;return s.append("order",e.orderNumber||e.id),s.append("station",e.stationId||"1"),e.waitTime&&s.append("eta",e.waitTime),`${t}/track?${s.toString()}`}(e),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!e.id)return null;const s=t.size||150,a=t.baseUrl||"https://order.expresso.cafe",r=t.errorCorrection||"L",n=t.margin||1,i=t.color||"000000",o=new URLSearchParams;o.append("order",e.orderNumber||e.id),o.append("station",e.stationId||"1"),e.waitTime&&o.append("eta",e.waitTime),e.customerName&&o.append("name",e.customerName);const l=`${a}/track?${o.toString()}`;return`https://chart.googleapis.com/chart?cht=qr&chs=${s}x${s}&chl=${encodeURIComponent(l)}&chld=${r}|${n}&chco=${i}`}(e);let r=t.replace("{coffeeType}",e.coffeeType||"coffee").replace("{stationId}",e.stationId||"1").replace("{orderNumber}",e.orderNumber||e.id).replace("{trackingLink}",s);return a&&(r+=" Scan the QR code on the tracking page for easy pickup!"),{smsText:r,qrCodeUrl:a,trackingLink:s}};const ls=new class{constructor(){this.messageHistory={},this.maxHistoryLength=10,this.settings={autoSendSmsOnComplete:!0,remindAfterDelay:!0,reminderDelay:30,showNameOnDisplay:!0,displayDuration:30,includeQrCode:!0,includeTrackingLink:!0,useShortUrls:!1},this.baseUrl="http://localhost:5001/api",this.debugMode=!0,this.token=localStorage.getItem("coffee_system_token")||null,console.log("MessageService initialized with direct backend URL:",this.baseUrl),this.token?console.log("Token found in localStorage during MessageService initialization"):console.warn("No token found in localStorage during MessageService initialization"),this.loadSettings(),this.loadHistory()}async directFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a;if(e.startsWith("http")){a=new URL(e).pathname,a.includes("/api/")&&(a=a.substring(a.indexOf("/api/")+4))}else a=e.includes("/api/")?e.substring(e.indexOf("/api/")+4):e.startsWith("/")?e.substring(1):e;const r=`/api/${a}`;if(console.log(`Using direct URL strategy: ${r}`),!this.token){const e=localStorage.getItem("coffee_system_token");e&&(console.log("Found token in localStorage but not in memory, using it for request"),this.token=e)}const n={"Content-Type":"application/json",Accept:"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...t.headers||{}};this.debugMode&&(console.log(`Authorization header ${this.token?"set":"NOT set"} for request to ${r}`),this.token&&console.log(`Token length: ${this.token.length}, Token prefix: ${this.token.substring(0,10)}...`),console.log(`Fetching from: ${r} with method: ${t.method||"GET"}`),t.body&&console.log(`Request body: ${t.body}`));const i=await fetch(r,{...t,headers:n,mode:"cors"});if(!i.ok){let e={};try{e=await i.json()}catch(bn){try{e={message:await i.text()}}catch(s){e={message:`HTTP error: ${i.status} ${i.statusText}`}}}throw console.error(`API error: ${i.status}`,e),new Error(e.message||`API error: ${i.status}`)}const o=await i.json();return this.debugMode&&console.log(`Response from ${r}:`,o),o}catch(a){throw console.error(`Error fetching from ${e}:`,a),a}}loadSettings(){try{const e=localStorage.getItem("messageServiceSettings");e&&(this.settings={...this.settings,...JSON.parse(e)})}catch(e){console.error("Failed to load message settings:",e)}}saveSettings(){try{localStorage.setItem("messageServiceSettings",JSON.stringify(this.settings))}catch(e){console.error("Failed to save message settings:",e)}}updateSettings(e){return this.settings={...this.settings,...e},this.saveSettings(),this.settings}async sendMessage(e,t){if(!e||!t)return{success:!1,error:"Missing order or message"};const s="string"===typeof e?e:e.id,a="object"===typeof e?e.customerName:"",r="object"===typeof e?e.phoneNumber:"";console.log(`MessageService: Sending message to order ${s}`),console.log(`Phone number in order object: "${r}"`),console.log("Full order object:",JSON.stringify(e,null,2));try{let e,l=!1;try{let a=String(s);a=a.replace(/^order_in_progress_/,"").replace(/^order_completed_/,"").replace(/^order_/,""),console.log(`Sending message to customer for order ${a} using direct URL: ${t}`);const n={order_id:a,message:t};r&&(n.to=r,console.log("Adding phone number directly to request:",r)),e=await this.directFetch("sms/send",{method:"POST",body:JSON.stringify(n)}),console.log("Direct fetch message send result:",e),l=!0}catch(o){console.error("Direct URL message sending failed:",o),console.log("Falling back to OrderDataService..."),e=await Bt.A.sendMessageToCustomer(s,t),console.log("OrderDataService message send result:",e)}var n,i;if(!(e&&(!0===e.success||!Object.prototype.hasOwnProperty.call(e,"success"))))throw new Error((null===(n=e)||void 0===n?void 0:n.message)||(null===(i=e)||void 0===i?void 0:i.error)||"Failed to send message");return this.addToHistory(s,{messageId:e.messageId||e.message_sid||`msg_${Date.now()}`,orderId:s,customerName:a,phoneNumber:r,text:t,timestamp:new Date,status:"sent",sentVia:l?"direct":"orderService",type:"outgoing"}),console.log("Message added to history"),{success:!0,messageId:e.messageId||e.message_sid||`msg_${Date.now()}`,timestamp:new Date}}catch(l){return console.error("Failed to send message:",l),this.addToHistory(s,{messageId:`failed_${Date.now()}`,orderId:s,customerName:a,phoneNumber:r,text:t,timestamp:new Date,status:"failed",error:l.message,type:"outgoing"}),{success:!1,error:l.message}}}addToHistory(e,t){e&&t&&(this.messageHistory[e]||(this.messageHistory[e]=[]),this.messageHistory[e].unshift(t),this.messageHistory[e].length>this.maxHistoryLength&&(this.messageHistory[e]=this.messageHistory[e].slice(0,this.maxHistoryLength)),this.persistHistory())}persistHistory(){try{localStorage.setItem("messageHistory",JSON.stringify(this.messageHistory))}catch(e){console.error("Failed to persist message history:",e)}}loadHistory(){try{const e=localStorage.getItem("messageHistory");e&&(this.messageHistory=JSON.parse(e))}catch(e){console.error("Failed to load message history:",e)}}getHistory(e){return this.messageHistory[e]||[]}getAllHistory(){return this.messageHistory}clearHistory(e){e&&this.messageHistory[e]&&(delete this.messageHistory[e],this.persistHistory())}clearAllHistory(){this.messageHistory={},this.persistHistory()}async sendReadyNotification(e){if(!e||!e.id)return console.error("Invalid order object:",e),{success:!1,error:"Invalid order"};console.log("Sending ready notification for order:",e);let t="";if(this.settings.includeTrackingLink||this.settings.includeQrCode){t=os(e,'\ud83d\udd14 YOUR COFFEE IS READY! Your ${order.coffeeType || "coffee"} is now ready for collection from ${order.stationName || "our counter"}.').smsText}else t=`\ud83d\udd14 YOUR COFFEE IS READY! Your ${e.coffeeType||"coffee"} is now ready for collection from ${e.stationName||"our counter"}. Enjoy! \u2615`;try{var s,a;let n,i=!1;try{let s=String(e.id);s=s.replace(/^order_in_progress_/,"").replace(/^order_completed_/,"").replace(/^order_/,"");const a={order_id:s,message:t};e.phoneNumber&&(a.to=e.phoneNumber),n=await this.directFetch("sms/send",{method:"POST",body:JSON.stringify(a)}),console.log("Direct fetch ready notification result:",n),i=!0}catch(r){console.error("Direct URL ready notification failed:",r),n=await Bt.A.sendMessageToCustomer(e.id,t),console.log("OrderDataService ready notification result:",n)}const o=n&&(!0===n.success||!Object.prototype.hasOwnProperty.call(n,"success"));return this.addToHistory(e.id,{messageId:`ready_${Date.now()}`,orderId:e.id,customerName:e.customerName,phoneNumber:e.phoneNumber,text:t,timestamp:new Date,status:o?"sent":"failed",sentVia:i?"direct":"orderService",error:o?null:(null===(s=n)||void 0===s?void 0:s.message)||"Unknown error",type:"outgoing"}),{success:o,message:o?"Notification sent successfully":"Failed to send notification",error:o?null:(null===(a=n)||void 0===a?void 0:a.message)||"Unknown error"}}catch(n){return console.error("Failed to send ready notification:",n),this.addToHistory(e.id,{messageId:`failed_${Date.now()}`,orderId:e.id,customerName:e.customerName,phoneNumber:e.phoneNumber,text:t,timestamp:new Date,status:"failed",error:n.message,type:"outgoing"}),{success:!1,error:n.message}}}async sendReminderNotification(e,t){if(!e||!e.id)return{success:!1,error:"Invalid order"};const s=`Reminder: Your ${e.coffeeType||"coffee"} has been ready for ${t} minutes. Please collect it soon!`;return this.sendMessage(e,s)}showOnDisplay(e){if(!e)return{success:!1,error:"Invalid order"};try{const t=new CustomEvent("showOrderOnDisplay",{detail:{orderId:e.id,orderNumber:e.orderNumber,customerName:e.customerName,coffeeType:e.coffeeType||"Coffee",status:"ready"}});return window.dispatchEvent(t),console.log(`Showing order ${e.id} for ${e.customerName} on display screen`),{success:!0,timestamp:new Date}}catch(t){return console.error("Failed to show order on display:",t),{success:!1,error:t.message}}}async getSMSTemplates(){try{const e=await this.directFetch("sms/templates",{method:"GET"});if(console.log("SMS templates response:",e),e)return e;throw new Error("Failed to fetch SMS templates")}catch(e){return console.error("Failed to fetch SMS templates:",e),{status:"success",templates:{order_confirmation_message:"Your order #{order_number} has been confirmed. We'll notify you when it's ready!",order_ready_message:"Your order #{order_number} is now ready for pickup!",delay_message:"We apologize, but your order #{order_number} is running a bit behind schedule."}}}}};const cs=new class{constructor(){this.apiService=new Qt.A,this.baseUrl="/api/chat",this.debugMode=!0,this.enableFallback=!1,this.messages=[],this.stationId=null,this.stationName=null,this.baristaName=null,this.listeners=[],this.pollingInterval=null,this.pollingDelay=1e4,this.initialized=!1,this._setupLocalMessageSharing()}_setupLocalMessageSharing(){window.addEventListener("storage",(e=>{if("coffee_chat_messages"===e.key)try{const t=JSON.parse(e.newValue||"[]");console.log(`Syncing ${t.length} messages from other tabs`);const s=this.messages.map((e=>e.id)),a=t.filter((e=>!s.includes(e.id)));if(a.length>0){console.log(`Adding ${a.length} new messages from other tabs`);const e=a.map((e=>(!e.original_station_id&&e.station_id&&(e.original_station_id=e.station_id),!e.original_station_name&&e.station_name&&(e.original_station_name=e.station_name),e)));this.messages=[...this.messages,...e],this.initialized&&this.notifyListeners()}}catch(t){console.error("Error syncing messages from storage:",t)}}));try{const e=localStorage.getItem("coffee_chat_messages");e&&(this.messages=JSON.parse(e))}catch(e){console.error("Error loading initial messages from storage:",e)}}initialize(e,t,s){const a=e;this.stationId="string"===typeof e?parseInt(e,10):e,this.stationName=t,this.baristaName=s,this.initialized=!0,this.startPolling(),this.loadMessages(),console.log(`Chat service initialized for ${t} (ID: ${this.stationId}, originalId: ${a}, type: ${typeof a}) with barista: ${s}`)}startPolling(){this.pollingInterval&&clearInterval(this.pollingInterval),this.pollingInterval=setInterval((()=>{this.loadMessages()}),this.pollingDelay)}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}async loadMessages(){try{if(!this.initialized)return this.messages;const e=localStorage.getItem("coffee_chat_messages");if(e)try{const t=JSON.parse(e);console.log(`Loaded ${t.length} messages from localStorage`),t.length>0&&console.log("Sample message:",{id:t[0].id,station_id:t[0].station_id,station_name:t[0].station_name,baristaName:t[0].baristaName,sender:t[0].sender}),this.messages=t.map((e=>{if(!e.station_name&&e.station_id){const s=t.find((t=>t.station_id===e.station_id&&t.station_name));if(s)return console.log(`Adding missing station_name to message ${e.id}: ${s.station_name}`),{...e,station_name:s.station_name}}return e}))}catch(bn){console.error("Failed to parse saved messages:",bn)}return this.notifyListeners(),this.messages}catch(e){return console.error("Failed to load chat messages:",e),this.messages}}async sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(!this.initialized)throw new Error("Chat service not initialized");console.log(`Preparing to send message from station ID: ${this.stationId}, station name: ${this.stationName}`);const a={sender:this.baristaName&&this.baristaName.trim()?this.baristaName.trim():this.stationName||`Station #${this.stationId}`,content:e,is_urgent:t,baristaName:this.baristaName&&this.baristaName.trim()?this.baristaName.trim():null,station_id:"string"===typeof this.stationId?parseInt(this.stationId,10):this.stationId},r={id:Date.now(),...a,station_id:"string"===typeof this.stationId?parseInt(this.stationId,10):this.stationId,station_name:this.stationName||`Station #${this.stationId}`,created_at:(new Date).toISOString()};console.log(`Creating message with station ID = ${r.station_id} and station name = ${r.station_name}`),r.original_station_id=r.station_id,r.original_station_name=r.station_name,console.log("Creating new message with station details:",{id:r.id,station_id:r.station_id,station_name:r.station_name,original_station_id:r.original_station_id,original_station_name:r.original_station_name,baristaName:r.baristaName,sender:r.sender}),this.messages=[...this.messages,r];try{localStorage.setItem("coffee_chat_messages",JSON.stringify(this.messages))}catch(s){console.error("Failed to save messages to localStorage:",s)}return this.notifyListeners(),r}catch(a){throw console.error("Failed to send chat message:",a),a}}async deleteMessage(e){try{if(!this.initialized)throw new Error("Chat service not initialized");this.messages=this.messages.filter((t=>t.id!==e));try{localStorage.setItem("coffee_chat_messages",JSON.stringify(this.messages))}catch(t){console.error("Failed to save messages to localStorage:",t)}return this.notifyListeners(),{success:!0}}catch(s){throw console.error(`Failed to delete message ${e}:`,s),s}}async getStations(){try{try{const e=localStorage.getItem("coffee_cue_stations");if(e)return JSON.parse(e)}catch(e){console.warn("Failed to get stations from localStorage:",e)}return[]}catch(t){return console.error("Failed to get stations:",t),[]}}addListener(e){return"function"!==typeof e||this.listeners.includes(e)||this.listeners.push(e),()=>{this.removeListener(e)}}removeListener(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}getStationMessages(){return this.messages}notifyListeners(){const e=this.getStationMessages();this.listeners.forEach((t=>{try{t(e)}catch(s){console.error("Error notifying chat listener:",s)}}))}cleanup(){this.stopPolling(),this.listeners=[],this.initialized=!1}resetMessages(){this.messages=[];try{return localStorage.setItem("coffee_chat_messages",JSON.stringify([])),console.log("Chat messages reset successfully"),this.notifyListeners(),!0}catch(e){return console.error("Failed to reset chat messages:",e),!1}}},ds=dt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),us=dt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ms=e=>{let{order:t,onSubmit:s,onClose:r}=e;const[n,i]=(0,a.useState)(""),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null);(0,a.useEffect)((()=>{if(t&&t.id){const e=ls.getHistory(t.id);l(e)}}),[t]);const h=[{label:"Ready for pickup",text:`Your ${(null===t||void 0===t?void 0:t.coffeeType)||"coffee"} is ready for pickup at ${(null===t||void 0===t?void 0:t.stationName)||"our station"}.`},{label:"Slight delay",text:`We're running slightly behind schedule. Your ${(null===t||void 0===t?void 0:t.coffeeType)||"coffee"} will be ready in about 5 more minutes.`},{label:"Reminder to collect",text:`Your ${(null===t||void 0===t?void 0:t.coffeeType)||"coffee"} order has been waiting for pickup. Please collect it from ${(null===t||void 0===t?void 0:t.stationName)||"our station"}.`},{label:"Confirm milk preference",text:"Could you please confirm your milk preference for this order?"}],g=e=>{if(!e)return"";return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},p=e=>{switch(e){case"sent":return(0,yt.jsx)(St,{size:16,className:"text-green-500"});case"failed":return(0,yt.jsx)(ds,{size:16,className:"text-red-500"});case"sending":return(0,yt.jsx)(Ot,{size:16,className:"text-amber-500 animate-spin"});default:return(0,yt.jsx)(Rt,{size:16,className:"text-gray-500"})}};return(0,yt.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full max-h-[80vh] flex flex-col",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-bold",children:"Message Customer"}),(0,yt.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:r,children:(0,yt.jsx)(Lt,{size:20})})]}),t&&(0,yt.jsxs)("div",{className:"mb-4 bg-gray-100 p-3 rounded",children:[(0,yt.jsxs)("div",{className:"font-medium",children:["Order #",t.id]}),(0,yt.jsxs)("div",{children:[t.customerName," - ",t.phoneNumber]}),(0,yt.jsxs)("div",{className:"text-sm",children:[t.coffeeType,", ",t.milkType]})]}),o.length>0&&(0,yt.jsxs)("div",{className:"mb-4 overflow-y-auto max-h-40 border border-gray-200 rounded p-2",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Message History"}),(0,yt.jsx)("div",{className:"space-y-2",children:o.map((e=>(0,yt.jsxs)("div",{className:"flex items-start p-2 rounded "+("outgoing"===e.type?"bg-blue-50":"bg-gray-50"),children:[(0,yt.jsxs)("div",{className:"flex-grow",children:[(0,yt.jsx)("div",{className:"text-sm",children:e.text}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500 flex items-center mt-1",children:[g(e.timestamp),(0,yt.jsx)("span",{className:"mx-1",children:"\u2022"}),"outgoing"===e.type?"Sent to customer":"Received"]})]}),(0,yt.jsx)("div",{className:"ml-2 mt-1",children:p(e.status)})]},e.messageId)))})]}),u&&(0,yt.jsxs)("div",{className:"mb-4 bg-red-50 text-red-700 p-2 rounded border border-red-200 text-sm flex items-center",children:[(0,yt.jsx)(ds,{size:16,className:"mr-1"}),u]}),(0,yt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim()){m(null),d(!0);try{console.log(`Sending message for order ${t.id}: ${n}`);const e=await s(t.id,n);console.log("Message sending result:",e),e&&e.success?(i(""),setTimeout((()=>{const e=ls.getHistory(t.id);l(e),console.log("Updated message history:",e)}),500)):e&&!e.success?(m(e.error||"Failed to send message"),console.error("Failed to send message:",e.error)):(console.error("Unexpected result format from message sending:",e),m("Unexpected response from server"))}catch(a){console.error("Error sending message:",a),m(a.message||"An error occurred while sending the message")}finally{d(!1)}}},className:"flex-grow flex flex-col",children:[(0,yt.jsxs)("div",{className:"mb-4 flex-grow",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,yt.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded resize-none flex-grow",rows:"4",placeholder:"Enter your message here...",required:!0})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Quick Messages:"}),(0,yt.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-1",children:h.map(((e,t)=>(0,yt.jsx)("button",{type:"button",className:"text-left text-xs bg-gray-100 p-2 rounded hover:bg-gray-200",onClick:()=>i(e.text),children:e.label},t)))})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yt.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:r,children:"Cancel"}),(0,yt.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700 flex items-center",disabled:!n.trim()||c,children:[c?(0,yt.jsx)(Ot,{size:16,className:"mr-1 animate-spin"}):(0,yt.jsx)(us,{size:16,className:"mr-1"}),c?"Sending...":"Send"]})]})]})]})})},hs=e=>{let{currentWaitTime:t,onSubmit:s,onClose:r}=e;const[n,i]=(0,a.useState)(t);return(0,yt.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-bold",children:"Adjust Wait Time"}),(0,yt.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:r,children:(0,yt.jsx)(Lt,{size:20})})]}),(0,yt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(n)},children:[(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Wait Time: ",t," minutes"]}),(0,yt.jsx)("input",{type:"number",min:"1",max:"60",value:n,onChange:e=>i(parseInt(e.target.value)),className:"w-full p-2 border rounded",required:!0})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yt.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:r,children:"Cancel"}),(0,yt.jsx)("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",children:"Update"})]})]})]})})},gs=dt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ps=dt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),fs=dt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const xs=new class{constructor(){this.apiService=new Qt.A,this.baseUrl="http://localhost:5001/api",this.debugMode=!0,this.enableFallback=!0,this.settingsCache=null,this.cacheTime=0,this.cacheLifetime=3e5,this.lastJwtError=0,this.jwtErrorDebounce=6e4,this.token=localStorage.getItem("coffee_system_token")||null,this._setDefaultSettings(),console.log("SettingsService initialized with direct backend URL:",this.baseUrl),this.token?console.log("Token found in localStorage during SettingsService initialization"):console.warn("No token found in localStorage during SettingsService initialization")}async getBrandingSettings(){try{const e=localStorage.getItem("coffee_system_branding");if(e)return JSON.parse(e);const t=await this.directFetch("/settings/branding",{method:"GET"});return t.success&&t.settings?(localStorage.setItem("coffee_system_branding",JSON.stringify(t.settings)),t.settings):null}catch(e){return console.error("Error getting branding settings:",e),{systemName:"CoffeeCue",customBranding:!1,clientName:"",primaryColor:"#1e40af",secondaryColor:"#f59e0b",textColor:"#1f2937",backgroundColor:"#f9fafb",defaultLanguage:"en",availableLanguages:["en"]}}}async updateBrandingSettings(e){try{localStorage.setItem("coffee_system_branding",JSON.stringify(e));return(await this.directFetch("/settings/branding",{method:"PUT",body:JSON.stringify({settings:e})})).success||!1}catch(t){return console.error("Error updating branding settings:",t),!0}}async directFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a;if(e.startsWith("http")){a=new URL(e).pathname,a.includes("/api/")&&(a=a.substring(a.indexOf("/api/")+4))}else a=e.includes("/api/")?e.substring(e.indexOf("/api/")+4):e.startsWith("/")?e.substring(1):e;const r=`${this.baseUrl}/${a}`;if(console.log(`Using direct URL strategy: ${r}`),!this.token){const e=localStorage.getItem("coffee_system_token")||localStorage.getItem("coffee_auth_token")||localStorage.getItem("jwt_token")||null;e&&(console.log("Found token in localStorage but not in memory, using it for request"),this.token=e)}const n={"Content-Type":"application/json",Accept:"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...t.headers||{}};this.debugMode&&(console.log(`Authorization header ${this.token?"set":"NOT set"} for request to ${r}`),this.token&&console.log(`Token length: ${this.token.length}, Token prefix: ${this.token.substring(0,10)}...`),console.log(`Fetching from: ${r} with method: ${t.method||"GET"}`),t.body&&console.log(`Request body: ${t.body}`));const i=await fetch(r,{...t,headers:n,mode:"cors",credentials:"same-origin"});if(!i.ok){let e={};try{e=await i.json()}catch(bn){try{e={message:await i.text()}}catch(s){e={message:`HTTP error: ${i.status} ${i.statusText}`}}}throw console.error(`API error: ${i.status}`,e),new Error(e.message||`API error: ${i.status}`)}const o=await i.json();return this.debugMode&&console.log(`Response from ${r}:`,o),o}catch(a){throw console.error(`Error fetching from ${e}:`,a),a}}_setDefaultSettings(){this.settingsCache={displayMode:"landscape",soundEnabled:!0,autoPrintLabels:!1,batchSuggestions:!0,waitTimeWarning:10,displayTimeout:5,autoSendSmsOnComplete:!0,remindAfterDelay:!0,reminderDelay:30,showNameOnDisplay:!0,displaySettings:{eventName:"ANZCA ASM 2025",organizationName:"Australian and New Zealand College of Anaesthetists",headerColor:"#1e40af",customMessage:"Enjoy your coffee!",smsNumber:"+61 123 456 789",showSponsor:!1,sponsorName:"",sponsorMessage:""},stationSettings:{},baristaSettings:{},milkColors:{"Full Cream Milk":"#FFFFFF","Skim Milk":"#ADD8E6","Reduced Fat Milk":"#D3D3D3","Lactose-Free Milk":"#FAFAFA","Soy Milk":"#FFFACD","Oat Milk":"#FFCCCB","Almond Milk":"#EADDCA","Coconut Milk":"#D0F0C0","Macadamia Milk":"#D2B48C","Rice Milk":"#E6E6FA"}},this.cacheTime=Date.now()}async getSettings(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{const a=Date.now();if(!e&&this.settingsCache&&a-this.cacheTime<this.cacheLifetime)return this.settingsCache;const r=a-this.lastJwtError;if(r<this.jwtErrorDebounce)return console.log(`Skipping API call due to recent JWT error (${Math.round(r/1e3)}s ago)`),this.settingsCache;let n;const i=`${this.baseUrl}/settings`;console.log(`Using direct URL for settings: ${i}`);try{n=await this.directFetch("settings",{method:"GET"}),console.log("\u2705 Got response from direct URL:",n)}catch(t){if(console.error("Direct URL approach failed:",t),t.message&&t.message.includes("Signature verification"))return console.warn("JWT token error detected, using cached settings to prevent flickering"),this.lastJwtError=a,this.settingsCache;try{console.log("Falling back to inherited method"),n=await this.get("/settings")}catch(s){return console.error("Fallback method failed:",s),s.message&&s.message.includes("Signature verification")?(console.warn("JWT token error detected in fallback, using cached settings"),this.lastJwtError=a,this.settingsCache):(console.warn("Using cached settings due to API failure"),this.settingsCache)}}if(!n)return console.warn("No response received from server, using cached settings"),this.settingsCache;const o=this.loadSettingsFromLocalStorage(),l=this.deepMergeSettings(n,o);return this.settingsCache=l,this.cacheTime=a,console.log("\ud83d\udd04 Merged API settings with localStorage settings"),l}catch(a){return console.error("Failed to fetch settings:",a),this.settingsCache}}async updateSetting(e,t){try{this.settingsCache&&(this.settingsCache={...this.settingsCache,[e]:t});const a=Date.now(),r=a-this.lastJwtError;if(r<this.jwtErrorDebounce)return console.log(`Skipping API call due to recent JWT error (${Math.round(r/1e3)}s ago)`),{[e]:t};try{const s=await this.directFetch(`settings/${e}`,{method:"POST",body:JSON.stringify({value:t})});return s&&s.success?(this.saveSettingToLocalStorage(e,t),s.settings||{[e]:t}):(console.warn(`Server update failed for ${e}, saving to localStorage for persistence`),this.saveSettingToLocalStorage(e,t),{[e]:t})}catch(s){return s.message&&s.message.includes("Signature verification")?(console.warn("JWT token error detected during setting update, cached value will be used"),this.lastJwtError=a,this.saveSettingToLocalStorage(e,t),{[e]:t}):(console.error(`API call failed for setting ${e}, saving to localStorage:`,s),this.saveSettingToLocalStorage(e,t),{[e]:t})}}catch(s){return console.error(`Failed to update setting ${e}:`,s),this.saveSettingToLocalStorage(e,t),{[e]:t,warning:"Cached only"}}}saveSettingToLocalStorage(e,t){try{const s=JSON.parse(localStorage.getItem("coffee_cue_settings")||"{}");s[e]=t,localStorage.setItem("coffee_cue_settings",JSON.stringify(s)),console.log(`\ud83d\udcbe Saved setting ${e}=${t} to localStorage`)}catch(s){console.error("Failed to save setting to localStorage:",s)}}loadSettingsFromLocalStorage(){try{const e=localStorage.getItem("coffee_cue_settings");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load settings from localStorage:",e)}return{}}deepMergeSettings(e,t){const s={...e};for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)){const e=t[a],r=s[a];e&&"object"===typeof e&&!Array.isArray(e)&&r&&"object"===typeof r&&!Array.isArray(r)?s[a]={...r,...e}:s[a]=e}return console.log("\ud83d\udd00 Deep merged settings - localStorage overrides:",Object.keys(t)),s}async updateSettings(e){try{const s={...JSON.parse(localStorage.getItem("coffee_system_settings")||"{}"),...e};localStorage.setItem("coffee_system_settings",JSON.stringify(s)),this.settingsCache&&(this.settingsCache={...this.settingsCache,...e});try{const t=await this.directFetch("settings",{method:"PUT",body:JSON.stringify(e)});if(t&&t.success)return t.settings||s}catch(t){console.warn("Failed to sync settings with backend, but saved locally:",t)}return s}catch(s){throw console.error("Failed to update settings:",s),s}}async resetSettings(){try{const e=await this.directFetch("settings/reset",{method:"POST"});if(e&&e.success)return this.settingsCache=e.settings,this.cacheTime=Date.now(),e.settings;throw new Error((null===e||void 0===e?void 0:e.error)||"Failed to reset settings")}catch(e){throw console.error("Failed to reset settings:",e),e}}async getSetting(e){try{if(this.settingsCache&&void 0!==this.settingsCache[e])return this.settingsCache[e];return(await this.getSettings())[e]}catch(t){throw console.error(`Failed to get setting ${e}:`,t),t}}async updateWaitTime(e){try{const t=await this.directFetch("settings/wait-time",{method:"POST",body:JSON.stringify({waitTime:e})});if(t&&t.success)return this.settingsCache&&(this.settingsCache.defaultWaitTime=e),t;throw new Error((null===t||void 0===t?void 0:t.error)||"Failed to update wait time")}catch(t){throw console.error("Failed to update wait time:",t),t}}},ys=e=>{let{onSubmit:t,onClose:s}=e;const{getCurrentStation:r,stations:n}=Xt(),i=r(),[o,l]=(0,a.useState)(qt.en),[c,d]=(0,a.useState)(["Espresso","Long Black","Flat White","Cappuccino","Latte","Mocha","Hot Chocolate","Chai Latte","Tea"]),[u,m]=(0,a.useState)(["Small","Regular","Large"]),[h,g]=(0,a.useState)(null),[p,f]=(0,a.useState)(!0),[x,y]=(0,a.useState)(null),[b,v]=(0,a.useState)({customerName:"",phoneNumber:"",coffeeType:"Flat White",size:"Regular",shots:"1",milkType:"full_cream",sugar:"No sugar",extraHot:!1,priority:!1,notes:"",collectionStation:null}),[j,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(null),[S,C]=(0,a.useState)(!1),_=(b.collectionStation||(null===i||void 0===i||i.id),b.collectionStation?n.find((e=>e.id===b.collectionStation)):i);(0,a.useEffect)((()=>{_&&(console.log(`Initializing StockService for station: ${_.id} (${_.name})`),Wt.default.initialize(_.id,_.name))}),[_]),(0,a.useEffect)((()=>{(async()=>{if(_){f(!0),y(null);try{let s;if(console.log(`Loading inventory for station ${_.id} (${_.name})`),b.collectionStation&&b.collectionStation!==(null===i||void 0===i?void 0:i.id))try{const e=await fetch(`/api/inventory?station_id=${_.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("coffee_system_token")}`,Accept:"application/json"}});if(!e.ok)throw new Error("Failed to fetch inventory from API");{const t=await e.json();s={milk:[],coffee:[],cups:[],lastUpdated:(new Date).toISOString()},t.items&&t.items.forEach((e=>{"milk"===e.category?s.milk.push({id:e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,amount:e.amount||0,unit:e.unit||"L"}):"coffee"===e.category?s.coffee.push({id:e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,amount:e.amount||0,unit:e.unit||"kg"}):"cups"===e.category&&s.cups.push({id:e.name.toLowerCase().replace(/\s+/g,"_"),name:e.name,amount:e.amount||0,unit:e.unit||"units"})})),console.log("Loaded inventory from API for station:",_.id,s)}}catch(e){console.error("Error fetching inventory from API:",e),s=Wt.default.getLocalStock()}else s=Wt.default.getLocalStock();g(s);const a=await xs.getSettings();if(console.log("Global settings loaded:",a),a&&a.availableMilks||console.warn("No global milk settings found! You need to configure available milks in the settings panel."),s&&s.milk)try{console.log(`Processing milk inventory for station ${_.id} (${_.name})`);const e=[],t=s.milk.filter((e=>e.amount>0));console.log("In-stock milk items in inventory:",t.map((e=>`${e.id} (${e.amount} ${e.unit})`)));const r=s.milk;console.log("ALL milk items in inventory:",r.map((e=>`${e.id} (${e.amount} ${e.unit})`)));const n=s.milk.filter((e=>e.amount<=0));n.length>0&&console.log("ZERO AMOUNT milk items (these will be EXCLUDED):",n.map((e=>`${e.id} (${e.name})`))),t.forEach((t=>{const s=t.id,a=s.startsWith("milk_")?s.substring(5):s,r=s.startsWith("milk_")?s:`milk_${s}`;let n=qt.en.find((e=>e.id===a||e.id===r||e.id===s));if(n)console.log(`Found matching milk type for inventory item ${s}: ${n.name}`),e.push({...n,inventoryAmount:t.amount,inventoryUnit:t.unit});else{console.log(`Creating new milk type definition for inventory item: ${s}`);const r=t.name||a,n=r.toLowerCase().includes("soy")||r.toLowerCase().includes("almond")||r.toLowerCase().includes("oat")||r.toLowerCase().includes("coconut")||r.toLowerCase().includes("rice")||r.toLowerCase().includes("hemp")||r.toLowerCase().includes("pea")||r.toLowerCase().includes("macadamia")||r.toLowerCase().includes("cashew"),i={id:a,name:t.name||`${a.charAt(0).toUpperCase()+a.slice(1)} Milk`,category:n?"alternative":"standard",available:!0,properties:{dairyFree:n,lactoseFree:n,vegan:n,lowFat:r.toLowerCase().includes("skim")||r.toLowerCase().includes("low")},inventoryAmount:t.amount,inventoryUnit:t.unit};console.log(`Created new milk type: ${i.name} (${i.category})`),e.push(i)}}));const i=a&&a.availableMilks?e.filter((e=>{const t=e.id.startsWith("milk_")?e.id.substring(5):e.id,s=e.id.startsWith("milk_")?e.id:`milk_${e.id}`;return!0===a.availableMilks[e.id]||!0===a.availableMilks[t]||!0===a.availableMilks[s]})):e;console.log("FINAL MILK OPTIONS:",i.map((e=>`${e.name} [ID: ${e.id}]`)));const o=qt.en.filter((e=>!i.some((t=>t.id===e.id||e.id.startsWith("milk_")&&t.id===e.id.substring(5)||!e.id.startsWith("milk_")&&t.id===`milk_${e.id}`))));o.length>0&&console.log("EXCLUDED MILK TYPES:",o.map((e=>e.name))),l(i),0===i.length?(console.warn("\u26a0\ufe0f WARNING: No milk options available for this station!"),y("No milk options available for this station. Please check your inventory.")):console.log(`Station ${_.id} has ${i.length} milk types available`)}catch(t){console.error("Error processing milk inventory:",t),y("Failed to process milk inventory: "+t.message)}else console.warn("\u26a0\ufe0f WARNING: No milk inventory found for this station!"),y("No milk inventory found for this station. Please check your station setup.");try{const e=Wt.default.getAvailableCoffeeTypes();console.log("Available coffee items from inventory:",e.map((e=>e.name)));const t=[];if(e.length>0){t.push("Espresso","Long Black","Flat White","Cappuccino","Latte","Mocha");e.some((e=>e.name.toLowerCase().includes("decaf")||e.id.toLowerCase().includes("decaf")))&&t.push("Decaf Espresso","Decaf Flat White","Decaf Latte")}t.push("Hot Chocolate","Chai Latte","Tea"),t.sort(),d(t),console.log(`Station ${_.id} has ${t.length} coffee drink types available`)}catch(t){console.error("Error processing coffee inventory:",t),y("Failed to process coffee inventory: "+t.message)}try{if(s&&s.cups&&Array.isArray(s.cups)){const e=s.cups.filter((e=>e.amount>0));console.log("Available cups in inventory:",e.map((e=>e.name)));const t=[];e.some((e=>"cups_small"===e.id||e.name.toLowerCase().includes("small")))&&t.push("Small"),e.some((e=>"cups_medium"===e.id||e.name.toLowerCase().includes("medium")||e.name.toLowerCase().includes("regular")))&&t.push("Regular"),e.some((e=>"cups_large"===e.id||e.name.toLowerCase().includes("large")))&&t.push("Large"),0===t.length&&(t.push("Regular"),console.warn("No cup sizes available in inventory, defaulting to Regular")),m(t),console.log(`Station ${_.id} has ${t.length} cup sizes available: ${t.join(", ")}`)}else m(["Small","Regular","Large"]),console.warn("No cup inventory found, using default sizes")}catch(t){console.error("Error processing cup sizes inventory:",t),y("Failed to process cup sizes inventory: "+t.message)}}catch(t){console.error("Error loading station inventory:",t),y("Failed to load station inventory")}finally{f(!1)}}})()}),[_,b.collectionStation]),(0,a.useEffect)((()=>{let e={...b},t=!1;c.includes(b.coffeeType)||(e.coffeeType=c[0]||"Flat White",t=!0),u.includes(b.size)||(e.size=u[0]||"Regular",t=!0),o.some((e=>e.id===b.milkType))||(e.milkType=o.length>0?o[0].id:"no_milk",t=!0),t&&v(e)}),[c,u,o]);const E=e=>{const{name:t,value:s,type:a,checked:r}=e.target,n={...b,[t]:"checkbox"===a?r:s};if("notes"===t){const e=s.toLowerCase();["vip","staff","organizer","organiser","priority"].some((t=>e.includes(t)))&&(n.priority=!0)}v(n)};return(0,yt.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-lg w-full",children:[_&&!p&&(0,yt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 mb-4 text-sm",children:[(0,yt.jsxs)("div",{className:"font-medium text-blue-800 flex items-center",children:[(0,yt.jsx)(ht,{size:16,className:"mr-1 text-amber-600"}),b.collectionStation?`Showing options available at collection station: ${_.name}`:`Creating order for station: ${_.name}`]}),(0,yt.jsx)("div",{className:"text-xs text-blue-600",children:b.collectionStation?"Coffee, milk, and size options are based on the collection station's inventory":"Only showing milk and coffee options available at this station"}),o.length<4&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited milk options at this station (",o.length," available)"]}),c.length<7&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited coffee options at this station (",c.length," available)"]}),u.length<3&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited cup sizes at this station (",u.length," available)"]})]}),p&&(0,yt.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded p-4 mb-4 text-center",children:(0,yt.jsxs)("div",{className:"animate-pulse text-gray-600",children:["Loading inventory for ",(null===_||void 0===_?void 0:_.name)||"station","..."]})}),x&&(0,yt.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-2 mb-4 text-sm",children:[(0,yt.jsxs)("div",{className:"font-medium text-red-800 flex items-center",children:[(0,yt.jsx)(gs,{size:16,className:"mr-1"}),x]}),(0,yt.jsx)("div",{className:"text-xs text-red-600",children:"Using default options instead. Some options might not be available at this station."})]}),(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-bold",children:"Add Walk-in Order"}),(0,yt.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:s,children:(0,yt.jsx)(Lt,{size:20})})]}),(0,yt.jsxs)("div",{className:"bg-blue-50 p-3 mb-4 rounded-lg border-2 border-blue-300",children:[(0,yt.jsxs)("h4",{className:"text-sm font-semibold mb-2 text-blue-800 flex items-center",children:[(0,yt.jsx)(ht,{size:16,className:"mr-1 text-blue-600"}),"Group Order Lookup",(0,yt.jsx)("span",{className:"ml-2 bg-blue-600 text-white text-xs px-2 py-0.5 rounded-full",children:"NEW"})]}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("input",{type:"text",placeholder:"Enter group code (e.g. ASM-1234)",className:"flex-1 p-2 border rounded",value:j,onChange:e=>w(e.target.value)}),(0,yt.jsx)("button",{type:"button",className:"bg-blue-600 text-white px-3 py-2 rounded flex items-center",onClick:()=>{if(j){C(!0);try{const e=localStorage.getItem("coffee_group_orders");let t=[];e&&(t=JSON.parse(e));const s=t.find((e=>e.groupCode===j||e.groupCode.toLowerCase()===j.toLowerCase()));if(s){k(s);const e=(s.notes||"").toLowerCase(),t=["vip","staff","organizer","organiser","priority"].some((t=>e.includes(t)));v(t?e=>({...e,priority:!0,notes:e.notes+(e.notes?" ":"")+`Group: ${s.groupName} (${s.groupCode})`}):e=>({...e,notes:e.notes+(e.notes?" ":"")+`Group: ${s.groupName} (${s.groupCode})`}))}else alert("No group found with that code"),k(null)}catch(e){console.error("Error looking up group code:",e),alert("Failed to lookup group code")}finally{C(!1)}}else alert("Please enter a group code")},disabled:S,children:S?"Looking up...":(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(ps,{size:16,className:"mr-1"})," Lookup"]})})]}),(0,yt.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:[(0,yt.jsx)("strong",{children:"NEW FEATURE:"})," Enter a group code to retrieve a pre-saved group order. Organizers can create group orders with priority status, and they'll be processed together."]}),N&&(0,yt.jsxs)("div",{className:"mt-3 bg-white p-3 rounded-lg border border-blue-200",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h5",{className:"font-semibold",children:N.groupName}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Code: ",N.groupCode]}),N.notes&&(0,yt.jsx)("div",{className:"text-sm mt-1",children:N.notes.toLowerCase().includes("vip")||N.notes.toLowerCase().includes("staff")||N.notes.toLowerCase().includes("priority")?(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(fs,{size:14,className:"text-red-500 mr-1"}),(0,yt.jsx)("span",{className:"font-medium text-red-600",children:N.notes})]}):(0,yt.jsx)("span",{className:"italic",children:N.notes})})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(zt,{size:18,className:"text-blue-500 mr-1"}),(0,yt.jsxs)("div",{className:"text-xl font-bold text-amber-600",children:[N.orders.length," orders"]})]})]}),(0,yt.jsxs)("button",{type:"button",className:"w-full mt-2 bg-amber-600 text-white py-2 rounded-md flex items-center justify-center",onClick:()=>{N&&(t&&t(N,"group"),s&&s())},children:[(0,yt.jsx)(ht,{size:18,className:"mr-2"}),"Submit Entire Group (",N.orders.length," coffees)"]})]}),(0,yt.jsx)("div",{className:"mt-2 text-center text-xs text-gray-600",children:"- OR -"})]}),(0,yt.jsxs)("form",{onSubmit:e=>{var s;e.preventDefault();const a="no_milk"===b.milkType?{id:"no_milk",name:"No milk",properties:{dairyFree:!0,lactoseFree:!0,vegan:!0}}:qt.en.find((e=>e.id===b.milkType))||qt.en[0],r=(b.notes||"").toLowerCase(),n=["vip","staff","organizer","organiser","priority"].some((e=>r.includes(e))),i=b.priority||n,o="1"===b.shots?"":"0.5"===b.shots?" (1/2 shot)":"2"===b.shots?" (double shot)":"3"===b.shots?" (triple shot)":"",l={customer_name:b.customerName,phone_number:b.phoneNumber||"Walk-in",coffee_type:`${b.size} ${b.coffeeType}${o}`,milk_type:a.name,milk_type_id:a.id,alternative_milk:"no_milk"!==a.id&&"alternative"===a.category,dairy_free:(null===(s=a.properties)||void 0===s?void 0:s.dairyFree)||!1,sugar:b.sugar,extra_hot:b.extraHot,priority:i,notes:b.notes,shots:parseFloat(b.shots),is_walk_in:!0,collection_station:b.collectionStation||null};t(l)},children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name*"}),(0,yt.jsx)("input",{type:"text",name:"customerName",value:b.customerName,onChange:E,className:"w-full p-2 border rounded",required:!0})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,yt.jsx)("input",{type:"text",name:"phoneNumber",value:b.phoneNumber,onChange:E,className:"w-full p-2 border rounded",placeholder:"Optional for walk-in"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coffee Type*"}),(0,yt.jsx)("select",{name:"coffeeType",value:c.includes(b.coffeeType)?b.coffeeType:c[0],onChange:E,className:"w-full p-2 border rounded",required:!0,children:c.map((e=>(0,yt.jsx)("option",{value:e,children:e},e)))}),c.length<9&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited coffee options at this station"]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),(0,yt.jsx)("select",{name:"size",value:u.includes(b.size)?b.size:u[0],onChange:E,className:"w-full p-2 border rounded",children:u.map((e=>(0,yt.jsx)("option",{value:e,children:e},e)))}),u.length<3&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited cup sizes at this station"]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Espresso Shots"}),(0,yt.jsxs)("select",{name:"shots",value:b.shots,onChange:E,className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"0.5",children:"Half shot (1/2)"}),(0,yt.jsx)("option",{value:"1",children:"Single shot"}),(0,yt.jsx)("option",{value:"2",children:"Double shot"}),(0,yt.jsx)("option",{value:"3",children:"Triple shot"})]}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Affects coffee usage calculations"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Milk Type"}),(0,yt.jsxs)("select",{name:"milkType",value:o.some((e=>e.id===b.milkType))?b.milkType:o.length>0?o[0].id:"no_milk",onChange:E,className:"w-full p-2 border rounded",children:[o.filter((e=>"standard"===e.category)).length>0&&(0,yt.jsx)("optgroup",{label:"Standard Milks",children:o.filter((e=>"standard"===e.category)).map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.name,e.properties.lactoseFree?" (Lactose-Free)":"",e.properties.lowFat?" (Low-Fat)":""]},e.id)))}),o.filter((e=>"alternative"===e.category)).length>0&&(0,yt.jsx)("optgroup",{label:"Alternative Milks",children:o.filter((e=>"alternative"===e.category)).map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.name,e.properties.vegan?" (Vegan)":""]},e.id)))}),(0,yt.jsx)("option",{value:"no_milk",children:"No milk"})]}),o.length<5&&(0,yt.jsxs)("div",{className:"mt-1 text-xs text-amber-600 flex items-center",children:[(0,yt.jsx)(gs,{size:12,className:"inline mr-1"}),"Limited milk options at this station"]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sugar"}),(0,yt.jsxs)("select",{name:"sugar",value:b.sugar,onChange:E,className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"No sugar",children:"No sugar"}),(0,yt.jsx)("option",{value:"1 sugar",children:"1 sugar"}),(0,yt.jsx)("option",{value:"2 sugars",children:"2 sugars"}),(0,yt.jsx)("option",{value:"3 sugars",children:"3 sugars"})]})]}),(0,yt.jsx)("div",{})]}),(0,yt.jsxs)("div",{className:"mb-4 flex space-x-4",children:[(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",name:"extraHot",checked:b.extraHot,onChange:E,className:"mr-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Extra hot"})]}),(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",name:"priority",checked:b.priority,onChange:E,className:"mr-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium text-red-600 font-semibold",children:"VIP / Staff Priority"})]})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Collection Station"}),(0,yt.jsxs)("select",{name:"collectionStation",value:b.collectionStation||"",onChange:E,className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"",children:"Same station (Order & collect here)"}),n.map((e=>(0,yt.jsxs)("option",{value:e.id,children:["Collect at ",e.name||`Station ${e.id}`]},e.id)))]}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Choose a different station if the customer wants to collect their order elsewhere."})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Instructions"}),(0,yt.jsx)("textarea",{name:"notes",value:b.notes,onChange:E,className:"w-full p-2 border rounded",rows:"2",placeholder:"Special instructions or VIP/organizer codes..."}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Adding words like "VIP", "staff", or "organiser" in the notes will automatically prioritize the order.'})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yt.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:s,children:"Cancel"}),(0,yt.jsx)("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",children:"Add Order"})]})]})]})})},bs=dt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),vs=e=>{let{onClose:t,onMessageRead:s,stations:r,currentStationId:n,currentStationName:i,baristaName:o="Barista",onBaristaNameChange:l}=e;const[c,d]=(0,a.useState)(n);(0,a.useEffect)((()=>{console.log(`StationChat - selectedStationId changed to: ${c}, type: ${typeof c}`)}),[c]),(0,a.useEffect)((()=>{console.log(`StationChat - currentStationId prop changed to: ${n}, type: ${typeof n}`),n!==c&&d(n)}),[n,c]);const[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)([]),[p,f]=(0,a.useState)(""),[x,y]=(0,a.useState)("normal"),[b,v]=(0,a.useState)(!0),[j,w]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),S=(0,a.useRef)(null),[C,_]=(0,a.useState)(!1),[E,T]=(0,a.useState)(o);(0,a.useEffect)((()=>{T(o)}),[o]);const I=()=>{if(!r||0===r.length)return"Unknown Station";const e=r.find((e=>e.id===c));return e?e.name:`Station ${c}`};(0,a.useEffect)((()=>{const e=r.find((e=>e.id===c||("string"===typeof e.id&&"number"===typeof c&&parseInt(e.id,10)===c||"string"===typeof c&&"number"===typeof e.id&&parseInt(c,10)===e.id))),t=e?e.name:`Station #${c}`,a="string"===typeof c?parseInt(c,10):c;console.log(`Initializing chat service for station ${a} (${t}) using stationObj:`,e),cs.initialize(a,t,o);const n=cs.addListener((e=>{g(e),v(!1),k(null)}));return s&&s(),O(),()=>{n(),cs.cleanup()}}),[c,r,o,s]);const O=async()=>{try{v(!0),await cs.loadMessages(),k(null)}catch(e){console.error("Error loading messages:",e),k("Failed to load messages")}finally{v(!1)}};(0,a.useEffect)((()=>{S.current&&S.current.scrollIntoView({behavior:"smooth"})}),[h]);const A=e=>{const t=new Date(e),s=Math.floor((new Date-t)/6e4);return s<1?"Just now":1===s?"1m ago":s<60?`${s}m ago`:`${Math.floor(s/60)}h ago`},$=()=>{if(E.trim()&&E!==o){l&&l(E.trim());const e=I(),t="string"===typeof c?parseInt(c,10):c;cs.initialize(t,e,E.trim());try{const e="string"===typeof c?parseInt(c,10):c;localStorage.setItem(`coffee_barista_name_station_${e}`,E.trim())}catch(N){console.error("Failed to save station-specific barista name to localStorage:",N)}}_(!1)};return(0,yt.jsxs)("div",{className:"fixed bottom-0 right-0 w-full md:w-80 h-96 bg-white shadow-lg border rounded-t-lg overflow-hidden z-40",children:[(0,yt.jsxs)("div",{className:"bg-blue-500 text-white p-2 flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("h3",{className:"font-medium mr-1",children:"Station Chat"}),(0,yt.jsxs)("div",{className:"relative ml-2",children:[(0,yt.jsxs)("button",{className:"flex items-center text-white text-sm p-1 hover:bg-blue-600 rounded",onClick:()=>m(!u),children:[I()," ",(0,yt.jsx)(It,{size:14,className:"ml-1"})]}),u&&r&&r.length>0&&(0,yt.jsx)("div",{className:"absolute top-full left-0 bg-white text-gray-800 shadow-lg rounded-md overflow-y-auto max-h-40 w-48 z-50",children:r.map((e=>(0,yt.jsxs)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer "+(e.id===c?"bg-blue-100":""),onClick:()=>{d(e.id);const t=e.name||`Station #${e.id}`,s="string"===typeof e.id?parseInt(e.id,10):e.id;console.log(`Dropdown selection - Reinitializing ChatService for station: ${s} (${t})`),cs.initialize(s,t,o),m(!1)},children:[(0,yt.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,yt.jsx)("div",{className:"w-2 h-2 rounded-full mr-1 "+("active"===e.status?"bg-green-500":"bg-red-500")}),e.status]})]},e.id)))})]})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{className:"text-white mr-2",onClick:()=>{O()},disabled:b,title:"Refresh Messages",children:(0,yt.jsx)(Ot,{size:18,className:b?"animate-spin":""})}),(0,yt.jsx)("button",{className:"text-white mr-2",onClick:()=>{window.confirm("Reset all chat messages? This is for debugging only.")&&cs.resetMessages()},title:"Reset All Messages (Debug)",children:(0,yt.jsx)(Ot,{size:18,className:"text-red-300"})}),(0,yt.jsx)("button",{className:"text-white",onClick:t,title:"Close Chat",children:(0,yt.jsx)(Lt,{size:20})})]})]}),N&&(0,yt.jsxs)("div",{className:"bg-red-100 text-red-700 p-2 text-sm flex items-center",children:[(0,yt.jsx)(gs,{size:16,className:"mr-1"}),N]}),(0,yt.jsxs)("div",{className:"bg-blue-50 border-b flex items-center p-2 justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(mt,{size:14,className:"text-blue-700 mr-1"}),C?(0,yt.jsx)("input",{type:"text",value:E,onChange:e=>T(e.target.value),className:"border rounded px-2 py-1 text-sm w-40",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&$()}}):(0,yt.jsx)("span",{className:"text-sm",children:o})]}),(0,yt.jsx)("button",{className:"text-blue-700 p-1 hover:bg-blue-100 rounded",onClick:()=>{C?$():_(!0)},children:C?(0,yt.jsx)(bs,{size:14}):(0,yt.jsx)(Ct,{size:14})})]}),(0,yt.jsxs)("div",{className:"h-64 overflow-y-auto p-3 bg-gray-50",children:[b&&0===h.length?(0,yt.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,yt.jsx)("p",{className:"mt-2 text-gray-500 text-sm",children:"Loading messages..."})]}):0===h.length?(0,yt.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[(0,yt.jsx)("p",{children:"No messages yet"}),(0,yt.jsx)("p",{className:"text-sm",children:"Send a message to start the conversation!"})]}):h.map((e=>{var t;return(0,yt.jsxs)("div",{className:"p-2 mb-2 rounded "+(e.is_urgent?"bg-red-50 border-l-2 border-red-500":e.station_id===c||"string"===typeof c&&e.station_id===parseInt(c,10)||e.sender===o&&e.station_id===c?"bg-blue-100":"bg-gray-100"),children:[(0,yt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex justify-between",children:[(0,yt.jsxs)("span",{children:[e.sender," ",(0,yt.jsxs)("span",{className:"text-blue-600",children:["(",(null===(t=r.find((t=>t.id===e.station_id||"string"===typeof e.station_id&&"number"===typeof t.id&&parseInt(e.station_id,10)===t.id||"string"===typeof t.id&&"number"===typeof e.station_id&&parseInt(t.id,10)===e.station_id)))||void 0===t?void 0:t.name)||e.station_name||`Station #${e.station_id}`,")"]})]}),(0,yt.jsx)("span",{children:A(e.created_at)})]}),(0,yt.jsx)("div",{className:e.is_urgent?"font-bold":"",children:e.content})]},e.id)})),(0,yt.jsx)("div",{ref:S})]}),(0,yt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p.trim())try{w(!0),await cs.sendMessage(p.trim(),"urgent"===x),f(""),y("normal")}catch(t){console.error("Error sending message:",t),k("Failed to send message")}finally{w(!1)}},className:"p-2 border-t flex",children:[(0,yt.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"Type a message...",className:"flex-grow border rounded-l p-2",disabled:j}),(0,yt.jsxs)("select",{value:x,onChange:e=>y(e.target.value),className:"border-y p-2",disabled:j,children:[(0,yt.jsx)("option",{value:"normal",children:"Normal"}),(0,yt.jsx)("option",{value:"urgent",children:"Urgent"})]}),(0,yt.jsx)("button",{type:"submit",className:(j?"bg-blue-400":"bg-blue-500 hover:bg-blue-600")+" text-white p-2 rounded-r transition-colors",disabled:j||!p.trim(),children:j?(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(Ot,{size:16,className:"animate-spin mr-1"}),(0,yt.jsx)("span",{children:"Sending"})]}):"Send"})]})]})},js=e=>{let{onSendMessage:t,onUpdateSettings:s}=e;const[r,n]=(0,a.useState)(ls.settings),[i,o]=(0,a.useState)(!1),l=e=>{const t={...r,...e};n(t),ls.updateSettings(t),s&&s(t)},c=()=>(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg",children:[(0,yt.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Notification Settings"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",id:"autoSendSms",checked:r.autoSendSmsOnComplete,onChange:e=>l({autoSendSmsOnComplete:e.target.checked}),className:"mr-2"}),(0,yt.jsx)("label",{htmlFor:"autoSendSms",children:"Automatically send SMS when order is completed"})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",id:"showOnDisplay",checked:r.showNameOnDisplay,onChange:e=>l({showNameOnDisplay:e.target.checked}),className:"mr-2"}),(0,yt.jsx)("label",{htmlFor:"showOnDisplay",children:"Show customer name on display screen"})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",id:"remindAfterDelay",checked:r.remindAfterDelay,onChange:e=>l({remindAfterDelay:e.target.checked}),className:"mr-2"}),(0,yt.jsx)("label",{htmlFor:"remindAfterDelay",children:"Send reminder if not picked up"})]}),r.remindAfterDelay&&(0,yt.jsxs)("div",{className:"ml-6",children:[(0,yt.jsx)("label",{className:"block text-sm mb-1",children:"Reminder delay (seconds):"}),(0,yt.jsx)("input",{type:"number",min:"10",max:"300",step:"10",value:r.reminderDelay,onChange:e=>l({reminderDelay:Number(e.target.value)}),className:"w-24 p-1 border rounded"})]})]}),(0,yt.jsx)("div",{className:"mt-4 flex justify-end",children:(0,yt.jsx)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",onClick:()=>o(!1),children:"Save Settings"})})]});return{renderSettingsButton:()=>(0,yt.jsxs)("button",{className:"p-2 bg-gray-200 rounded-full hover:bg-gray-300 relative",onClick:()=>o(!i),title:"Notification Settings",children:[(0,yt.jsx)(gt,{size:20}),i&&(0,yt.jsx)("div",{className:"absolute right-0 top-full mt-2 z-20",children:(0,yt.jsx)(c,{})})]}),completeWithNotification:async e=>{try{console.log("Completing order with notification:",e),r.showNameOnDisplay&&ls.showOnDisplay(e),await ls.sendReadyNotification(e),console.log("SMS notification sent for order:",e.id),r.remindAfterDelay&&r.reminderDelay>0&&setTimeout((()=>{ls.sendReminderNotification(e,Math.floor(r.reminderDelay/60))}),1e3*r.reminderDelay)}catch(t){console.error("Failed to send order completion notification:",t)}},settings:r}};function ws(){const[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!0),[n,i]=(0,a.useState)(null),[o,l]=(0,a.useState)(Date.now()),[c,d]=(0,a.useState)(!1),{isDemoMode:u}=(0,Ut.q)(),m=(0,a.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?d(!0):r(!0);try{if(u){const e=localStorage.getItem("coffee_cue_settings");e&&t(JSON.parse(e))}else{const s=await xs.getSettings(e);t(s)}i(null),l(Date.now())}catch(s){console.error("Error loading settings:",s),i(`Failed to load settings: ${s.message}`)}finally{r(!1),d(!1)}}),[u]),h=(0,a.useCallback)((async s=>{try{console.log("[useSettings] Saving multiple settings:",s);const r={...e||{},...s};if(t(r),u)console.log("[useSettings] In demo mode, updating settings to:",r),localStorage.setItem("coffee_cue_settings",JSON.stringify(r)),console.log("[useSettings] Updated settings state in demo mode");else{console.log("[useSettings] In production mode, calling API with:",s);try{await xs.updateSettings(s),console.log("[useSettings] API update successful")}catch(a){console.warn("[useSettings] API update failed, but UI state was updated:",a)}}return l(Date.now()),!0}catch(r){return console.error("Error saving settings:",r),i(`Failed to save settings: ${r.message}`),!1}}),[e,u]),g=(0,a.useCallback)((async(s,a)=>{try{if(console.log(`[useSettings] Updating setting ${s} with value:`,a),t((e=>({...e||{},[s]:a}))),u){console.log("[useSettings] In demo mode, saving to localStorage");const t={...e||{},[s]:a};localStorage.setItem("coffee_cue_settings",JSON.stringify(t)),console.log("[useSettings] Demo mode update completed")}else{console.log("[useSettings] In production mode, using API endpoint");try{await xs.updateSetting(s,a),console.log("[useSettings] API update successful")}catch(r){console.warn("[useSettings] API update failed, but UI state was updated:",r)}}return l(Date.now()),!0}catch(n){return console.error(`Error updating setting ${s}:`,n),i(`Failed to update setting: ${n.message}`),!1}}),[e,u]),p=(0,a.useCallback)((async()=>{try{if(u){localStorage.removeItem("coffee_cue_settings");const e=await xs.getSettings(!0);t(e)}else{const e=await xs.resetSettings();t(e)}return l(Date.now()),!0}catch(e){return console.error("Error resetting settings:",e),i(`Failed to reset settings: ${e.message}`),!1}}),[u]),f=(0,a.useCallback)((async e=>{try{return u?await g("waitTimeWarning",e):(await xs.updateWaitTime(e),t((t=>({...t,waitTimeWarning:e}))),l(Date.now()),!0)}catch(s){return console.error("Error updating wait time:",s),i(`Failed to update wait time: ${s.message}`),!1}}),[u,g]),x=(0,a.useCallback)((()=>{d(!0),m(!0)}),[m]);return(0,a.useEffect)((()=>{m()}),[m,u]),{settings:e||{},loading:s,error:n,lastUpdated:o,isRefreshing:c,updateSetting:g,saveSettings:h,resetSettings:p,updateWaitTime:f,refreshData:x,clearError:()=>i(null)}}const Ns=ws,ks=e=>{let{orders:t,onStartOrder:s,onSendMessage:a,onDelayOrder:r,onEditOrder:n}=e;const{settings:i}=ws();return t&&0!==t.length?(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("div",{className:"text-xs uppercase text-red-600 font-semibold mb-1 px-1",children:"VIP ORDERS"}),t.map((e=>{const t=e.milkType&&"No Milk"!==e.milkType?ns(e.milkType,e.milkTypeId):{borderLeftWidth:"4px",borderLeftStyle:"solid",borderLeftColor:"#EF4444"};return(0,yt.jsx)("div",{className:`mb-2 rounded-lg overflow-hidden shadow-sm ${Vt(e,i)}`,style:t,children:(0,yt.jsxs)("div",{className:"p-3",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold text-gray-800",children:["#",e.orderNumber," - ",e.customerName]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.waitTime," min"]}),(0,yt.jsx)("div",{className:`w-2 h-2 rounded-full ${Ht(e.waitTime,e.promisedTime)}`})]})]}),(0,yt.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{className:"font-medium text-gray-700 flex items-center",children:[e.milkType&&"No Milk"!==e.milkType&&(0,yt.jsx)("span",{style:is(e.milkType,e.milkTypeId)}),e.coffeeType,", ",e.milkType?e.milkType:"No milk",", ",e.sugar?e.sugar:"No sugar"]}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"mt-1",children:(0,yt.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-sm",children:"Alternative Milk"})})]}),(0,yt.jsxs)("div",{className:"mt-2 flex justify-between space-x-2",children:[(0,yt.jsx)("button",{className:"flex-1 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded-md text-sm",onClick:()=>s(e),children:"Start"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>r&&r(e),children:"Delay"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>a&&a(e),children:"Message"}),(0,yt.jsx)("button",{className:"p-1 text-gray-500 hover:text-gray-700",onClick:()=>n&&n(e),title:"Edit order",children:(0,yt.jsx)(Ct,{size:16})})]}),(0,yt.jsx)("div",{className:"mt-2 bg-gray-200 h-1 w-full rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`h-1 ${Ht(e.waitTime,e.promisedTime)}`,style:{width:`${Math.min(e.waitTime/e.promisedTime*100,100)}%`}})})]})},e.id)}))]}):null},Ss=e=>{let{batchGroups:t,onStartOrder:s,onProcessBatch:a,onSendMessage:r,onDelayOrder:n,onEditOrder:i}=e;const{settings:o}=ws(),l=e=>e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ");return(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("div",{className:"text-xs uppercase text-amber-800 font-semibold mb-1 px-1",children:"Batch Groups"}),Object.entries(t).map((e=>{let[t,c]=e;return(0,yt.jsxs)("div",{className:"mb-3 bg-amber-50 rounded-lg overflow-hidden",children:[(0,yt.jsxs)("div",{className:"bg-amber-100 px-3 py-2 text-sm text-amber-800 font-medium flex justify-between items-center border-b border-amber-200",children:[(0,yt.jsxs)("span",{children:["Batch: ",l(t)," (",c.length,")"]}),(0,yt.jsx)("button",{className:"text-white bg-amber-600 text-xs px-3 py-1 rounded-md hover:bg-amber-700",onClick:()=>a(t),children:"Process Batch"})]}),c.map(((e,t)=>(0,yt.jsxs)("div",{className:`p-3 border-b ${t===c.length-1?"":"border-amber-100"} ${Vt(e,o)}`,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold text-gray-800",children:["#",e.orderNumber," - ",e.customerName]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.waitTime," min"]}),(0,yt.jsx)("div",{className:`w-2 h-2 rounded-full ${Ht(e.waitTime,e.promisedTime)}`})]})]}),(0,yt.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{className:"font-medium text-gray-700 flex items-center",children:[e.milkTypeId&&(0,yt.jsx)("div",{className:`milk-indicator-dot ${e.milkTypeId}`}),e.coffeeType,", ",e.milkType,", ",e.sugar]}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"mt-1",children:(0,yt.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-sm",children:"Alternative Milk"})})]}),(0,yt.jsxs)("div",{className:"mt-2 flex justify-between space-x-2",children:[(0,yt.jsx)("button",{className:"flex-1 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded-md text-sm",onClick:()=>s(e),children:"Start"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>n&&n(e),children:"Delay"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>r&&r(e),children:"Message"}),(0,yt.jsx)("button",{className:"p-1 text-gray-500 hover:text-gray-700",onClick:()=>i&&i(e),title:"Edit order",children:(0,yt.jsx)(Ct,{size:16})})]}),(0,yt.jsx)("div",{className:"mt-2 bg-gray-200 h-1 w-full rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`h-1 ${Ht(e.waitTime,e.promisedTime)}`,style:{width:`${Math.min(e.waitTime/e.promisedTime*100,100)}%`}})})]},e.id)))]},t)}))]})},Cs=e=>{let{orders:t,onStartOrder:s,onSendMessage:a,onDelayOrder:r,onEditOrder:n}=e;const{settings:i}=ws();return t&&t.length>0&&console.log("RegularOrdersList first order milk info:",{milkType:t[0].milkType,milkTypeId:t[0].milkTypeId,alternativeMilk:t[0].alternativeMilk,dairyFree:t[0].dairyFree,classApplied:Vt(t[0],i)}),t&&0!==t.length?(0,yt.jsx)("div",{children:t.map((e=>{const t=e.milkType&&"No Milk"!==e.milkType?ns(e.milkType,e.milkTypeId):{borderLeftWidth:"4px",borderLeftStyle:"solid",borderLeftColor:"#3B82F6"};return(0,yt.jsx)("div",{className:`mb-2 rounded-lg overflow-hidden shadow-sm ${Vt(e,i)}`,style:t,children:(0,yt.jsxs)("div",{className:"p-3",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold text-gray-800",children:["#",e.orderNumber," - ",e.customerName]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.waitTime," min"]}),(0,yt.jsx)("div",{className:`w-2 h-2 rounded-full ${Ht(e.waitTime,e.promisedTime)}`})]})]}),(0,yt.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{className:"font-medium text-gray-700 flex items-center",children:[e.milkType&&"No Milk"!==e.milkType&&(0,yt.jsx)("span",{style:is(e.milkType,e.milkTypeId)}),e.coffeeType,", ",e.milkType,", ",e.sugar]}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"mt-1",children:(0,yt.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-sm",children:"Alternative Milk"})})]}),(0,yt.jsxs)("div",{className:"mt-2 flex justify-between space-x-2",children:[(0,yt.jsx)("button",{className:"flex-1 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded-md text-sm",onClick:()=>s(e),children:"Start"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>r&&r(e),children:"Delay"}),(0,yt.jsx)("button",{className:"flex-1 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>a&&a(e),children:"Message"}),(0,yt.jsx)("button",{className:"p-1 text-gray-500 hover:text-gray-700",onClick:()=>n&&n(e),title:"Edit order",children:(0,yt.jsx)(Ct,{size:16})})]}),(0,yt.jsx)("div",{className:"mt-2 bg-gray-200 h-1 w-full rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`h-1 ${Ht(e.waitTime,e.promisedTime)}`,style:{width:`${Math.min(e.waitTime/e.promisedTime*100,100)}%`}})})]})},e.id)}))}):null},_s=e=>{let{orders:t,filter:s,onFilterChange:a,onStartOrder:r,onProcessBatch:n,onSendMessage:i,onDelayOrder:o,onEditOrder:l}=e;const{settings:c}=ws(),d=t.filter((e=>e.vip||e.priority)),u=t.reduce(((e,t)=>(t.batchGroup&&(e[t.batchGroup]||(e[t.batchGroup]=[]),e[t.batchGroup].push(t)),e)),{}),m=t.filter((e=>!(e.vip||e.priority)&&!e.batchGroup));return(0,yt.jsxs)("div",{className:"w-1/2 flex flex-col h-full",children:[(0,yt.jsxs)("div",{className:"bg-amber-600 text-white p-2 rounded-t-lg flex justify-between items-center",children:[(0,yt.jsxs)("h2",{className:"text-xl font-bold",children:["Upcoming Orders (",t.length,")"]}),(0,yt.jsxs)("div",{className:"flex space-x-1",children:[(0,yt.jsx)("button",{className:"px-2 py-1 rounded-md text-xs "+("all"===s?"bg-white text-amber-600":"bg-amber-500 hover:bg-amber-700"),onClick:()=>a("all"),children:"All"}),(0,yt.jsx)("button",{className:"px-2 py-1 rounded-md text-xs "+("vip"===s?"bg-white text-amber-600":"bg-amber-500 hover:bg-amber-700"),onClick:()=>a("vip"),children:"VIP"}),(0,yt.jsx)("button",{className:"px-2 py-1 rounded-md text-xs "+("batch"===s?"bg-white text-amber-600":"bg-amber-500 hover:bg-amber-700"),onClick:()=>a("batch"),children:"Batch"}),(0,yt.jsx)("button",{className:"px-2 py-1 rounded-md text-xs bg-amber-500 hover:bg-amber-700",children:(0,yt.jsx)(It,{size:12})})]})]}),(0,yt.jsx)("div",{className:"bg-white rounded-b-lg shadow-md p-2 flex-grow overflow-y-auto",children:"all"===s?(0,yt.jsxs)(yt.Fragment,{children:[d.length>0&&(0,yt.jsx)(ks,{orders:d,onStartOrder:r,onSendMessage:i,onDelayOrder:o,onEditOrder:l}),Object.keys(u).length>0&&(0,yt.jsx)(Ss,{batchGroups:u,onStartOrder:r,onProcessBatch:n,onSendMessage:i,onDelayOrder:o,onEditOrder:l}),m.length>0&&(0,yt.jsx)(Cs,{orders:m,onStartOrder:r,onSendMessage:i,onDelayOrder:o,onEditOrder:l})]}):(0,yt.jsx)("div",{children:(()=>{switch(s){case"vip":return t.filter((e=>e.vip||e.priority));case"batch":return t.filter((e=>e.batchGroup));case"urgent":return t.filter((e=>e.waitTime/e.promisedTime>.8));default:return t}})().map((e=>(0,yt.jsxs)("div",{className:`mb-2 p-3 rounded-lg border-l-4 ${e.vip||e.priority?"border-red-500":e.batchGroup?"border-yellow-500":"border-blue-500"} shadow-sm hover:shadow transition-all ${Vt(e,c)}`,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold",children:["#",e.orderNumber," - ",e.customerName]}),(0,yt.jsxs)("div",{className:"text-sm flex items-center space-x-1",children:[(0,yt.jsxs)("span",{children:[e.waitTime," min"]}),(0,yt.jsx)("div",{className:`w-3 h-3 rounded-full ${Ht(e.waitTime,e.promisedTime)}`})]})]}),(0,yt.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 rounded",children:[(0,yt.jsxs)("div",{className:"font-medium",children:[e.coffeeType,", ",e.milkType,", ",e.sugar]}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded mt-2",children:"Alternative Milk"})]}),(0,yt.jsxs)("div",{className:"mt-2 flex justify-between",children:[(0,yt.jsx)("button",{className:"px-3 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded-md text-sm",onClick:()=>r(e),children:"Start"}),(0,yt.jsx)("button",{className:"px-3 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>o&&o(e),children:"Delay"}),(0,yt.jsx)("button",{className:"px-3 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm",onClick:()=>i&&i(e),children:"Message"}),(0,yt.jsx)("button",{className:"p-1 text-gray-500 hover:text-gray-700",children:(0,yt.jsx)(Ct,{size:16})})]}),(0,yt.jsx)("div",{className:"mt-2 bg-gray-200 h-1 w-full rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`h-1 ${Ht(e.waitTime,e.promisedTime)}`,style:{width:e.waitTime/e.promisedTime*100+"%"}})})]},e.id)))})})]})},Es=dt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ts=dt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Is=dt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Os=()=>{const{stations:e,loading:t}=Xt(),{pendingOrders:s,inProgressOrders:r}=Gt(),[n,i]=(0,a.useState)((()=>{try{const e=localStorage.getItem("coffee_cue_routing_rules");if(e)return JSON.parse(e)}catch(e){console.error("Error loading routing rules from localStorage:",e)}return{prioritizeEfficiency:!0,balanceWorkload:!0,considerCapabilities:!0,emergencyMode:!1}})());(0,a.useEffect)((()=>{try{localStorage.setItem("coffee_cue_routing_rules",JSON.stringify(n)),console.log("Saved routing rules to localStorage:",n)}catch(e){console.error("Error saving routing rules to localStorage:",e)}}),[n]);const[o,l]=(0,a.useState)({avgWaitTime:0,routingEfficiency:0,workloadBalance:0,totalOrdersRouted:0}),c=(0,a.useCallback)((()=>e&&s&&r?e.map((e=>{var t,s,a;const n=r.filter((t=>t.stationId===e.id||t.station_id===e.id)),i={coffeeTypes:(null===(t=e.capabilities)||void 0===t?void 0:t.coffee)||["Espresso","Flat White","Cappuccino","Latte"],milkOptions:(null===(s=e.capabilities)||void 0===s?void 0:s.milk)||["Full Cream","Skim","Soy","Almond"],specialFeatures:(null===(a=e.capabilities)||void 0===a?void 0:a.special)||[]},o=.4*i.coffeeTypes.length+.3*i.milkOptions.length+.3*i.specialFeatures.length,l=n.length,c=e.maxCapacity||5,d=l/c*100,u=e.avgOrderTime||4,m=Math.round(60/u),h=l*u;return{...e,capabilities:i,capabilityScore:o,currentLoad:l,maxCapacity:c,workloadPercentage:d,ordersPerHour:m,estimatedWaitTime:h,efficiency:Math.max(0,100-d),status:d>90?"overloaded":d>70?"busy":d>30?"active":"available"}})):[]),[e,s,r])(),d=(0,a.useCallback)((e=>{var t;if(!c.length)return null;let s=c.map((t=>{let s=0;const a=t.capabilities.coffeeTypes.some((t=>{var s;return null===(s=e.coffeeType)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase())})),r="No milk"===e.milkType||t.capabilities.milkOptions.some((t=>{var s;return null===(s=e.milkType)||void 0===s?void 0:s.toLowerCase().includes(t.toLowerCase())}));if(a&&r?s+=40:(a||r)&&(s+=20),n.balanceWorkload){s+=.3*Math.max(0,100-t.workloadPercentage)}return n.prioritizeEfficiency&&(s+=.2*t.efficiency),e.priority&&t.capabilities.specialFeatures.includes("VIP")&&(s+=10),"overloaded"===t.status&&(s-=25),{station:t,score:s,reasoning:{canMake:a&&r,workload:t.workloadPercentage,efficiency:t.efficiency,waitTime:t.estimatedWaitTime}}}));return s.sort(((e,t)=>t.score-e.score)),(null===(t=s[0])||void 0===t?void 0:t.score)>50?s[0]:null}),[c,n]),u=(0,a.useCallback)((()=>s.length?s.map((e=>{const t=d(e);return{order:e,suggested:t,currentStation:e.stationId?c.find((t=>t.id===e.stationId)):null}})).filter((e=>e.suggested)):[]),[s,d,c])();(0,a.useEffect)((()=>{if(!c.length)return;const e=(null===r||void 0===r?void 0:r.length)||0,t=c.reduce(((e,t)=>e+(t.estimatedWaitTime||0)),0)/c.length,s=Math.sqrt(c.reduce(((e,t)=>e+Math.pow((t.workloadPercentage||0)-50,2)),0)/c.length),a=Math.max(0,100-s);l({avgWaitTime:Math.round(10*t)/10,routingEfficiency:Math.round((a+(100-t))/2),workloadBalance:Math.round(a),totalOrdersRouted:e})}),[null===r||void 0===r?void 0:r.length,null===e||void 0===e?void 0:e.length]);const m=e=>{switch(e){case"available":return"bg-green-100 text-green-800";case"active":return"bg-blue-100 text-blue-800";case"busy":return"bg-yellow-100 text-yellow-800";case"overloaded":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},h=e=>{switch(e){case"available":return(0,yt.jsx)(St,{size:16,className:"text-green-600"});case"active":return(0,yt.jsx)(Rt,{size:16,className:"text-blue-600"});case"busy":return(0,yt.jsx)(zt,{size:16,className:"text-yellow-600"});case"overloaded":return(0,yt.jsx)(gs,{size:16,className:"text-red-600"});default:return(0,yt.jsx)(Rt,{size:16,className:"text-gray-600"})}};return t?(0,yt.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:(0,yt.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,yt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,yt.jsx)("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})]})}):(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,yt.jsx)(Pt,{className:"mr-3"}),"Queue Intelligence Dashboard"]}),(0,yt.jsx)("p",{className:"text-purple-100 mt-1",children:"Intelligent order routing and workload optimization"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[o.routingEfficiency||0,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-purple-200",children:"Efficiency"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[o.avgWaitTime||0,"m"]}),(0,yt.jsx)("div",{className:"text-sm text-purple-200",children:"Avg Wait"})]})]})]})}),(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Es,{className:"mr-2 text-yellow-600"}),"Routing Configuration"]}),(0,yt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(n).map((e=>{let[t,s]=e;return(0,yt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,yt.jsx)("input",{type:"checkbox",checked:s,onChange:e=>i({...n,[t]:e.target.checked}),className:"rounded border-gray-300"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:t.replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase()))})]},t)}))})]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map((e=>(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yt.jsx)("h4",{className:"font-semibold",children:e.name}),(0,yt.jsxs)("div",{className:`px-2 py-1 rounded-full text-xs flex items-center space-x-1 ${m(e.status)}`,children:[h(e.status),(0,yt.jsx)("span",{children:e.status})]})]}),(0,yt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Current Load:"}),(0,yt.jsxs)("span",{children:[e.currentLoad,"/",e.maxCapacity]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Workload:"}),(0,yt.jsxs)("span",{children:[Math.round(e.workloadPercentage),"%"]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Est. Wait:"}),(0,yt.jsxs)("span",{children:[e.estimatedWaitTime,"m"]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Orders/Hour:"}),(0,yt.jsx)("span",{children:e.ordersPerHour})]})]}),(0,yt.jsx)("div",{className:"mt-3",children:(0,yt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,yt.jsx)("div",{className:"h-2 rounded-full "+(e.workloadPercentage>90?"bg-red-500":e.workloadPercentage>70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(100,e.workloadPercentage)}%`}})})})]},e.id)))}),u.length>0&&(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Ts,{className:"mr-2 text-blue-600"}),"Intelligent Routing Suggestions (",u.length,")"]}),(0,yt.jsx)("div",{className:"space-y-3",children:u.slice(0,5).map((e=>{let{order:t,suggested:s,currentStation:a}=e;return(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"font-medium",children:["#",t.orderNumber," - ",t.customerName]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:[t.coffeeType,", ",t.milkType]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[a&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-sm font-medium",children:a.name}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Current"})]}),(0,yt.jsx)(Is,{size:16,className:"text-gray-400"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-sm font-medium text-blue-600",children:s.station.name}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:["Score: ",Math.round(s.score)," | Wait: ",s.station.estimatedWaitTime,"m"]})]}),(0,yt.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Route"})]})]},t.id)}))})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.totalOrdersRouted||0}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Active Orders"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[o.avgWaitTime||0,"m"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Wait Time"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[o.routingEfficiency||0,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Routing Efficiency"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[o.workloadBalance||0,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Workload Balance"})]})]})]})},As=dt("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),$s=()=>{var e;const{stations:t}=Xt(),{pendingOrders:s,inProgressOrders:r,startOrder:n}=Gt(),i=(()=>{try{const e=localStorage.getItem("coffee_cue_balancing_settings");if(e){const t=JSON.parse(e);return{balancingActive:t.balancingActive||!1,balancingRules:t.balancingRules||{autoBalance:!0,balanceThreshold:70,maxTransfers:3,considerCapabilities:!0}}}}catch(e){console.error("Error loading balancing settings from localStorage:",e)}return{balancingActive:!1,balancingRules:{autoBalance:!0,balanceThreshold:70,maxTransfers:3,considerCapabilities:!0}}})(),[o,l]=(0,a.useState)(i.balancingActive),[c,d]=(0,a.useState)(i.balancingRules);(0,a.useEffect)((()=>{try{const e={balancingActive:o,balancingRules:c};localStorage.setItem("coffee_cue_balancing_settings",JSON.stringify(e)),console.log("Saved balancing settings to localStorage:",e)}catch(e){console.error("Error saving balancing settings to localStorage:",e)}}),[o,c]);const[u,m]=(0,a.useState)([]),[h,g]=(0,a.useState)({workloadVariance:0,avgWaitTime:0,transfersToday:0,efficiencyGain:0}),p=(0,a.useCallback)((()=>{if(!t||!r)return{stations:[],variance:0,needsBalancing:!1};const e=t.map((e=>{const t=r.filter((t=>t.stationId===e.id||t.station_id===e.id)),s=e.maxCapacity||5,a=t.length,n=a/s*100,i=a*(e.avgOrderTime||4);return{...e,currentLoad:a,maxCapacity:s,workloadPercentage:n,estimatedWaitTime:i,orders:t,status:n>90?"overloaded":n>70?"busy":n>30?"active":"available"}})),s=e.reduce(((e,t)=>e+t.workloadPercentage),0)/e.length,a=Math.sqrt(e.reduce(((e,t)=>e+Math.pow(t.workloadPercentage-s,2)),0)/e.length),n=a>c.balanceThreshold;return{stations:e,variance:Math.round(a),avgWorkload:Math.round(s),needsBalancing:n}}),[t,r,c.balanceThreshold])(),f=(0,a.useCallback)((()=>{if(!p.needsBalancing)return[];const e=p.stations.filter((e=>e.workloadPercentage>c.balanceThreshold)),t=p.stations.filter((e=>e.workloadPercentage<50)).sort(((e,t)=>e.workloadPercentage-t.workloadPercentage));if(!e.length||!t.length)return[];const s=[];return e.forEach((e=>{e.orders.filter((e=>!e.priority&&!e.vip)).sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).slice(0,c.maxTransfers).forEach((a=>{const r=t.find((e=>{var t,s;if(!c.considerCapabilities)return!0;const r=!(null!==(t=e.capabilities)&&void 0!==t&&t.coffee)||e.capabilities.coffee.some((e=>{var t;return null===(t=a.coffeeType)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase())})),n="No milk"===a.milkType||!(null!==(s=e.capabilities)&&void 0!==s&&s.milk)||e.capabilities.milk.some((e=>{var t;return null===(t=a.milkType)||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase())}));return r&&n}));if(r){const t=e.estimatedWaitTime-r.estimatedWaitTime;s.push({order:a,fromStation:e,toStation:r,waitTimeReduction:t,priority:t+(e.workloadPercentage-r.workloadPercentage)})}}))})),s.sort(((e,t)=>t.priority-e.priority)).slice(0,c.maxTransfers)}),[p,c])();(0,a.useEffect)((()=>{c.autoBalance&&f.length&&!o&&m(f)}),[f,c.autoBalance,o]);const x=async e=>{l(!0);try{console.log(`Transferring order ${e.order.id} from ${e.fromStation.name} to ${e.toStation.name}`),await new Promise((e=>setTimeout(e,1e3))),g((t=>({...t,transfersToday:t.transfersToday+1,efficiencyGain:t.efficiencyGain+e.waitTimeReduction}))),m((t=>t.filter((t=>t.order.id!==e.order.id))))}catch(t){console.error("Transfer failed:",t)}finally{l(!1)}};(0,a.useEffect)((()=>{var e;if(null===(e=p.stations)||void 0===e||!e.length)return;const t=p.stations.reduce(((e,t)=>e+(t.estimatedWaitTime||0)),0)/p.stations.length;g((e=>({...e,workloadVariance:p.variance||0,avgWaitTime:Math.round(10*t)/10})))}),[p.variance,null===(e=p.stations)||void 0===e?void 0:e.length]);const y=e=>{switch(e){case"available":return"text-green-600 bg-green-100";case"active":return"text-blue-600 bg-blue-100";case"busy":return"text-yellow-600 bg-yellow-100";case"overloaded":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsx)("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,yt.jsx)(Dt,{className:"mr-3"}),"Station Load Balancer"]}),(0,yt.jsx)("p",{className:"text-green-100 mt-1",children:"Real-time workload distribution and order transfer optimization"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold",children:h.workloadVariance}),(0,yt.jsx)("div",{className:"text-sm text-green-200",children:"Variance"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold",children:h.transfersToday}),(0,yt.jsx)("div",{className:"text-sm text-green-200",children:"Transfers"})]})]})]})}),(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,yt.jsx)(Es,{className:"mr-2 text-yellow-600"}),"Load Balancing Configuration"]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:c.autoBalance,onChange:e=>d({...c,autoBalance:e.target.checked}),className:"rounded border-gray-300"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Auto-Balance"})]}),(0,yt.jsxs)("button",{onClick:()=>m(f),disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[(0,yt.jsx)(Ot,{size:16,className:o?"animate-spin":""}),(0,yt.jsx)("span",{children:"Analyze"})]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Balance Threshold (%)"}),(0,yt.jsx)("input",{type:"range",min:"50",max:"100",value:c.balanceThreshold,onChange:e=>d({...c,balanceThreshold:parseInt(e.target.value)}),className:"w-full"}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:[c.balanceThreshold,"%"]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Transfers"}),(0,yt.jsxs)("select",{value:c.maxTransfers,onChange:e=>d({...c,maxTransfers:parseInt(e.target.value)}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:1,children:"1"}),(0,yt.jsx)("option",{value:3,children:"3"}),(0,yt.jsx)("option",{value:5,children:"5"})]})]}),(0,yt.jsx)("div",{className:"flex items-center",children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:c.considerCapabilities,onChange:e=>d({...c,considerCapabilities:e.target.checked}),className:"rounded border-gray-300"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Check Capabilities"})]})})]})]}),(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(zt,{className:"mr-2 text-blue-600"}),"Station Workload Distribution"]}),(0,yt.jsx)("div",{className:"space-y-4",children:p.stations.map((e=>(0,yt.jsxs)("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",children:[(0,yt.jsx)("div",{className:"w-20 text-sm font-medium",children:e.name}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[(0,yt.jsxs)("span",{children:[e.currentLoad,"/",e.maxCapacity," orders"]}),(0,yt.jsxs)("span",{children:[Math.round(e.workloadPercentage),"%"]})]}),(0,yt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,yt.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 "+(e.workloadPercentage>90?"bg-red-500":e.workloadPercentage>70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(100,e.workloadPercentage)}%`}})})]}),(0,yt.jsx)("div",{className:`px-2 py-1 rounded-full text-xs flex items-center space-x-1 ${y(e.status)}`,children:(0,yt.jsx)("span",{children:e.status})}),(0,yt.jsxs)("div",{className:"text-right text-sm",children:[(0,yt.jsxs)("div",{className:"font-medium",children:[e.estimatedWaitTime,"m"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"wait time"})]})]},e.id)))})]}),u.length>0&&(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,yt.jsx)(As,{className:"mr-2 text-purple-600"}),"Recommended Transfers (",u.length,")"]}),(0,yt.jsx)("button",{onClick:async()=>{l(!0);for(const e of u)await x(e);l(!1)},disabled:o,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:"Execute All Transfers"})]}),(0,yt.jsx)("div",{className:"space-y-3",children:u.map(((e,t)=>(0,yt.jsxs)("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"font-medium",children:["#",e.order.orderNumber," - ",e.order.customerName]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:[e.order.coffeeType,", ",e.order.milkType]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-sm font-medium",children:e.fromStation.name}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:[e.fromStation.estimatedWaitTime,"m wait"]})]}),(0,yt.jsx)(As,{size:16,className:"text-purple-600"}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-sm font-medium text-purple-600",children:e.toStation.name}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:[e.toStation.estimatedWaitTime,"m wait"]})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("div",{className:"text-sm font-bold text-green-600",children:["-",e.waitTimeReduction,"m"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"time saved"})]}),(0,yt.jsx)("button",{onClick:()=>x(e),disabled:o,className:"px-3 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700 disabled:opacity-50",children:"Transfer"})]})]},`${e.order.id}-${t}`)))})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold "+(p.needsBalancing?"text-red-600":"text-green-600"),children:p.needsBalancing?(0,yt.jsx)(gs,{size:24,className:"mx-auto"}):(0,yt.jsx)(St,{size:24,className:"mx-auto"})}),(0,yt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:p.needsBalancing?"Needs Balancing":"Well Balanced"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:h.workloadVariance||0}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Workload Variance"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[h.avgWaitTime||0,"m"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Wait Time"})]}),(0,yt.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm text-center",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(h.efficiencyGain||0),"m"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Time Saved Today"})]})]})]})},Ms=()=>{var e,t,s;const{stations:r,updateStation:n}=Xt(),{pendingOrders:i,inProgressOrders:o,completedOrders:l}=Gt(),{settings:c}=Ns(),d={pending:i||[],inProgress:o||[],completed:l||[]},u=(()=>{try{const e=localStorage.getItem("coffee_cue_staff_allocation");if(e){const t=JSON.parse(e);return{timeframe:t.timeframe||"1h",showAdvanced:t.showAdvanced||!1}}}catch(e){console.error("Error loading staff allocation settings:",e)}return{timeframe:"1h",showAdvanced:!1}})(),[m,h]=(0,a.useState)({}),[g,p]=(0,a.useState)([]),[f,x]=(0,a.useState)(u.timeframe),[y,b]=(0,a.useState)(u.showAdvanced);(0,a.useEffect)((()=>{try{const e={timeframe:f,showAdvanced:y};localStorage.setItem("coffee_cue_staff_allocation",JSON.stringify(e)),console.log("Saved staff allocation settings:",e)}catch(e){console.error("Error saving staff allocation settings:",e)}}),[f,y]);const v=(0,a.useCallback)((()=>{const e={},t={"1h":1,"4h":4,"8h":8,"1d":24}[f],s=new Date(Date.now()-60*t*60*1e3);r.forEach((a=>{var r;const n=d.completed.filter((e=>e.station_id===a.id&&new Date(e.completed_at||e.updated_at)>s)),i=n.length,o=n.reduce(((e,t)=>e+(t.total||0)),0),l=n.filter((e=>e.started_at&&e.completed_at)).map((e=>new Date(e.completed_at)-new Date(e.started_at))),c=l.length>0?l.reduce(((e,t)=>e+t),0)/l.length/6e4:0,u=i/t,m=u*(n.reduce(((e,t)=>{let s=1;return t.milk_type&&"none"!==t.milk_type&&(s+=.3),"large"===t.size&&(s+=.2),t.special_instructions&&(s+=.5),e+s}),0)/Math.max(i,1)),h=(null===(r=d.cancelled)||void 0===r?void 0:r.filter((e=>e.station_id===a.id&&new Date(e.updated_at)>s)).length)||0,g=i>0?h/i*100:0,p=d.inProgress.filter((e=>e.station_id===a.id)).length+d.pending.filter((e=>e.station_id===a.id)).length;e[a.id]={stationName:a.name,baristaName:a.current_barista||"Unassigned",totalOrders:i,totalRevenue:o,ordersPerHour:parseFloat(u.toFixed(1)),avgCompletionTime:parseFloat(c.toFixed(1)),efficiencyScore:parseFloat(m.toFixed(2)),errorRate:parseFloat(g.toFixed(1)),currentWorkload:p,status:a.status||"active",capabilities:a.capabilities||{},lastOrderTime:n.length>0?Math.max(...n.map((e=>new Date(e.completed_at||e.updated_at).getTime()))):null}})),h(e)}),[r,null===d||void 0===d||null===(e=d.pending)||void 0===e?void 0:e.length,null===d||void 0===d||null===(t=d.inProgress)||void 0===t?void 0:t.length,null===d||void 0===d||null===(s=d.completed)||void 0===s?void 0:s.length,f]),j=(0,a.useCallback)((()=>{const e=[],t=Object.values(m);if(0===t.length)return;const s=t.reduce(((e,t)=>e+t.currentWorkload),0)/t.length,a=t.filter((e=>e.currentWorkload>1.5*s)),r=t.filter((e=>e.currentWorkload<.5*s&&"active"===e.status));a.forEach((t=>{const a=r.filter((e=>{const s=t.capabilities,a=e.capabilities;return Object.keys(s).every((e=>a[e]))})).sort(((e,t)=>t.efficiencyScore-e.efficiencyScore))[0];a&&e.push({type:"redistribute",from:t.stationName,to:a.stationName,reason:`${t.stationName} has ${t.currentWorkload} orders vs ${a.stationName}'s ${a.currentWorkload}`,impact:`Could reduce wait time by ~${Math.round((t.currentWorkload-a.currentWorkload)*t.avgCompletionTime/4)} minutes`,priority:t.currentWorkload>2*s?"high":"medium"})})),t.forEach((t=>{const a=t.lastOrderTime,r=a?(Date.now()-a)/6e4:0;t.ordersPerHour>1.2*s&&r<30&&t.currentWorkload>3&&e.push({type:"break",station:t.stationName,reason:`High performance (${t.ordersPerHour} orders/hr) but continuous work for ${Math.round(r)} minutes`,impact:"Prevent burnout and maintain quality",priority:"medium"})}));const n=t.reduce(((e,t)=>e+t.currentWorkload),0),i=t.filter((e=>"active"===e.status)).length;n>3*i&&e.push({type:"additional_staff",reason:`High demand: ${n} orders across ${i} stations`,impact:"Could reduce overall wait times significantly",priority:"high"}),p(e)}),[m]);(0,a.useEffect)((()=>{v()}),[v]),(0,a.useEffect)((()=>{j()}),[j]);const w=(0,a.useMemo)((()=>Object.values(m).filter((e=>e.totalOrders>0)).sort(((e,t)=>t.efficiencyScore-e.efficiencyScore)).slice(0,3)),[m]),N=e=>{switch(e){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},k=e=>{switch(e){case"active":return"text-green-600 bg-green-100";case"break":return"text-yellow-600 bg-yellow-100";case"offline":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Dynamic Staff Allocation"}),(0,yt.jsxs)("div",{className:"flex space-x-4",children:[(0,yt.jsxs)("select",{value:f,onChange:e=>x(e.target.value),className:"border rounded-lg px-3 py-2",children:[(0,yt.jsx)("option",{value:"1h",children:"Last Hour"}),(0,yt.jsx)("option",{value:"4h",children:"Last 4 Hours"}),(0,yt.jsx)("option",{value:"8h",children:"Last 8 Hours"}),(0,yt.jsx)("option",{value:"1d",children:"Last Day"})]}),(0,yt.jsxs)("button",{onClick:()=>b(!y),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600",children:[y?"Hide":"Show"," Advanced"]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Top Performers"}),(0,yt.jsx)("div",{className:"space-y-3",children:w.map(((e,t)=>(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"font-medium",children:e.baristaName}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:e.stationName})]}),(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsx)("div",{className:"text-lg font-bold text-green-600",children:e.efficiencyScore}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"efficiency score"})]})]},e.stationName)))})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Current Workload"}),(0,yt.jsx)("div",{className:"space-y-3",children:Object.values(m).map((e=>(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"font-medium",children:e.stationName}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:e.baristaName})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("span",{className:"text-lg font-bold",children:e.currentWorkload}),(0,yt.jsx)("span",{className:`px-2 py-1 rounded-full text-xs ${k(e.status)}`,children:e.status})]})]},e.stationName)))})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Allocation Suggestions"}),(0,yt.jsx)("div",{className:"space-y-3",children:g.slice(0,3).map(((e,t)=>(0,yt.jsxs)("div",{className:`p-3 rounded-lg ${N(e.priority)}`,children:[(0,yt.jsxs)("div",{className:"font-medium text-sm",children:["redistribute"===e.type&&`Move orders: ${e.from} \u2192 ${e.to}`,"break"===e.type&&`Break suggested: ${e.station}`,"additional_staff"===e.type&&"Additional staff needed"]}),(0,yt.jsx)("div",{className:"text-xs mt-1",children:e.impact})]},t)))})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,yt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Station Performance Metrics"})}),(0,yt.jsx)("div",{className:"overflow-x-auto",children:(0,yt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,yt.jsx)("thead",{className:"bg-gray-50",children:(0,yt.jsxs)("tr",{children:[(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Station"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Barista"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Orders/Hr"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Time"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Efficiency"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Error Rate"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Current Load"}),(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),y&&(0,yt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,yt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.values(m).map((e=>(0,yt.jsxs)("tr",{children:[(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.stationName}),(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.baristaName}),(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.ordersPerHour}),(0,yt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.avgCompletionTime,"m"]}),(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,yt.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.efficiencyScore>2?"bg-green-100 text-green-800":e.efficiencyScore>1?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.efficiencyScore})}),(0,yt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.errorRate,"%"]}),(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,yt.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(e.currentWorkload>3?"bg-red-100 text-red-800":e.currentWorkload>1?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.currentWorkload})}),(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,yt.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${k(e.status)}`,children:e.status})}),y&&(0,yt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,yt.jsxs)("select",{value:e.status,onChange:t=>{const s=r.find((t=>t.name===e.stationName));null!==s&&void 0!==s&&s.id&&(async(e,t)=>{try{await n(e,{status:t})}catch(s){console.error("Failed to update station status:",s)}})(s.id,t.target.value)},className:"border rounded px-2 py-1 text-xs",children:[(0,yt.jsx)("option",{value:"active",children:"Active"}),(0,yt.jsx)("option",{value:"break",children:"Break"}),(0,yt.jsx)("option",{value:"offline",children:"Offline"})]})})]},e.stationName)))})]})})]}),g.length>0&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Detailed Allocation Recommendations"})}),(0,yt.jsx)("div",{className:"p-6 space-y-4",children:g.map(((e,t)=>(0,yt.jsx)("div",{className:"p-4 rounded-lg border-l-4 "+("high"===e.priority?"border-red-400 bg-red-50":"medium"===e.priority?"border-yellow-400 bg-yellow-50":"border-green-400 bg-green-50"),children:(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("h4",{className:"font-semibold text-gray-900",children:["redistribute"===e.type&&"Redistribute Orders","break"===e.type&&"Break Recommendation","additional_staff"===e.type&&"Additional Staff Needed"]}),(0,yt.jsx)("p",{className:"text-gray-700 mt-1",children:e.reason}),(0,yt.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Expected Impact: ",e.impact]})]}),(0,yt.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${N(e.priority)}`,children:e.priority})]})},t)))})]})]})},Ps=dt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Ds=dt("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),zs=()=>{var e,t,s,r,n,i,o,l,c,d,u,m;const{stations:h}=Xt(),{settings:g}=Ns(),[p,f]=(0,a.useState)("overview"),[x,y]=(0,a.useState)(null),[b,v]=(0,a.useState)({eventLevel:{},stationLevel:{},predictions:{},alerts:[]}),[j,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)({enabled:!0,threshold:20,orderLeadTime:24}),S=(0,a.useCallback)((async()=>{try{w(!0);const e=localStorage.getItem("authToken")||localStorage.getItem("coffee_system_token"),t=await fetch("/api/inventory/event",{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"}});if(!t.ok)throw new Error("Failed to fetch event inventory");const s=await t.json(),a=h.map((t=>fetch(`/api/inventory?station_id=${t.id}`,{headers:{Authorization:`Bearer ${e}`,Accept:"application/json"}}).then((e=>e.json())))),r=await Promise.all(a),n={};h.forEach(((e,t)=>{n[e.id]={...e,inventory:r[t]}}));const i=C(s,n),o=_(s,n,i);v({eventLevel:s,stationLevel:n,predictions:i,alerts:o})}catch(e){console.error("Error loading inventory data:",e)}finally{w(!1)}}),[h]),C=(e,t)=>{const s={milkConsumption:{},coffeeConsumption:{},stockoutRisk:[],reorderSuggestions:[]};return["Full Cream","Skim","Soy","Almond","Oat"].forEach((e=>{const a=Object.values(t).reduce(((t,s)=>{var a,r;const n=null===(a=s.inventory)||void 0===a||null===(r=a.milk)||void 0===r?void 0:r.find((t=>t.name===e));return t+((null===n||void 0===n?void 0:n.amount)||0)}),0);s.milkConsumption[e]={currentStock:a,predictedConsumption:4,remainingStock:a-4,riskLevel:a-4<2?"high":a-4<5?"medium":"low"},"low"!==s.milkConsumption[e].riskLevel&&s.stockoutRisk.push({item:e,type:"milk",hoursUntilStockout:a/.5,riskLevel:s.milkConsumption[e].riskLevel})})),["House Blend","Single Origin","Decaf"].forEach((e=>{const a=Object.values(t).reduce(((t,s)=>{var a,r;const n=null===(a=s.inventory)||void 0===a||null===(r=a.coffee)||void 0===r?void 0:r.find((t=>t.name===e));return t+((null===n||void 0===n?void 0:n.amount)||0)}),0),r=2.4;s.coffeeConsumption[e]={currentStock:a,predictedConsumption:r,remainingStock:a-r,riskLevel:a-r<1?"high":a-r<2?"medium":"low"}})),s.stockoutRisk.forEach((e=>{"high"===e.riskLevel&&s.reorderSuggestions.push({item:e.item,type:e.type,urgency:"immediate",suggestedAmount:"milk"===e.type?10:5,message:`Urgent: ${e.item} will run out in ${e.hoursUntilStockout.toFixed(1)} hours`})})),s},_=(e,t,s)=>{const a=[];Object.entries(t).forEach((e=>{var t,s;let[r,n]=e;null===(t=n.inventory)||void 0===t||null===(s=t.milk)||void 0===s||s.forEach((e=>{"danger"===e.status?a.push({type:"critical",station:n.name,message:`${e.name} critically low at ${n.name} (${e.amount}${e.unit} remaining)`,action:"restock",itemType:"milk",item:e.name}):"warning"===e.status&&a.push({type:"warning",station:n.name,message:`${e.name} running low at ${n.name} (${e.amount}${e.unit} remaining)`,action:"monitor",itemType:"milk",item:e.name})}))}));const r={};return Object.values(t).forEach((e=>{var t,s;null===(t=e.inventory)||void 0===t||null===(s=t.milk)||void 0===s||s.forEach((t=>{r[t.name]||(r[t.name]=[]),r[t.name].push({station:e.name,amount:t.amount,status:t.status})}))})),Object.entries(r).forEach((e=>{let[t,s]=e;const r=s.map((e=>e.amount)),n=Math.max(...r),i=Math.min(...r);if(n>3*i&&i<2){const e=s.find((e=>e.amount===n)).station,r=s.find((e=>e.amount===i)).station;a.push({type:"info",message:`${t} distribution imbalanced: ${e} has ${n}L while ${r} has only ${i}L`,action:"redistribute",fromStation:e,toStation:r,item:t,suggestedTransfer:Math.floor((n-i)/2)})}})),a};(0,a.useEffect)((()=>{S()}),[S]),(0,a.useEffect)((()=>{const e=setInterval((()=>{S()}),3e4);return()=>clearInterval(e)}),[S]);const E=(0,a.useMemo)((()=>({milk:Object.values(b.stationLevel).reduce(((e,t)=>{var s,a;return e+((null===(s=t.inventory)||void 0===s||null===(a=s.milk)||void 0===a?void 0:a.reduce(((e,t)=>e+t.amount),0))||0)}),0),coffee:Object.values(b.stationLevel).reduce(((e,t)=>{var s,a;return e+((null===(s=t.inventory)||void 0===s||null===(a=s.coffee)||void 0===a?void 0:a.reduce(((e,t)=>e+t.amount),0))||0)}),0),cups:Object.values(b.stationLevel).reduce(((e,t)=>{var s,a;return e+((null===(s=t.inventory)||void 0===s||null===(a=s.cups)||void 0===a?void 0:a.reduce(((e,t)=>e+t.amount),0))||0)}),0)})),[b]),T=e=>{switch(e){case"critical":return(0,yt.jsx)(gs,{className:"text-red-500",size:20});case"warning":return(0,yt.jsx)(Ps,{className:"text-yellow-500",size:20});case"info":return(0,yt.jsx)(Ot,{className:"text-blue-500",size:20});default:return null}};return j?(0,yt.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,yt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Multi-Level Inventory Intelligence"}),(0,yt.jsxs)("div",{className:"flex space-x-4",children:[(0,yt.jsxs)("button",{onClick:()=>S(),className:"flex items-center space-x-2 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600",children:[(0,yt.jsx)(Ot,{size:16}),(0,yt.jsx)("span",{children:"Refresh"})]}),(0,yt.jsxs)("select",{value:p,onChange:e=>f(e.target.value),className:"border rounded-lg px-3 py-2",children:[(0,yt.jsx)("option",{value:"overview",children:"Event Overview"}),(0,yt.jsx)("option",{value:"station",children:"Station View"}),(0,yt.jsx)("option",{value:"predictions",children:"Predictions & Analytics"})]})]})]}),b.alerts.length>0&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Active Alerts"}),(0,yt.jsx)("div",{className:"space-y-2",children:b.alerts.map(((e,t)=>(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border "+("critical"===e.type?"border-red-300 bg-red-50":"warning"===e.type?"border-yellow-300 bg-yellow-50":"border-blue-300 bg-blue-50"),children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[T(e.type),(0,yt.jsx)("span",{className:"text-sm",children:e.message})]}),"redistribute"===e.action&&(0,yt.jsxs)("button",{onClick:()=>(async e=>{try{console.log("Redistributing:",e),await new Promise((e=>setTimeout(e,1e3))),await S()}catch(t){console.error("Redistribution failed:",t)}})(e),className:"text-sm bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:["Redistribute ",e.suggestedTransfer,"L"]}),"restock"===e.action&&(0,yt.jsx)("button",{onClick:()=>(async(e,t,s)=>{try{if(!(await fetch("/api/inventory/emergency-restock",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("coffee_system_token")}`},body:JSON.stringify({item:e,type:t,amount:s,priority:"urgent"})})).ok)throw new Error("Restock request failed");await S()}catch(a){console.error("Emergency restock failed:",a)}})(e.item,e.itemType,10),className:"text-sm bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",children:"Emergency Restock"})]},t)))})]}),"overview"===p&&(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Total Milk Stock"}),(0,yt.jsx)(At,{className:"text-blue-500",size:24})]}),(0,yt.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:[E.milk.toFixed(1),"L"]}),(0,yt.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Across ",Object.keys(b.stationLevel).length," stations"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Total Coffee Stock"}),(0,yt.jsx)(ht,{className:"text-brown-500",size:24})]}),(0,yt.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:[E.coffee.toFixed(1),"kg"]}),(0,yt.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:[(null===(e=b.predictions)||void 0===e||null===(t=e.stockoutRisk)||void 0===t?void 0:t.filter((e=>"coffee"===e.type)).length)||0," items at risk"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Total Cups"}),(0,yt.jsx)(At,{className:"text-green-500",size:24})]}),(0,yt.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:E.cups}),(0,yt.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:"All sizes combined"})]})]}),"station"===p&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsxs)("select",{value:(null===x||void 0===x?void 0:x.id)||"",onChange:e=>y(b.stationLevel[e.target.value]),className:"w-full border rounded-lg px-3 py-2",children:[(0,yt.jsx)("option",{value:"",children:"Select a station..."}),Object.values(b.stationLevel).map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name},e.id)))]})}),x&&(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("h3",{className:"text-xl font-semibold mb-4",children:[x.name," Inventory"]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Milk Stock"}),(0,yt.jsx)("div",{className:"space-y-2",children:null===(s=x.inventory)||void 0===s||null===(r=s.milk)||void 0===r?void 0:r.map((e=>(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"font-medium",children:e.name}),(0,yt.jsx)("span",{className:"ml-2 text-xs px-2 py-1 rounded "+("good"===e.status?"bg-green-100 text-green-700":"warning"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:e.status})]}),(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsxs)("div",{className:"font-bold",children:[e.amount,e.unit]}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:["of ",e.capacity,e.unit]})]})]},e.id)))})]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Coffee Stock"}),(0,yt.jsx)("div",{className:"space-y-2",children:null===(n=x.inventory)||void 0===n||null===(i=n.coffee)||void 0===i?void 0:i.map((e=>(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"font-medium",children:e.name}),(0,yt.jsx)("span",{className:"ml-2 text-xs px-2 py-1 rounded "+("good"===e.status?"bg-green-100 text-green-700":"warning"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:e.status})]}),(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsxs)("div",{className:"font-bold",children:[e.amount,e.unit]}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:["of ",e.capacity,e.unit]})]})]},e.id)))})]})]})]}),"predictions"===p&&(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Consumption Predictions"}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Milk Consumption Forecast"}),(0,yt.jsx)("div",{className:"space-y-3",children:Object.entries((null===(o=b.predictions)||void 0===o?void 0:o.milkConsumption)||{}).map((e=>{let[t,s]=e;return(0,yt.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,yt.jsx)("span",{className:"font-medium",children:t}),(0,yt.jsxs)("span",{className:"text-xs px-2 py-1 rounded "+("high"===s.riskLevel?"bg-red-100 text-red-700":"medium"===s.riskLevel?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:[s.riskLevel," risk"]})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Current: ",s.currentStock.toFixed(1),"L | Predicted use: ",s.predictedConsumption.toFixed(1),"L | Remaining: ",s.remainingStock.toFixed(1),"L"]}),(0,yt.jsx)("div",{className:"mt-2 bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"h-2 "+("high"===s.riskLevel?"bg-red-500":"medium"===s.riskLevel?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.max(0,Math.min(100,s.remainingStock/s.currentStock*100))}%`}})})]},t)}))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Reorder Suggestions"}),(0,yt.jsxs)("div",{className:"space-y-3",children:[null===(l=b.predictions)||void 0===l||null===(c=l.reorderSuggestions)||void 0===c?void 0:c.map(((e,t)=>(0,yt.jsxs)("div",{className:"border border-red-300 bg-red-50 rounded-lg p-3",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,yt.jsx)(Ds,{className:"text-red-500",size:20}),(0,yt.jsx)("span",{className:"font-medium text-red-700",children:e.urgency.toUpperCase()})]}),(0,yt.jsx)("div",{className:"text-sm",children:e.message}),(0,yt.jsx)("div",{className:"mt-2",children:(0,yt.jsxs)("button",{className:"text-sm bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",children:["Order ",e.suggestedAmount,"milk"===e.type?"L":"kg"," now"]})})]},t))),(!(null!==(d=b.predictions)&&void 0!==d&&d.reorderSuggestions)||0===(null===(u=b.predictions)||void 0===u||null===(m=u.reorderSuggestions)||void 0===m?void 0:m.length))&&(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(At,{size:48,className:"mx-auto mb-2 text-gray-400"}),(0,yt.jsx)("p",{children:"No urgent reorders needed"})]})]})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Auto-Restock Settings"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("input",{type:"checkbox",checked:N.enabled,onChange:e=>k({...N,enabled:e.target.checked}),className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Enable automatic restock orders"})]}),N.enabled&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Restock when stock falls below:"}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"range",min:"10",max:"50",value:N.threshold,onChange:e=>k({...N,threshold:parseInt(e.target.value)}),className:"flex-1"}),(0,yt.jsxs)("span",{className:"w-12 text-right",children:[N.threshold,"%"]})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Order lead time:"}),(0,yt.jsxs)("select",{value:N.orderLeadTime,onChange:e=>k({...N,orderLeadTime:parseInt(e.target.value)}),className:"border rounded px-3 py-1",children:[(0,yt.jsx)("option",{value:"12",children:"12 hours"}),(0,yt.jsx)("option",{value:"24",children:"24 hours"}),(0,yt.jsx)("option",{value:"48",children:"48 hours"}),(0,yt.jsx)("option",{value:"72",children:"72 hours"})]})]})]})]})]})]})]})},Ls=dt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Rs=dt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Fs=()=>{const{stations:e,updateStation:t}=Xt(),{pendingOrders:s,inProgressOrders:r,completedOrders:n}=Gt(),{settings:i}=Ns(),o={pending:s||[],inProgress:r||[],completed:n||[]},l=(()=>{try{const e=localStorage.getItem("coffee_cue_enhanced_capabilities");if(e){const t=JSON.parse(e);return{baristaProfiles:t.baristaProfiles||{},skillRoutingEnabled:void 0===t.skillRoutingEnabled||t.skillRoutingEnabled}}}catch(e){console.error("Error loading enhanced capabilities settings:",e)}return{baristaProfiles:{},skillRoutingEnabled:!0}})(),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(l.baristaProfiles),[h,g]=(0,a.useState)(null),[p,f]=(0,a.useState)(l.skillRoutingEnabled);(0,a.useEffect)((()=>{try{const e={baristaProfiles:u,skillRoutingEnabled:p};localStorage.setItem("coffee_cue_enhanced_capabilities",JSON.stringify(e)),console.log("Saved enhanced capabilities settings:",e)}catch(e){console.error("Error saving enhanced capabilities settings:",e)}}),[u,p]);const x={novice:{label:"Novice",color:"bg-gray-100 text-gray-700",borderColor:"border-gray-300",allowedDrinks:["espresso","long_black","cappuccino"],maxConcurrentOrders:3,complexityLimit:"simple",supportMode:"detailed_instructions",description:"Basic drinks only, detailed guidance provided"},experienced:{label:"Experienced",color:"bg-blue-100 text-blue-700",borderColor:"border-blue-300",allowedDrinks:["all_standard_drinks"],maxConcurrentOrders:5,complexityLimit:"standard",supportMode:"normal",description:"All standard drinks, normal workflow"},expert:{label:"Expert",color:"bg-purple-100 text-purple-700",borderColor:"border-purple-300",allowedDrinks:["all_drinks"],maxConcurrentOrders:8,complexityLimit:"complex",supportMode:"minimal",customSkills:["latte_art","custom_recipes"],description:"All drinks including custom orders, minimal guidance"},specialist:{label:"Specialist",color:"bg-green-100 text-green-700",borderColor:"border-green-300",allowedDrinks:["all_drinks"],maxConcurrentOrders:6,complexityLimit:"complex",supportMode:"normal",specializations:["alternative_milk_expert","batch_processing","vip_service"],description:"Specialized in specific areas with deep expertise"}};(0,a.useEffect)((()=>{y()}),[]);const y=async()=>{try{const e=await fetch("/api/barista-profiles",{headers:{Authorization:`Bearer ${localStorage.getItem("coffee_system_token")}`,Accept:"application/json"}});if(e.ok){const t=await e.json();m(t)}else{const e=localStorage.getItem("barista_profiles");e&&m(JSON.parse(e))}}catch(t){console.error("Error loading barista profiles:",t);const s={};e.forEach((e=>{e.current_barista&&(s[e.current_barista]={name:e.current_barista,skillLevel:"experienced",specializations:[],statistics:{totalOrders:0,avgCompletionTime:0,errorRate:0,customerRating:0}})})),m(s)}},b=async(e,t)=>{const s={...u,[e]:{...u[e],...t}};m(s),localStorage.setItem("barista_profiles",JSON.stringify(s));try{await fetch(`/api/barista-profiles/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("coffee_system_token")}`},body:JSON.stringify(s[e])})}catch(a){console.error("Error saving barista profile:",a)}},v=e=>{const t=u[e.current_barista];if(!t)return 1;return{novice:.7,experienced:1,expert:1.3,specialist:1.2}[t.skillLevel]||1};return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Enhanced Station Capabilities"}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:p,onChange:e=>f(e.target.checked),className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Enable Skill-Based Routing"})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Barista Skill Levels"}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Object.entries(x).map((e=>{let[t,s]=e;return(0,yt.jsxs)("div",{className:`p-3 rounded-lg border ${s.borderColor}`,children:[(0,yt.jsx)("div",{className:`inline-block px-2 py-1 rounded text-sm font-medium ${s.color} mb-2`,children:s.label}),(0,yt.jsx)("p",{className:"text-xs text-gray-600",children:s.description}),(0,yt.jsxs)("div",{className:"mt-2 text-xs",children:[(0,yt.jsx)("span",{className:"font-medium",children:"Max Orders:"})," ",s.maxConcurrentOrders]})]},t)}))})]}),(0,yt.jsx)("div",{className:"space-y-4",children:e.map((e=>{var s,a,r,n,i,l,c,d,m;const f=u[e.current_barista],y=f?x[f.skillLevel]:null,j=v(e),w=p?(e=>{const t=u[e.current_barista];if(!t)return[];const s=x[t.skillLevel];return s?o.pending.filter((e=>{var a,r;if((e.alternativeMilk||e.customizations||e.specialInstructions)&&"simple"===s.complexityLimit)return!1;if("all_drinks"!==s.allowedDrinks[0]&&"all_standard_drinks"!==s.allowedDrinks[0]){var n;const t=null===(n=e.coffeeType)||void 0===n?void 0:n.toLowerCase().replace(" ","_");if(!s.allowedDrinks.includes(t))return!1}return null!==(a=t.specializations)&&void 0!==a&&a.includes("alternative_milk_expert")&&e.alternativeMilk||null!==(r=t.specializations)&&void 0!==r&&r.includes("vip_service")&&(e.vip||e.priority),!0})).slice(0,s.maxConcurrentOrders):[]})(e):[],N=h===e.id;return(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),(0,yt.jsxs)("p",{className:"text-sm text-gray-500",children:["Station #",e.id]})]}),(0,yt.jsx)("button",{onClick:()=>{return t=e.id,void g(h===t?null:t);var t},className:"text-gray-500 hover:text-gray-700",children:N?(0,yt.jsx)(Ls,{size:20}):(0,yt.jsx)(It,{size:20})})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsx)(mt,{size:20,className:"text-gray-400"}),(0,yt.jsx)("div",{className:"flex-1",children:(0,yt.jsx)("input",{type:"text",value:e.current_barista||"",onChange:s=>(async(e,s,a)=>{try{var r;u[s]||await b(s,{name:s,skillLevel:a||"experienced",specializations:[],statistics:{totalOrders:0,avgCompletionTime:0,errorRate:0,customerRating:0}}),await t(e,{current_barista:s,barista_skill_level:a||(null===(r=u[s])||void 0===r?void 0:r.skillLevel)||"experienced"})}catch(n){console.error("Error assigning barista:",n)}})(e.id,s.target.value),placeholder:"Assign barista...",className:"w-full border rounded px-3 py-1 text-sm"})}),f&&(0,yt.jsx)("select",{value:f.skillLevel,onChange:t=>b(e.current_barista,{skillLevel:t.target.value}),className:`border rounded px-3 py-1 text-sm ${null===y||void 0===y?void 0:y.borderColor}`,children:Object.entries(x).map((e=>{let[t,s]=e;return(0,yt.jsx)("option",{value:t,children:s.label},t)}))})]}),f&&(0,yt.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm",children:[(0,yt.jsx)("span",{className:`px-2 py-1 rounded ${null===y||void 0===y?void 0:y.color}`,children:null===y||void 0===y?void 0:y.label}),(0,yt.jsxs)("span",{className:"text-gray-500",children:["Efficiency: ",(100*j).toFixed(0),"%"]}),(0,yt.jsxs)("span",{className:"text-gray-500",children:["Max Orders: ",null===y||void 0===y?void 0:y.maxConcurrentOrders]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)(ht,{size:16,className:"text-gray-400"}),(0,yt.jsx)("span",{className:"text-sm",children:null!==(s=e.capabilities)&&void 0!==s&&s.standard_coffee?"Standard Coffee":"No Coffee"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)(ht,{size:16,className:"text-gray-400"}),(0,yt.jsx)("span",{className:"text-sm",children:null!==(a=e.capabilities)&&void 0!==a&&a.alternative_milk?"Alt Milk":"No Alt Milk"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)(Rs,{size:16,className:"text-gray-400"}),(0,yt.jsx)("span",{className:"text-sm",children:null!==(r=e.capabilities)&&void 0!==r&&r.high_volume?"High Volume":"Normal Volume"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)(Rt,{size:16,className:"text-gray-400"}),(0,yt.jsx)("span",{className:"text-sm",children:e.status||"Active"})]})]}),p&&w.length>0&&(0,yt.jsxs)("div",{className:"border-t pt-4",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommended Orders (based on skill level)"}),(0,yt.jsx)("div",{className:"space-y-2",children:w.slice(0,3).map((e=>(0,yt.jsxs)("div",{className:"flex items-center justify-between text-sm bg-gray-50 p-2 rounded",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("span",{className:"font-medium",children:["#",e.orderNumber]})," -",e.coffeeType,", ",e.milkType,e.alternativeMilk&&(0,yt.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-700 px-1 rounded",children:"Alt Milk"}),(e.vip||e.priority)&&(0,yt.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-700 px-1 rounded",children:"VIP"})]}),(0,yt.jsx)("button",{className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",onClick:()=>console.log("Assign order to station"),children:"Assign"})]},e.id)))})]}),N&&(0,yt.jsxs)("div",{className:"border-t pt-4 mt-4 space-y-4",children:[f&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Barista Performance"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,yt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Total Orders"}),(0,yt.jsx)("div",{className:"text-lg font-bold",children:(null===(n=f.statistics)||void 0===n?void 0:n.totalOrders)||0})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Avg Time"}),(0,yt.jsxs)("div",{className:"text-lg font-bold",children:[(null===(i=f.statistics)||void 0===i?void 0:i.avgCompletionTime)||0,"m"]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Error Rate"}),(0,yt.jsxs)("div",{className:"text-lg font-bold",children:[(null===(l=f.statistics)||void 0===l?void 0:l.errorRate)||0,"%"]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Rating"}),(0,yt.jsx)("div",{className:"text-lg font-bold",children:(null===(c=f.statistics)||void 0===c?void 0:c.customerRating)||"N/A"})]})]})]}),f&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Specializations"}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:(null===(d=x[f.skillLevel])||void 0===d||null===(m=d.specializations)||void 0===m?void 0:m.map((e=>(0,yt.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase()))},e))))||(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"No specializations"})})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Advanced Settings"}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.auto_accept_orders||!1,onChange:s=>t(e.id,{auto_accept_orders:s.target.checked}),className:"h-4 w-4"}),(0,yt.jsx)("span",{className:"text-sm",children:"Auto-accept suitable orders"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.training_mode||!1,onChange:s=>t(e.id,{training_mode:s.target.checked}),className:"h-4 w-4"}),(0,yt.jsx)("span",{className:"text-sm",children:"Training mode (slower, more guidance)"})]})]})]})]})]})},e.id)}))}),p&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Skill-Based Routing Overview"}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsx)("h4",{className:"font-medium mb-2",children:"Order Distribution"}),(0,yt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Simple Orders:"}),(0,yt.jsx)("span",{className:"font-medium",children:o.pending.filter((e=>!e.alternativeMilk&&!e.customizations)).length})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Complex Orders:"}),(0,yt.jsx)("span",{className:"font-medium",children:o.pending.filter((e=>e.alternativeMilk||e.customizations)).length})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"VIP Orders:"}),(0,yt.jsx)("span",{className:"font-medium",children:o.pending.filter((e=>e.vip||e.priority)).length})]})]})]}),(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsx)("h4",{className:"font-medium mb-2",children:"Barista Availability"}),(0,yt.jsx)("div",{className:"space-y-2 text-sm",children:Object.entries(x).map((e=>{let[t,s]=e;const a=Object.values(u).filter((e=>e.skillLevel===t)).length;return(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsxs)("span",{children:[s.label,":"]}),(0,yt.jsx)("span",{className:"font-medium",children:a})]},t)}))})]}),(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsx)("h4",{className:"font-medium mb-2",children:"Routing Efficiency"}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:[(e.reduce(((e,t)=>e+v(t)),0)/e.length*100).toFixed(0),"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:"Average Station Efficiency"})]})]})]})]})]})},Us=()=>{var e,t;const{isDemoMode:s,toggleAppMode:r}=(0,Ut.q)(),{stations:n,selectedStation:i,loading:o,changeSelectedStation:l,updateStation:c,refreshData:d}=Xt(),[u,m]=(0,a.useState)(!1),{scheduleData:h,loading:g,error:p,setStation:f,refreshData:x}=function(){const e={shifts:[],breaks:[],rushPeriods:[]},[t,s]=(0,a.useState)(e),[r,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[l,c]=(0,a.useState)(Date.now()),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),{isDemoMode:g}=(0,Ut.q)();(0,a.useEffect)((()=>{localStorage.removeItem("coffee_cue_schedule"),Object.keys(localStorage).forEach((e=>{e.includes("demo_")&&localStorage.removeItem(e)})),localStorage.setItem("coffee_cue_schedule",JSON.stringify(e)),console.log("Legacy schedule data cleared on hook init")}),[]);const p=(0,a.useCallback)((async function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?u(!0):n(!0);try{let t;if(console.log("Loading schedule data for station:",m),m?(console.log(`Fetching schedule data for station ID: ${m}`),t=await es.getTodaySchedule(m)):(console.log("No station ID provided, fetching all schedules"),t=await es.getTodaySchedule()),console.log("Schedule response:",t),t&&t.success){const e=JSON.parse(localStorage.getItem("coffee_cue_hidden_demo_items")||"[]");console.log("Hidden demo items:",e);const a={shifts:t.schedules?t.schedules.filter((t=>!t.isDemoData||!e.includes(t.id))):[],breaks:[],rushPeriods:[]};console.log("Formatted schedule data (after filtering demo items):",a),s(a)}else console.log("No valid schedule data found, using empty data"),s(e);c(Date.now()),o(null)}catch(t){console.error("Error loading schedule:",t),o(`Failed to load schedule: ${t.message}`),s(e)}finally{n(!1),u(!1)}}),[e,m]),f=(0,a.useCallback)((async(e,a)=>{try{const r=t.shifts.map((t=>t.id===e?{...t,status:a}:t));return s((e=>({...e,shifts:r}))),c(Date.now()),!0}catch(r){return console.error("Error updating shift status:",r),o(`Failed to update shift status: ${r.message}`),!1}}),[t]),x=(0,a.useCallback)((async e=>{try{const t={...e,id:Date.now(),status:"upcoming"};return s((e=>({...e,shifts:[...e.shifts,t]}))),t}catch(t){return console.error("Error adding shift:",t),o(`Failed to add shift: ${t.message}`),null}}),[]),y=(0,a.useCallback)((async e=>{try{return s((t=>{const s=t.shifts.find((t=>t.id===e));if(s&&s.isDemoData){const t=JSON.parse(localStorage.getItem("coffee_cue_hidden_demo_items")||"[]");t.includes(e)||(t.push(e),localStorage.setItem("coffee_cue_hidden_demo_items",JSON.stringify(t)),console.log(`Marked demo shift ${e} as hidden permanently`))}return{...t,shifts:t.shifts.filter((t=>t.id!==e))}})),c(Date.now()),!0}catch(t){return console.error("Error removing shift:",t),o(`Failed to remove shift: ${t.message}`),!1}}),[]),b=(0,a.useCallback)((async e=>{try{const t={...e,id:Date.now(),status:"upcoming"};return s((e=>({...e,breaks:[...e.breaks,t]}))),t}catch(t){return console.error("Error adding break:",t),o(`Failed to add break: ${t.message}`),null}}),[]),v=(0,a.useCallback)((async e=>{try{return s((t=>{const s=t.breaks.find((t=>t.id===e));if(s&&s.isDemoData){const t=JSON.parse(localStorage.getItem("coffee_cue_hidden_demo_items")||"[]");t.includes(e)||(t.push(e),localStorage.setItem("coffee_cue_hidden_demo_items",JSON.stringify(t)),console.log(`Marked demo break ${e} as hidden permanently`))}return{...t,breaks:t.breaks.filter((t=>t.id!==e))}})),c(Date.now()),!0}catch(t){return console.error("Error removing break:",t),o(`Failed to remove break: ${t.message}`),!1}}),[]),j=(0,a.useCallback)((async e=>{try{const t={...e,id:Date.now()};return s((e=>({...e,rushPeriods:[...e.rushPeriods,t]}))),t}catch(t){return console.error("Error adding rush period:",t),o(`Failed to add rush period: ${t.message}`),null}}),[]),w=(0,a.useCallback)((e=>{h(e),p(!0)}),[p]),N=(0,a.useCallback)((()=>null),[]),k=(0,a.useCallback)((()=>{u(!0),p(!0)}),[]);return(0,a.useEffect)((()=>{p()}),[g]),{scheduleData:t,stationId:m,loading:r,error:i,lastUpdated:l,isRefreshing:d,updateShiftStatus:f,addShift:x,removeShift:y,addBreak:b,removeBreak:v,addRushPeriod:j,setStation:w,getCurrentBarista:N,refreshData:k,clearError:()=>o(null)}}(),{pendingOrders:y,inProgressOrders:b,completedOrders:v,previousOrders:j,historyOrders:w,yesterdayOrders:N,thisWeekOrders:k,searchResults:S,vipOrders:C,regularOrders:_,batchGroups:E,queueCount:T,online:I,loading:O,error:A,lastUpdated:$,isRefreshing:M,autoRefreshEnabled:P,autoRefreshInterval:D,toggleAutoRefresh:z,updateAutoRefreshInterval:L,startOrder:R,completeOrder:F,markOrderPickedUp:U,processBatch:B,processBatchSelection:W,addWalkInOrder:q,sendMessage:H,updateWaitTime:J,clearError:V,refreshData:G,fetchYesterdayOrders:Q,fetchThisWeekOrders:Y,searchOrders:K,getOrderHistory:X}=Gt(i),[Z,ee]=(0,a.useState)((()=>{try{const e=localStorage.getItem("coffee_cue_active_tab");if(e)return e}catch(A){console.error("Error loading active tab from localStorage:",A)}return"orders"})()),te=e=>{ee(e);try{localStorage.setItem("coffee_cue_active_tab",e),console.log("Saved active tab to localStorage:",e)}catch(A){console.error("Error saving active tab to localStorage:",A)}},[se,ae]=(0,a.useState)((()=>{try{const e=localStorage.getItem("dismissed_info_panels");return e?JSON.parse(e):{stockInfoPanel:!1,scheduleInfoPanel:!1,historyInfoPanel:!1,displayInfoPanel:!1}}catch(bn){return console.error("Error loading dismissed panels state:",bn),{stockInfoPanel:!1,scheduleInfoPanel:!1,historyInfoPanel:!1,displayInfoPanel:!1}}})),re=(0,a.useCallback)((e=>{ae((t=>{const s={...t,[e]:!0};return localStorage.setItem("dismissed_info_panels",JSON.stringify(s)),s}))}),[]),ne=(0,a.useCallback)((()=>{const e={stockInfoPanel:!1,scheduleInfoPanel:!1,historyInfoPanel:!1,displayInfoPanel:!1};ae(e),localStorage.setItem("dismissed_info_panels",JSON.stringify(e)),Le("All information panels have been restored")}),[]);(0,a.useEffect)((()=>{console.log("Initializing inventory integration service for BaristaInterface"),ts.A.initializeStockServiceIntegration()}),[]),(0,a.useEffect)((()=>{console.log(`Tab changed to: ${Z}`),i&&(localStorage.setItem("coffee_cue_selected_station",i.toString()),localStorage.setItem("last_used_station_id",i.toString())),"in-progress"===Z&&(console.log(`Switched to in-progress tab - refreshing data for station ${i}`),setTimeout((()=>{G()}),50))}),[Z,G,i]);const[ie,oe]=(0,a.useState)("completed"),[le,ce]=(0,a.useState)(null),[de,ue]=(0,a.useState)(""),[me,he]=(0,a.useState)(!1),[ge,pe]=(0,a.useState)(2),[fe,xe]=(0,a.useState)(new Set),[ye,be]=(0,a.useState)(!1),[ve,je]=(0,a.useState)(2),[we,Ne]=(0,a.useState)("all"),ke=(0,a.useRef)(null);(0,a.useEffect)((()=>{if(!i||!n.length)return;if(ke.current===i)return;console.log(`Syncing settings for station ${i}`);const e=n.find((e=>e.id===i));if(e){ke.current=i;const t=tt(i);let s=e.name;try{const e=localStorage.getItem(`coffee_station_name_${i}`);e&&(console.log(`Using custom name from localStorage for station ${i}: ${e}`),s=e)}catch(bn){console.error(`Error getting custom name for station ${i}:`,bn)}rt((a=>({...a,stationName:s,stationLocation:e.location||"",baristaName:t}))),cs.initialize(i,s,t),setTimeout((()=>{console.log(`Force syncing inventory for station ${i}`),ts.A.forceSyncStation(i)}),100),f(i)}}),[i,n,f]);const[Se,Ce]=(0,a.useState)(!1),[_e,Ee]=(0,a.useState)(!1),[Te,Ie]=(0,a.useState)(!1),[Oe,Ae]=(0,a.useState)(null),[$e,Me]=(0,a.useState)(!1),[Pe,De]=(0,a.useState)({}),[ze,Le]=(0,a.useState)(""),[Re,Fe]=(0,a.useState)(!1),{stockItems:Ue,stockCategories:Be,loading:We,error:qe,getCategoryStock:He,updateStockItem:Je,addStockItem:Ve,deleteStockItem:Ge,resetStock:Qe,getLowStockCount:Ye}=Zt(i,(null===(e=n.find((e=>e.id===i)))||void 0===e?void 0:e.name)||"Coffee Station"),[Ke,Xe]=(0,a.useState)("milk"),{lowCount:Ze,criticalCount:et}=Ye();(0,a.useEffect)((()=>{console.log("BaristaInterface mounted - initializing inventory integration"),ts.A.initializeStockServiceIntegration()}),[]);const tt=e=>{try{const t="string"===typeof e?parseInt(e,10):e,s=localStorage.getItem(`coffee_barista_name_station_${t}`);if(s)return s;const a=n.find((e=>e.id===t));return`Barista (${a?a.name:`Station ${t}`})`}catch(A){return console.error("Error getting station barista name:",A),"Barista"}},[st,at]=(0,a.useState)((()=>{var e,t;try{const e=localStorage.getItem("coffee_cue_barista_settings");if(e&&"undefined"!==e&&"null"!==e){var s,a;const t=JSON.parse(e);return{displayMode:t.displayMode||"landscape",soundEnabled:void 0===t.soundEnabled||t.soundEnabled,soundNewOrder:void 0===t.soundNewOrder||t.soundNewOrder,soundOrderComplete:void 0===t.soundOrderComplete||t.soundOrderComplete,soundOrderPickedUp:void 0===t.soundOrderPickedUp||t.soundOrderPickedUp,soundLowStock:void 0===t.soundLowStock||t.soundLowStock,soundError:void 0===t.soundError||t.soundError,soundVolume:t.soundVolume||50,autoPrintLabels:t.autoPrintLabels||!1,stationName:t.stationName||(null===(s=n.find((e=>e.id===i)))||void 0===s?void 0:s.name)||"Coffee Station",stationLocation:t.stationLocation||(null===(a=n.find((e=>e.id===i)))||void 0===a?void 0:a.location)||"",baristaName:t.baristaName||tt(i),batchSuggestions:void 0===t.batchSuggestions||t.batchSuggestions,waitTimeWarning:t.waitTimeWarning||10,displayTimeout:t.displayTimeout||5,autoSendSmsOnComplete:void 0===t.autoSendSmsOnComplete||t.autoSendSmsOnComplete,remindAfterDelay:void 0===t.remindAfterDelay||t.remindAfterDelay,reminderDelay:t.reminderDelay||30,showNameOnDisplay:void 0===t.showNameOnDisplay||t.showNameOnDisplay,demoMode:t.demoMode||!1}}}catch(A){console.error("Error loading settings from localStorage:",A)}return{displayMode:"landscape",soundEnabled:!0,soundNewOrder:!0,soundOrderComplete:!0,soundOrderPickedUp:!0,soundLowStock:!0,soundError:!0,soundVolume:50,autoPrintLabels:!1,stationName:(null===(e=n.find((e=>e.id===i)))||void 0===e?void 0:e.name)||"Coffee Station",stationLocation:(null===(t=n.find((e=>e.id===i)))||void 0===t?void 0:t.location)||"",baristaName:tt(i),batchSuggestions:!0,waitTimeWarning:10,displayTimeout:5,autoSendSmsOnComplete:!0,remindAfterDelay:!0,reminderDelay:30,showNameOnDisplay:!0,demoMode:!1}})()),rt=e=>{at(e);try{localStorage.setItem("coffee_cue_barista_settings",JSON.stringify(e)),console.log("Saved settings to localStorage:",e)}catch(A){console.error("Error saving settings to localStorage:",A)}},nt=js({onSendMessage:(e,t)=>it(e,t),onUpdateSettings:e=>{rt({...st,...e})}});(0,a.useEffect)((()=>{}),[]),(0,a.useEffect)((()=>{ls.updateSettings({autoSendSmsOnComplete:st.autoSendSmsOnComplete,remindAfterDelay:st.remindAfterDelay,reminderDelay:st.reminderDelay,showNameOnDisplay:st.showNameOnDisplay,displayDuration:60*st.displayTimeout})}),[]),(0,a.useEffect)((()=>{i&&"function"===typeof f&&(console.log("Synchronizing schedule station with selected station:",i),f(i))}),[i]),(0,a.useEffect)((()=>{const e=new URLSearchParams(window.location.search);e.has("from")&&"organiser"===e.get("from")&&(console.log("Detected navigation from organiser via URL parameter"),setTimeout((()=>{if(G(),console.log("Forced order refresh after organiser navigation"),window.history&&window.history.replaceState){const e=window.location.pathname;window.history.replaceState({},document.title,e)}}),100));"true"===sessionStorage.getItem("force_orders_refresh")&&(console.log("Detected return from organiser via sessionStorage flag"),sessionStorage.removeItem("force_orders_refresh"),G())}),[]);const it=async(e,t)=>{try{const s=b.find((t=>t.id===e))||v.find((t=>t.id===e))||y.find((t=>t.id===e))||e;De((t=>({...t,[e]:{status:"sending",timestamp:new Date}})));const a=await ls.sendMessage(s,t);return a.success?(De((t=>({...t,[e]:{status:"sent",timestamp:new Date}}))),{success:!0}):(De((t=>({...t,[e]:{status:"failed",error:a.error,timestamp:new Date}}))),{success:!1,error:a.error})}catch(s){return console.error("Message send error:",s),De((t=>({...t,[e]:{status:"failed",error:s.message,timestamp:new Date}}))),{success:!1,error:s.message}}},ot=e=>{Ae(e),Ie(!0)},lt=()=>{window.open(`/display?station=${i}`,"_blank")},ct=e=>{var t;const s="sent"===(null===(t=Pe[e.id])||void 0===t?void 0:t.status);return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"text-sm text-gray-500",children:["Order #",e.id]}),(0,yt.jsxs)("div",{className:"text-xl font-bold mt-1 flex items-center",children:[e.customerName,s&&(0,yt.jsx)("span",{className:"ml-1 text-green-500",title:"Message sent",children:(0,yt.jsx)(St,{size:16})})]}),(0,yt.jsx)("div",{className:"text-gray-700",children:e.phoneNumber})]}),(0,yt.jsxs)("div",{className:"flex flex-col items-end",children:[e.priority&&(0,yt.jsx)("div",{className:"bg-red-100 text-red-700 px-2 py-1 rounded text-sm font-medium",children:"PRIORITY"}),(0,yt.jsx)("button",{className:"mt-2 text-gray-500 hover:text-gray-700",onClick:()=>{alert(`Edit order #${e.id}`)},children:(0,yt.jsx)(Ct,{size:16})})]})]}),(0,yt.jsxs)("div",{className:"mt-4 bg-gray-100 p-3 rounded-lg",children:[(0,yt.jsx)("div",{className:"text-xl font-bold",children:e.coffeeType||"Coffee"}),(0,yt.jsxs)("div",{className:"text-gray-700",children:[e.milkType||"Regular milk",", ",e.sugar||"No sugar"]}),e.extraHot&&(0,yt.jsx)("div",{className:"text-gray-700",children:"Extra hot"}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"mt-1",children:(0,yt.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded",children:"Alternative Milk"})})]}),(0,yt.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,yt.jsxs)("button",{className:"flex-1 bg-gray-200 py-2 rounded flex items-center justify-center space-x-1 hover:bg-gray-300",onClick:()=>ot(e),children:[(0,yt.jsx)(_t,{size:18}),(0,yt.jsx)("span",{children:"Message Customer"})]}),(0,yt.jsxs)("button",{className:"flex-1 bg-gray-200 py-2 rounded flex items-center justify-center space-x-1 hover:bg-gray-300",onClick:()=>{console.log(`Printing label for order #${e.id}`),alert(`Printing label for ${e.coffeeType||"Coffee"}`)},children:[(0,yt.jsx)(Et,{size:18}),(0,yt.jsx)("span",{children:"Print Label"})]})]}),(0,yt.jsx)("button",{className:"mt-3 w-full bg-green-500 text-white py-3 rounded-lg font-bold text-lg hover:bg-green-600",onClick:()=>(async e=>{try{console.log("Starting order completion process for order:",e);const r=b.find((t=>t.id===e));if(!r)return console.error("Could not find order in inProgressOrders array:",e),alert("Error: Could not find the order details. Please try again."),!1;const o=n.find((e=>e.id===i)),l={...r,stationName:o?o.name:st.stationName};console.log("Prepared order object for notification:",l);const c=await F(e);if(console.log("Complete order API result:",c),c&&(!0===c.success||!Object.prototype.hasOwnProperty.call(c,"success"))){console.log("Order marked as complete in backend. Sending notification...");let r=!1,n=null;try{await nt.completeWithNotification(l),console.log("Primary notification sent successfully for order:",e),r=!0}catch(t){console.error("Primary notification failed:",t),n=t;try{const t=await ls.sendReadyNotification(l);if(console.log("MessageService notification result:",t),t&&t.success)console.log("MessageService notification sent successfully for order:",e),r=!0;else{console.log("MessageService failed, falling back to OrderDataService");const s=await Bt.A.sendReadyNotification(l);if(console.log("OrderDataService notification result:",s),!s||!s.success)throw new Error((null===s||void 0===s?void 0:s.error)||(null===t||void 0===t?void 0:t.error)||"All notification attempts failed");console.log("OrderDataService notification sent successfully for order:",e),r=!0}}catch(s){console.error("Secondary notification failed:",s);try{console.log("Attempting direct OrderDataService.sendMessageToCustomer as last resort");const t=await Bt.A.sendMessageToCustomer(e,`\ud83d\udd14 YOUR COFFEE IS READY! Your ${l.coffeeType||"coffee"} is now ready for collection. Enjoy! \u2615`);if(console.log("Direct SMS result:",t),!t||!0!==t.success&&Object.prototype.hasOwnProperty.call(t,"success"))throw new Error((null===t||void 0===t?void 0:t.error)||"Final notification attempt failed without details");console.log("Last resort notification sent successfully"),r=!0}catch(a){console.error("All notification attempts failed:",a),n=a}}}return De((t=>{var s;return{...t,[e]:{status:r?"sent":"failed",error:r?null:(null===(s=n)||void 0===s?void 0:s.message)||"Failed to send notification",timestamp:new Date}}})),!0}return console.error("Failed to complete order in backend"),alert("Failed to complete the order. Please try again."),!1}catch(r){return console.error("Error completing order with notifications:",r),alert(`Error: ${r.message||"Unknown error completing order"}`),!1}})(e.id),children:"COMPLETE ORDER"}),(0,yt.jsxs)("div",{className:"mt-3 flex items-center space-x-2",children:[(0,yt.jsx)("div",{className:"text-sm",children:"Time pressure:"}),(0,yt.jsx)("div",{className:"flex-grow bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:`h-2 ${Ht(e.waitTime,e.promisedTime)}`,style:{width:e.waitTime/e.promisedTime*100+"%"}})}),(0,yt.jsxs)("div",{className:"text-sm",children:[Math.floor(e.waitTime/e.promisedTime*100),"%"]})]})]},e.id)},dt=e=>{var t;const s=e.completedAt?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return Math.floor((new Date(t)-new Date(e))/6e4)}(e.completedAt):0,a="sent"===(null===(t=Pe[e.id])||void 0===t?void 0:t.status),r=e.milkType&&"No Milk"!==e.milkType?ns(e.milkType,e.milkTypeId):{borderLeftWidth:"4px",borderLeftStyle:"solid",borderLeftColor:"#10B981"};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-3 mb-2",style:r,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold flex items-center",children:["Order #",e.id,a&&(0,yt.jsx)("span",{className:"ml-1 text-green-500",title:"Message sent",children:(0,yt.jsx)(St,{size:14})})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-500",children:["Completed ",s," minutes ago"]})]}),(0,yt.jsxs)("div",{className:"mt-2",children:[(0,yt.jsxs)("div",{className:"text-gray-700 flex items-center",children:[e.milkType&&"No Milk"!==e.milkType&&(0,yt.jsx)("span",{style:is(e.milkType,e.milkTypeId)}),e.coffeeType||"Coffee",", ",e.milkType||"Regular milk"]}),(0,yt.jsx)("div",{className:"font-medium",children:e.customerName}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:e.phoneNumber}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"mt-1",children:(0,yt.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded",children:"Alternative Milk"})})]}),(0,yt.jsxs)("div",{className:"mt-3 flex space-x-2",children:[(0,yt.jsx)("button",{className:"flex-1 bg-amber-600 text-white py-1 rounded text-sm hover:bg-amber-700",onClick:()=>ot(e),children:"Remind"}),(0,yt.jsx)("button",{className:"flex-1 bg-green-500 text-white py-1 rounded text-sm hover:bg-green-600",onClick:()=>U(e.id),children:"Picked Up"})]})]},e.id)},ut=e=>{const t=e.milkType&&"No Milk"!==e.milkType?ns(e.milkType,e.milkTypeId):{borderLeftWidth:"4px",borderLeftStyle:"solid",borderLeftColor:"#10B981"};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-3 mb-2",style:t,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold",children:["Order #",e.id]}),(0,yt.jsx)("button",{className:"text-sm text-gray-600 bg-gray-200 px-2 py-1 rounded hover:bg-gray-300",onClick:()=>{console.log(`Viewing details for order #${e.id}`),alert(`Order detail viewing requires backend API implementation. Details for order #${e.id} are not available.`)},children:"View Details"})]}),(0,yt.jsxs)("div",{className:"mt-2",children:[(0,yt.jsxs)("div",{className:"text-gray-700 flex items-center",children:[e.milkType&&"No Milk"!==e.milkType&&(0,yt.jsx)("span",{style:is(e.milkType,e.milkTypeId)}),e.coffeeType||"Coffee",", ",e.milkType||"Regular milk"," ",e.sugar?`, ${e.sugar}`:""]}),(0,yt.jsx)("div",{className:"font-medium",children:e.customerName}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Picked up at ",e.pickedUpAt?new Date(e.pickedUpAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"unknown"]})]})]},e.id)},mt=e=>{let{item:t,category:s,updateStockItem:r,deleteStockItem:n,addStockItem:i}=e;const o=t.amount/t.capacity*100,[l,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(t.capacity),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(t.amount),f=e=>{switch(e){case"danger":return"bg-red-400";case"warning":return"bg-yellow-400";default:return"bg-green-400"}},x=(b=t,"milk"===(y=s)?.5:"coffee"===y?.1:"cups"===y?5:"syrups"===y?.1:"pcs"===b.unit?5:.5);var y,b;return(0,yt.jsxs)("div",{className:"flex flex-col mb-6 pb-4 border-b border-gray-200",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsxs)("div",{className:"w-1/4",children:[(0,yt.jsx)("div",{className:"font-medium",children:t.name}),(0,yt.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,yt.jsxs)("span",{className:"mr-2",children:["Available: ",t.amount," ",t.unit]}),(0,yt.jsx)("button",{className:"text-blue-500 text-xs underline",onClick:()=>h(!m),children:m?"Hide":"Edit"})]}),m&&(0,yt.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,yt.jsx)("input",{type:"number",min:"0",max:t.capacity,step:"pcs"===t.unit?1:.1,value:g,onChange:e=>{p(e.target.value)},className:"w-24 p-1 border rounded mr-2"}),(0,yt.jsx)("button",{className:"bg-green-500 text-white px-2 py-1 rounded text-xs",onClick:()=>{const e=parseFloat(g);!isNaN(e)&&e>=0&&e<=t.capacity&&r(s,t.id,e),h(!1)},children:"Apply"})]})]}),(0,yt.jsxs)("div",{className:"w-1/4 flex flex-col",children:[(0,yt.jsxs)("div",{className:"font-medium flex items-center",children:["Capacity: ",t.capacity," ",t.unit,(0,yt.jsx)("button",{className:"ml-2 text-blue-500 text-xs underline",onClick:()=>c(!l),children:l?"Cancel":"Edit"})]}),l&&(0,yt.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,yt.jsx)("input",{type:"number",min:t.amount,step:"pcs"===t.unit?1:.1,value:d,onChange:e=>u(e.target.value),className:"w-24 p-1 border rounded mr-2"}),(0,yt.jsx)("button",{className:"bg-green-500 text-white px-2 py-1 rounded text-xs",onClick:()=>{if(!isNaN(d)&&d>0){const e=t.lowThreshold/t.capacity,a=t.criticalThreshold/t.capacity,r={...t,capacity:parseFloat(d),amount:Math.min(t.amount,parseFloat(d)),lowThreshold:parseFloat(d)*e,criticalThreshold:parseFloat(d)*a};n(s,t.id),i(s,r),c(!1)}},children:"Update"})]})]}),(0,yt.jsxs)("div",{className:"w-1/4 flex justify-end space-x-2",children:[(0,yt.jsx)("button",{className:"w-10 h-10 bg-gray-200 rounded-md flex items-center justify-center hover:bg-gray-300",onClick:()=>{if(t.amount>0){const e=Math.max(0,t.amount-x);r(s,t.id,e),p(e)}},children:"-"}),(0,yt.jsx)("button",{className:"w-10 h-10 bg-gray-200 rounded-md flex items-center justify-center hover:bg-gray-300",onClick:()=>{const e=Math.min(t.capacity,t.amount+x);r(s,t.id,e),p(e)},children:"+"})]})]}),(0,yt.jsxs)("div",{className:"w-full mt-2",children:[(0,yt.jsx)("div",{className:"flex items-center",children:(0,yt.jsx)("input",{type:"range",min:"0",max:t.capacity,step:"pcs"===t.unit?1:.1,value:t.amount,onChange:e=>{const a=parseFloat(e.target.value);r(s,t.id,a),p(a)},className:"w-full h-5 appearance-none bg-gray-200 rounded-full focus:outline-none",style:{background:`linear-gradient(to right, ${f(t.status)} 0%, ${f(t.status)} ${o}%, #e5e7eb ${o}%, #e5e7eb 100%)`}})}),(0,yt.jsxs)("div",{className:"relative w-full h-6",children:[(0,yt.jsx)("div",{className:"absolute top-0 w-0.5 h-2 bg-yellow-500",style:{left:t.lowThreshold/t.capacity*100+"%"}}),(0,yt.jsx)("div",{className:"absolute top-3 text-xs text-yellow-600",style:{left:t.lowThreshold/t.capacity*100+"%",transform:"translateX(-50%)"},children:"Low"}),(0,yt.jsx)("div",{className:"absolute top-0 w-0.5 h-2 bg-red-500",style:{left:t.criticalThreshold/t.capacity*100+"%"}}),(0,yt.jsx)("div",{className:"absolute top-3 text-xs text-red-600",style:{left:t.criticalThreshold/t.capacity*100+"%",transform:"translateX(-50%)"},children:"Critical"})]})]})]})},ft=(e,t)=>(0,yt.jsxs)("div",{className:`mb-2 p-3 rounded-lg border-l-4 ${(e=>{switch(e){case"active":return"bg-green-100 border-green-500 text-green-700";case"upcoming":return"bg-blue-100 border-blue-500 text-blue-700";default:return"bg-gray-100 border-gray-500 text-gray-700"}})(e.status)} shadow-sm`,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"font-bold",children:[e.start," - ",e.end]}),"shift"===t&&(0,yt.jsx)("div",{className:"text-sm bg-amber-100 text-amber-800 px-2 py-1 rounded",children:e.barista}),"rush"===t&&(0,yt.jsx)("div",{className:"text-sm bg-red-100 text-red-800 px-2 py-1 rounded",children:"Rush Period"})]}),(0,yt.jsxs)("div",{className:"mt-2",children:["shift"===t&&(0,yt.jsx)("div",{className:"text-gray-700",children:"Barista Shift"}),"break"===t&&(0,yt.jsxs)("div",{className:"text-gray-700",children:["Break Time for ",e.barista]}),"rush"===t&&(0,yt.jsx)("div",{className:"text-gray-700",children:e.reason})]})]},`${t}-${e.id}`),xt=e=>{let{id:t,title:s,message:a,extraContent:r,borderColor:n="green",bgColor:i="green",isDismissed:o,onDismiss:l}=e;return o?null:(0,yt.jsxs)("div",{className:`bg-${i}-100 border-l-4 border-${n}-500 text-${n}-700 p-2 mb-3 relative`,children:[(0,yt.jsxs)("div",{className:"flex",children:[(0,yt.jsx)("div",{className:"py-1",children:(0,yt.jsx)("svg",{className:`fill-current h-5 w-5 text-${n}-500 mr-2`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})})}),(0,yt.jsxs)("div",{className:"pr-7",children:[(0,yt.jsx)("p",{className:"font-bold text-sm",children:s}),(0,yt.jsx)("p",{className:"text-xs",children:a}),r&&(0,yt.jsx)("div",{className:"mt-1 text-xs",children:r})]})]}),(0,yt.jsx)("button",{className:"absolute top-1 right-1 text-gray-500 hover:text-gray-800 bg-white rounded-full p-1 shadow-sm",onClick:()=>l(t),"aria-label":"Dismiss message",title:"Dismiss this message",children:(0,yt.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,yt.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,yt.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})},bt=()=>{const[e,t]=(0,a.useState)({autoSendSmsOnComplete:st.autoSendSmsOnComplete,remindAfterDelay:st.remindAfterDelay,reminderDelay:st.reminderDelay,showNameOnDisplay:st.showNameOnDisplay});return(0,yt.jsxs)("div",{className:"p-4 border rounded shadow-lg bg-white",children:[(0,yt.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Notification Settings"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsx)("div",{children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.autoSendSmsOnComplete,onChange:s=>t({...e,autoSendSmsOnComplete:s.target.checked})}),(0,yt.jsx)("span",{children:"Automatically send SMS when order is completed"})]})}),(0,yt.jsx)("div",{children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.showNameOnDisplay,onChange:s=>t({...e,showNameOnDisplay:s.target.checked})}),(0,yt.jsx)("span",{children:"Show customer name on display screen"})]})}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.remindAfterDelay,onChange:s=>t({...e,remindAfterDelay:s.target.checked})}),(0,yt.jsx)("span",{children:"Send reminder if order not picked up"})]}),e.remindAfterDelay&&(0,yt.jsx)("div",{className:"pl-6 mt-2",children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("span",{children:"Reminder delay (seconds):"}),(0,yt.jsx)("input",{type:"number",min:"10",max:"300",value:e.reminderDelay,onChange:s=>t({...e,reminderDelay:parseInt(s.target.value)}),className:"w-20 p-1 border rounded"})]})})]})]}),(0,yt.jsx)("div",{className:"mt-4 flex justify-end",children:(0,yt.jsx)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",onClick:()=>{rt({...st,...e}),ls.updateSettings(e),alert("Notification settings saved")},children:"Save Settings"})})]})};return(0,yt.jsxs)("div",{className:"bg-gray-100 min-h-screen flex flex-col",children:[!I&&(0,yt.jsx)("div",{className:"bg-red-500 text-white p-2 text-center",children:"Could not connect to backend service. Using sample data instead."}),s&&(0,yt.jsx)("div",{className:"bg-amber-500 text-white p-2 text-center",children:"Demo Mode Active - Using simulated data"}),(0,yt.jsxs)("header",{className:"bg-amber-800 text-white p-4 flex justify-between items-center shadow-md",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{className:"mr-2 p-1 rounded hover:bg-amber-700",onClick:()=>window.history.back(),title:"Back to Home",children:(0,yt.jsx)(Tt,{size:20})}),(0,yt.jsxs)("div",{className:"text-xl font-bold cursor-pointer",onClick:()=>m(!u),children:[(e=>{if(i)try{const e=localStorage.getItem(`coffee_station_name_${i}`);if(e)return e}catch(bn){console.error("Error getting custom station name for display:",bn)}return(null===(e=n.find((e=>e.id===i)))||void 0===e?void 0:e.name)||"Select a Station"})(),(0,yt.jsx)(It,{size:16,className:"inline ml-1"})]}),u&&(0,yt.jsx)("div",{className:"absolute top-16 left-4 bg-white text-gray-800 shadow-lg rounded-md overflow-hidden z-50",children:n.map((e=>(0,yt.jsxs)("div",{className:"p-3 hover:bg-gray-100 cursor-pointer "+(e.id===i?"bg-amber-100":""),onClick:()=>{l(e.id);const t=tt(e.id);let s=e.name;try{const t=localStorage.getItem(`coffee_station_name_${e.id}`);t&&(console.log(`Found custom station name in localStorage: ${t}`),s=t)}catch(bn){console.error("Error getting custom station name from localStorage:",bn)}rt({...st,stationName:s,baristaName:t}),cs.initialize(e.id,s,t),m(!1),G()},children:[(0,yt.jsx)("div",{className:"font-medium",children:(()=>{try{return localStorage.getItem(`coffee_station_name_${e.id}`)||e.name}catch(bn){return e.name}})()}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,yt.jsx)("div",{className:"w-2 h-2 rounded-full mr-1 "+("active"===e.status?"bg-green-500":"bg-red-500")}),"active"===e.status?"Active":"Maintenance"]})]},e.id)))})]}),(0,yt.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,yt.jsxs)("button",{className:"px-3 py-1 rounded-md bg-blue-500 hover:bg-blue-600 text-white flex items-center",onClick:lt,children:[(0,yt.jsx)(pt,{size:16,className:"mr-1"}),"Display"]}),(0,yt.jsxs)("div",{className:"px-4 py-1 rounded-full flex items-center "+(I?"bg-green-500":"bg-gray-400"),children:[(0,yt.jsx)("div",{className:`w-3 h-3 rounded-full ${I?"bg-green-300":"bg-gray-300"} mr-2`}),I?"Online":"Offline"]}),(0,yt.jsxs)("div",{className:"px-4 py-1 rounded-full flex items-center cursor-pointer "+(P?"bg-green-500":"bg-gray-400"),onClick:z,title:P?`Auto-refresh every ${D} seconds`:"Auto-refresh disabled (click to enable)",children:[(0,yt.jsx)(Ot,{size:14,className:"mr-1 "+(M?"animate-spin":"")}),P?`${D}s`:"Manual"]}),(0,yt.jsxs)("div",{className:"px-4 py-1 rounded-full bg-green-500",children:["Queue: ",T]}),(0,yt.jsxs)("div",{className:"px-4 py-1 rounded-full bg-green-500",children:["Wait: ",ge," min"]}),(0,yt.jsx)("button",{className:"px-4 py-1 rounded-full bg-red-500 flex items-center font-medium hover:bg-red-600 transition-colors",onClick:()=>Me(!0),children:"HELP"})]})]}),(0,yt.jsxs)("div",{className:"bg-white border-b flex shadow-sm",children:[(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("orders"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("orders"),children:[(0,yt.jsx)(ht,{size:18,className:"mr-1"}),"Orders"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("stock"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("stock"),children:[(0,yt.jsx)(At,{size:18,className:"mr-1"}),"Stock"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("inventory"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("inventory"),children:[(0,yt.jsx)(At,{size:18,className:"mr-1"}),"Inventory AI"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("schedule"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("schedule"),children:[(0,yt.jsx)($t,{size:18,className:"mr-1"}),"Schedule"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("completed"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("completed"),children:[(0,yt.jsx)(Mt,{size:18,className:"mr-1"}),"Completed"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("display"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("display"),children:[(0,yt.jsx)(pt,{size:18,className:"mr-1"}),"Display"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("queue"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("queue"),children:[(0,yt.jsx)(Pt,{size:18,className:"mr-1"}),"Queue AI"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("balance"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("balance"),children:[(0,yt.jsx)(Dt,{size:18,className:"mr-1"}),"Balance"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("capabilities"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("capabilities"),children:[(0,yt.jsx)(gt,{size:18,className:"mr-1"}),"Capabilities"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("staff"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("staff"),children:[(0,yt.jsx)(zt,{size:18,className:"mr-1"}),"Staff"]}),(0,yt.jsxs)("button",{className:"py-4 px-6 font-medium flex items-center "+("settings"===Z?"border-b-2 border-amber-600 bg-white text-amber-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>te("settings"),children:[(0,yt.jsx)(gt,{size:18,className:"mr-1"}),"Settings"]})]}),(0,yt.jsxs)("div",{className:"p-4 flex-grow overflow-y-auto",children:[O&&(0,yt.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,yt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-600"})}),A&&(0,yt.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:[(0,yt.jsx)("strong",{className:"font-bold",children:"Error!"}),(0,yt.jsxs)("span",{className:"block sm:inline",children:[" ",A]}),(0,yt.jsx)("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:V,children:(0,yt.jsx)(Lt,{size:20})})]}),!O&&!A&&(0,yt.jsxs)("div",{className:"text-xs text-gray-500 mb-2 flex items-center",children:[(0,yt.jsx)(Rt,{size:12,className:"mr-1"}),"Last updated: ",new Date($).toLocaleTimeString(),M&&(0,yt.jsxs)("span",{className:"ml-2 flex items-center text-amber-600",children:[(0,yt.jsx)(Ot,{size:12,className:"animate-spin mr-1"}),"Refreshing..."]})]}),!O&&"orders"===Z&&(0,yt.jsxs)("div",{className:"flex space-x-4",children:[(0,yt.jsxs)("div",{className:"w-1/2",children:[(0,yt.jsx)("div",{className:"bg-amber-700 text-white p-2 rounded-t-lg",children:(0,yt.jsx)("h2",{className:"text-xl font-bold",children:"Current Order"})}),(0,yt.jsx)("div",{className:"bg-white p-4 rounded-b-lg shadow-md",children:b.length>0?b.map((e=>ct(e))):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(ht,{size:48,className:"mx-auto mb-2 text-gray-400"}),(0,yt.jsx)("p",{children:"No orders in progress"}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Start an order from the queue"})]})})]}),(0,yt.jsx)(_s,{orders:y,filter:we,onFilterChange:Ne,onStartOrder:R,onProcessBatch:B,onSendMessage:ot,onDelayOrder:e=>{e&&e.id?(alert(`Order #${e.id} for ${e.customerName} delayed by 5 minutes`),console.log(`Delayed order ${e.id} by 5 minutes`)):console.error("Cannot delay order: Missing order ID")},onEditOrder:e=>{if(!e||!e.id)return void console.error("Cannot edit order: Missing order ID");const t=prompt(`Edit notes for order #${e.orderNumber}:`,e.notes||"");null!==t&&t!==e.notes&&(console.log(`Updated notes for order ${e.id}: ${t}`),alert(`Order #${e.orderNumber} notes updated. This will be saved when the order update API is implemented.`))}})]}),!O&&"stock"===Z&&(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsx)(xt,{id:"stockInfoPanel",title:"Station-Specific Inventory Management",message:"This station's inventory is saved locally. Each station manages its own inventory independently.",borderColor:"green",bgColor:"green",isDismissed:se.stockInfoPanel,onDismiss:re,extraContent:(Ze>0||et>0)&&(0,yt.jsxs)("p",{className:"font-medium",children:[et>0&&(0,yt.jsxs)("span",{className:"text-red-600 mr-2",children:["Critical: ",et," items"]}),Ze>0&&(0,yt.jsxs)("span",{className:"text-yellow-600",children:["Low: ",Ze," items"]})]})}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:Be.map((e=>(0,yt.jsx)("button",{className:"px-4 py-2 rounded-full "+(Ke===e?"bg-green-500 text-white":"bg-gray-200"),onClick:()=>Xe(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))}),(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4 flex items-center justify-between",children:(0,yt.jsxs)("span",{children:[Ke.charAt(0).toUpperCase()+Ke.slice(1)," Inventory"]})}),(0,yt.jsx)("div",{className:"space-y-4 bg-white rounded-lg shadow-md p-4",children:We?(0,yt.jsx)("div",{className:"flex justify-center py-8",children:(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"})}):He(Ke).length>0?He(Ke).map((e=>(0,yt.jsx)(mt,{item:e,category:Ke,updateStockItem:Je,deleteStockItem:Ge,addStockItem:Ve},e.id))):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(At,{size:48,className:"mx-auto mb-2 text-gray-400"}),(0,yt.jsxs)("p",{children:["No ",Ke," items found"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Click 'Add Event Stock' to add standard items or 'Custom Item' for unique items"})]})}),(0,yt.jsxs)("div",{className:"flex flex-wrap gap-2 mt-6",children:[(0,yt.jsx)("button",{className:"flex-1 py-3 bg-green-500 text-white rounded-md font-medium hover:bg-green-600",onClick:()=>{if("yes"===window.prompt(`Type 'yes' to confirm restocking all ${Ke} items to full capacity:`)){He(Ke).forEach((e=>{Je(Ke,e.id,e.capacity)}))}},children:"Restock All to Full"}),(0,yt.jsx)("button",{className:"flex-1 py-3 bg-gray-500 text-white rounded-md font-medium hover:bg-gray-600",onClick:()=>{const e=He(Ke);if(0===e.length)return void alert(`No ${Ke} items to delete`);let t="Select item to delete:\n";e.forEach(((e,s)=>{t+=`${s+1}. ${e.name}\n`}));const s=prompt(t);if(s){const t=parseInt(s,10)-1;if(!isNaN(t)&&t>=0&&t<e.length){const s=e[t];"yes"===window.prompt(`Type 'yes' to confirm deleting ${s.name}:`)&&Ge(Ke,s.id)}else alert("Invalid selection")}},children:"Delete Item"}),(0,yt.jsx)("button",{className:"flex-1 py-3 bg-red-500 text-white rounded-md font-medium hover:bg-red-600",onClick:()=>{"yes"===window.prompt("Type 'yes' to reset all stock to default values. This cannot be undone:")&&Qe()},children:"Reset to Defaults"})]})]}),!O&&"inventory"===Z&&(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)(zs,{})}),!O&&"schedule"===Z&&(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsx)(xt,{id:"scheduleInfoPanel",title:"Schedule Management Available in Organiser",message:"Create and manage schedules in the Organiser interface. Go to Organiser \u2192 Schedule to add shifts for today.",borderColor:"blue",bgColor:"blue",isDismissed:se.scheduleInfoPanel,onDismiss:re}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Today's Schedule"}),(0,yt.jsx)("div",{className:"space-y-2",children:g?(0,yt.jsxs)("div",{className:"text-center py-6",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-amber-600 mx-auto"}),(0,yt.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading schedule data..."})]}):h.shifts&&h.shifts.length>0?h.shifts.map((e=>{const t={id:e.id,start:e.start_time||"9:00",end:e.end_time||"17:00",status:e.status||"active",barista:e.staff_name||"Barista"};return ft(t,"shift")})):(0,yt.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,yt.jsx)("p",{children:"No schedule data available for this station"}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Create schedules in the Organiser interface"})]})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Breaks"}),(0,yt.jsx)("div",{className:"space-y-2",children:g?(0,yt.jsxs)("div",{className:"text-center py-6",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-amber-600 mx-auto"}),(0,yt.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading break data..."})]}):h.breaks&&h.breaks.length>0?h.breaks.map((e=>ft(e,"break"))):(0,yt.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,yt.jsx)("p",{children:"No break data available"}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Break scheduling will be added soon"})]})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 md:col-span-2",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Predicted Rush Periods"}),(0,yt.jsx)("div",{className:"space-y-2",children:g?(0,yt.jsxs)("div",{className:"text-center py-6",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-amber-600 mx-auto"}),(0,yt.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading rush period data..."})]}):h.rushPeriods&&h.rushPeriods.length>0?h.rushPeriods.map((e=>ft(e,"rush"))):(0,yt.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,yt.jsx)("p",{children:"No rush period data available"}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Rush period analytics will be added soon"})]})})]})]})]}),!O&&"completed"===Z&&(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-3",children:"Completed Orders"}),(0,yt.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,yt.jsx)("button",{className:("completed"===ie?"bg-amber-600 text-white":"bg-gray-200 hover:bg-gray-300")+" px-6 py-2 rounded-full",onClick:()=>oe("completed"),children:"Today"}),(0,yt.jsx)("button",{className:("yesterday"===ie?"bg-amber-600 text-white":"bg-gray-200 hover:bg-gray-300")+" px-6 py-2 rounded-full",onClick:()=>{oe("yesterday"),Q()},children:"Yesterday"}),(0,yt.jsx)("button",{className:("thisWeek"===ie?"bg-amber-600 text-white":"bg-gray-200 hover:bg-gray-300")+" px-6 py-2 rounded-full",onClick:()=>{oe("thisWeek"),Y()},children:"This Week"}),(0,yt.jsx)("button",{className:("search"===ie?"bg-amber-600 text-white":"bg-gray-200 hover:bg-gray-300")+" px-6 py-2 rounded-full ml-auto",onClick:()=>oe("search"),children:"Search Orders"})]}),"search"===ie&&(0,yt.jsx)("div",{className:"mb-4",children:(0,yt.jsxs)("div",{className:"flex",children:[(0,yt.jsx)("input",{type:"text",placeholder:"Search by customer name, order number, or coffee type...",value:de,onChange:e=>ue(e.target.value),className:"flex-1 p-2 border rounded-l-md"}),(0,yt.jsx)("button",{className:"bg-amber-600 text-white px-4 py-2 rounded-r-md",onClick:()=>K(de),children:"Search"})]})})]}),"completed"===ie&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold mb-3 ml-2",children:"Ready for Pickup"}),(0,yt.jsx)("div",{className:"space-y-2 mb-6",children:v.length>0?v.map((e=>dt(e))):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"No orders ready for pickup"})})}),(0,yt.jsx)("h3",{className:"text-xl font-bold mb-3 ml-2",children:"Previously Completed"}),(0,yt.jsx)("div",{className:"space-y-2",children:j.length>0?j.map((e=>ut(e))):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"No previous orders to display"})})})]}),"yesterday"===ie&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold mb-3 ml-2",children:"Yesterday's Orders"}),(0,yt.jsx)("div",{className:"space-y-2",children:O?(0,yt.jsxs)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600 mx-auto mb-2"}),(0,yt.jsx)("p",{className:"text-gray-500",children:"Loading yesterday's orders..."})]}):N.length>0?N.map((e=>ut(e))):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"No orders from yesterday"})})})]}),"thisWeek"===ie&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold mb-3 ml-2",children:"This Week's Orders"}),(0,yt.jsx)("div",{className:"space-y-2",children:O?(0,yt.jsxs)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600 mx-auto mb-2"}),(0,yt.jsx)("p",{className:"text-gray-500",children:"Loading this week's orders..."})]}):k.length>0?k.map((e=>ut(e))):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"No orders from this week"})})})]}),"search"===ie&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold mb-3 ml-2",children:"Search Results"}),(0,yt.jsx)("div",{className:"space-y-2",children:O?(0,yt.jsxs)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600 mx-auto mb-2"}),(0,yt.jsx)("p",{className:"text-gray-500",children:"Searching orders..."})]}):de?S.length>0?S.map((e=>ut(e))):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"No orders match your search"})}):(0,yt.jsx)("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm text-gray-500",children:(0,yt.jsx)("p",{children:"Enter a search term to find orders"})})})]})]}),!O&&"queue"===Z&&(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)(Os,{})}),!O&&"balance"===Z&&(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)($s,{})}),!O&&"capabilities"===Z&&(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)(Fs,{})}),!O&&"staff"===Z&&(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)(Ms,{})}),!O&&"settings"===Z&&(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Auto-Refresh Settings"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsx)("div",{children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:P,onChange:z}),(0,yt.jsx)("span",{children:"Enable automatic refreshing of order data"})]})}),P&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refresh interval (seconds)"}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"number",min:"5",max:"300",value:D,onChange:e=>L(parseInt(e.target.value)),className:"w-20 p-2 border rounded mr-2"}),(0,yt.jsx)("span",{className:"text-sm text-gray-500",children:D<15?"(Fast refresh may impact performance)":""})]})]}),(0,yt.jsx)("div",{className:"mt-4",children:(0,yt.jsxs)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700 flex items-center",onClick:()=>{const e=n.find((e=>e.id===i));console.log(`Refreshing with station: ${(null===e||void 0===e?void 0:e.name)||"Unknown"} (ID: ${i})`),localStorage.setItem("coffee_cue_selected_station",i.toString()),localStorage.setItem("last_used_station_id",i.toString()),G()},children:[(0,yt.jsx)(Ot,{size:16,className:"mr-1 "+(M?"animate-spin":"")}),"Refresh Now"]})})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Station Settings"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Station Name"}),(0,yt.jsx)("input",{type:"text",value:st.stationName,onChange:e=>rt({...st,stationName:e.target.value}),className:"w-full p-2 border rounded"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Station Location"}),(0,yt.jsx)("input",{type:"text",value:st.stationLocation,onChange:e=>rt({...st,stationLocation:e.target.value}),className:"w-full p-2 border rounded",placeholder:"e.g., Main Hall, Registration Area, etc."})]}),(0,yt.jsxs)("button",{className:"mt-4 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center",onClick:()=>{try{localStorage.setItem(`coffee_station_name_${i}`,st.stationName),localStorage.setItem(`coffee_station_location_${i}`,st.stationLocation),localStorage.setItem(`coffee_station_barista_${i}`,st.baristaName),c&&c({id:i,name:st.stationName,location:st.stationLocation,baristaName:st.baristaName}),alert("Station settings saved successfully!")}catch(A){console.error("Error saving station settings:",A),alert("Error saving station settings. Please try again.")}},children:[(0,yt.jsx)(Mt,{size:18,className:"mr-1"}),"Save Station Settings"]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Barista Name"}),(0,yt.jsx)("input",{type:"text",value:st.baristaName,onChange:e=>{const t=e.target.value;rt({...st,baristaName:t});try{const e="string"===typeof i?parseInt(i,10):i;localStorage.setItem(`coffee_barista_name_station_${e}`,t)}catch(A){console.error("Failed to save station-specific barista name to localStorage:",A)}},className:"w-full p-2 border rounded"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium mb-3",children:"Sound Notifications"}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2 mb-3",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundEnabled,onChange:e=>{const t=e.target.checked;rt({...st,soundEnabled:t}),localStorage.setItem("coffee_sound_enabled",t?"true":"false"),window.dispatchEvent(new CustomEvent("app:toggleSound",{detail:{enabled:t}})),t&&window.coffeeSounds?window.coffeeSounds.play("newOrder"):t&&setTimeout((()=>{window.dispatchEvent(new CustomEvent("app:newOrder"))}),300)}}),(0,yt.jsx)("span",{className:"font-medium",children:"Enable All Sounds"})]}),st.soundEnabled&&(0,yt.jsxs)("div",{className:"ml-6 space-y-2",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("label",{className:"text-sm w-20",children:"Volume:"}),(0,yt.jsx)("input",{type:"range",min:"0",max:"100",value:st.soundVolume,onChange:e=>rt({...st,soundVolume:parseInt(e.target.value)}),className:"flex-1"}),(0,yt.jsxs)("span",{className:"text-sm w-10",children:[st.soundVolume,"%"]})]}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundNewOrder,onChange:e=>rt({...st,soundNewOrder:e.target.checked})}),(0,yt.jsx)("span",{className:"text-sm",children:"New Order"})]}),(0,yt.jsx)("button",{className:"px-2 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.play("newOrder");else{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfPo");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}},children:"Test"})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundOrderComplete,onChange:e=>rt({...st,soundOrderComplete:e.target.checked})}),(0,yt.jsx)("span",{className:"text-sm",children:"Order Complete"})]}),(0,yt.jsx)("button",{className:"px-2 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.play("orderComplete");else{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfPg");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}},children:"Test"})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundOrderPickedUp,onChange:e=>rt({...st,soundOrderPickedUp:e.target.checked})}),(0,yt.jsx)("span",{className:"text-sm",children:"Order Picked Up"})]}),(0,yt.jsx)("button",{className:"px-2 py-1 bg-purple-500 text-white text-xs rounded hover:bg-purple-600",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.play("orderPickedUp");else{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfOl");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}},children:"Test"})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundLowStock,onChange:e=>rt({...st,soundLowStock:e.target.checked})}),(0,yt.jsx)("span",{className:"text-sm",children:"Low Stock Alert"})]}),(0,yt.jsx)("button",{className:"px-2 py-1 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.play("lowStock");else{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfPx");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}},children:"Test"})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.soundError,onChange:e=>rt({...st,soundError:e.target.checked})}),(0,yt.jsx)("span",{className:"text-sm",children:"Error Alert"})]}),(0,yt.jsx)("button",{className:"px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.play("error");else{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfPe");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}},children:"Test"})]})]}),(0,yt.jsx)("button",{className:"mt-3 px-4 py-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 w-full",onClick:()=>{if(window.coffeeSounds)window.coffeeSounds.testSounds();else{["newOrder","orderComplete","orderPickedUp","lowStock","error"].forEach(((e,t)=>{setTimeout((()=>{const e=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhCEGdyfPg");e.volume=st.soundVolume/100,e.play().catch((e=>console.log("Audio play failed:",e)))}),800*t)}))}},children:"Test All Sounds"})]})]}),(0,yt.jsx)("div",{children:(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:st.autoPrintLabels,onChange:e=>rt({...st,autoPrintLabels:e.target.checked})}),(0,yt.jsx)("span",{children:"Auto-print labels"})]})})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Notification Settings"}),(0,yt.jsx)(bt,{})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Info Panels"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Information panels can be dismissed by clicking the X in the corner. You can restore all dismissed panels here."}),(0,yt.jsxs)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center",onClick:ne,children:[(0,yt.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,yt.jsx)("path",{d:"M3 2v6h6"}),(0,yt.jsx)("path",{d:"M3 13a9 9 0 1 0 3-7.7L3 8"})]}),"Restore All Info Panels"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"System Information"}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,yt.jsx)("div",{children:"Version: 1.2.0"}),(0,yt.jsxs)("div",{children:["Station: ",(e=>{if(i)try{const e=localStorage.getItem(`coffee_station_name_${i}`);if(e)return e}catch(bn){console.error("Error getting custom station name for system info:",bn)}return(null===(e=n.find((e=>e.id===i)))||void 0===e?void 0:e.name)||"Unknown"})()]}),(0,yt.jsxs)("div",{children:["Last Sync: ",(new Date).toLocaleString()]}),(0,yt.jsxs)("div",{children:["API Status: ",I?"Connected":"Offline"]}),(0,yt.jsxs)("div",{children:["App Mode: ",s?"Demo":"Production"]})]}),(0,yt.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,yt.jsx)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",onClick:r,children:"Toggle Demo Mode"}),(0,yt.jsx)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700",onClick:()=>{try{const e="string"===typeof i?parseInt(i,10):i;localStorage.setItem(`coffee_barista_name_station_${e}`,st.baristaName)}catch(A){console.error("Failed to save station-specific barista name to localStorage:",A)}if(i&&st.stationName){try{localStorage.setItem(`coffee_station_name_${i}`,st.stationName),console.log(`Saved custom station name to localStorage: ${st.stationName}`)}catch(bn){console.error("Error saving custom station name to localStorage:",bn)}try{const e=localStorage.getItem("coffee_cue_stations");if(e){const t=JSON.parse(e).map((e=>e.id===i?{...e,name:st.stationName,location:st.stationLocation}:e));localStorage.setItem("coffee_cue_stations",JSON.stringify(t)),console.log("Updated station name in cached stations")}}catch(e){console.error("Error updating station name in cached stations:",e)}c(i,{name:st.stationName,location:st.stationLocation}).then((e=>{e?d().then((()=>{alert("Settings updated successfully!")})):alert("Changes saved locally. Server update failed but your changes will persist.")})).catch((e=>{console.error("Error updating station:",e),alert("Changes saved locally. Server connection error: "+(e.message||"Unknown error"))}))}else alert("Settings updated successfully!")},children:"Save Settings"})]})]})]}),!O&&"display"===Z&&(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsx)(xt,{id:"displayInfoPanel",title:"Display Screen Integration",message:"The display screen currently shows demo data. It requires backend API integration for showing real-time order data.",borderColor:"amber",bgColor:"amber",isDismissed:se.displayInfoPanel,onDismiss:re}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Display Screen Settings"}),(0,yt.jsx)("p",{className:"mb-4",children:"Control what appears on the customer-facing display screen."}),(0,yt.jsxs)("div",{className:"flex space-x-4 mb-4",children:[(0,yt.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>{alert("The display screen currently shows demo data. Backend API integration is required for real-time order display."),lt()},children:"Open Display Screen"}),(0,yt.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",onClick:()=>alert("Test display feature requires backend API implementation."),children:"Test Display"})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Header"}),(0,yt.jsx)("input",{type:"text",value:st.stationName,onChange:e=>rt({...st,stationName:e.target.value}),className:"w-full p-2 border rounded"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Message"}),(0,yt.jsx)("input",{type:"text",placeholder:"Enjoy your coffee!",className:"w-full p-2 border rounded"})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Display Configuration"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Mode"}),(0,yt.jsxs)("select",{value:st.displayMode,onChange:e=>rt({...st,displayMode:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"landscape",children:"Landscape"}),(0,yt.jsx)("option",{value:"portrait",children:"Portrait"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Timeout (minutes)"}),(0,yt.jsx)("input",{type:"number",min:"1",max:"60",value:st.displayTimeout,onChange:e=>rt({...st,displayTimeout:parseInt(e.target.value)}),className:"w-full p-2 border rounded"}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"How long to show completed orders before removing them"})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",id:"showNameOnDisplay",checked:st.showNameOnDisplay,onChange:e=>rt({...st,showNameOnDisplay:e.target.checked}),className:"mr-2"}),(0,yt.jsx)("label",{htmlFor:"showNameOnDisplay",className:"text-sm font-medium text-gray-700",children:"Show customer names on display (uncheck for privacy)"})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Preview"}),(0,yt.jsxs)("div",{className:"border p-4 rounded-lg bg-gray-50",children:[(0,yt.jsxs)("div",{className:"bg-amber-800 text-white p-4 text-center",children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold",children:st.stationName}),(0,yt.jsx)("p",{children:"Ready for Pickup"}),(0,yt.jsxs)("div",{className:"text-sm text-gray-200 mt-1",children:["Station #",i]})]}),(0,yt.jsx)("div",{className:"p-4",children:v.length>0?(0,yt.jsx)("div",{className:"space-y-2",children:v.slice(0,3).map((e=>(0,yt.jsxs)("div",{className:"border-l-4 border-green-500 bg-white p-3 rounded shadow-sm",children:[(0,yt.jsx)("div",{className:"font-bold",children:st.showNameOnDisplay?e.customerName:`Order #${e.id}`}),(0,yt.jsx)("div",{children:e.coffeeType||"Coffee"}),e.alternativeMilk&&(0,yt.jsx)("div",{className:"text-xs text-blue-600",children:"Alternative Milk"})]},e.id)))}):(0,yt.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,yt.jsxs)("p",{children:["No orders ready for pickup at Station #",i]}),(0,yt.jsx)("p",{className:"text-sm text-gray-400",children:"Complete orders to see them here"})]})})]})]})]})]}),(0,yt.jsx)("div",{className:"sticky bottom-0 bg-white p-3 shadow-lg flex justify-between border-t border-gray-200",children:(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsxs)("button",{className:"px-4 py-2 bg-gray-200 rounded flex items-center hover:bg-gray-300 transition-colors",onClick:()=>Ee(!0),children:[(0,yt.jsx)(Ft,{size:18,className:"mr-1"})," Add Walk-in Order"]}),(0,yt.jsxs)("button",{className:"px-4 py-2 bg-gray-200 rounded flex items-center hover:bg-gray-300 transition-colors",onClick:()=>Ce(!0),children:[(0,yt.jsx)(Rt,{size:18,className:"mr-1"})," Adjust Wait Time"]}),(0,yt.jsxs)("button",{className:"px-4 py-2 bg-gray-200 rounded flex items-center hover:bg-gray-300 transition-colors",onClick:()=>{d(),G(),x()},children:[(0,yt.jsx)(Ot,{size:18,className:"mr-1 "+(M?"animate-spin":"")}),M?"Refreshing...":"Refresh"]})]})}),(0,yt.jsxs)("button",{className:"fixed bottom-16 right-4 bg-blue-500 text-white p-3 rounded-full shadow-lg hover:bg-blue-600",onClick:()=>{be(!ye),ye||je(0)},children:[(0,yt.jsx)(_t,{size:24}),ve>0&&(0,yt.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full",children:ve})]}),Se&&(0,yt.jsx)(hs,{currentWaitTime:ge,onSubmit:async e=>{if(e&&!isNaN(e)){const t=parseInt(e);await J(t)?(pe(t),Ce(!1),alert(`Wait time updated to ${t} minutes`)):alert("Failed to update wait time. Please try again.")}},onClose:()=>Ce(!1)}),_e&&(0,yt.jsx)(ys,{onSubmit:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"single";try{if("group"===t){console.log("Attempting to add group order:",e);n.find((e=>e.id===i));const t=await Bt.A.submitGroupOrder(e);return void(t&&t.success?(Ee(!1),alert(`Group order "${e.groupName}" with ${t.count} coffees added to the queue!`),G()):alert(`Failed to add group order: ${(null===t||void 0===t?void 0:t.message)||"Unknown error"}`))}console.log("Attempting to add walk-in order:",e);const s=n.find((e=>e.id===i)),a=e.collectionStation||i,r=n.find((e=>e.id===a)),o={...e,stationId:a,station_id:a,assignedStation:a,stationName:r?r.name:s?s.name:st.stationName,orderedAtStation:e.collectionStation?i:null};console.log("Adding walk-in order with station information:",o);if(await q(o)){Ee(!1);const t=e.collectionStation?` (Order placed here, collect at ${o.stationName})`:"";alert(`Walk-in order added for ${e.customerName}${t}`)}else alert("Failed to add walk-in order. The backend API may not be properly connected or implemented.")}catch(A){console.error("Error submitting walk-in order:",A);const t=(null===A||void 0===A?void 0:A.message)||"Unknown error occurred";alert(`Error adding walk-in order: ${t}`),Ee(!1)}},onClose:()=>Ee(!1)}),Te&&Oe&&(0,yt.jsx)(ms,{order:Oe,onSubmit:(e,t)=>{H(e,t).then((e=>{e&&(Ie(!1),Ae(null))})).catch((e=>{console.error("Message send error:",e)}))},onClose:()=>{Ie(!1),Ae(null)}}),$e&&(0,yt.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,yt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full max-h-[80vh] overflow-y-auto",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Help"}),(0,yt.jsx)("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>Me(!1),children:"\xd7"})]}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsx)("p",{children:"If you need assistance with the coffee station system, please contact:"}),(0,yt.jsxs)("ul",{className:"list-disc pl-5 space-y-2",children:[(0,yt.jsxs)("li",{children:[(0,yt.jsx)("strong",{children:"Technical Support:"})," 123-456-7890"]}),(0,yt.jsxs)("li",{children:[(0,yt.jsx)("strong",{children:"Event Manager:"})," 098-765-4321"]})]}),(0,yt.jsxs)("div",{className:"bg-gray-100 p-4 rounded",children:[(0,yt.jsx)("h4",{className:"font-medium mb-2",children:"Quick Tips:"}),(0,yt.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,yt.jsx)("li",{children:"Use the batch mode to complete multiple orders at once"}),(0,yt.jsx)("li",{children:"Refresh the order list if you don't see new orders"}),(0,yt.jsx)("li",{children:"Check Chat for communications from other stations"})]})]}),(0,yt.jsx)("button",{className:"w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600",onClick:()=>Me(!1),children:"Close"})]})]})}),ye&&(0,yt.jsx)(vs,{onClose:()=>be(!1),onMessageRead:()=>je(0),stations:n,currentStationId:i,currentStationName:(null===(t=n.find((e=>e.id===i)))||void 0===t?void 0:t.name)||"Unknown Station",baristaName:st.baristaName,onBaristaNameChange:e=>rt({...st,baristaName:e})})]})};const Bs=dt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ws=dt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),qs=dt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Hs=dt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Js=dt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Vs=()=>{const{orders:e}=Gt(),{stations:t}=Xt(),[s,r]=(0,a.useState)("today"),[n,i]=(0,a.useState)("orders"),[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)({ordersPerHour:0,avgWaitTime:0,completionRate:0,customerSatisfaction:0,revenue:0,popularItems:[],peakTimes:[],stationPerformance:[]});(0,a.useEffect)((()=>{if(!e||0===e.length)return;const a=new Date,r=e.filter((e=>{const t=new Date(e.created_at);if("today"===s)return t.toDateString()===a.toDateString();if("week"===s){return t>=new Date(a.getTime()-6048e5)}if("month"===s){return t>=new Date(a.getTime()-2592e6)}return!0})),n="today"===s?a.getHours()+1:"week"===s?168:720,i=r.length/n,o=r.filter((e=>"completed"===e.status)),l=o.map((e=>{if(e.completed_at&&e.created_at){return(new Date(e.completed_at)-new Date(e.created_at))/1e3/60}return 0})),c=l.length>0?l.reduce(((e,t)=>e+t),0)/l.length:0,u=r.length>0?o.length/r.length*100:0,m={};r.forEach((e=>{e.items&&Array.isArray(e.items)&&e.items.forEach((e=>{const t=e.coffee_type||"Unknown";m[t]=(m[t]||0)+1}))}));const h=Object.entries(m).sort(((e,t)=>{let[,s]=e,[,a]=t;return a-s})).slice(0,5).map((e=>{let[t,s]=e;return{item:t,count:s,percentage:(s/r.length*100).toFixed(1)}})),g={};r.forEach((e=>{const t=new Date(e.created_at).getHours();g[t]=(g[t]||0)+1}));const p=Object.entries(g).sort(((e,t)=>{let[,s]=e,[,a]=t;return a-s})).slice(0,3).map((e=>{let[t,s]=e;return{time:`${t}:00`,count:s,label:`${t}:00-${t}:59`}})),f=t.map((e=>{const t=r.filter((t=>t.station_id===e.id)),s=t.filter((e=>"completed"===e.status));return{stationId:e.id,stationName:e.name,totalOrders:t.length,completedOrders:s.length,avgProcessTime:e.average_wait_time||5,efficiency:t.length>0?(s.length/t.length*100).toFixed(1):0}})),x=5.5*o.length;d({ordersPerHour:i.toFixed(1),avgWaitTime:c.toFixed(1),completionRate:u.toFixed(1),customerSatisfaction:4.8,revenue:x.toFixed(2),popularItems:h,peakTimes:p,stationPerformance:f})}),[e,t,s]);return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold mb-4 md:mb-0",children:"Analytics Dashboard"}),(0,yt.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,yt.jsx)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["today","week","month"].map((e=>(0,yt.jsx)("button",{onClick:()=>r(e),className:"px-4 py-2 rounded-md capitalize transition-colors "+(s===e?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:e},e)))}),(0,yt.jsxs)("button",{onClick:async()=>{l(!0),await new Promise((e=>setTimeout(e,1e3))),l(!1)},disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[(0,yt.jsx)(Ot,{className:"w-4 h-4 "+(o?"animate-spin":"")}),(0,yt.jsx)("span",{children:"Refresh"})]}),(0,yt.jsxs)("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-2",children:[(0,yt.jsx)(Ws,{className:"w-4 h-4"}),(0,yt.jsx)("span",{children:"Export"})]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,yt.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Orders/Hour"}),(0,yt.jsx)("p",{className:"text-3xl font-bold text-blue-900 mt-1",children:c.ordersPerHour}),(0,yt.jsxs)("div",{className:"flex items-center mt-2 text-sm",children:[(0,yt.jsx)(Bs,{className:"w-4 h-4 mr-1 text-green-500"}),(0,yt.jsx)("span",{className:"text-green-600",children:"+15%"}),(0,yt.jsx)("span",{className:"text-gray-600 ml-1",children:"vs target"})]})]}),(0,yt.jsx)("div",{className:"p-3 bg-blue-200 rounded-lg",children:(0,yt.jsx)(qs,{className:"w-6 h-6 text-blue-700"})})]})}),(0,yt.jsx)("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-sm text-amber-600 font-medium",children:"Avg Wait Time"}),(0,yt.jsxs)("p",{className:"text-3xl font-bold text-amber-900 mt-1",children:[c.avgWaitTime,"min"]}),(0,yt.jsxs)("div",{className:"flex items-center mt-2 text-sm",children:[(0,yt.jsx)(Bs,{className:"w-4 h-4 mr-1 text-green-500"}),(0,yt.jsx)("span",{className:"text-green-600",children:"-8%"}),(0,yt.jsx)("span",{className:"text-gray-600 ml-1",children:"improvement"})]})]}),(0,yt.jsx)("div",{className:"p-3 bg-amber-200 rounded-lg",children:(0,yt.jsx)(Rt,{className:"w-6 h-6 text-amber-700"})})]})}),(0,yt.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Completion Rate"}),(0,yt.jsxs)("p",{className:"text-3xl font-bold text-green-900 mt-1",children:[c.completionRate,"%"]}),(0,yt.jsxs)("div",{className:"flex items-center mt-2 text-sm",children:[(0,yt.jsx)(Bs,{className:"w-4 h-4 mr-1 text-green-500"}),(0,yt.jsx)("span",{className:"text-green-600",children:"+2%"}),(0,yt.jsx)("span",{className:"text-gray-600 ml-1",children:"vs yesterday"})]})]}),(0,yt.jsx)("div",{className:"p-3 bg-green-200 rounded-lg",children:(0,yt.jsx)(Hs,{className:"w-6 h-6 text-green-700"})})]})}),(0,yt.jsx)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg",children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:"Revenue"}),(0,yt.jsxs)("p",{className:"text-3xl font-bold text-purple-900 mt-1",children:["$",c.revenue]}),(0,yt.jsxs)("div",{className:"flex items-center mt-2 text-sm",children:[(0,yt.jsx)(Bs,{className:"w-4 h-4 mr-1 text-green-500"}),(0,yt.jsx)("span",{className:"text-green-600",children:"+22%"}),(0,yt.jsx)("span",{className:"text-gray-600 ml-1",children:"vs target"})]})]}),(0,yt.jsx)("div",{className:"p-3 bg-purple-200 rounded-lg",children:(0,yt.jsx)(Js,{className:"w-6 h-6 text-purple-700"})})]})})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(ht,{className:"w-5 h-5 mr-2"}),"Popular Items"]}),(0,yt.jsx)("div",{className:"space-y-3",children:c.popularItems.map(((e,t)=>(0,yt.jsx)("div",{className:"flex items-center",children:(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,yt.jsx)("span",{className:"font-medium capitalize",children:e.item}),(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.count," orders (",e.percentage,"%)"]})]}),(0,yt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,yt.jsx)("div",{className:"h-2 rounded-full "+(0===t?"bg-blue-500":1===t?"bg-green-500":2===t?"bg-amber-500":"bg-gray-400"),style:{width:`${e.percentage}%`}})})]})},e.item)))}),0===c.popularItems.length&&(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(ht,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,yt.jsx)("p",{children:"No order data available"})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Ts,{className:"w-5 h-5 mr-2"}),"Station Performance"]}),(0,yt.jsx)("div",{className:"space-y-3",children:c.stationPerformance.map((e=>(0,yt.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.stationName}),(0,yt.jsxs)("span",{className:"text-sm font-medium "+(parseFloat(e.efficiency)>90?"text-green-600":parseFloat(e.efficiency)>80?"text-amber-600":"text-red-600"),children:[e.efficiency,"% efficient"]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-gray-500",children:"Orders"}),(0,yt.jsx)("p",{className:"font-semibold",children:e.totalOrders})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-gray-500",children:"Completed"}),(0,yt.jsx)("p",{className:"font-semibold",children:e.completedOrders})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-gray-500",children:"Avg Time"}),(0,yt.jsxs)("p",{className:"font-semibold",children:[e.avgProcessTime,"min"]})]})]})]},e.stationId)))})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(ds,{className:"w-5 h-5 mr-2"}),"Insights & Recommendations"]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.peakTimes.length>0&&(0,yt.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Peak Time Identified"}),(0,yt.jsxs)("p",{className:"text-blue-700",children:["Highest traffic at ",c.peakTimes[0].label," with ",c.peakTimes[0].count," orders"]}),(0,yt.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"\u2192 Add extra staff during this period"})]}),c.popularItems.length>0&&(0,yt.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"font-medium text-green-900 mb-2",children:"Most Popular Item"}),(0,yt.jsxs)("p",{className:"text-green-700",children:[c.popularItems[0].item," accounts for ",c.popularItems[0].percentage,"% of orders"]}),(0,yt.jsx)("p",{className:"text-sm text-green-600 mt-2",children:"\u2192 Ensure sufficient stock and ingredients"})]}),parseFloat(c.avgWaitTime)>10&&(0,yt.jsxs)("div",{className:"p-4 bg-amber-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"font-medium text-amber-900 mb-2",children:"Wait Time Alert"}),(0,yt.jsxs)("p",{className:"text-amber-700",children:["Average wait time (",c.avgWaitTime,"min) exceeds target"]}),(0,yt.jsx)("p",{className:"text-sm text-amber-600 mt-2",children:"\u2192 Consider opening additional stations"})]}),c.stationPerformance.some((e=>parseFloat(e.efficiency)<80))&&(0,yt.jsxs)("div",{className:"p-4 bg-red-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"font-medium text-red-900 mb-2",children:"Station Efficiency"}),(0,yt.jsx)("p",{className:"text-red-700",children:"Some stations operating below 80% efficiency"}),(0,yt.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"\u2192 Review station assignments and workflows"})]})]})]})]})},Gs=dt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Qs=dt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ys=dt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),Ks=dt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Xs=dt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Zs=()=>{const[e,t]=(0,a.useState)({systemName:Nt.systemName||"Coffee Cue",companyName:Nt.companyName||"Coffee Cue",shortName:Nt.shortName||"Coffee Cue",landingTitle:Nt.landingTitle||"Coffee Cue Ordering System",landingSubtitle:Nt.landingSubtitle||"Select your role to continue",adminPanelTitle:Nt.adminPanelTitle||"Coffee Cue Admin",baristaPanelTitle:Nt.baristaPanelTitle||"Coffee Cue Barista",tagline:Nt.tagline||"Skip the Queue, Get Your Cue",footerText:Nt.footerText||"\xa9 2025 Expresso Coffee System | ANZCA ASM 2025 Cairns",customBranding:!0,clientName:"",clientLogo:Nt.logo||"",primaryColor:Nt.primaryColor||"#D97706",secondaryColor:Nt.primaryColorHover||"#B45309",textColor:Nt.accentColor||"#92400E",backgroundColor:"#f9fafb",defaultLanguage:"en",availableLanguages:["en"],translations:{en:{welcomeMessage:"Welcome to {systemName}! I'll take your coffee order. What's your first name?",orderConfirmation:"Thanks {name}! Your {coffee} order has been received.",readyNotification:"Hi {name}, your {coffee} is ready for pickup!",stationChat:"Message from {station}"},es:{welcomeMessage:"\xa1Bienvenido a {systemName}! Tomar\xe9 tu pedido de caf\xe9. \xbfCu\xe1l es tu nombre?",orderConfirmation:"\xa1Gracias {name}! Tu pedido de {coffee} ha sido recibido.",readyNotification:"Hola {name}, tu {coffee} est\xe1 listo para recoger!",stationChat:"Mensaje de {station}"},zh:{welcomeMessage:"\u6b22\u8fce\u6765\u5230{systemName}\uff01\u6211\u6765\u4e3a\u60a8\u70b9\u5496\u5561\u3002\u8bf7\u95ee\u60a8\u7684\u540d\u5b57\u662f\uff1f",orderConfirmation:"\u8c22\u8c22{name}\uff01\u60a8\u7684{coffee}\u8ba2\u5355\u5df2\u6536\u5230\u3002",readyNotification:"\u60a8\u597d{name}\uff0c\u60a8\u7684{coffee}\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\uff01",stationChat:"\u6765\u81ea{station}\u7684\u6d88\u606f"}}}),[s,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)("");(0,a.useEffect)((()=>{u()}),[]);const u=async()=>{try{const e=await xs.getBrandingSettings();e&&t((t=>({...t,...e})))}catch(e){console.error("Error loading branding settings:",e),l("Failed to load branding settings")}},m=(e,s,a)=>{t((t=>({...t,translations:{...t.translations,[e]:{...t.translations[e],[s]:a}}})))};return(0,yt.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[(0,yt.jsx)(Gs,{className:"mr-2"}),"Branding & Customization"]}),o&&(0,yt.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center text-red-700",children:[(0,yt.jsx)(ds,{className:"mr-2",size:20}),o]}),c&&(0,yt.jsxs)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center text-green-700",children:[(0,yt.jsx)(Mt,{className:"mr-2",size:20}),c]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.customBranding,onChange:s=>t({...e,customBranding:s.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),(0,yt.jsx)("span",{className:"text-lg font-medium",children:"Enable Custom Branding"})]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600 mt-1 ml-8",children:"Override default CoffeeCue branding with custom client branding"})]}),e.customBranding&&(0,yt.jsxs)("div",{className:"space-y-4 ml-8",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),(0,yt.jsx)("input",{type:"text",value:e.clientName,onChange:s=>t({...e,clientName:s.target.value}),placeholder:"Sydney Convention Centre",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Name"}),(0,yt.jsx)("input",{type:"text",value:e.systemName,onChange:s=>t({...e,systemName:s.target.value}),placeholder:"Coffee Cue",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),(0,yt.jsx)("input",{type:"text",value:e.companyName,onChange:s=>t({...e,companyName:s.target.value}),placeholder:"Coffee Cue",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Name (for compact views)"}),(0,yt.jsx)("input",{type:"text",value:e.shortName,onChange:s=>t({...e,shortName:s.target.value}),placeholder:"Coffee Cue",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tagline"}),(0,yt.jsx)("input",{type:"text",value:e.tagline,onChange:s=>t({...e,tagline:s.target.value}),placeholder:"Skip the Queue, Get Your Cue",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Landing Page Title"}),(0,yt.jsx)("input",{type:"text",value:e.landingTitle,onChange:s=>t({...e,landingTitle:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Landing Page Subtitle"}),(0,yt.jsx)("input",{type:"text",value:e.landingSubtitle,onChange:s=>t({...e,landingSubtitle:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Panel Title"}),(0,yt.jsx)("input",{type:"text",value:e.adminPanelTitle,onChange:s=>t({...e,adminPanelTitle:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Barista Panel Title"}),(0,yt.jsx)("input",{type:"text",value:e.baristaPanelTitle,onChange:s=>t({...e,baristaPanelTitle:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Footer Text"}),(0,yt.jsx)("input",{type:"text",value:e.footerText,onChange:s=>t({...e,footerText:s.target.value}),placeholder:"\xa9 2025 Expresso Coffee System | ANZCA ASM 2025 Cairns",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This text appears at the bottom of the main page"})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Gs,{className:"mr-2",size:20}),"Color Theme"]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Quick Themes:"}),(0,yt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries({coffeeCue:{name:"Coffee Cue Default",primaryColor:"#D97706",secondaryColor:"#B45309",textColor:"#92400E",backgroundColor:"#f9fafb"},corporate:{name:"Corporate Blue",primaryColor:"#1e3a8a",secondaryColor:"#64748b",textColor:"#0f172a",backgroundColor:"#f8fafc"},warm:{name:"Warm Coffee",primaryColor:"#92400e",secondaryColor:"#ea580c",textColor:"#451a03",backgroundColor:"#fef3c7"},modern:{name:"Modern Dark",primaryColor:"#4f46e5",secondaryColor:"#ec4899",textColor:"#1e293b",backgroundColor:"#f1f5f9"}}).map((e=>{let[s,a]=e;return(0,yt.jsxs)("button",{onClick:()=>(e=>{t((t=>({...t,...e,customBranding:!0})))})(a),className:"p-3 border rounded-lg hover:border-blue-500 transition-colors",style:{borderColor:a.primaryColor,backgroundColor:a.backgroundColor},children:[(0,yt.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,yt.jsx)("div",{className:"w-6 h-6 rounded-full mr-2",style:{backgroundColor:a.primaryColor}}),(0,yt.jsx)("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:a.secondaryColor}})]}),(0,yt.jsx)("p",{className:"text-xs font-medium",style:{color:a.textColor},children:a.name})]},s)}))})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("input",{type:"color",value:e.primaryColor,onChange:s=>t({...e,primaryColor:s.target.value}),className:"h-10 w-20"}),(0,yt.jsx)("input",{type:"text",value:e.primaryColor,onChange:s=>t({...e,primaryColor:s.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Color"}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("input",{type:"color",value:e.secondaryColor,onChange:s=>t({...e,secondaryColor:s.target.value}),className:"h-10 w-20"}),(0,yt.jsx)("input",{type:"text",value:e.secondaryColor,onChange:s=>t({...e,secondaryColor:s.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),(0,yt.jsxs)("button",{onClick:()=>r(!s),className:"mt-4 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center",children:[(0,yt.jsx)(Qs,{className:"mr-2",size:16}),s?"Hide":"Show"," Preview"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Ys,{className:"mr-2",size:20}),"Multi-Language Support"]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),(0,yt.jsxs)("select",{value:e.defaultLanguage,onChange:s=>t({...e,defaultLanguage:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"en",children:"English"}),(0,yt.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,yt.jsx)("option",{value:"zh",children:"\u4e2d\u6587"}),(0,yt.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,yt.jsx)("option",{value:"de",children:"Deutsch"}),(0,yt.jsx)("option",{value:"ja",children:"\u65e5\u672c\u8a9e"})]})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Available Languages:"}),(0,yt.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.availableLanguages.map((e=>(0,yt.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:e},e))),(0,yt.jsx)("button",{onClick:()=>{return s="es",void(e.availableLanguages.includes(s)||t((e=>({...e,availableLanguages:[...e.availableLanguages,s],translations:{...e.translations,[s]:e.translations[s]||{}}}))));var s},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm hover:bg-gray-200",children:"+ Add Language"})]})]}),(0,yt.jsxs)("div",{className:"border-t pt-4",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Message Translations"}),(0,yt.jsx)("div",{className:"space-y-3",children:Object.keys(e.translations[e.defaultLanguage]||{}).map((t=>(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"text-xs text-gray-500",children:[t," (English)"]}),(0,yt.jsx)("input",{type:"text",value:e.translations.en[t],onChange:e=>m("en",t,e.target.value),className:"w-full px-3 py-1 border border-gray-300 rounded text-sm"})]}),e.availableLanguages.filter((e=>"en"!==e)).map((s=>{var a;return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"text-xs text-gray-500",children:[t," (",s,")"]}),(0,yt.jsx)("input",{type:"text",value:(null===(a=e.translations[s])||void 0===a?void 0:a[t])||"",onChange:e=>m(s,t,e.target.value),className:"w-full px-3 py-1 border border-gray-300 rounded text-sm"})]},s)}))]},t)))})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Import/Export Settings"}),(0,yt.jsxs)("div",{className:"flex space-x-4",children:[(0,yt.jsxs)("button",{onClick:()=>{const t=JSON.stringify(e,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(t),a=`branding-settings-${(new Date).toISOString().split("T")[0]}.json`,r=document.createElement("a");r.setAttribute("href",s),r.setAttribute("download",a),r.click()},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center",children:[(0,yt.jsx)(Ws,{className:"mr-2",size:16}),"Export Settings"]}),(0,yt.jsxs)("label",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center cursor-pointer",children:[(0,yt.jsx)(Ks,{className:"mr-2",size:16}),"Import Settings",(0,yt.jsx)("input",{type:"file",accept:".json",onChange:e=>{const s=e.target.files[0];if(s){const e=new FileReader;e.onload=e=>{try{const s=JSON.parse(e.target.result);t(s),d("Settings imported successfully!")}catch(s){l("Invalid settings file")}},e.readAsText(s)}},className:"hidden"})]})]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to reset to default Coffee Cue branding? This will reload the page.")&&(localStorage.removeItem("coffee_system_branding"),window.location.reload())},className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center",children:[(0,yt.jsx)(Xs,{className:"mr-2",size:20}),"Reset to Default"]}),(0,yt.jsx)("button",{onClick:async()=>{i(!0),l(""),d("");try{(e=>{const t={...wt,...e};localStorage.setItem("coffee_system_branding",JSON.stringify(t)),window.location.reload()})({companyName:e.companyName,systemName:e.systemName,shortName:e.shortName,tagline:e.tagline,landingTitle:e.landingTitle,landingSubtitle:e.landingSubtitle,adminPanelTitle:e.adminPanelTitle,baristaPanelTitle:e.baristaPanelTitle,footerText:e.footerText,primaryColor:e.primaryColor,primaryColorHover:e.secondaryColor,accentColor:e.textColor,logo:e.clientLogo,customCSS:e.customCSS||""});try{await xs.updateBrandingSettings(e)}catch(t){console.log("Backend save failed, but local branding updated")}d("Branding settings saved successfully! Page will reload..."),e.customBranding&&(document.documentElement.style.setProperty("--primary-color",e.primaryColor),document.documentElement.style.setProperty("--secondary-color",e.secondaryColor),document.documentElement.style.setProperty("--text-color",e.textColor),document.documentElement.style.setProperty("--bg-color",e.backgroundColor))}catch(t){console.error("Error saving branding settings:",t),l("Failed to save branding settings")}finally{i(!1)}},disabled:n,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center",children:n?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Saving..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(bs,{className:"mr-2",size:20}),"Save Branding Settings"]})})]}),s&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,yt.jsx)("div",{className:"p-4 rounded-lg mb-4",style:{backgroundColor:e.primaryColor,color:"white"},children:(0,yt.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,yt.jsx)(ht,{className:"mr-2"}),e.customBranding&&e.clientName?e.clientName:e.systemName]})}),(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)("div",{className:"p-3 rounded",style:{backgroundColor:e.backgroundColor,color:e.textColor},children:[(0,yt.jsx)("p",{className:"text-sm",children:"Welcome message preview:"}),(0,yt.jsx)("p",{className:"font-medium",children:e.translations[e.defaultLanguage].welcomeMessage.replace("{systemName}",e.systemName)})]}),(0,yt.jsx)("button",{style:{backgroundColor:e.secondaryColor,color:"white"},className:"w-full py-2 rounded-lg font-medium",children:"Sample Button"})]}),(0,yt.jsx)("button",{onClick:()=>r(!1),className:"mt-4 w-full py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close Preview"})]})})]})},ea=dt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ta=dt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),sa=dt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),aa=dt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),ra=e=>{let{onSubmitGroupOrders:t}=e;const[s,r]=(0,a.useState)(""),[n,i]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)({name:"",coffeeType:"Flat White",size:"Regular",milkType:"full_cream",sugar:"No sugar",extraHot:!1,notes:""}),[h,g]=(0,a.useState)([]),[p,f]=(0,a.useState)(!1),[x,y]=(0,a.useState)(!1);(0,a.useEffect)((()=>{try{const e=localStorage.getItem("coffee_group_orders");e&&g(JSON.parse(e))}catch(e){console.error("Failed to load saved groups:",e)}}),[]),(0,a.useEffect)((()=>{if(s){const e=s.trim().substring(0,3).toUpperCase(),t=Math.floor(1e3+9e3*Math.random());i(`${e}-${t}`)}}),[s]);const b=e=>{navigator.clipboard.writeText(e).then((()=>{y(e),setTimeout((()=>y(!1)),2e3)}))};return(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Group Orders"}),(0,yt.jsx)("div",{children:(0,yt.jsx)("button",{className:"px-4 py-2 rounded-md "+(p?"bg-amber-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>f(!p),children:p?"Create New Group":"View Saved Groups"})})]}),p?(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Saved Group Orders"}),0===h.length?(0,yt.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No saved group orders yet."}):(0,yt.jsx)("div",{className:"grid grid-cols-1 gap-4",children:h.map((e=>(0,yt.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"text-lg font-medium",children:e.groupName}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,yt.jsxs)("span",{className:"text-sm bg-gray-100 px-2 py-1 rounded",children:["Code: ",e.groupCode]}),(0,yt.jsx)("button",{onClick:()=>b(e.groupCode),className:"text-gray-500 hover:text-gray-700",title:"Copy code",children:x===e.groupCode?(0,yt.jsx)(Mt,{size:16,className:"text-green-600"}):(0,yt.jsx)(ea,{size:16})})]})]}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsxs)("button",{className:"px-3 py-1 bg-amber-600 text-white rounded-md hover:bg-amber-700 text-sm flex items-center",onClick:()=>(e=>{t&&(t(e),alert(`Group "${e.groupName}" has been sent to the barista queue!`))})(e),children:[(0,yt.jsx)(ht,{size:14,className:"mr-1"}),"Send to Barista"]}),(0,yt.jsx)("button",{className:"px-3 py-1 bg-red-100 text-red-600 rounded-md hover:bg-red-200 text-sm",onClick:()=>(e=>{if(window.confirm("Are you sure you want to delete this group?")){const t=h.filter((t=>t.id!==e));localStorage.setItem("coffee_group_orders",JSON.stringify(t)),g(t)}})(e.id),children:(0,yt.jsx)(sa,{size:14})})]})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["Created: ",new Date(e.createdAt).toLocaleString()]}),e.notes&&(0,yt.jsxs)("div",{className:"text-sm bg-yellow-50 p-2 rounded mb-2",children:["Notes: ",e.notes]}),(0,yt.jsxs)("div",{className:"mt-2",children:[(0,yt.jsxs)("div",{className:"text-sm font-medium",children:[e.orders.length," ",1===e.orders.length?"coffee":"coffees"," in this group"]}),(0,yt.jsx)("div",{className:"mt-1 max-h-32 overflow-y-auto",children:e.orders.map(((e,t)=>{var s;return(0,yt.jsxs)("div",{className:"text-sm p-1 border-b last:border-b-0",children:[(0,yt.jsx)("span",{className:"font-medium",children:e.name}),":\xa0",(0,yt.jsxs)("span",{className:"text-gray-600",children:[e.size," ",e.coffeeType,",",(null===(s=qt.en.find((t=>t.id===e.milkType)))||void 0===s?void 0:s.name)||e.milkType,",",e.sugar,e.extraHot?", Extra Hot":"",e.notes?`, ${e.notes}`:""]})]},t)}))})]})]},e.id)))})]}):(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Name*"}),(0,yt.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded",placeholder:"e.g. Marketing Team, Room 101",required:!0})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Code (auto-generated)"}),(0,yt.jsxs)("div",{className:"flex",children:[(0,yt.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded-l",placeholder:"Code will be generated",readOnly:!0}),(0,yt.jsx)("button",{className:"bg-gray-200 px-3 rounded-r border-y border-r",onClick:()=>b(n),title:"Copy code",children:x===n?(0,yt.jsx)(Mt,{size:18,className:"text-green-600"}):(0,yt.jsx)(ea,{size:18})})]}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This code can be used by members to reference the group order."})]})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Notes (optional)"}),(0,yt.jsx)("textarea",{value:o,onChange:e=>l(e.target.value),className:"w-full p-2 border rounded",rows:"2",placeholder:"e.g. Break time at 10:30am, Priority group, etc."})]}),(0,yt.jsx)("hr",{className:"my-4"}),(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Individual Orders"}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name*"}),(0,yt.jsx)("input",{type:"text",value:u.name,onChange:e=>m({...u,name:e.target.value}),className:"w-full p-2 border rounded",placeholder:"Person's name"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),(0,yt.jsxs)("select",{value:u.size,onChange:e=>m({...u,size:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"Small",children:"Small"}),(0,yt.jsx)("option",{value:"Regular",children:"Regular"}),(0,yt.jsx)("option",{value:"Large",children:"Large"})]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coffee Type*"}),(0,yt.jsxs)("select",{value:u.coffeeType,onChange:e=>m({...u,coffeeType:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"Espresso",children:"Espresso"}),(0,yt.jsx)("option",{value:"Long Black",children:"Long Black"}),(0,yt.jsx)("option",{value:"Flat White",children:"Flat White"}),(0,yt.jsx)("option",{value:"Cappuccino",children:"Cappuccino"}),(0,yt.jsx)("option",{value:"Latte",children:"Latte"}),(0,yt.jsx)("option",{value:"Mocha",children:"Mocha"}),(0,yt.jsx)("option",{value:"Hot Chocolate",children:"Hot Chocolate"}),(0,yt.jsx)("option",{value:"Chai Latte",children:"Chai Latte"}),(0,yt.jsx)("option",{value:"Tea",children:"Tea"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Milk Type"}),(0,yt.jsxs)("select",{value:u.milkType,onChange:e=>m({...u,milkType:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("optgroup",{label:"Standard Milks",children:qt.en.filter((e=>"standard"===e.category)).map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.name,e.properties.lactoseFree?" (Lactose-Free)":"",e.properties.lowFat?" (Low-Fat)":""]},e.id)))}),(0,yt.jsx)("optgroup",{label:"Alternative Milks",children:qt.en.filter((e=>"alternative"===e.category)).map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.name,e.properties.vegan?" (Vegan)":""]},e.id)))}),(0,yt.jsx)("option",{value:"no_milk",children:"No milk"})]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sugar"}),(0,yt.jsxs)("select",{value:u.sugar,onChange:e=>m({...u,sugar:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"No sugar",children:"No sugar"}),(0,yt.jsx)("option",{value:"1 sugar",children:"1 sugar"}),(0,yt.jsx)("option",{value:"2 sugars",children:"2 sugars"}),(0,yt.jsx)("option",{value:"3 sugars",children:"3 sugars"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),(0,yt.jsx)("input",{type:"text",value:u.notes,onChange:e=>m({...u,notes:e.target.value}),className:"w-full p-2 border rounded",placeholder:"e.g. extra hot, decaf, etc."})]})]}),(0,yt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,yt.jsx)("input",{type:"checkbox",id:"extraHot",checked:u.extraHot,onChange:e=>m({...u,extraHot:e.target.checked}),className:"mr-2"}),(0,yt.jsx)("label",{htmlFor:"extraHot",className:"text-sm text-gray-700",children:"Extra hot"})]}),(0,yt.jsxs)("button",{className:"w-full p-2 flex items-center justify-center bg-green-600 text-white rounded-md hover:bg-green-700",onClick:()=>{u.name?(d([...c,{...u,id:Date.now()}]),m({...u,name:""})):alert("Please enter a name for this order")},children:[(0,yt.jsx)(ta,{size:18,className:"mr-2"}),"Add Coffee Order"]})]}),c.length>0&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("h3",{className:"text-md font-medium mb-2",children:["Orders in this group: ",c.length]}),(0,yt.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 max-h-60 overflow-y-auto",children:c.map(((e,t)=>{var s;return(0,yt.jsxs)("div",{className:"flex items-center justify-between p-2 border-b last:border-b-0",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(ht,{size:16,className:"mr-2 text-amber-600"}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"font-medium",children:e.name}),(0,yt.jsxs)("span",{className:"text-sm text-gray-600 ml-2",children:[e.size," ",e.coffeeType,",",(null===(s=qt.en.find((t=>t.id===e.milkType)))||void 0===s?void 0:s.name)||e.milkType,",",e.sugar,e.extraHot?", Extra Hot":"",e.notes?`, ${e.notes}`:""]})]})]}),(0,yt.jsx)("button",{onClick:()=>{return t=e.id,void d(c.filter((e=>e.id!==t)));var t},className:"text-red-500 hover:text-red-700",children:(0,yt.jsx)(sa,{size:16})})]},e.id)}))}),(0,yt.jsxs)("button",{className:"w-full p-3 mt-4 bg-amber-600 text-white rounded-md hover:bg-amber-700 flex items-center justify-center",onClick:()=>{if(!s)return void alert("Please enter a group name");if(0===c.length)return void alert("Please add at least one coffee order to the group");const e={id:Date.now(),groupName:s,groupCode:n,notes:o,orders:c,createdAt:(new Date).toISOString()};try{const t=[...h,e];localStorage.setItem("coffee_group_orders",JSON.stringify(t)),g(t),alert(`Group "${s}" created with code ${n}`),r(""),i(""),l(""),d([])}catch(t){console.error("Failed to save group order:",t),alert("Failed to save group order. Please try again.")}},children:[(0,yt.jsx)(aa,{size:18,className:"mr-2"}),"Save Group Order (",c.length," coffees)"]})]})]})]})},na=dt("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),ia=dt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]),oa=dt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),la=dt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),ca=dt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),da=dt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ua=()=>{const[e,t]=(0,a.useState)({pending:[],inProgress:[],completed:[],previous:[]}),[s,r]=(0,a.useState)("all"),[n,i]=(0,a.useState)("all"),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)({totalOrders:0,pendingCount:0,inProgressCount:0,completedCount:0,avgWaitTime:0,busiestStation:null});(0,a.useEffect)((()=>{h();const e=setInterval(h,3e4);return()=>clearInterval(e)}),[]);const h=()=>{try{const e={pending:[],inProgress:[],completed:[],previous:[]};["1","2","3"].forEach((t=>{const s=`orders_cache_station_${t}`,a=localStorage.getItem(s);if(a)try{const s=JSON.parse(a);s.pendingOrders&&e.pending.push(...s.pendingOrders.map((e=>({...e,assignedStation:t})))),s.inProgressOrders&&e.inProgress.push(...s.inProgressOrders.map((e=>({...e,assignedStation:t})))),s.completedOrders&&e.completed.push(...s.completedOrders.map((e=>({...e,assignedStation:t})))),s.previousOrders&&e.previous.push(...s.previousOrders.map((e=>({...e,assignedStation:t}))))}catch(bn){console.error(`Error parsing orders for station ${t}:`,bn)}})),e.pending.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))),e.inProgress.sort(((e,t)=>new Date(t.startedAt)-new Date(e.startedAt))),e.completed.sort(((e,t)=>new Date(t.completedAt)-new Date(e.completedAt))),e.previous.sort(((e,t)=>new Date(t.pickedUpAt)-new Date(e.pickedUpAt))),t(e),g(e),d(!1)}catch(e){console.error("Error loading all orders:",e),d(!1)}},g=e=>{var t;const s=e.pending.length+e.inProgress.length+e.completed.length+e.previous.length,a=[...e.completed,...e.previous].filter((e=>e.waitTime)).map((e=>e.waitTime)),r=a.length>0?Math.round(a.reduce(((e,t)=>e+t),0)/a.length):0,n={};[...e.pending,...e.inProgress,...e.completed,...e.previous].forEach((e=>{const t=e.assignedStation||"unassigned";n[t]=(n[t]||0)+1}));const i=(null===(t=Object.entries(n).sort(((e,t)=>{let[,s]=e,[,a]=t;return a-s}))[0])||void 0===t?void 0:t[0])||null;m({totalOrders:s,pendingCount:e.pending.length,inProgressCount:e.inProgress.length,completedCount:e.completed.length,avgWaitTime:r,busiestStation:i})},p=e=>e.filter((e=>{if("all"!==n&&e.assignedStation!==n)return!1;if(o){var t,s,a,r;const n=o.toLowerCase();return(null===(t=e.customerName)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(s=e.phoneNumber)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(a=e.coffeeType)||void 0===a?void 0:a.toLowerCase().includes(n))||(null===(r=e.id)||void 0===r?void 0:r.toString().includes(n))}return!0})),f=(e,t)=>{const s=e.milkType&&"No Milk"!==e.milkType?ns(e.milkType,e.milkTypeId):{borderLeftWidth:"4px",borderLeftStyle:"solid",borderLeftColor:"#D1D5DB"},a={pending:(0,yt.jsx)(Rt,{size:16,className:"text-amber-600"}),inProgress:(0,yt.jsx)(ht,{size:16,className:"text-blue-600"}),completed:(0,yt.jsx)(St,{size:16,className:"text-green-600"}),previous:(0,yt.jsx)(At,{size:16,className:"text-gray-600"})};return(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-3 mb-2",style:s,children:(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[a[t],(0,yt.jsxs)("span",{className:"font-bold",children:["Order #",e.id]}),(0,yt.jsxs)("span",{className:"text-sm text-gray-500",children:["Station ",e.assignedStation||"?"]}),e.priority&&(0,yt.jsx)("span",{className:"bg-red-100 text-red-700 px-2 py-0.5 rounded text-xs font-medium",children:"PRIORITY"})]}),(0,yt.jsxs)("div",{className:"mt-1",children:[(0,yt.jsx)("div",{className:"font-medium",children:e.customerName}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.milkType&&"No Milk"!==e.milkType&&(0,yt.jsx)("span",{style:is(e.milkType,e.milkTypeId)}),e.coffeeType,", ",e.milkType,", ",e.sugar]})]})]}),(0,yt.jsxs)("div",{className:"text-right text-sm",children:["pending"===t&&(0,yt.jsxs)("div",{className:"text-amber-600",children:["Waiting ",e.waitTime," min"]}),"inProgress"===t&&e.startedAt&&(0,yt.jsxs)("div",{className:"text-blue-600",children:["Started ",Math.round((Date.now()-new Date(e.startedAt))/6e4)," min ago"]}),"completed"===t&&e.completedAt&&(0,yt.jsxs)("div",{className:"text-green-600",children:["Ready ",Math.round((Date.now()-new Date(e.completedAt))/6e4)," min ago"]}),"previous"===t&&e.pickedUpAt&&(0,yt.jsxs)("div",{className:"text-gray-600",children:["Picked up ",new Date(e.pickedUpAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]})},e.id)};if(c)return(0,yt.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,yt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"})});const x=(()=>{switch(s){case"pending":return{orders:p(e.pending),status:"pending"};case"inProgress":return{orders:p(e.inProgress),status:"inProgress"};case"completed":return{orders:p(e.completed),status:"completed"};default:return{orders:[...p(e.pending).map((e=>({...e,_status:"pending"}))),...p(e.inProgress).map((e=>({...e,_status:"inProgress"}))),...p(e.completed).map((e=>({...e,_status:"completed"})))],status:"mixed"}}})();return(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:u.totalOrders}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Total Orders"})]}),(0,yt.jsxs)("div",{className:"bg-amber-50 rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:u.pendingCount}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Pending"})]}),(0,yt.jsxs)("div",{className:"bg-blue-50 rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:u.inProgressCount}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"In Progress"})]}),(0,yt.jsxs)("div",{className:"bg-green-50 rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:u.completedCount}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Ready"})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold text-gray-600",children:[u.avgWaitTime," min"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Wait"})]})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,yt.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(da,{size:18,className:"text-gray-500"}),(0,yt.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"border rounded px-3 py-1",children:[(0,yt.jsx)("option",{value:"all",children:"All Orders"}),(0,yt.jsx)("option",{value:"pending",children:"Pending Only"}),(0,yt.jsx)("option",{value:"inProgress",children:"In Progress Only"}),(0,yt.jsx)("option",{value:"completed",children:"Completed Only"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(zt,{size:18,className:"text-gray-500"}),(0,yt.jsxs)("select",{value:n,onChange:e=>i(e.target.value),className:"border rounded px-3 py-1",children:[(0,yt.jsx)("option",{value:"all",children:"All Stations"}),(0,yt.jsx)("option",{value:"1",children:"Station 1"}),(0,yt.jsx)("option",{value:"2",children:"Station 2"}),(0,yt.jsx)("option",{value:"3",children:"Station 3"})]})]}),(0,yt.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,yt.jsx)(ps,{size:18,className:"text-gray-500"}),(0,yt.jsx)("input",{type:"text",placeholder:"Search by name, phone, or order #...",value:o,onChange:e=>l(e.target.value),className:"flex-1 border rounded px-3 py-1"})]}),(0,yt.jsx)("button",{onClick:h,className:"bg-amber-600 text-white px-4 py-1 rounded hover:bg-amber-700",children:"Refresh"})]})}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("h3",{className:"text-lg font-bold mb-3",children:["all"===s?"All Active Orders":`${s.charAt(0).toUpperCase()+s.slice(1)} Orders`,"all"!==n&&` - Station ${n}`]}),x.orders.length>0?(0,yt.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:"mixed"===x.status?x.orders.map((e=>f(e,e._status))):x.orders.map((e=>f(e,x.status)))}):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(ds,{size:32,className:"mx-auto mb-2 text-gray-400"}),(0,yt.jsx)("p",{children:"No orders found matching your filters"})]})]}),u.busiestStation&&(0,yt.jsx)("div",{className:"bg-blue-50 rounded-lg shadow-sm p-4",children:(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(ds,{size:18,className:"text-blue-600"}),(0,yt.jsxs)("span",{className:"text-sm",children:["Station ",u.busiestStation," is the busiest station right now"]})]})})]})},ma=dt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ha=dt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ga=dt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),pa=()=>{const[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)("all"),[u,m]=(0,a.useState)(null),[h,g]=(0,a.useState)({}),[p,f]=(0,a.useState)({username:"",password:"",confirmPassword:"",email:"",fullName:"",role:"barista",phone:"",experience:"beginner",skills:{espresso:!1,latte_art:!1,customer_service:!1,inventory_management:!1,speed:!1,training_others:!1},availability:{monday:{available:!1,start:"08:00",end:"17:00"},tuesday:{available:!1,start:"08:00",end:"17:00"},wednesday:{available:!1,start:"08:00",end:"17:00"},thursday:{available:!1,start:"08:00",end:"17:00"},friday:{available:!1,start:"08:00",end:"17:00"},saturday:{available:!1,start:"08:00",end:"17:00"},sunday:{available:!1,start:"08:00",end:"17:00"}},preferredStation:"",certifications:[],notes:"",active:!0});(0,a.useEffect)((()=>{x()}),[]);const x=()=>{try{const e=localStorage.getItem("coffee_system_users");if(e)t(JSON.parse(e));else{const e=[{id:"user_1",username:"barista1",email:"barista1@coffee.com",fullName:"John Smith",role:"barista",phone:"555-0101",experience:"intermediate",skills:{espresso:!0,latte_art:!0,customer_service:!0,inventory_management:!1,speed:!0,training_others:!1},preferredStation:"1",active:!0,createdAt:(new Date).toISOString(),stats:{totalOrders:156,avgPrepTime:3.5,rating:4.8}}];t(e),localStorage.setItem("coffee_system_users",JSON.stringify(e))}}catch(e){console.error("Error loading users:",e)}},y=e=>{try{localStorage.setItem("coffee_system_users",JSON.stringify(e)),t(e)}catch(s){console.error("Error saving users:",s),alert("Failed to save users")}},b=()=>{f({username:"",password:"",confirmPassword:"",email:"",fullName:"",role:"barista",phone:"",experience:"beginner",skills:{espresso:!1,latte_art:!1,customer_service:!1,inventory_management:!1,speed:!1,training_others:!1},availability:{monday:{available:!1,start:"08:00",end:"17:00"},tuesday:{available:!1,start:"08:00",end:"17:00"},wednesday:{available:!1,start:"08:00",end:"17:00"},thursday:{available:!1,start:"08:00",end:"17:00"},friday:{available:!1,start:"08:00",end:"17:00"},saturday:{available:!1,start:"08:00",end:"17:00"},sunday:{available:!1,start:"08:00",end:"17:00"}},preferredStation:"",certifications:[],notes:"",active:!0})},v=e.filter((e=>{const t=e.fullName.toLowerCase().includes(o.toLowerCase())||e.username.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase()),s="all"===c||e.role===c;return t&&s})),j=e=>{switch(e){case"expert":return"text-purple-600 bg-purple-100";case"advanced":return"text-blue-600 bg-blue-100";case"intermediate":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},w=e=>{switch(e){case"admin":return"bg-red-100 text-red-700";case"organizer":return"bg-purple-100 text-purple-700";case"barista":return"bg-amber-100 text-amber-700";default:return"bg-gray-100 text-gray-700"}};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold",children:"User Management"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Manage barista profiles, skills, and schedules"})]}),(0,yt.jsxs)("button",{onClick:()=>{b(),r(!0),i(null)},className:"bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 flex items-center gap-2",children:[(0,yt.jsx)(ma,{size:18}),"Add New User"]})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,yt.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,yt.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,yt.jsx)(ps,{size:18,className:"text-gray-500"}),(0,yt.jsx)("input",{type:"text",placeholder:"Search users by name, username, or email...",value:o,onChange:e=>l(e.target.value),className:"flex-1 border rounded px-3 py-1"})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(da,{size:18,className:"text-gray-500"}),(0,yt.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"border rounded px-3 py-1",children:[(0,yt.jsx)("option",{value:"all",children:"All Roles"}),(0,yt.jsx)("option",{value:"barista",children:"Baristas"}),(0,yt.jsx)("option",{value:"organizer",children:"Organizers"}),(0,yt.jsx)("option",{value:"admin",children:"Admins"})]})]})]})}),(s||n)&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-bold mb-4",children:n?"Edit User":"Add New User"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Username *"}),(0,yt.jsx)("input",{type:"text",value:p.username,onChange:e=>f({...p,username:e.target.value}),className:"w-full border rounded px-3 py-2",disabled:n})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Full Name *"}),(0,yt.jsx)("input",{type:"text",value:p.fullName,onChange:e=>f({...p,fullName:e.target.value}),className:"w-full border rounded px-3 py-2"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,yt.jsx)("input",{type:"email",value:p.email,onChange:e=>f({...p,email:e.target.value}),className:"w-full border rounded px-3 py-2"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),(0,yt.jsx)("input",{type:"tel",value:p.phone,onChange:e=>f({...p,phone:e.target.value}),className:"w-full border rounded px-3 py-2"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Role *"}),(0,yt.jsxs)("select",{value:p.role,onChange:e=>f({...p,role:e.target.value}),className:"w-full border rounded px-3 py-2",children:[(0,yt.jsx)("option",{value:"barista",children:"Barista"}),(0,yt.jsx)("option",{value:"organizer",children:"Organizer"}),(0,yt.jsx)("option",{value:"admin",children:"Admin"})]})]}),!n&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Password *"}),(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)("input",{type:h.new?"text":"password",value:p.password,onChange:e=>f({...p,password:e.target.value}),className:"w-full border rounded px-3 py-2 pr-10"}),(0,yt.jsx)("button",{type:"button",onClick:()=>g({...h,new:!h.new}),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500",children:h.new?(0,yt.jsx)(ha,{size:18}):(0,yt.jsx)(Qs,{size:18})})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Confirm Password *"}),(0,yt.jsx)("input",{type:"password",value:p.confirmPassword,onChange:e=>f({...p,confirmPassword:e.target.value}),className:"w-full border rounded px-3 py-2"})]})]})]}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Experience Level"}),(0,yt.jsxs)("select",{value:p.experience,onChange:e=>f({...p,experience:e.target.value}),className:"w-full border rounded px-3 py-2",children:[(0,yt.jsx)("option",{value:"beginner",children:"Beginner (0-1 years)"}),(0,yt.jsx)("option",{value:"intermediate",children:"Intermediate (1-3 years)"}),(0,yt.jsx)("option",{value:"advanced",children:"Advanced (3-5 years)"}),(0,yt.jsx)("option",{value:"expert",children:"Expert (5+ years)"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Preferred Station"}),(0,yt.jsxs)("select",{value:p.preferredStation,onChange:e=>f({...p,preferredStation:e.target.value}),className:"w-full border rounded px-3 py-2",children:[(0,yt.jsx)("option",{value:"",children:"No preference"}),(0,yt.jsx)("option",{value:"1",children:"Station 1"}),(0,yt.jsx)("option",{value:"2",children:"Station 2"}),(0,yt.jsx)("option",{value:"3",children:"Station 3"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Skills"}),(0,yt.jsx)("div",{className:"space-y-2",children:Object.entries({espresso:"Espresso Making",latte_art:"Latte Art",customer_service:"Customer Service",inventory_management:"Inventory Management",speed:"High-Speed Service",training_others:"Training Others"}).map((e=>{let[t,s]=e;return(0,yt.jsxs)("label",{className:"flex items-center gap-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:p.skills[t],onChange:e=>f({...p,skills:{...p.skills,[t]:e.target.checked}}),className:"rounded"}),(0,yt.jsx)("span",{className:"text-sm",children:s})]},t)}))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),(0,yt.jsx)("textarea",{value:p.notes,onChange:e=>f({...p,notes:e.target.value}),className:"w-full border rounded px-3 py-2",rows:"3",placeholder:"Additional notes about this user..."})]}),(0,yt.jsx)("div",{children:(0,yt.jsxs)("label",{className:"flex items-center gap-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:p.active,onChange:e=>f({...p,active:e.target.checked}),className:"rounded"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Active User"})]})})]})]}),(0,yt.jsxs)("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[(0,yt.jsx)("button",{onClick:()=>{b(),r(!1),i(null)},className:"px-4 py-2 border rounded hover:bg-gray-50",children:"Cancel"}),(0,yt.jsxs)("button",{onClick:n?()=>{if(!p.username||!p.fullName)return void alert("Please fill in all required fields");const t=e.map((e=>e.id===n?{...e,...p,password:p.password||e.password,updatedAt:(new Date).toISOString()}:e));y(t),b(),i(null)}:()=>{if(!p.username||!p.password||!p.fullName)return void alert("Please fill in all required fields");if(p.password!==p.confirmPassword)return void alert("Passwords do not match");if(e.some((e=>e.username===p.username)))return void alert("Username already exists");const t={id:`user_${Date.now()}`,...p,createdAt:(new Date).toISOString(),stats:{totalOrders:0,avgPrepTime:0,rating:0}};delete t.confirmPassword,t.password="***",y([...e,t]),b(),r(!1)},className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700 flex items-center gap-2",children:[(0,yt.jsx)(bs,{size:18}),n?"Update User":"Create User"]})]})]}),(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow-sm",children:v.length>0?(0,yt.jsx)("div",{className:"divide-y",children:v.map((t=>(0,yt.jsxs)("div",{className:"p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("div",{className:"w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center",children:(0,yt.jsx)(mt,{size:20,className:"text-amber-700"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("h4",{className:"font-bold",children:t.fullName}),(0,yt.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${w(t.role)}`,children:t.role}),!t.active&&(0,yt.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600",children:"Inactive"})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["@",t.username," \u2022 ",t.email]}),(0,yt.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,yt.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${j(t.experience)}`,children:t.experience}),t.preferredStation&&(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:["Prefers Station ",t.preferredStation]}),t.stats&&t.stats.totalOrders>0&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:[t.stats.totalOrders," orders"]}),(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:["Avg ",t.stats.avgPrepTime,"min"]}),t.stats.rating>0&&(0,yt.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,yt.jsx)(fs,{size:12,className:"text-yellow-500"}),t.stats.rating]})]})]})]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("button",{onClick:()=>m(u===t.id?null:t.id),className:"p-2 hover:bg-gray-100 rounded",children:u===t.id?(0,yt.jsx)(Ls,{size:18}):(0,yt.jsx)(It,{size:18})}),(0,yt.jsx)("button",{onClick:()=>(e=>{f({...e,password:"",confirmPassword:""}),i(e.id),r(!1)})(t),className:"p-2 hover:bg-gray-100 rounded text-blue-600",children:(0,yt.jsx)(ga,{size:18})}),(0,yt.jsx)("button",{onClick:()=>{return s=t.id,void(window.confirm("Are you sure you want to delete this user?")&&y(e.filter((e=>e.id!==s))));var s},className:"p-2 hover:bg-gray-100 rounded text-red-600",children:(0,yt.jsx)(sa,{size:18})})]})]}),u===t.id&&(0,yt.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h5",{className:"font-medium mb-2",children:"Skills"}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(t.skills||{}).filter((e=>{let[t,s]=e;return s})).map((e=>{let[t]=e;return(0,yt.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:t.replace(/_/g," ")},t)}))})]}),t.availability&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h5",{className:"font-medium mb-2",children:"Availability"}),(0,yt.jsx)("div",{className:"text-xs space-y-1",children:Object.entries(t.availability).filter((e=>{let[t,s]=e;return s.available})).map((e=>{let[t,s]=e;return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("span",{className:"capitalize",children:[t,":"]})," ",s.start," - ",s.end]},t)}))})]})]}),t.notes&&(0,yt.jsxs)("div",{className:"mt-4",children:[(0,yt.jsx)("h5",{className:"font-medium mb-1",children:"Notes"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:t.notes})]})]})]},t.id)))}):(0,yt.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,yt.jsx)(mt,{size:48,className:"mx-auto mb-2 text-gray-300"}),(0,yt.jsx)("p",{children:"No users found"})]})})]})},fa=dt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),xa=dt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),ya=dt("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),ba=dt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),va=dt("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),ja=dt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),wa=()=>{var e,t;const{stations:s,updateStation:r}=Xt(),{pendingOrders:n,inProgressOrders:i,completedOrders:o,online:l,queueCount:c,refreshData:d,sendMessage:u}=Gt(),m={pending:n||[],inProgress:i||[],completed:o||[]},{settings:h}=Ns(),[g,p]=(0,a.useState)([]),[f,x]=(0,a.useState)(null),[y,b]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(""),[k,S]=(0,a.useState)([]),[C,_]=(0,a.useState)("grid"),E=(0,a.useMemo)((()=>{if(!m)return{totalOrders:0,avgWaitTime:0,activeStations:0,loadPercentage:0,ordersPerHour:0,customerSatisfaction:0,totalRevenue:0,peakTime:null};const e=m.pending.length+m.inProgress.length,t=m.pending.length>0?m.pending.reduce(((e,t)=>e+(t.waitTime||0)),0)/m.pending.length:0,a=s.filter((e=>"active"===e.status)).length,r=s.reduce(((e,t)=>e+(t.max_concurrent_orders||5)),0),n=m.inProgress.length,i=r>0?n/r*100:0,o=m.completed.filter((e=>new Date(e.completed_at||e.updated_at)>new Date(Date.now()-36e5))).length,l=m.completed.reduce(((e,t)=>e+(t.total||0)),0),c={};m.completed.forEach((e=>{const t=new Date(e.created_at).getHours();c[t]=(c[t]||0)+1}));const d=Object.entries(c).sort(((e,t)=>t[1]-e[1]))[0];return{totalOrders:e,avgWaitTime:Math.round(t),activeStations:a,loadPercentage:Math.round(i),ordersPerHour:o,customerSatisfaction:94,totalRevenue:l,peakTime:d?`${d[0]}:00`:null}}),[m,s]);(0,a.useEffect)((()=>{const e=[];s.forEach((t=>{const s=m.inProgress.filter((e=>e.station_id===t.id)),a=m.pending.filter((e=>{var s;return e.preferred_station===t.id||!e.preferred_station&&(null===(s=t.capabilities)||void 0===s?void 0:s.standard_coffee)})),r=s.length+a.length,n=t.max_concurrent_orders||5;r>1.5*n?e.push({id:`overload-${t.id}`,type:"overload",severity:"critical",station:t.name,stationId:t.id,message:`${t.name} critically overloaded`,detail:`${r} orders (${Math.round(r/n*100)}% capacity)`,action:"Redistribute",timestamp:new Date}):r>n&&e.push({id:`overload-${t.id}`,type:"overload",severity:"warning",station:t.name,stationId:t.id,message:`${t.name} overloaded`,detail:`${r} orders queued`,action:"Monitor",timestamp:new Date})}));const t=m.pending.filter((e=>e.waitTime>15)),a=m.pending.filter((e=>e.waitTime>20));a.length>0?e.push({id:"critical-wait",type:"wait",severity:"critical",message:`${a.length} orders waiting over 20 minutes`,detail:"Customer satisfaction at risk",action:"Urgent Action",timestamp:new Date}):t.length>5&&e.push({id:"long-wait",type:"wait",severity:"warning",message:`${t.length} orders waiting over 15 minutes`,detail:"Consider opening another station",action:"Review",timestamp:new Date});const r=m.pending.filter((e=>e.vip||e.priority));r.length>0&&e.push({id:"vip-orders",type:"vip",severity:"info",message:`${r.length} VIP orders pending`,detail:r.map((e=>`#${e.orderNumber}`)).join(", "),action:"Prioritize",timestamp:new Date});s.filter((e=>{var t;return(null===(t=e.low_stock_items)||void 0===t?void 0:t.length)>0})).forEach((t=>{var s,a;e.push({id:`stock-${t.id}`,type:"stock",severity:(null===(s=t.critical_stock_items)||void 0===s?void 0:s.length)>0?"critical":"warning",station:t.name,message:`${t.name} low on supplies`,detail:(null===(a=t.low_stock_items)||void 0===a?void 0:a.join(", "))||"Check inventory",action:"Restock",timestamp:new Date})})),E.loadPercentage>90&&e.push({id:"system-load",type:"system",severity:"critical",message:"System at maximum capacity",detail:`${E.loadPercentage}% load across all stations`,action:"Open Station",timestamp:new Date}),p(e.sort(((e,t)=>{const s={critical:0,warning:1,info:2};return s[e.severity]-s[t.severity]})))}),[null===m||void 0===m||null===(e=m.pending)||void 0===e?void 0:e.length,null===m||void 0===m||null===(t=m.inProgress)||void 0===t?void 0:t.length,null===s||void 0===s?void 0:s.length,E.loadPercentage]);const T=(0,a.useCallback)(((e,t)=>{S((s=>[{id:Date.now(),type:e,message:t,timestamp:new Date},...s].slice(0,20)))}),[]),I=((0,a.useCallback)((async e=>{try{T("system",`Redistributing orders from station ${e}`)}catch(t){console.error("Failed to redistribute:",t)}}),[T]),(0,a.useCallback)((e=>{console.log("Handling long wait orders:",e)}),[]),(0,a.useCallback)((e=>{console.log("Prioritizing VIP orders:",e)}),[]),e=>{const t=(m.inProgress.filter((t=>t.station_id===e.id)).length+m.pending.filter((t=>t.preferred_station===e.id)).length)/(e.max_concurrent_orders||5);return"active"!==e.status?"bg-gray-100 border-gray-300":t>1.2?"bg-red-50 border-red-300":t>.8?"bg-yellow-50 border-yellow-300":t>.5?"bg-blue-50 border-blue-300":"bg-green-50 border-green-300"});return(0,yt.jsxs)("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Live Operations Command Center"}),(0,yt.jsx)("div",{className:"flex items-center space-x-2",children:l?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(fa,{className:"text-green-500",size:20}),(0,yt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"System Online"})]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(xa,{className:"text-red-500",size:20}),(0,yt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Offline Mode"})]})}),(0,yt.jsxs)("div",{className:"text-sm text-gray-500",children:["Last update: ",(new Date).toLocaleTimeString()]})]}),(0,yt.jsxs)("button",{onClick:d,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900",children:[(0,yt.jsx)(Ot,{size:16}),(0,yt.jsx)("span",{children:"Refresh"})]})]})}),g.length>0&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,yt.jsx)("div",{className:"bg-red-600 text-white px-6 py-3",children:(0,yt.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,yt.jsx)(gs,{className:"mr-2",size:20}),"Critical Alerts (",g.filter((e=>"critical"===e.severity)).length," critical, ",g.filter((e=>"warning"===e.severity)).length," warnings)"]})}),(0,yt.jsx)("div",{className:"p-4 space-y-3 max-h-64 overflow-y-auto",children:g.map((e=>{return(0,yt.jsx)("div",{className:`p-4 rounded-lg border ${s=e.severity,{critical:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"}[s]||"bg-gray-50 border-gray-200"}`,children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-start space-x-3",children:[(t=e.type,{overload:(0,yt.jsx)(zt,{className:"text-red-500",size:20}),wait:(0,yt.jsx)(Rt,{className:"text-yellow-500",size:20}),vip:(0,yt.jsx)(Es,{className:"text-purple-500",size:20}),stock:(0,yt.jsx)(At,{className:"text-orange-500",size:20}),system:(0,yt.jsx)(ds,{className:"text-red-500",size:20})}[t]||(0,yt.jsx)(ca,{className:"text-blue-500",size:20})),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"font-semibold",children:e.message}),e.detail&&(0,yt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.detail}),(0,yt.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]})]}),e.action&&(0,yt.jsx)("button",{onClick:e.actionHandler,className:"px-4 py-2 rounded text-sm font-medium "+("critical"===e.severity?"bg-red-600 text-white hover:bg-red-700":"warning"===e.severity?"bg-yellow-600 text-white hover:bg-yellow-700":"bg-blue-600 text-white hover:bg-blue-700"),children:e.action})]})},e.id);var t,s}))})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(ht,{className:"text-gray-400",size:20}),(0,yt.jsx)("span",{className:"text-xs text-green-600",children:"+12%"})]}),(0,yt.jsx)("div",{className:"text-2xl font-bold",children:E.totalOrders}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Active Orders"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(Rt,{className:"text-gray-400",size:20}),(0,yt.jsx)("span",{className:"text-xs "+(E.avgWaitTime>15?"text-red-600":"text-green-600"),children:E.avgWaitTime>15?"\u2191":"\u2193"})]}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[E.avgWaitTime,"m"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Avg Wait"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(zt,{className:"text-gray-400",size:20})}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[E.activeStations,"/",s.length]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Active Stations"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(qs,{className:"text-gray-400",size:20})}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[E.loadPercentage,"%"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"System Load"}),(0,yt.jsx)("div",{className:"mt-1 bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"h-full "+(E.loadPercentage>90?"bg-red-500":E.loadPercentage>70?"bg-yellow-500":"bg-green-500"),style:{width:`${E.loadPercentage}%`}})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(Bs,{className:"text-gray-400",size:20})}),(0,yt.jsx)("div",{className:"text-2xl font-bold",children:E.ordersPerHour}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Orders/Hour"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(Hs,{className:"text-gray-400",size:20})}),(0,yt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[E.customerSatisfaction,"%"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Satisfaction"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(ya,{className:"text-gray-400",size:20})}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:["$",E.totalRevenue]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Revenue"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,yt.jsx)(Rt,{className:"text-gray-400",size:20})}),(0,yt.jsx)("div",{className:"text-2xl font-bold",children:E.peakTime||"--"}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"Peak Time"})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,yt.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold",children:"Station Status Grid"}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-500",children:[E.activeStations," active, ",c," orders in queue"]}),(0,yt.jsx)("button",{onClick:()=>_("grid"===C?"list":"grid"),className:"text-gray-500 hover:text-gray-700",children:"grid"===C?"List View":"Grid View"})]})]}),(0,yt.jsx)("div",{className:"p-6 "+("grid"===C?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4":"space-y-4"),children:s.map((e=>{var t,s,a;const r=m.inProgress.filter((t=>t.station_id===e.id)),n=m.pending.filter((t=>t.preferred_station===e.id)),i=r.length+n.length,o=n.length>0?Math.round(n.reduce(((e,t)=>e+(t.waitTime||0)),0)/n.length):0;return(0,yt.jsxs)("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all hover:shadow-lg ${I(e)}`,onClick:()=>x(e),children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-bold text-lg",children:e.name}),(0,yt.jsxs)("p",{className:"text-sm text-gray-500",children:["Station #",e.id]})]}),(0,yt.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+("active"===e.status?"bg-green-100 text-green-800":"paused"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status||"active"})]}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:"Queue"}),(0,yt.jsxs)("span",{className:"font-semibold",children:[i," orders"]})]}),(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:"In Progress"}),(0,yt.jsx)("span",{className:"font-semibold",children:r.length})]}),(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:"Wait Time"}),(0,yt.jsxs)("span",{className:"font-semibold "+(o>15?"text-red-600":""),children:[o,"m"]})]}),e.current_barista&&(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsx)("span",{className:"text-sm text-gray-600",children:"Barista"}),(0,yt.jsx)("span",{className:"font-medium text-sm truncate max-w-[100px]",children:e.current_barista})]})]}),(0,yt.jsx)("div",{className:"mt-3 bg-gray-200 h-3 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"h-full transition-all "+(i/(e.max_concurrent_orders||5)>1?"bg-red-500":i/(e.max_concurrent_orders||5)>.8?"bg-yellow-500":i/(e.max_concurrent_orders||5)>.5?"bg-blue-500":"bg-green-500"),style:{width:`${Math.min(100,i/(e.max_concurrent_orders||5)*100)}%`}})}),(0,yt.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[(null===(t=e.capabilities)||void 0===t?void 0:t.standard_coffee)&&(0,yt.jsx)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:"Coffee"}),(null===(s=e.capabilities)||void 0===s?void 0:s.alternative_milk)&&(0,yt.jsx)("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded",children:"Alt Milk"}),(null===(a=e.capabilities)||void 0===a?void 0:a.high_volume)&&(0,yt.jsx)("span",{className:"text-xs bg-purple-100 text-purple-600 px-2 py-1 rounded",children:"High Vol"})]})]},e.id)}))})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,yt.jsxs)("button",{onClick:()=>j(!0),className:"flex flex-col items-center justify-center p-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all",children:[(0,yt.jsx)(gs,{size:24,className:"mb-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Emergency Alert"}),(0,yt.jsx)("span",{className:"text-xs opacity-75",children:"All Stations"})]}),(0,yt.jsxs)("button",{onClick:()=>console.log("Announce"),className:"flex flex-col items-center justify-center p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all",children:[(0,yt.jsx)(_t,{size:24,className:"mb-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Announce"}),(0,yt.jsx)("span",{className:"text-xs opacity-75",children:"To Customers"})]}),(0,yt.jsxs)("button",{onClick:async()=>{try{b(!y),T("system",y?"Order system resumed":"New orders paused")}catch(e){console.error("Failed to pause/resume orders:",e)}},className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all ${y?"bg-green-500 hover:bg-green-600":"bg-yellow-500 hover:bg-yellow-600"} text-white`,children:[y?(0,yt.jsx)(ba,{size:24,className:"mb-2"}):(0,yt.jsx)(va,{size:24,className:"mb-2"}),(0,yt.jsxs)("span",{className:"text-sm font-medium",children:[y?"Resume":"Pause"," Orders"]}),(0,yt.jsxs)("span",{className:"text-xs opacity-75",children:["System ",y?"Paused":"Active"]})]}),(0,yt.jsxs)("button",{onClick:()=>console.log("Redistribute"),className:"flex flex-col items-center justify-center p-4 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-all",children:[(0,yt.jsx)(Ot,{size:24,className:"mb-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Redistribute"}),(0,yt.jsx)("span",{className:"text-xs opacity-75",children:"Balance Load"})]}),(0,yt.jsxs)("button",{onClick:()=>console.log("Manual SMS"),className:"flex flex-col items-center justify-center p-4 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all",children:[(0,yt.jsx)(_t,{size:24,className:"mb-2"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Manual SMS"}),(0,yt.jsx)("span",{className:"text-xs opacity-75",children:"Response"})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,yt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,yt.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,yt.jsx)(qs,{className:"mr-2",size:20}),"Recent Activity Stream"]})}),(0,yt.jsx)("div",{className:"p-4 space-y-2 max-h-64 overflow-y-auto",children:k.length>0?k.map((e=>(0,yt.jsxs)("div",{className:"flex items-center space-x-3 py-2 border-b border-gray-100 last:border-0",children:[(0,yt.jsx)("span",{className:"text-xs text-gray-400 w-16",children:new Date(e.timestamp).toLocaleTimeString()}),(0,yt.jsx)(ja,{size:14,className:"text-gray-400"}),(0,yt.jsx)("span",{className:"text-sm "+("emergency"===e.type?"text-red-600 font-semibold":"system"===e.type?"text-blue-600":"text-gray-700"),children:e.message})]},e.id))):(0,yt.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,yt.jsx)(qs,{size:48,className:"mx-auto mb-3"}),(0,yt.jsx)("p",{children:"No recent activity"}),(0,yt.jsx)("p",{className:"text-xs mt-1",children:"Actions will appear here"})]})})]}),v&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,yt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,yt.jsx)(gs,{className:"text-red-500 mr-3",size:24}),(0,yt.jsx)("h3",{className:"text-xl font-bold",children:"Send Emergency Alert"})]}),(0,yt.jsx)("p",{className:"text-gray-600 mb-4",children:"This will immediately notify all stations and pending customers."}),(0,yt.jsx)("textarea",{value:w,onChange:e=>N(e.target.value),placeholder:"Enter your emergency message...",className:"w-full border rounded-lg p-3 mb-4 focus:outline-none focus:ring-2 focus:ring-red-500",rows:4,autoFocus:!0}),(0,yt.jsxs)("div",{className:"flex space-x-3",children:[(0,yt.jsx)("button",{onClick:async()=>{if(w.trim())try{console.log("Emergency Alert:",w);m.pending.map((e=>e.phoneNumber)).filter(Boolean);T("emergency",`Emergency alert: "${w}"`),j(!1),N("")}catch(e){console.error("Failed to send emergency alert:",e)}},disabled:!w.trim(),className:"flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Send Emergency Alert"}),(0,yt.jsx)("button",{onClick:()=>{j(!1),N("")},className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]})})]})},Na=()=>{const{pendingOrders:e,inProgressOrders:t,completedOrders:s,sendMessage:r}=Gt(),{stations:n}=Xt(),{settings:i}=Ns(),o={pending:e||[],inProgress:t||[],completed:s||[]},[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)("precise"),[g,p]=(0,a.useState)(!0),[f,x]=(0,a.useState)(null),y=(0,a.useCallback)((e=>{const t=[],s={};e.forEach((e=>{const t=e.milkType||"none";s[t]||(s[t]=[]),s[t].push(e)})),Object.entries(s).forEach((e=>{let[s,a]=e;a.length>=3&&t.push({id:`milk-${s}`,type:"milk",description:`${a.length} ${s} orders`,orders:a.map((e=>e.orderNumber)),timeSaved:Math.round(.5*a.length),priority:a.some((e=>e.vip))?"high":"medium"})}));const a={};return e.forEach((e=>{const t=e.coffeeType||"unknown";a[t]||(a[t]=[]),a[t].push(e)})),Object.entries(a).forEach((e=>{let[s,a]=e;a.length>=3&&t.push({id:`coffee-${s}`,type:"coffee",description:`${a.length} ${s} orders`,orders:a.map((e=>e.orderNumber)),timeSaved:Math.round(.3*a.length),priority:"low"})})),t.sort(((e,t)=>t.timeSaved-e.timeSaved))}),[]),b=(0,a.useMemo)((()=>{if(null===o||void 0===o||!o.pending)return{averageWait:0,longestWait:0,queueVelocity:0,predictedClearTime:0,customerTypes:{},batchOpportunities:[]};const e=o.pending,t=o.inProgress,s=e.map((e=>e.waitTime||0)),a=s.length>0?s.reduce(((e,t)=>e+t),0)/s.length:0,r=Math.max(...s,0),n=o.completed.filter((e=>new Date(e.completed_at||e.updated_at)>new Date(Date.now()-6e5))).length/10,i=e.length+t.length,l=n>0?i/n:0,c={vip:e.filter((e=>e.vip||e.priority)).length,regular:e.filter((e=>!e.vip&&!e.priority&&!e.first_time)).length,firstTime:e.filter((e=>e.first_time)).length,returning:e.filter((e=>e.returning_customer)).length},d=y(e);return{averageWait:Math.round(a),longestWait:Math.round(r),queueVelocity:n.toFixed(2),predictedClearTime:Math.round(l),customerTypes:c,batchOpportunities:d}}),[o,y]),v=(0,a.useMemo)((()=>{const e=o.completed||[],t=e.length;if(0===t)return{overall:0,waitTimeScore:0,accuracyScore:0,communicationScore:0};const s=e.reduce(((e,t)=>{const s=t.actual_wait_time||t.waitTime||0;return e+Math.max(0,100-5*(s-10))}),0)/t;return{overall:Math.round((s+98+95)/3),waitTimeScore:Math.round(s),accuracyScore:98,communicationScore:95}}),[o]);return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,yt.jsx)(Pt,{className:"mr-2",size:24}),"Queue Psychology & Customer Intelligence"]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("select",{value:m,onChange:e=>h(e.target.value),className:"border rounded-lg px-3 py-2",children:[(0,yt.jsx)("option",{value:"precise",children:"Precise Mode"}),(0,yt.jsx)("option",{value:"friendly",children:"Friendly Mode"}),(0,yt.jsx)("option",{value:"gamified",children:"Gamified Mode"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:g,onChange:e=>p(e.target.checked),className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Batch Optimization"})]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(Rt,{className:"text-blue-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Average"})]}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[b.averageWait,"m"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Wait Time"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(Bs,{className:"text-green-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Per minute"})]}),(0,yt.jsx)("div",{className:"text-2xl font-bold",children:b.queueVelocity}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Queue Velocity"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(Hs,{className:"text-purple-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Predicted"})]}),(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[b.predictedClearTime,"m"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Queue Clear Time"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(fs,{className:"text-yellow-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Overall"})]}),(0,yt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[v.overall,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Satisfaction"})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Customer Distribution"})}),(0,yt.jsxs)("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:b.customerTypes.vip}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"VIP Orders"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:b.customerTypes.returning}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Returning"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-green-600",children:b.customerTypes.firstTime}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"First Time"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-gray-600",children:b.customerTypes.regular}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Regular"})]})]})]}),g&&b.batchOpportunities.length>0&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,yt.jsx)(Es,{className:"mr-2 text-yellow-500",size:20}),"Batch Optimization Opportunities"]})}),(0,yt.jsx)("div",{className:"p-4 space-y-3",children:b.batchOpportunities.map((e=>(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"font-medium",children:e.description}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Orders: ",e.orders.join(", ")," \u2022 Save ~",e.timeSaved," minutes"]})]}),(0,yt.jsx)("button",{className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Batch Process"})]},e.id)))})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Smart Queue Management"})}),(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:o.pending.slice(0,10).map((e=>{const t=(e=>{if(!n.find((t=>t.id===e.station_id)))return null;const t=[];return n.forEach((s=>{var a,r;if(s.id===e.station_id||"active"!==s.status)return;if(!((null===(a=s.capabilities)||void 0===a?void 0:a.standard_coffee)||e.alternativeMilk&&(null===(r=s.capabilities)||void 0===r?void 0:r.alternative_milk)))return;const n=2*(o.pending.filter((e=>e.station_id===s.id)).length+o.inProgress.filter((e=>e.station_id===s.id)).length);n<e.waitTime-2&&t.push({station:s,currentWait:e.waitTime,newWait:n,timeSaved:Math.round(e.waitTime-n),incentive:n<5?"priority":"normal"})})),t.sort(((e,t)=>t.timeSaved-e.timeSaved))[0]})(e),s=(e=>{var t,s;const a={precise:{template:"Your ${coffee} will be ready in ${time} minutes and ${seconds} seconds. You're ${position} in line at ${station}.",alternativePrompt:"Station ${altStation} can make your order ${timeDiff} minutes faster. Switch?"},friendly:{template:"Hey ${name}! Your ${coffee} is being crafted with care. About ${time} minutes to go! \u2615",alternativePrompt:"Pro tip: ${altStation} has a shorter queue! Save ${timeDiff} minutes?"},gamified:{template:"Level up! Your ${coffee} quest: ${time} min remaining. Position: ${position}/${total} \ud83c\udfae",alternativePrompt:"Speed boost available! ${altStation} offers -${timeDiff} min buff!"}}[m],r=o.pending.findIndex((t=>t.id===e.id))+1,i=(null===(t=n.find((t=>t.id===e.station_id)))||void 0===t?void 0:t.name)||"Station 1";return a.template.replace("${coffee}",e.coffeeType).replace("${time}",Math.floor(e.waitTime)).replace("${seconds}",Math.round(e.waitTime%1*60)).replace("${position}",r).replace("${station}",i).replace("${name}",(null===(s=e.customerName)||void 0===s?void 0:s.split(" ")[0])||"there").replace("${total}",o.pending.length)})(e);return(0,yt.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsxs)("span",{className:"font-medium",children:["#",e.orderNumber]}),(0,yt.jsxs)("span",{className:"text-gray-600",children:["- ",e.customerName]}),e.vip&&(0,yt.jsx)("span",{className:"bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded",children:"VIP"})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[e.coffeeType,", ",e.milkType]}),(0,yt.jsxs)("div",{className:"text-sm text-blue-600 mt-2 italic",children:['"',s,'"']})]}),(0,yt.jsxs)("div",{className:"ml-4 text-right",children:[(0,yt.jsxs)("div",{className:"text-2xl font-bold",children:[Math.round(e.waitTime),"m"]}),(0,yt.jsx)("div",{className:"text-xs text-gray-500",children:"wait time"}),t&&(0,yt.jsxs)("button",{onClick:()=>{c(e),x(t),u(!0)},className:"mt-2 text-xs bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600",children:["Save ",t.timeSaved,"m"]})]})]})},e.id)}))})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsx)("h3",{className:"text-lg font-semibold",children:"Customer Experience Metrics"})}),(0,yt.jsx)("div",{className:"p-4",children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Wait Time Satisfaction"}),(0,yt.jsxs)("span",{className:"text-sm font-bold",children:[v.waitTimeScore,"%"]})]}),(0,yt.jsx)("div",{className:"bg-gray-200 h-3 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"bg-green-500 h-full transition-all",style:{width:`${v.waitTimeScore}%`}})})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Order Accuracy"}),(0,yt.jsxs)("span",{className:"text-sm font-bold",children:[v.accuracyScore,"%"]})]}),(0,yt.jsx)("div",{className:"bg-gray-200 h-3 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"bg-blue-500 h-full transition-all",style:{width:`${v.accuracyScore}%`}})})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Communication Quality"}),(0,yt.jsxs)("span",{className:"text-sm font-bold",children:[v.communicationScore,"%"]})]}),(0,yt.jsx)("div",{className:"bg-gray-200 h-3 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"bg-purple-500 h-full transition-all",style:{width:`${v.communicationScore}%`}})})]})]})})]}),d&&f&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,yt.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Faster Service Available!"}),(0,yt.jsxs)("div",{className:"mb-4 space-y-3",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)(ht,{className:"text-gray-400",size:20}),(0,yt.jsxs)("span",{children:["Order: ",null===l||void 0===l?void 0:l.coffeeType,", ",null===l||void 0===l?void 0:l.milkType]})]}),(0,yt.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,yt.jsxs)("div",{className:"font-medium text-green-800",children:[f.station.name," can serve you faster!"]}),(0,yt.jsxs)("div",{className:"mt-2 space-y-1 text-sm",children:[(0,yt.jsxs)("div",{children:["Current wait: ",f.currentWait," minutes"]}),(0,yt.jsxs)("div",{className:"font-bold",children:["New wait: ",f.newWait," minutes"]}),(0,yt.jsxs)("div",{className:"text-green-600",children:["Save ",f.timeSaved," minutes!"]})]})]}),"priority"===f.incentive&&(0,yt.jsxs)("div",{className:"bg-purple-50 p-3 rounded text-sm text-purple-800",children:[(0,yt.jsx)(fs,{className:"inline mr-1",size:16}),"You'll get priority service at the new station!"]})]}),(0,yt.jsxs)("div",{className:"flex space-x-3",children:[(0,yt.jsx)("button",{onClick:async()=>{if(l&&f)try{console.log("Switching order to alternative station:",f),await r(l.id,`Great choice! Your order has been moved to ${f.station.name}. New wait time: ${f.newWait} minutes.`),u(!1),x(null)}catch(e){console.error("Failed to switch station:",e)}},className:"flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600",children:"Switch Station"}),(0,yt.jsx)("button",{onClick:()=>{u(!1),x(null)},className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400",children:"Keep Current"})]})]})})]})},ka=dt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Sa=dt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Ca=()=>{var e,t,s,r,n,i;const{pendingOrders:o,inProgressOrders:l,completedOrders:c}=Gt(),{stations:d,updateStation:u}=Xt(),{settings:m,updateSettings:h}=Ns(),g={pending:o||[],inProgress:l||[],completed:c||[]},p="setup",f="pre_event",x="morning_peak",y="mid_morning",b="lunch_break",v="afternoon",j="afternoon_peak",w="wind_down",N="cleanup",[k,S]=(0,a.useState)(x),[C,_]=(0,a.useState)([]),[E,T]=(0,a.useState)(!0),[I,O]=(0,a.useState)({}),[A,$]=(0,a.useState)(null),M={[p]:{name:"Setup Phase",icon:(0,yt.jsx)(gt,{className:"text-gray-500",size:20}),timeRange:"06:00 - 07:00",characteristics:{orderVolume:"none",staffRequired:"setup_crew",menuAvailability:"testing_only",stationConfig:"preparation_mode"},automations:{preHeatMachines:!0,stockCheck:!0,systemTest:!0,staffBriefing:!0},recommendations:["Run machine diagnostics","Verify all stock levels","Test order system end-to-end","Brief staff on special requirements"]},[f]:{name:"Pre-Event",icon:(0,yt.jsx)(ka,{className:"text-yellow-500",size:20}),timeRange:"07:00 - 08:00",characteristics:{orderVolume:"low",staffRequired:"partial",menuAvailability:"limited_quick_drinks",stationConfig:"warm_up"},menuRestrictions:{availableDrinks:["espresso","long_black","americano"],preparationMode:"quick_serve",maxComplexity:"simple"},recommendations:["Open 1-2 stations only","Focus on quick drinks","Build initial stock buffer"]},[x]:{name:"Morning Peak",icon:(0,yt.jsx)(Bs,{className:"text-red-500",size:20}),timeRange:"08:00 - 10:30",characteristics:{orderVolume:"very_high",staffRequired:"full",menuAvailability:"full_menu",stationConfig:"high_performance"},optimizations:{batchProcessing:!0,priorityRouting:!0,dynamicStaffing:!0,stockPreloading:!0},alerts:{waitTimeThreshold:10,queueLengthThreshold:15,stockLevelThreshold:30},recommendations:["All stations fully operational","Enable batch processing","Monitor wait times closely","Pre-stage popular milk types"]},[y]:{name:"Mid-Morning Lull",icon:(0,yt.jsx)(ht,{className:"text-blue-500",size:20}),timeRange:"10:30 - 11:30",characteristics:{orderVolume:"moderate",staffRequired:"standard",menuAvailability:"full_menu",stationConfig:"balanced"},opportunities:{stockReplenishment:!0,staffRotation:!0,equipmentCleaning:!0,customerEngagement:!0},recommendations:["Rotate staff for breaks","Replenish stock levels","Clean equipment between rushes","Engage with customers"]},[b]:{name:"Lunch Break",icon:(0,yt.jsx)(Rt,{className:"text-green-500",size:20}),timeRange:"11:30 - 13:00",characteristics:{orderVolume:"low",staffRequired:"minimal",menuAvailability:"limited",stationConfig:"conservation"},strategies:{consolidateStations:!0,reducedMenu:!0,staffLunch:!0,prepForAfternoon:!0},recommendations:["Consolidate to 1-2 stations","Staggered staff lunch breaks","Prepare for afternoon session"]},[j]:{name:"Afternoon Peak",icon:(0,yt.jsx)(Es,{className:"text-orange-500",size:20}),timeRange:"14:00 - 15:30",characteristics:{orderVolume:"high",staffRequired:"increased",menuAvailability:"full_menu_plus_iced",stationConfig:"flexible"},specialConsiderations:{icedDrinkDemand:"high",decafRequests:"increased",customizations:"frequent",socialOrders:"common"},recommendations:["Prepare iced drink station","Stock extra alternative milks","Enable customization options","Focus on quality over speed"]},[w]:{name:"Wind Down",icon:(0,yt.jsx)(Sa,{className:"text-purple-500",size:20}),timeRange:"16:00 - 17:00",characteristics:{orderVolume:"declining",staffRequired:"reduced",menuAvailability:"simplified",stationConfig:"consolidation"},endOfDayTasks:{lastCallAnnouncement:!0,stockDepletion:!0,equipmentWindDown:!0,orderCutoff:!0},recommendations:["Announce last call","Start depleting perishable stock","Begin equipment shutdown sequence","Process final orders"]}},P=(0,a.useCallback)(((e,t,s)=>{var a,r;const n=M[e];if(!n)return 0;let i=100;const o=t.pending.reduce(((e,t)=>e+(t.waitTime||0)),0)/(t.pending.length||1);null!==(a=n.alerts)&&void 0!==a&&a.waitTimeThreshold&&o>n.alerts.waitTimeThreshold&&(i-=20),null!==(r=n.alerts)&&void 0!==r&&r.queueLengthThreshold&&t.pending.length>n.alerts.queueLengthThreshold&&(i-=15);const l=s.filter((e=>"active"===e.status)).length,c="full"===n.characteristics.staffRequired?s.length:"minimal"===n.characteristics.staffRequired?1:Math.ceil(s.length/2);return Math.abs(l-c)>1&&(i-=10),Math.max(0,i)}),[]),D=(0,a.useCallback)((e=>{const t=e.filter((e=>"active"===e.status&&e.current_barista)).length,s=e.filter((e=>e.current_barista)).length;return s>0?Math.round(t/s*100):0}),[]),z=(0,a.useMemo)((()=>{const e=new Date,t=new Date(e);t.setHours(7,0,0,0);const s=(e-t)/36e5,a=g.completed.length+g.inProgress.length+g.pending.length,r=s>0?a/s:0,n=M[k],i=P(k,g,d);return{hoursElapsed:s.toFixed(1),totalOrders:a,ordersPerHour:r.toFixed(1),phaseEfficiency:i,activeStations:d.filter((e=>"active"===e.status)).length,staffUtilization:D(d),recommendedActions:(null===n||void 0===n?void 0:n.recommendations)||[]}}),[g,d,k,P,D]);(0,a.useEffect)((()=>{if(!E)return;const e=()=>{const e=new Date,t=e.getHours()+e.getMinutes()/60;let s=p;s=t>=6&&t<7?p:t>=7&&t<8?f:t>=8&&t<10.5?x:t>=10.5&&t<11.5?y:t>=11.5&&t<13?b:t>=13&&t<14?v:t>=14&&t<15.5?j:t>=15.5&&t<17?w:N,I[s]&&(s=I[s]),s!==k&&L(s)},t=setInterval(e,6e4);return e(),()=>clearInterval(t)}),[E,k,I]);const L=e=>{console.log(`Transitioning from ${k} to ${e}`),_((t=>[...t,{from:k,to:e,timestamp:new Date,automatic:E}])),R(e),S(e)},R=e=>{var t;const s=M[e];if(!s)return;const a={};void 0!==(null===(t=s.optimizations)||void 0===t?void 0:t.batchProcessing)&&(a.batchProcessingEnabled=s.optimizations.batchProcessing),s.menuRestrictions&&(a.menuRestrictions=s.menuRestrictions),Object.keys(a).length>0&&h(a),"preparation_mode"===s.characteristics.stationConfig?d.forEach((e=>{u(e.id,{status:"preparing"})})):"high_performance"===s.characteristics.stationConfig&&d.forEach((e=>{u(e.id,{status:"active",high_performance_mode:!0})}))},F=()=>{const e=new Date,t=M[k];if(null===t||void 0===t||!t.timeRange)return 0;const[s,a]=t.timeRange.split(" - "),[r,n]=s.split(":").map(Number),[i,o]=a.split(":").map(Number),l=new Date(e);l.setHours(r,n,0);const c=new Date(e);c.setHours(i,o,0);const d=c-l,u=e-l;return Math.max(0,Math.min(100,u/d*100))};return(0,yt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,yt.jsx)($t,{className:"mr-2",size:24}),"Event Lifecycle Management"]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",checked:E,onChange:e=>T(e.target.checked),className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Automated Transitions"})]}),(0,yt.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Configure Phases"})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[null===(e=M[k])||void 0===e?void 0:e.icon,(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"text-xl font-bold",children:null===(t=M[k])||void 0===t?void 0:t.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-500",children:null===(s=M[k])||void 0===s?void 0:s.timeRange})]})]}),(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:[z.phaseEfficiency,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Phase Efficiency"})]})]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mb-1",children:[(0,yt.jsx)("span",{children:"Phase Progress"}),(0,yt.jsxs)("span",{children:[F().toFixed(0),"%"]})]}),(0,yt.jsx)("div",{className:"bg-gray-200 h-3 rounded-full overflow-hidden",children:(0,yt.jsx)("div",{className:"bg-blue-500 h-full transition-all",style:{width:`${F()}%`}})})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Order Volume"}),(0,yt.jsx)("div",{className:"font-semibold capitalize",children:null===(r=M[k])||void 0===r?void 0:r.characteristics.orderVolume.replace("_"," ")})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Staff Required"}),(0,yt.jsx)("div",{className:"font-semibold capitalize",children:null===(n=M[k])||void 0===n?void 0:n.characteristics.staffRequired.replace("_"," ")})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Menu"}),(0,yt.jsx)("div",{className:"font-semibold capitalize",children:null===(i=M[k])||void 0===i?void 0:i.characteristics.menuAvailability.replace("_"," ")})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Active Stations"}),(0,yt.jsxs)("div",{className:"font-semibold",children:[z.activeStations," / ",d.length]})]})]}),(0,yt.jsxs)("div",{className:"border-t pt-4",children:[(0,yt.jsx)("h4",{className:"font-medium mb-2",children:"Recommended Actions"}),(0,yt.jsx)("div",{className:"space-y-2",children:z.recommendedActions.map(((e,t)=>(0,yt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,yt.jsx)(St,{className:"text-green-500",size:16}),(0,yt.jsx)("span",{children:e})]},t)))})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Event Timeline"}),(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-gray-200"}),Object.entries(M).map(((e,t)=>{let[s,a]=e;const r=s===k,n=C.some((e=>e.from===s));return(0,yt.jsxs)("div",{className:"relative pl-8 pb-6 last:pb-0",children:[(0,yt.jsx)("div",{className:"absolute left-0 w-8 h-8 rounded-full flex items-center justify-center "+(r?"bg-blue-500":n?"bg-green-500":"bg-gray-300"),children:r?(0,yt.jsx)(qs,{className:"text-white",size:16}):n?(0,yt.jsx)(St,{className:"text-white",size:16}):(0,yt.jsx)("div",{className:"w-3 h-3 bg-white rounded-full"})}),(0,yt.jsx)("div",{className:(r?"bg-blue-50 -mx-4 px-4":"")+" rounded-lg py-2",children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[a.icon,(0,yt.jsx)("span",{className:"font-medium "+(r?"text-blue-700":""),children:a.name})]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:a.timeRange})]}),!E&&!r&&!n&&(0,yt.jsx)("button",{onClick:()=>L(s),className:"text-sm bg-gray-200 px-3 py-1 rounded hover:bg-gray-300",children:"Activate"})]})})]},s)}))]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(ht,{className:"text-brown-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Total"})]}),(0,yt.jsx)("div",{className:"text-3xl font-bold",children:z.totalOrders}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Orders Processed"}),(0,yt.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[z.ordersPerHour,"/hour avg"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(zt,{className:"text-blue-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Current"})]}),(0,yt.jsxs)("div",{className:"text-3xl font-bold",children:[z.staffUtilization,"%"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Staff Utilization"}),(0,yt.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[z.activeStations," stations active"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)(Rt,{className:"text-green-500",size:20}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Elapsed"})]}),(0,yt.jsxs)("div",{className:"text-3xl font-bold",children:[z.hoursElapsed,"h"]}),(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:"Event Duration"}),(0,yt.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:"Since 7:00 AM"})]})]}),k===x&&(0,yt.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,yt.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Peak Hour Optimizations Active"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Batch Processing"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Priority Routing"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Dynamic Staffing"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"h-4 w-4"}),(0,yt.jsx)("span",{children:"Stock Preloading"})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Phase Transition History"}),(0,yt.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:C.length>0?C.map(((e,t)=>{var s,a;return(0,yt.jsxs)("div",{className:"flex items-center justify-between text-sm py-2 border-b last:border-0",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("span",{className:"text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()}),(0,yt.jsxs)("span",{className:"text-gray-600",children:[null===(s=M[e.from])||void 0===s?void 0:s.name," \u2192 ",null===(a=M[e.to])||void 0===a?void 0:a.name]})]}),(0,yt.jsx)("span",{className:"text-xs px-2 py-1 rounded "+(e.automatic?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.automatic?"Automatic":"Manual"})]},t)})):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,yt.jsx)($t,{size:32,className:"mx-auto mb-2"}),(0,yt.jsx)("p",{children:"No phase transitions yet"})]})})]})]})},_a=dt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Ea=dt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ta=dt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Ia=()=>{const{orders:e,loading:t,error:s}=Gt(),{settings:r}=Ns();(0,a.useEffect)((()=>{console.log("EnhancedCommunicationHub: Orders state update",{orders:e?"loaded":"not loaded",ordersType:typeof e,ordersIsArray:Array.isArray(e),ordersKeys:e&&"object"===typeof e?Object.keys(e):"N/A",ordersLoading:t,ordersError:s})}),[e,t,s]);const[n,i]=(0,a.useState)("all"),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)([]),[h,g]=(0,a.useState)(""),[p,f]=(0,a.useState)("all"),[x,y]=(0,a.useState)(null),[b,v]=(0,a.useState)(""),[j,w]=(0,a.useState)(!1),N=(0,a.useRef)(null),k=[{id:"sms",name:"SMS",icon:_a,color:"blue",enabled:!0},{id:"email",name:"Email",icon:Ea,color:"green",enabled:!0},{id:"push",name:"Push",icon:ca,color:"purple",enabled:!0},{id:"voice",name:"Voice",icon:Ta,color:"amber",enabled:!1},{id:"whatsapp",name:"WhatsApp",icon:la,color:"emerald",enabled:!1}];(0,a.useEffect)((()=>{S(),C(),_();const e=setInterval(S,1e4);return()=>clearInterval(e)}),[e]);const S=async()=>{try{const t=ls.getAllHistory(),s=[];if(!e)return void console.log("EnhancedCommunicationHub: Waiting for orders data to load...");let a=e;if(Array.isArray(e)||(a=[...e.pending||[],...e.inProgress||[],...e.completed||[]]),0===a.length)return void console.log("EnhancedCommunicationHub: No orders available yet");Object.entries(t).forEach((e=>{var t;let[r,n]=e;const i=null===(t=a)||void 0===t?void 0:t.find((e=>{var t;return(null===(t=e.id)||void 0===t?void 0:t.toString())===r}));n.forEach((e=>{s.push({id:`${r}-${e.timestamp}`,channel:e.channel||"sms",recipient:(null===i||void 0===i?void 0:i.phone)||e.recipient||"Unknown",customerName:(null===i||void 0===i?void 0:i.customer_name)||"Customer",message:e.message,status:e.status||"delivered",timestamp:new Date(e.timestamp),order:(null===i||void 0===i?void 0:i.order_number)||r,type:e.type||"outbound"})}))})),s.sort(((e,t)=>t.timestamp-e.timestamp)),l(s)}catch(t){console.error("Error loading messages:",t)}},C=async()=>{try{await ls.getSMSTemplates();d([{id:1,name:"Order Ready",channel:"sms",template:"Hi {name}, your {coffee} is ready for pickup at {station}! \u2615",variables:["name","coffee","station"],usage:1247},{id:2,name:"Queue Update",channel:"sms",template:"Your order is #{position} in queue. Est. wait: {wait} mins \u23f1\ufe0f",variables:["position","wait"],usage:892},{id:3,name:"Welcome Email",channel:"email",template:"Welcome to Coffee Cue! Your first order gets 10% off. \ud83c\udf89",variables:[],usage:234},{id:4,name:"Order Delayed",channel:"push",template:"Sorry for the delay! Your order will be ready in {time} mins",variables:["time"],usage:45},{id:5,name:"VIP Fast Track",channel:"sms",template:"VIP Fast Track: Skip to Station {station} for immediate service! \ud83c\udf1f",variables:["station"],usage:89},{id:6,name:"Loyalty Reward",channel:"email",template:"Congrats {name}! You've earned a free {reward}. Use code: {code}",variables:["name","reward","code"],usage:156}])}catch(e){console.error("Error loading templates:",e)}},_=()=>{m([{id:1,name:"Morning Rush Alert",channels:["sms","push"],audience:"All waiting customers",message:"\u2615 High demand this morning! Your patience is appreciated. Est. +5min wait.",scheduled:new Date(Date.now()+36e5),status:"scheduled",recipients:45,filters:{waitTime:">10"}},{id:2,name:"Happy Hour Promo",channels:["email","push"],audience:"Loyalty members",message:"\ud83c\udf89 Happy Hour: 50% off all drinks 3-5 PM today!",scheduled:new Date(Date.now()+108e5),status:"scheduled",recipients:234,filters:{customerType:"loyalty"}},{id:3,name:"Station 2 Closure",channels:["sms"],audience:"Station 2 queue",message:"Station 2 temporarily closed. You've been moved to Station 1.",scheduled:null,status:"sent",recipients:12,sentAt:new Date(Date.now()-18e5)}])};(0,a.useEffect)((()=>{var e;null===(e=N.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[o]);const E=o.filter((e=>{const t=e.customerName.toLowerCase().includes(h.toLowerCase())||e.message.toLowerCase().includes(h.toLowerCase())||e.order&&e.order.toLowerCase().includes(h.toLowerCase()),s="all"===p||e.status===p,a="all"===n||e.channel===n;return t&&s&&a})),T=async function(t,s,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=a;Object.entries(r).forEach((e=>{let[t,s]=e;n=n.replace(`{${t}}`,s)}));const i={id:Date.now(),channel:t,recipient:s,customerName:r.name||"Customer",message:n,status:"sending",timestamp:new Date,order:r.order||null};if(l((e=>[i,...e])),"sms"===t&&x){const t=e.find((e=>e.phone===s));t&&await ls.sendMessage(t,n)}setTimeout((()=>{l((e=>e.map((e=>e.id===i.id?{...e,status:Math.random()>.1?"delivered":"failed"}:e))))}),2e3)},I=e=>{switch(e){case"delivered":return"text-green-600 bg-green-50";case"sent":return"text-blue-600 bg-blue-50";case"sending":return"text-amber-600 bg-amber-50";case"failed":return"text-red-600 bg-red-50";case"scheduled":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},O=e=>{const t=k.find((t=>t.id===e));return t?t.color:"gray"},A=a.useMemo((()=>{const e={};return E.forEach((t=>{const s=t.recipient;e[s]||(e[s]={id:s,recipient:t.recipient,customerName:t.customerName,lastMessage:t.message,lastTimestamp:t.timestamp,unreadCount:0,messages:[]}),e[s].messages.push(t),t.timestamp>e[s].lastTimestamp&&(e[s].lastMessage=t.message,e[s].lastTimestamp=t.timestamp),"inbound"===t.type&&"unread"===t.status&&e[s].unreadCount++})),Object.values(e).sort(((e,t)=>t.lastTimestamp-e.lastTimestamp))}),[E]);return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold",children:"Communication Hub"}),(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,yt.jsx)(fa,{className:"w-4 h-4 text-green-500"}),(0,yt.jsx)("span",{className:"text-gray-600",children:"All channels online"})]}),(0,yt.jsxs)("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,yt.jsx)(ia,{className:"w-4 h-4"}),(0,yt.jsx)("span",{children:"New Broadcast"})]})]})]}),(0,yt.jsxs)("div",{className:"flex space-x-1 border-b",children:[(0,yt.jsx)("button",{onClick:()=>i("all"),className:"px-4 py-2 font-medium border-b-2 transition-colors "+("all"===n?"text-gray-900 border-gray-900":"text-gray-500 border-transparent hover:text-gray-700"),children:"All Channels"}),k.map((e=>(0,yt.jsxs)("button",{onClick:()=>i(e.id),disabled:!e.enabled,className:"px-4 py-2 font-medium border-b-2 transition-colors flex items-center space-x-2 "+(n===e.id?`text-${e.color}-600 border-${e.color}-600`:e.enabled?"text-gray-500 border-transparent hover:text-gray-700":"text-gray-300 cursor-not-allowed"),children:[(0,yt.jsx)(e.icon,{className:"w-4 h-4"}),(0,yt.jsx)("span",{children:e.name}),!e.enabled&&(0,yt.jsx)("span",{className:"text-xs",children:"(Soon)"})]},e.id)))]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,yt.jsxs)("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm",children:[(0,yt.jsx)("div",{className:"p-4 border-b",children:(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsxs)("div",{className:"relative flex-1",children:[(0,yt.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,yt.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"Search messages...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("select",{value:p,onChange:e=>f(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"all",children:"All Status"}),(0,yt.jsx)("option",{value:"delivered",children:"Delivered"}),(0,yt.jsx)("option",{value:"sent",children:"Sent"}),(0,yt.jsx)("option",{value:"failed",children:"Failed"})]}),(0,yt.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,yt.jsx)(Ot,{className:"w-5 h-5 text-gray-600"})})]})}),(0,yt.jsxs)("div",{className:"flex h-96",children:[(0,yt.jsx)("div",{className:"w-1/3 border-r overflow-y-auto",children:A.map((e=>(0,yt.jsxs)("div",{onClick:()=>y(e),className:"p-4 border-b cursor-pointer hover:bg-gray-50 "+((null===x||void 0===x?void 0:x.id)===e.id?"bg-blue-50":""),children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.customerName}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:e.lastTimestamp.toLocaleTimeString()})]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.recipient}),(0,yt.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.lastMessage}),e.unreadCount>0&&(0,yt.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mt-1",children:[e.unreadCount," new"]})]},e.id)))}),(0,yt.jsx)("div",{className:"flex-1 flex flex-col",children:x?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,yt.jsx)("h3",{className:"font-semibold",children:x.customerName}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:x.recipient})]}),(0,yt.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[x.messages.map((e=>(0,yt.jsx)("div",{className:"flex "+("outbound"===e.type?"justify-end":"justify-start"),children:(0,yt.jsxs)("div",{className:"max-w-xs "+("outbound"===e.type?"order-2":""),children:[(0,yt.jsx)("div",{className:"p-3 rounded-lg "+("outbound"===e.type?"bg-blue-500 text-white":"bg-gray-100"),children:(0,yt.jsx)("p",{className:"text-sm",children:e.message})}),(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.timestamp.toLocaleTimeString()})]})},e.id))),(0,yt.jsx)("div",{ref:N})]}),(0,yt.jsx)("div",{className:"p-4 border-t",children:(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("input",{type:"text",value:b,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),T("sms",x.recipient,b),v(""))},placeholder:"Type a message...",className:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,yt.jsx)("button",{onClick:()=>{T("sms",x.recipient,b),v("")},disabled:!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:(0,yt.jsx)(us,{className:"w-5 h-5"})})]})})]}):(0,yt.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)(la,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),(0,yt.jsx)("p",{children:"Select a conversation"})]})})})]})]}),(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Templates"}),(0,yt.jsx)("div",{className:"space-y-2",children:c.filter((e=>"all"===n||e.channel===n)).slice(0,5).map((t=>(0,yt.jsxs)("div",{className:"border rounded-lg p-3 hover:bg-gray-50 cursor-pointer",onClick:()=>(t=>{var s,a;if(!x)return;const r=e.find((e=>e.phone===x.recipient));if(!r)return;let n=t.template;const i={name:r.customer_name||"Customer",coffee:(null===(s=r.items)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.coffee_type)||"coffee",station:r.station_id||"1",wait:Math.floor(10*Math.random()+5),position:Math.floor(5*Math.random()+1),time:Math.floor(10*Math.random()+5)};Object.entries(i).forEach((e=>{let[t,s]=e;n=n.replace(`{${t}}`,s)})),v(n)})(t),children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,yt.jsx)("h4",{className:"font-medium text-sm",children:t.name}),(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:[t.usage," uses"]})]}),(0,yt.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:t.template}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs bg-${O(t.channel)}-100 text-${O(t.channel)}-700`,children:t.channel}),(0,yt.jsx)(ja,{className:"w-4 h-4 text-gray-400"})]})]},t.id)))})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Broadcasts"}),(0,yt.jsx)("div",{className:"space-y-3",children:u.slice(0,3).map((e=>(0,yt.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,yt.jsx)("h4",{className:"font-medium text-sm mb-1",children:e.name}),(0,yt.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.message}),(0,yt.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,yt.jsx)("span",{className:`inline-flex items-center px-2 py-1 rounded-full ${I(e.status)}`,children:e.status}),(0,yt.jsxs)("span",{className:"text-gray-500",children:[e.recipients," recipients"]})]}),e.scheduled&&(0,yt.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[(0,yt.jsx)(Rt,{className:"w-3 h-3 inline mr-1"}),e.scheduled.toLocaleTimeString()]})]},e.id)))})]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Communication Analytics"}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,yt.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:o.filter((e=>e.timestamp>new Date(Date.now()-864e5))).length}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Messages Today"}),(0,yt.jsxs)("p",{className:"text-xs text-blue-600 mt-1",children:[(0,yt.jsx)(Bs,{className:"w-3 h-3 inline"})," +12% vs yesterday"]})]}),(0,yt.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,yt.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:[(o.filter((e=>"delivered"===e.status)).length/o.length*100).toFixed(1),"%"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Delivery Rate"}),(0,yt.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"Above target"})]}),(0,yt.jsxs)("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[(0,yt.jsx)("p",{className:"text-3xl font-bold text-amber-600",children:"1.8s"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Response Time"}),(0,yt.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Within SLA"})]}),(0,yt.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,yt.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:"4.8"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Satisfaction Score"}),(0,yt.jsx)("p",{className:"text-xs text-purple-600 mt-1",children:"Based on feedback"})]})]})]})]})},Oa=()=>{const{pendingOrders:e,inProgressOrders:t,completedOrders:s}=Gt(),{stations:r}=Xt(),{stockData:n}=Zt(),i=[...e||[],...t||[],...s||[]],[o,l]=(0,a.useState)({demandForecast:[],bottlenecks:[],stockAlerts:[],staffingNeeds:[],customerSurge:null}),[c,d]=(0,a.useState)({mode:"normal",activeProtocols:[],automations:[],healthScore:85}),[u,m]=(0,a.useState)("next2hours"),[h,g]=(0,a.useState)(!0),[p,f]=(0,a.useState)(!1);(0,a.useEffect)((()=>{x()}),[null===i||void 0===i?void 0:i.length,null===r||void 0===r?void 0:r.length,null===n||void 0===n?void 0:n.length,u]);const x=()=>{const e=y(),t=b(),s=v(),a=w(),r=N();l({demandForecast:e,bottlenecks:t,stockAlerts:s,staffingNeeds:a,customerSurge:r}),k(t,s)},y=()=>{const e={};i&&Array.isArray(i)&&i.forEach((t=>{const s=new Date(t.created_at).getHours();e[s]=(e[s]||0)+1}));const t=(new Date).getHours(),s=[];for(let a=0;a<4;a++){const r=(t+a)%24,n=e[r]||0;let i=n;r>=7&&r<=9&&(i*=1.5),r>=12&&r<=13&&(i*=1.3);const o=(new Date).getDay();1===o&&(i*=1.2),5===o&&(i*=1.1),s.push({hour:`${r}:00`,predicted:Math.round(i),confidence:i>0?85+10*Math.random():0,trend:i>n?"up":"down"})}return s},b=()=>{const e=[];r&&Array.isArray(r)&&r.forEach((t=>{const s=(i||[]).filter((e=>e.station_id===t.id&&["pending","in-progress"].includes(e.status))),a=s.length/(t.capacity||10)*100;a>80&&e.push({id:`station-${t.id}`,type:"station",severity:a>95?"critical":"warning",location:t.name,metric:`${a.toFixed(0)}% capacity`,impact:`${s.length} orders affected`,recommendation:"Redistribute orders or add staff",automatable:!0})}));const t={};return i&&Array.isArray(i)&&i.forEach((e=>{e.items&&e.items.forEach((e=>{e.milk_type&&(t[e.milk_type]=(t[e.milk_type]||0)+1)}))})),Object.entries(t).forEach((t=>{let[s,a]=t;a>20&&e.push({id:`milk-${s}`,type:"ingredient",severity:"warning",location:"All stations",metric:`${a} ${s} milk orders`,impact:"Potential stock shortage",recommendation:"Prepare extra stock",automatable:!1})})),e},v=()=>{const e=[];return n&&0!==n.length?(n&&Array.isArray(n)&&n.forEach((t=>{if(t.current_stock<1.5*t.min_stock){const s=j(t.name),a=t.current_stock/s;a<4&&e.push({id:`stock-${t.id}`,item:t.name,currentStock:t.current_stock,burnRate:s.toFixed(1),timeToDepletion:`${a.toFixed(1)} hours`,severity:a<2?"critical":"warning",action:"Reorder immediately",automatable:!0})}})),e):e},j=e=>.3*i.filter((e=>new Date(e.created_at)>new Date(Date.now()-36e5))).length,w=()=>{const e=[];return o.demandForecast.forEach(((t,s)=>{const a=Math.ceil(t.predicted/10),n=r.filter((e=>e.is_active)).length;a>n&&e.push({id:`staff-${s}`,time:t.hour,current:n,required:a,gap:a-n,urgency:0===s?"immediate":"scheduled",action:`Add ${a-n} barista(s)`})})),e},N=()=>{const e=4*i.filter((e=>new Date(e.created_at)>new Date(Date.now()-9e5))).length,t=i.length/8;return e>1.5*t?{detected:!0,velocity:e,increase:(100*(e/t-1)).toFixed(0),duration:"Next 30-45 minutes",confidence:87}:null},k=(e,t)=>{const s=[...e.filter((e=>"critical"===e.severity)),...t.filter((e=>"critical"===e.severity))];let a="normal",r=100;const n=[],i=[];s.length>3?(a="emergency",r=40,n.push("Emergency Response Protocol"),i.push("Auto-redistribute orders"),i.push("Priority queue activation")):(s.length>0||e.length>2)&&(a="degraded",r=70,n.push("Load Balancing Protocol"),i.push("Smart routing enabled")),r-=5*e.length,r-=3*t.length,r=Math.max(0,Math.min(100,r)),d({mode:a,activeProtocols:n,automations:i,healthScore:r})},S=e=>{switch(e){case"critical":return"text-red-600 bg-red-50";case"warning":return"text-amber-600 bg-amber-50";default:return"text-blue-600 bg-blue-50"}};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)(Pt,{className:"w-8 h-8 text-purple-600"}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold",children:"Predictive Intelligence"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"AI-powered forecasting & resilience"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,yt.jsx)("option",{value:"next2hours",children:"Next 2 Hours"}),(0,yt.jsx)("option",{value:"next4hours",children:"Next 4 Hours"}),(0,yt.jsx)("option",{value:"today",children:"Today"}),(0,yt.jsx)("option",{value:"tomorrow",children:"Tomorrow"})]}),(0,yt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,yt.jsx)("input",{type:"checkbox",checked:h,onChange:e=>g(e.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"}),(0,yt.jsx)("span",{className:"text-sm font-medium",children:"Auto-adjust"})]}),(0,yt.jsxs)("button",{onClick:async()=>{f(!0),await new Promise((e=>setTimeout(e,1e3))),x(),f(!1)},disabled:p,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center space-x-2",children:[(0,yt.jsx)(Ot,{className:"w-4 h-4 "+(p?"animate-spin":"")}),(0,yt.jsx)("span",{children:"Refresh"})]})]})]}),(0,yt.jsxs)("div",{className:"p-4 rounded-lg flex items-center justify-between "+(C=c.healthScore,C>=80?"text-green-600 bg-green-50":C>=60?"text-amber-600 bg-amber-50":"text-red-600 bg-red-50"),children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)(oa,{className:"w-6 h-6"}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("p",{className:"font-semibold",children:["System Resilience: ",c.mode.toUpperCase()]}),(0,yt.jsxs)("p",{className:"text-sm",children:["Health Score: ",c.healthScore,"%"]})]})]}),c.activeProtocols.length>0&&(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsx)("p",{className:"text-sm font-medium",children:"Active Protocols:"}),c.activeProtocols.map(((e,t)=>(0,yt.jsx)("p",{className:"text-xs",children:e},t)))]})]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Bs,{className:"w-5 h-5 mr-2"}),"Demand Forecast"]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:o.demandForecast.map(((e,t)=>(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.hour}),"up"===e.trend?(0,yt.jsx)(Bs,{className:"w-4 h-4 text-green-500"}):(0,yt.jsx)(Bs,{className:"w-4 h-4 text-red-500 rotate-180"})]}),(0,yt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.predicted}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"orders expected"}),(0,yt.jsxs)("div",{className:"mt-2",children:[(0,yt.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,yt.jsx)("span",{children:"Confidence"}),(0,yt.jsxs)("span",{children:[e.confidence,"%"]})]}),(0,yt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,yt.jsx)("div",{className:"bg-purple-600 h-1.5 rounded-full",style:{width:`${e.confidence}%`}})})]})]},t)))}),o.customerSurge&&(0,yt.jsxs)("div",{className:"mt-4 p-4 bg-amber-50 rounded-lg flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)(Es,{className:"w-6 h-6 text-amber-600"}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"font-semibold text-amber-900",children:"Customer Surge Detected!"}),(0,yt.jsxs)("p",{className:"text-sm text-amber-700",children:["+",o.customerSurge.increase,"% increase \u2022 ",o.customerSurge.duration]})]})]}),(0,yt.jsx)("button",{className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm",children:"Activate Surge Protocol"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(gs,{className:"w-5 h-5 mr-2"}),"Bottleneck Detection"]}),(0,yt.jsx)("div",{className:"space-y-3",children:o.bottlenecks.length>0?o.bottlenecks.map((e=>(0,yt.jsxs)("div",{className:`p-4 rounded-lg ${S(e.severity)}`,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.location}),(0,yt.jsxs)("p",{className:"text-sm",children:[e.metric," \u2022 ",e.impact]})]}),(0,yt.jsx)("span",{className:"text-xs font-medium uppercase",children:e.severity})]}),(0,yt.jsx)("p",{className:"text-sm mb-2",children:e.recommendation}),e.automatable&&h&&(0,yt.jsxs)("div",{className:"flex items-center text-xs",children:[(0,yt.jsx)(St,{className:"w-3 h-3 mr-1"}),(0,yt.jsx)("span",{children:"Auto-adjustment enabled"})]})]},e.id))):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(St,{className:"w-12 h-12 mx-auto mb-2 text-green-400"}),(0,yt.jsx)("p",{children:"No bottlenecks detected"})]})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(ht,{className:"w-5 h-5 mr-2"}),"Stock Depletion Alerts"]}),(0,yt.jsx)("div",{className:"space-y-3",children:o.stockAlerts.length>0?o.stockAlerts.map((e=>(0,yt.jsxs)("div",{className:`p-4 rounded-lg ${S(e.severity)}`,children:[(0,yt.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.item}),(0,yt.jsx)("span",{className:"text-xs font-medium uppercase",children:e.severity})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm mb-2",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-xs opacity-75",children:"Current"}),(0,yt.jsx)("p",{className:"font-semibold",children:e.currentStock})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-xs opacity-75",children:"Burn Rate"}),(0,yt.jsxs)("p",{className:"font-semibold",children:[e.burnRate,"/hr"]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"text-xs opacity-75",children:"Time Left"}),(0,yt.jsx)("p",{className:"font-semibold",children:e.timeToDepletion})]})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("p",{className:"text-sm",children:e.action}),e.automatable&&h&&(0,yt.jsx)("button",{className:"text-xs underline",children:"Auto-order"})]})]},e.id))):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(St,{className:"w-12 h-12 mx-auto mb-2 text-green-400"}),(0,yt.jsx)("p",{children:"Stock levels healthy"})]})})]})]}),o.staffingNeeds.length>0&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(zt,{className:"w-5 h-5 mr-2"}),"Staffing Optimization"]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.staffingNeeds.map((e=>(0,yt.jsxs)("div",{className:"p-4 rounded-lg border "+("immediate"===e.urgency?"border-red-300 bg-red-50":"border-gray-300"),children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.time}),"immediate"===e.urgency&&(0,yt.jsx)("span",{className:"text-xs text-red-600 font-medium",children:"URGENT"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4 mb-3",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("p",{className:"text-2xl font-bold",children:e.current}),(0,yt.jsx)("p",{className:"text-xs text-gray-600",children:"Current"})]}),(0,yt.jsx)(Is,{className:"w-4 h-4 text-gray-400"}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.required}),(0,yt.jsx)("p",{className:"text-xs text-gray-600",children:"Required"})]})]}),(0,yt.jsx)("p",{className:"text-sm font-medium text-center",children:e.action})]},e.id)))})]}),c.automations.length>0&&(0,yt.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Es,{className:"w-5 h-5 mr-2"}),"Active Automations"]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.automations.map(((e,t)=>(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-4 flex items-center space-x-3",children:[(0,yt.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,yt.jsx)(qs,{className:"w-5 h-5 text-purple-600"})}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"font-medium",children:e}),(0,yt.jsx)("p",{className:"text-xs text-gray-600",children:"Running automatically"})]}),(0,yt.jsx)(St,{className:"w-5 h-5 text-green-500"})]},t)))})]})]});var C},Aa={"Whole Milk":"#FFFFFF","Skim Milk":"#ADD8E6","Low-fat Milk":"#D3D3D3","Lactose-Free Milk":"#FAFAFA","Soy Milk":"#FFEC8B","Oat Milk":"#FF7F7F","Almond Milk":"#87CEEB","Coconut Milk":"#90EE90","Macadamia Milk":"#DEB887","Rice Milk":"#E6E6FA","Hemp Milk":"#D8F8D8","Cashew Milk":"#F5DEB3","Pea Milk":"#CCFFCC"},$a=()=>{const[e,t]=(0,a.useState)({}),[s,r]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=async()=>{try{i(!0);const e=ts.A.getEventInventory(),s=(null===e||void 0===e?void 0:e.milk)||[];r(s);const a=(await xs.getSettings(!0)).milkColors||{},n={};s.forEach((e=>{n[e.name]=e.color||a[e.name]||Aa[e.name]||u(e.name)})),t(n)}catch(e){console.error("Error loading data:",e),d({type:"error",text:"Failed to load milk data"})}finally{i(!1)}};e();const s=()=>{e()};return window.addEventListener("inventory:updated",s),()=>{window.removeEventListener("inventory:updated",s)}}),[]);const u=e=>`hsl(${e.split("").reduce(((e,t)=>e+t.charCodeAt(0)),0)%360}, 70%, 80%)`,m=(s,a)=>{t({...e,[s]:a})},h=e=>{if(!s.find((t=>t.name===e)))return"alternative";const t=e.toLowerCase();return t.includes("whole")||t.includes("skim")||t.includes("full cream")||t.includes("reduced fat")||t.includes("lactose-free")||t.includes("low-fat")?"standard":"alternative"};return n?(0,yt.jsx)("div",{className:"flex justify-center py-8",children:"Loading milk colors..."}):(0,yt.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Milk Color Settings"}),c&&(0,yt.jsx)("div",{className:"p-4 mb-4 rounded "+("success"===c.type?"bg-green-100 text-green-800":"error"===c.type?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:c.text}),(0,yt.jsx)("div",{className:"mb-6 p-4 border border-blue-200 rounded-lg bg-blue-50",children:(0,yt.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,yt.jsx)("strong",{children:"Note:"})," Milk types are managed in the"," ",(0,yt.jsx)("span",{className:"font-semibold",children:"Organiser \u2192 Stations \u2192 Event Inventory"})," section. Colors you set here will be used throughout the system to identify different milk types visually."]})}),(()=>{const t=Object.entries(e).filter((e=>{let[t]=e;return"standard"===h(t)})),a=Object.entries(e).filter((e=>{let[t]=e;return"alternative"===h(t)}));return(0,yt.jsxs)("div",{className:"space-y-6",children:[t.length>0&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Standard Milks"}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e=>{let[t,a]=e;const r=s.find((e=>e.name===t));return(0,yt.jsxs)("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[(0,yt.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:a}}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("div",{className:"font-medium",children:t}),(null===r||void 0===r?void 0:r.description)&&(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:r.description})]}),(0,yt.jsx)("input",{type:"color",value:a,onChange:e=>m(t,e.target.value),className:"w-12 h-12 rounded cursor-pointer border-2 border-gray-300",title:`Change color for ${t}`})]},t)}))})]}),a.length>0&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Alternative Milks"}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map((e=>{let[t,a]=e;const r=s.find((e=>e.name===t));return(0,yt.jsxs)("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[(0,yt.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundColor:a}}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("div",{className:"font-medium",children:t}),(null===r||void 0===r?void 0:r.description)&&(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:r.description})]}),(0,yt.jsx)("input",{type:"color",value:a,onChange:e=>m(t,e.target.value),className:"w-12 h-12 rounded cursor-pointer border-2 border-gray-300",title:`Change color for ${t}`})]},t)}))})]})]})})(),(()=>{const t=Object.keys(e);return(0,yt.jsxs)("div",{className:"mt-8",children:[(0,yt.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Color Preview"}),(0,yt.jsxs)("div",{className:"mb-6 p-4 border rounded bg-gray-50",children:[(0,yt.jsx)("h4",{className:"font-medium mb-3",children:"Color Legend"}),(0,yt.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,yt.jsxs)("div",{className:"flex items-center bg-white p-2 border rounded",children:[(0,yt.jsx)("div",{className:"milk-indicator-dot soy-milk"}),(0,yt.jsx)("span",{className:"text-sm",children:"Soy Milk - Yellow"})]}),(0,yt.jsxs)("div",{className:"flex items-center bg-white p-2 border rounded",children:[(0,yt.jsx)("div",{className:"milk-indicator-dot oat-milk"}),(0,yt.jsx)("span",{className:"text-sm",children:"Oat Milk - Red"})]}),(0,yt.jsxs)("div",{className:"flex items-center bg-white p-2 border rounded",children:[(0,yt.jsx)("div",{className:"milk-indicator-dot almond-milk"}),(0,yt.jsx)("span",{className:"text-sm",children:"Almond Milk - Blue"})]}),(0,yt.jsxs)("div",{className:"flex items-center bg-white p-2 border rounded",children:[(0,yt.jsx)("div",{className:"milk-indicator-dot lactose-free-milk"}),(0,yt.jsx)("span",{className:"text-sm",children:"Lactose-Free - Dashed"})]})]})]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e=>{const t=`order-milk-${e.toLowerCase().replace(/\s+/g,"-")}`,s=(e=>{const t=[],s=e.toLowerCase();return(s.includes("soy")||s.includes("oat")||s.includes("almond")||s.includes("coconut")||s.includes("macadamia")||s.includes("rice")||s.includes("hemp")||s.includes("cashew")||s.includes("pea"))&&(t.push("Dairy-Free"),t.push("Vegan")),s.includes("lactose-free")&&t.push("Lactose-Free"),(s.includes("skim")||s.includes("reduced fat"))&&t.push("Low-Fat"),t})(e);return(0,yt.jsxs)("div",{className:`p-4 border rounded ${t}`,children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("div",{className:`milk-indicator-dot ${e.toLowerCase().replace(/\s+/g,"-")}`}),(0,yt.jsx)("span",{className:"font-medium",children:"Cappuccino"})]}),(0,yt.jsx)("div",{className:"flex gap-1",children:s.map((t=>(0,yt.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded "+("Dairy-Free"===t||"Vegan"===t?"bg-green-100 text-green-800":"Lactose-Free"===t?"bg-blue-100 text-blue-800":"Low-Fat"===t?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:t},`${e}-${t}`)))})]}),(0,yt.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Regular, ",e,", 1 sugar"]})]},e)}))})]})})(),(0,yt.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,yt.jsx)("button",{onClick:()=>{const e={};s.forEach((t=>{e[t.name]=Aa[t.name]||u(t.name)})),t(e),d({type:"info",text:"Reset to defaults (not saved yet)"})},className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-4 rounded",children:"Reset to Defaults"}),(0,yt.jsx)("button",{onClick:async()=>{try{l(!0),d(null);const t=ts.A.getEventInventory();t&&t.milk&&(t.milk.forEach((t=>{e[t.name]&&(t.color=e[t.name])})),localStorage.setItem("event_inventory",JSON.stringify(t)),ts.A.notifyInventoryUpdated()),await xs.updateSettings({milkColors:e}),d({type:"success",text:"Milk colors saved successfully"})}catch(t){console.error("Error saving milk colors:",t),d({type:"error",text:`Failed to save: ${t.message}`})}finally{l(!1)}},disabled:o,className:"bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded",children:o?"Saving...":"Save Colors"})]})]})},Ma=()=>{const[e,t]=(0,a.useState)("branding");return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"mb-6 bg-white p-2 rounded-lg shadow flex gap-2",children:[(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md transition-colors "+("branding"===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>t("branding"),children:[(0,yt.jsx)(gt,{size:16,className:"inline-block mr-2"}),"Branding & Display"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md transition-colors "+("colors"===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>t("colors"),children:[(0,yt.jsx)(Gs,{size:16,className:"inline-block mr-2"}),"Visual Identifiers"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md transition-colors "+("advanced"===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>t("advanced"),children:[(0,yt.jsx)(ht,{size:16,className:"inline-block mr-2"}),"Advanced Settings"]})]}),(0,yt.jsxs)("div",{children:["branding"===e&&(0,yt.jsx)(Zs,{}),"colors"===e&&(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsx)($a,{}),(0,yt.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 opacity-50",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Coffee Type Colors"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Coming soon: Assign visual colors to different coffee types (Espresso, Cappuccino, Latte, etc.)"})]})]}),"advanced"===e&&(0,yt.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Advanced Settings"}),(0,yt.jsx)("p",{className:"text-gray-600",children:"Additional configuration options will be available here."})]})]})]})},Pa=dt("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]),Da=dt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),za=dt("Beaker",[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]]),La=dt("Candy",[["path",{d:"m9.5 7.5-2 2a4.95 4.95 0 1 0 7 7l2-2a4.95 4.95 0 1 0-7-7Z",key:"ue6khb"}],["path",{d:"M14 6.5v10",key:"5xnk7c"}],["path",{d:"M10 7.5v10",key:"1uew51"}],["path",{d:"m16 7 1-5 1.37.68A3 3 0 0 0 19.7 3H21v1.3c0 .46.1.92.32 1.33L22 7l-5 1",key:"b9cp6k"}],["path",{d:"m8 17-1 5-1.37-.68A3 3 0 0 0 4.3 21H3v-1.3a3 3 0 0 0-.32-1.33L2 17l5-1",key:"5lney8"}]]),Ra=dt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Fa=dt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ua=e=>{var t;let{item:s,onSave:r,onCancel:n,category:i,categories:o}=e;const[l,c]=(0,a.useState)({name:s.name||"",description:s.description||"",volume:s.volume||0,shots:s.shots||0});return(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),(0,yt.jsx)("input",{type:"text",value:l.name,onChange:e=>c({...l,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("input",{type:"text",value:l.description,onChange:e=>c({...l,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(null===(t=o[i])||void 0===t?void 0:t.additionalFields)&&(0,yt.jsx)("div",{className:"grid grid-cols-2 gap-4",children:o[i].additionalFields.map((e=>(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.label}),(0,yt.jsx)("input",{type:e.type,value:l[e.key]||"",onChange:t=>c({...l,[e.key]:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:e.required})]},e.key)))}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,yt.jsxs)("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 flex items-center",children:[(0,yt.jsx)(Fa,{size:16,className:"mr-1"}),"Cancel"]}),(0,yt.jsxs)("button",{onClick:()=>{var e;if(!l.name||!l.name.trim())return;const t={name:l.name.trim(),description:(l.description||"").trim()};null!==(e=o[i])&&void 0!==e&&e.additionalFields&&o[i].additionalFields.forEach((e=>{void 0!==l[e.key]&&(t[e.key]="number"===e.type?Number(l[e.key]):l[e.key])})),r(t)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center",children:[(0,yt.jsx)(bs,{size:16,className:"mr-1"}),"Save"]})]})]})},Ba=()=>{var e;const t={milk:{name:"Milk & Dairy",icon:(0,yt.jsx)(Pa,{size:20}),color:"blue",defaultItems:[{name:"Whole Milk",description:"Regular dairy milk"},{name:"Skim Milk",description:"Low-fat dairy milk"},{name:"Oat Milk",description:"Plant-based oat milk"},{name:"Almond Milk",description:"Plant-based almond milk"},{name:"Soy Milk",description:"Plant-based soy milk"},{name:"Coconut Milk",description:"Plant-based coconut milk"},{name:"Macadamia Milk",description:"Plant-based macadamia milk"},{name:"Rice Milk",description:"Plant-based rice milk"}]},coffee:{name:"Coffee Types",icon:(0,yt.jsx)(ht,{size:20}),color:"amber",defaultItems:[{name:"Espresso",description:"Strong coffee shot"},{name:"Americano",description:"Espresso with hot water"},{name:"Latte",description:"Espresso with steamed milk"},{name:"Cappuccino",description:"Espresso with foam"},{name:"Flat White",description:"Double shot with microfoam"},{name:"Mocha",description:"Chocolate coffee drink"},{name:"Macchiato",description:"Espresso with milk foam"},{name:"Cortado",description:"Equal parts espresso and warm milk"},{name:"Filter Coffee",description:"Drip brewed coffee"},{name:"Cold Brew",description:"Cold steeped coffee"}]},cups:{name:"Cups & Sizes",icon:(0,yt.jsx)(Da,{size:20}),color:"green",defaultItems:[{name:"Small (8oz)",description:"240ml cup",volume:240,shots:1},{name:"Medium (12oz)",description:"350ml cup",volume:350,shots:1},{name:"Large (16oz)",description:"470ml cup",volume:470,shots:2},{name:"Extra Large (20oz)",description:"590ml cup",volume:590,shots:2},{name:"Takeaway Cup Small",description:"Small disposable cup",volume:240,shots:1},{name:"Takeaway Cup Medium",description:"Medium disposable cup",volume:350,shots:1},{name:"Takeaway Cup Large",description:"Large disposable cup",volume:470,shots:2},{name:"Ceramic Mug",description:"Reusable ceramic mug",volume:300,shots:1}],additionalFields:[{key:"volume",label:"Volume (ml)",type:"number",required:!0},{key:"shots",label:"Espresso Shots",type:"number",required:!0}]},syrups:{name:"Syrups & Flavors",icon:(0,yt.jsx)(za,{size:20}),color:"purple",defaultItems:[{name:"Vanilla Syrup",description:"Classic vanilla flavor"},{name:"Caramel Syrup",description:"Sweet caramel flavor"},{name:"Hazelnut Syrup",description:"Nutty hazelnut flavor"},{name:"Cinnamon Syrup",description:"Warm spice flavor"},{name:"Coconut Syrup",description:"Tropical coconut flavor"},{name:"Chocolate Syrup",description:"Rich chocolate flavor"},{name:"Peppermint Syrup",description:"Fresh mint flavor"},{name:"Gingerbread Syrup",description:"Seasonal spice flavor"},{name:"Irish Cream Syrup",description:"Creamy liqueur flavor"},{name:"Maple Syrup",description:"Natural maple sweetener"}]},sweeteners:{name:"Sugars & Sweeteners",icon:(0,yt.jsx)(La,{size:20}),color:"pink",defaultItems:[{name:"White Sugar",description:"Regular granulated sugar"},{name:"Brown Sugar",description:"Raw cane sugar"},{name:"Honey",description:"Natural honey sweetener"},{name:"Stevia",description:"Natural leaf sweetener"},{name:"Artificial Sweetener",description:"Sugar substitute"},{name:"Agave Syrup",description:"Plant-based sweetener"},{name:"Coconut Sugar",description:"Natural coconut sweetener"},{name:"Maple Sugar",description:"Natural maple sweetener"}]},extras:{name:"Extras & Add-ons",icon:(0,yt.jsx)(At,{size:20}),color:"indigo",defaultItems:[{name:"Extra Shot",description:"Additional espresso shot"},{name:"Decaf Shot",description:"Caffeine-free espresso"},{name:"Extra Hot",description:"Higher temperature"},{name:"Extra Foam",description:"Additional milk foam"},{name:"No Foam",description:"Milk without foam"},{name:"Whipped Cream",description:"Dairy whipped topping"},{name:"Cinnamon Powder",description:"Ground cinnamon spice"},{name:"Cocoa Powder",description:"Chocolate dusting"},{name:"Marshmallows",description:"Sweet marshmallow topping"},{name:"Biscotti",description:"Italian almond biscuit"}]}},[s,r]=(0,a.useState)({}),[n,i]=(0,a.useState)("milk"),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)({name:"",description:""}),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)("");(0,a.useEffect)((()=>{const e={name:"",description:""},s=t[n];null!==s&&void 0!==s&&s.additionalFields&&s.additionalFields.forEach((t=>{e[t.key]="number"===t.type?0:""})),d(e),m(!1)}),[n]),(0,a.useEffect)((()=>{const e=localStorage.getItem("event_inventory");if(e)try{const t=JSON.parse(e),s={};Object.keys(t).forEach((e=>{Array.isArray(t[e])&&(s[e]=t[e].filter((e=>e&&"object"===typeof e&&e.name)))})),r(s)}catch(bn){console.error("Error loading saved inventory:",bn),localStorage.removeItem("event_inventory"),p()}else p()}),[]);const p=()=>{const e={};Object.keys(t).forEach((s=>{e[s]=t[s].defaultItems.map(((e,t)=>({id:`${s}_${t+1}`,...e,enabled:!0,category:s})))})),r(e),f(e)},f=e=>{try{localStorage.setItem("event_inventory",JSON.stringify(e)),console.log("Inventory saved successfully"),ts.A.notifyInventoryUpdated()}catch(bn){console.error("Error saving inventory:",bn)}},x=()=>{const e=s[n]||[];return h?e.filter((e=>{if(!e)return!1;const t=e.name||"",s=e.description||"",a=h.toLowerCase();return t.toLowerCase().includes(a)||s.toLowerCase().includes(a)})):e};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Inventory Management"}),(0,yt.jsx)("button",{onClick:p,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Reset to Defaults"})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,yt.jsxs)("div",{className:"col-span-3",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Categories"}),(0,yt.jsx)("div",{className:"space-y-2",children:Object.entries(t).map((e=>{let[t,a]=e;const r=(e=>{const t=s[e]||[],a=t.filter((e=>e.enabled)).length;return{total:t.length,enabled:a}})(t);return(0,yt.jsx)("button",{onClick:()=>i(t),className:"w-full text-left p-3 rounded-md transition-colors "+(n===t?`bg-${a.color}-100 border border-${a.color}-300`:"bg-gray-50 hover:bg-gray-100"),children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("span",{className:`text-${a.color}-600 mr-2`,children:a.icon}),(0,yt.jsx)("span",{className:"font-medium",children:a.name})]}),(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:[r.enabled,"/",r.total]})]})},t)}))})]}),(0,yt.jsxs)("div",{className:"col-span-9",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("span",{className:`text-${t[n].color}-600 mr-2`,children:t[n].icon}),(0,yt.jsx)("h3",{className:"text-xl font-semibold",children:t[n].name})]}),(0,yt.jsxs)("button",{onClick:()=>m(!0),className:"flex items-center px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:[(0,yt.jsx)(Ft,{size:16,className:"mr-2"}),"Add Item"]})]}),(0,yt.jsxs)("div",{className:"relative mb-4",children:[(0,yt.jsx)(ps,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,yt.jsx)("input",{type:"text",placeholder:"Search items...",value:h,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u&&(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-md p-4 mb-4",children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Add New Item"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name"}),(0,yt.jsx)("input",{type:"text",value:c.name,onChange:e=>d({...c,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter item name..."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("input",{type:"text",value:c.description,onChange:e=>d({...c,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter description..."})]})]}),(null===(e=t[n])||void 0===e?void 0:e.additionalFields)&&(0,yt.jsx)("div",{className:"grid grid-cols-2 gap-4",children:t[n].additionalFields.map((e=>(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.label}),(0,yt.jsx)("input",{type:e.type,value:c[e.key]||"",onChange:t=>d({...c,[e.key]:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter ${e.label.toLowerCase()}...`,required:e.required})]},e.key)))})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,yt.jsx)("button",{onClick:()=>{m(!1);const e={name:"",description:""},s=t[n];null!==s&&void 0!==s&&s.additionalFields&&s.additionalFields.forEach((t=>{e[t.key]="number"===t.type?0:""})),d(e)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,yt.jsx)("button",{onClick:()=>{if(!c.name||!c.name.trim())return;const e={id:`${n}_${Date.now()}`,name:c.name.trim(),description:(c.description||"").trim(),enabled:!0,category:n},a=t[n];null!==a&&void 0!==a&&a.additionalFields&&a.additionalFields.forEach((t=>{void 0!==c[t.key]&&(e[t.key]="number"===t.type?Number(c[t.key]):c[t.key])}));const i={...s,[n]:[...s[n]||[],e]};r(i),f(i);const o={name:"",description:""};null!==a&&void 0!==a&&a.additionalFields&&a.additionalFields.forEach((e=>{o[e.key]="number"===e.type?0:""})),d(o),m(!1)},className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Add Item"})]})]}),(0,yt.jsx)("div",{className:"space-y-2",children:x().map((e=>(0,yt.jsx)("div",{className:"p-4 rounded-md border "+(e.enabled?"border-gray-200 bg-white":"border-gray-100 bg-gray-50 opacity-60"),children:o===e.id?(0,yt.jsx)(Ua,{item:e,category:n,categories:t,onSave:t=>((e,t)=>{const a={...s,[n]:s[n].map((s=>s.id===e?{...s,...t}:s))};r(a),f(a),l(null)})(e.id,t),onCancel:()=>l(null)}):(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("label",{className:"flex items-center",children:(0,yt.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:()=>(e=>{const t={...s,[n]:s[n].map((t=>t.id===e?{...t,enabled:!t.enabled}:t))};r(t),f(t)})(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),"cups"===n&&(e.volume||e.shots)&&(0,yt.jsxs)("div",{className:"flex space-x-4 text-sm text-gray-500 mt-1",children:[e.volume&&(0,yt.jsxs)("span",{children:["Volume: ",e.volume,"ml"]}),e.shots&&(0,yt.jsxs)("span",{children:["Shots: ",e.shots]})]})]})]}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("button",{onClick:()=>l(e.id),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-md",children:(0,yt.jsx)(Ra,{size:16})}),(0,yt.jsx)("button",{onClick:()=>(e=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const t={...s,[n]:s[n].filter((t=>t.id!==e))};r(t),f(t)})(e.id),className:"p-2 text-red-600 hover:bg-red-100 rounded-md",children:(0,yt.jsx)(sa,{size:16})})]})]})},e.id)))}),0===x().length&&(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(At,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"No items found in this category"}),h&&(0,yt.jsx)("p",{className:"text-sm",children:"Try adjusting your search term"})]})]})]})]})},Wa=dt("Package2",[["path",{d:"M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z",key:"1ront0"}],["path",{d:"m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9",key:"19h2x1"}],["path",{d:"M12 3v6",key:"1holv5"}]]),qa=dt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Ha=()=>{const[e,t]=(0,a.useState)({}),[s,r]=(0,a.useState)({}),[n,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)(""),c={milk:{unit:"L",defaultQuantity:10,step:1},coffee:{unit:"kg",defaultQuantity:5,step:.5},cups:{unit:"units",defaultQuantity:100,step:50},syrups:{unit:"bottles",defaultQuantity:5,step:1},sweeteners:{unit:"units",defaultQuantity:100,step:10},extras:{unit:"units",defaultQuantity:50,step:10}};(0,a.useEffect)((()=>{d(),u()}),[]);const d=()=>{const e=localStorage.getItem("event_inventory");if(e)try{r(JSON.parse(e))}catch(bn){console.error("Error loading inventory:",bn)}},u=()=>{const e=localStorage.getItem("event_stock_levels");if(e)try{t(JSON.parse(e))}catch(bn){console.error("Error loading event stock:",bn),m()}else m()},m=()=>{const e={};Object.entries(s).forEach((t=>{let[s,a]=t;e[s]={},null===a||void 0===a||a.forEach((t=>{var a,r,n;t.enabled&&(e[s][t.id]={quantity:(null===(a=c[s])||void 0===a?void 0:a.defaultQuantity)||10,unit:(null===(r=c[s])||void 0===r?void 0:r.unit)||"units",allocated:0,available:(null===(n=c[s])||void 0===n?void 0:n.defaultQuantity)||10})}))})),t(e)},h=(s,a,r)=>{var n,o,l;const c={...e,[s]:{...e[s],[a]:{...null===(n=e[s])||void 0===n?void 0:n[a],quantity:Math.max(0,r),available:Math.max(0,r-((null===(o=e[s])||void 0===o||null===(l=o[a])||void 0===l?void 0:l.allocated)||0))}}};t(c),i(!0)},g=e=>{switch(e){case"milk":return(0,yt.jsx)(Pa,{size:20});case"coffee":return(0,yt.jsx)(ht,{size:20});case"cups":return(0,yt.jsx)(Da,{size:20});case"syrups":return(0,yt.jsx)(za,{size:20});case"sweeteners":return(0,yt.jsx)(La,{size:20});case"extras":return(0,yt.jsx)(At,{size:20});default:return(0,yt.jsx)(Wa,{size:20})}},p=e=>({milk:"blue",coffee:"amber",cups:"green",syrups:"purple",sweeteners:"pink",extras:"indigo"}[e]||"gray");return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Event Stock Management"}),(0,yt.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage total stock quantities for the entire event"})]}),n&&(0,yt.jsxs)("button",{onClick:()=>{try{localStorage.setItem("event_stock_levels",JSON.stringify(e)),l("Event stock levels saved successfully!"),i(!1),window.dispatchEvent(new CustomEvent("eventStock:updated",{detail:{eventStock:e}})),setTimeout((()=>l("")),3e3)}catch(bn){console.error("Error saving event stock:",bn),l("Error saving stock levels")}},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,yt.jsx)(bs,{size:20}),"Save Changes"]})]}),o&&(0,yt.jsxs)("div",{className:"mt-4 p-3 rounded-md flex items-center gap-2 "+(o.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:[o.includes("Error")?(0,yt.jsx)(ds,{size:20}):(0,yt.jsx)(Mt,{size:20}),o]})]}),(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:Object.entries(s).map((t=>{var s;let[a,r]=t;const n=(t=>{const s=e[t]||{};let a=0,r=0,n=0;return Object.values(s).forEach((e=>{a+=e.quantity||0,r+=e.allocated||0,n++})),{itemCount:n,totalQuantity:a,totalAllocated:r,totalAvailable:a-r}})(a),i=p(a),o=(null===(s=c[a])||void 0===s?void 0:s.unit)||"units";return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)("div",{className:`p-2 bg-${i}-100 rounded-lg`,children:g(a)}),(0,yt.jsx)("h3",{className:"font-semibold capitalize",children:a})]}),(0,yt.jsxs)("span",{className:"text-sm text-gray-500",children:[n.itemCount," items"]})]}),(0,yt.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Total Stock:"}),(0,yt.jsxs)("span",{className:"font-medium",children:[n.totalQuantity," ",o]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Allocated:"}),(0,yt.jsxs)("span",{className:"text-orange-600",children:[n.totalAllocated," ",o]})]}),(0,yt.jsxs)("div",{className:"flex justify-between",children:[(0,yt.jsx)("span",{children:"Available:"}),(0,yt.jsxs)("span",{className:"text-green-600 font-medium",children:[n.totalAvailable," ",o]})]})]})]},a)}))}),(0,yt.jsx)("div",{className:"space-y-6",children:Object.entries(s).map((t=>{var s,a;let[r,n]=t;const i=(null===n||void 0===n?void 0:n.filter((e=>e.enabled)))||[];if(0===i.length)return null;const o=p(r),l=(null===(s=c[r])||void 0===s?void 0:s.unit)||"units",d=(null===(a=c[r])||void 0===a?void 0:a.step)||1;return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,yt.jsx)("div",{className:`px-6 py-4 bg-${o}-50 border-b border-${o}-200`,children:(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[g(r),(0,yt.jsx)("h3",{className:"text-lg font-semibold capitalize",children:r}),(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:["(",l,")"]})]})}),(0,yt.jsx)("div",{className:"p-6",children:(0,yt.jsx)("div",{className:"space-y-4",children:i.map((t=>{var s;const a=(null===(s=e[r])||void 0===s?void 0:s[t.id])||{quantity:0,allocated:0,available:0};return(0,yt.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-0",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium",children:t.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:t.description}),(0,yt.jsxs)("div",{className:"flex gap-4 mt-1 text-sm",children:[(0,yt.jsxs)("span",{className:"text-orange-600",children:["Allocated: ",a.allocated," ",l]}),(0,yt.jsxs)("span",{className:"text-green-600",children:["Available: ",a.available," ",l]})]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,yt.jsx)("button",{onClick:()=>h(r,t.id,a.quantity-d),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 transition-colors",children:(0,yt.jsx)(qa,{size:16})}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("input",{type:"number",min:"0",step:d,value:a.quantity,onChange:e=>h(r,t.id,parseFloat(e.target.value)||0),className:"w-20 px-2 py-1 text-center border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,yt.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:l})]}),(0,yt.jsx)("button",{onClick:()=>h(r,t.id,a.quantity+d),className:"w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 transition-colors",children:(0,yt.jsx)(Ft,{size:16})})]})]},t.id)}))})})]},r)}))})]})},Ja=dt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Va=e=>{let{stations:t,onStationUpdate:s,onAddStation:r,onDeleteStation:n}=e;const[i,o]=(0,a.useState)(null),[l,c]=(0,a.useState)({name:"",location:"",status:"active",description:"",maxConcurrentOrders:3}),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)({name:"",location:"",description:"",status:"active",maxConcurrentOrders:3}),[f,x]=(0,a.useState)(!1),[y,b]=(0,a.useState)(null);(0,a.useEffect)((()=>{i&&(c({name:i.name||"",location:i.location||"",status:i.status||"active",description:i.description||"",maxConcurrentOrders:i.maxConcurrentOrders||3}),u(!1))}),[i]);return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,yt.jsx)(gt,{className:"mr-2"}),"Station Settings",(0,yt.jsx)("span",{className:"ml-3 px-2 py-1 bg-green-100 text-green-800 text-sm rounded-md",children:"\u2728 New Interface"})]}),(0,yt.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:[(0,yt.jsx)(Ft,{size:16,className:"mr-2"}),"Add Station"]})]}),y&&(0,yt.jsxs)("div",{className:"mb-4 p-3 rounded-md flex items-center "+("success"===y?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:["success"===y?(0,yt.jsx)(St,{size:16,className:"mr-2"}):(0,yt.jsx)(ds,{size:16,className:"mr-2"}),"success"===y?"Changes saved successfully!":"Error saving changes. Please try again."]}),(0,yt.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,yt.jsxs)("div",{className:"col-span-4",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Stations"}),(0,yt.jsx)("div",{className:"space-y-2",children:t.map((e=>(0,yt.jsx)("div",{className:"p-3 rounded-md border cursor-pointer transition-colors "+((null===i||void 0===i?void 0:i.id)===e.id?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"),onClick:()=>o(e),children:(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),e.location&&(0,yt.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-1",children:[(0,yt.jsx)(Ja,{size:12,className:"mr-1"}),e.location]}),(0,yt.jsxs)("div",{className:"flex items-center mt-1",children:[(0,yt.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 "+("active"===e.status?"bg-green-500":"bg-red-500")}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"active"===e.status?"Active":"Inactive"})]})]}),(0,yt.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this station? This action cannot be undone.")){x(!0);try{await n(e)?((null===i||void 0===i?void 0:i.id)===e&&o(null),b("success"),setTimeout((()=>b(null)),3e3)):(b("error"),setTimeout((()=>b(null)),3e3))}catch(t){console.error("Error deleting station:",t),b("error"),setTimeout((()=>b(null)),3e3)}finally{x(!1)}}})(e.id)},className:"text-red-600 hover:bg-red-100 p-1 rounded",children:(0,yt.jsx)(sa,{size:14})})]})},e.id)))}),0===t.length&&(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(ht,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"No stations configured"}),(0,yt.jsx)("p",{className:"text-sm",children:"Add your first station to get started"})]})]}),(0,yt.jsx)("div",{className:"col-span-8",children:i?(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold",children:"Configure Station"}),(0,yt.jsx)("div",{className:"flex space-x-2",children:d?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("button",{onClick:()=>{u(!1),c({name:i.name||"",location:i.location||"",status:i.status||"active",description:i.description||"",maxConcurrentOrders:i.maxConcurrentOrders||3})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 flex items-center",children:[(0,yt.jsx)(Fa,{size:16,className:"mr-2"}),"Cancel"]}),(0,yt.jsxs)("button",{onClick:async()=>{if(i&&l.name.trim()){x(!0),b(null);try{await s(i.id,l)?(b("success"),u(!1),setTimeout((()=>b(null)),3e3)):(b("error"),setTimeout((()=>b(null)),3e3))}catch(e){console.error("Error saving station:",e),b("error"),setTimeout((()=>b(null)),3e3)}finally{x(!1)}}},disabled:f,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center disabled:opacity-50",children:[(0,yt.jsx)(bs,{size:16,className:"mr-2"}),f?"Saving...":"Save Changes"]})]}):(0,yt.jsxs)("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center",children:[(0,yt.jsx)(Ra,{size:16,className:"mr-2"}),"Edit Station"]})})]}),(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-md p-4",children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-4",children:"Basic Information"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Station Name"}),(0,yt.jsx)("input",{type:"text",value:l.name,onChange:e=>c({...l,name:e.target.value}),disabled:!d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"Enter station name..."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,yt.jsx)("input",{type:"text",value:l.location,onChange:e=>c({...l,location:e.target.value}),disabled:!d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"Enter location..."})]})]}),(0,yt.jsxs)("div",{className:"mt-4",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("textarea",{value:l.description,onChange:e=>c({...l,description:e.target.value}),disabled:!d,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",placeholder:"Optional description..."})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-md p-4",children:[(0,yt.jsx)("h4",{className:"text-lg font-medium mb-4",children:"Operational Settings"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,yt.jsxs)("select",{value:l.status,onChange:e=>c({...l,status:e.target.value}),disabled:!d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[(0,yt.jsx)("option",{value:"active",children:"Active"}),(0,yt.jsx)("option",{value:"inactive",children:"Inactive"}),(0,yt.jsx)("option",{value:"maintenance",children:"Maintenance"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Concurrent Orders"}),(0,yt.jsx)("input",{type:"number",min:"1",max:"10",value:l.maxConcurrentOrders,onChange:e=>c({...l,maxConcurrentOrders:parseInt(e.target.value)||1}),disabled:!d,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"})]})]})]})]})]}):(0,yt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,yt.jsx)(gt,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"Select a station to configure its settings"})]})})]}),m&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,yt.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Add New Station"}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Station Name *"}),(0,yt.jsx)("input",{type:"text",value:g.name,onChange:e=>p({...g,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter station name..."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,yt.jsx)("input",{type:"text",value:g.location,onChange:e=>p({...g,location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter location..."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("textarea",{value:g.description,onChange:e=>p({...g,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional description..."})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,yt.jsxs)("select",{value:g.status,onChange:e=>p({...g,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yt.jsx)("option",{value:"active",children:"Active"}),(0,yt.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Orders"}),(0,yt.jsx)("input",{type:"number",min:"1",max:"10",value:g.maxConcurrentOrders,onChange:e=>p({...g,maxConcurrentOrders:parseInt(e.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,yt.jsx)("button",{onClick:()=>{h(!1),p({name:"",location:"",description:"",status:"active",maxConcurrentOrders:3})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,yt.jsx)("button",{onClick:async()=>{if(g.name.trim()){x(!0);try{await r(g)?(h(!1),p({name:"",location:"",description:"",status:"active",maxConcurrentOrders:3}),b("success"),setTimeout((()=>b(null)),3e3)):(b("error"),setTimeout((()=>b(null)),3e3))}catch(e){console.error("Error adding station:",e),b("error"),setTimeout((()=>b(null)),3e3)}finally{x(!1)}}},disabled:!g.name.trim()||f,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50",children:f?"Adding...":"Add Station"})]})]})})]})},Ga=dt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Qa=e=>{let{stations:t}=e;const[s,r]=(0,a.useState)(null),[n,i]=(0,a.useState)({}),[o,l]=(0,a.useState)({}),[c,d]=(0,a.useState)({}),[u,m]=(0,a.useState)(""),[h,g]=(0,a.useState)("all"),[p,f]=(0,a.useState)("all"),x={milk:{name:"Milk & Dairy",color:"blue"},coffee:{name:"Coffee Types",color:"amber"},cups:{name:"Cups & Sizes",color:"green"},syrups:{name:"Syrups & Flavors",color:"purple"},sweeteners:{name:"Sugars & Sweeteners",color:"pink"},extras:{name:"Extras & Add-ons",color:"indigo"}};(0,a.useEffect)((()=>(console.log("StationInventoryConfig mounting, loading data..."),y(),b(),v(),()=>{console.log("StationInventoryConfig unmounting...")})),[]),(0,a.useEffect)((()=>{console.log("Inventory loaded, length:",Object.keys(c).length)}),[c]);const y=()=>{const e=localStorage.getItem("event_inventory");if(e)try{const t=JSON.parse(e);d(t)}catch(bn){console.error("Error loading inventory:",bn)}},b=()=>{const e=localStorage.getItem("station_inventory_configs");if(console.log("Loading station configs from localStorage:",e),e)try{const t=JSON.parse(e);console.log("Parsed station configs:",t),i(t)}catch(bn){console.error("Error loading station configs:",bn)}else console.log("No saved station configs found")},v=()=>{const e=localStorage.getItem("station_inventory_quantities");if(console.log("Loading station inventory quantities from localStorage:",e),e)try{const t=JSON.parse(e);console.log("Parsed station inventory quantities:",t),l(t)}catch(bn){console.error("Error loading station inventory:",bn)}else console.log("No saved station inventory quantities found")},j=e=>{try{const t=JSON.stringify(e);console.log("Saving to localStorage:",t),localStorage.setItem("station_inventory_configs",t),i(e);const s=localStorage.getItem("station_inventory_configs");console.log("Verified saved configs:",s),ts.A.notifyStationConfigUpdated()}catch(bn){console.error("Error saving station configs:",bn)}},w=e=>{try{const t=JSON.stringify(e);console.log("Saving station inventory quantities to localStorage:",t),localStorage.setItem("station_inventory_quantities",t),l(e),console.log("Station inventory quantities saved successfully");const s=localStorage.getItem("station_inventory_quantities");console.log("Verified saved inventory quantities:",s),console.log("Skipping auto-sync to prevent config loss")}catch(bn){console.error("Error saving station inventory:",bn)}},N=(e,t,s,a)=>{const r=String(e),n={...o};n[r]||(n[r]={}),n[r][t]||(n[r][t]={}),n[r][t][s]||(n[r][t][s]={}),n[r][t][s].quantity=Math.max(0,a),console.log(`Updated quantity for item ${s} in category ${t} at station ${r} to ${a}`),w(n)},k=e=>{const t=String(e);return n[t]?n[t]:{}},S=(e,t,s)=>{var a;const r=k(e),i={};null===(a=c[t])||void 0===a||a.forEach((e=>{e.enabled&&(i[e.id]=s)}));const o={...r,[t]:i},l={...n,[e]:o};j(l)},C=()=>{let e=(()=>{const e=[];return Object.keys(c).forEach((t=>{var s;null===(s=c[t])||void 0===s||s.forEach((s=>{var a;s.enabled&&e.push({...s,category:t,categoryName:(null===(a=x[t])||void 0===a?void 0:a.name)||t})}))})),e})();if(u&&(e=e.filter((e=>e.name.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase())||e.categoryName.toLowerCase().includes(u.toLowerCase())))),"all"!==h&&(e=e.filter((e=>e.category===h))),"all"!==p&&s){const t=k(s.id);e=e.filter((e=>{var s;const a=(null===(s=t[e.category])||void 0===s?void 0:s[e.id])||!1;return"available"===p?a:!a}))}return e},_=e=>{const t=k(e);let s=0,a=0;return Object.keys(c).forEach((e=>{var r;null===(r=c[e])||void 0===r||r.forEach((r=>{var n;r.enabled&&(a++,null!==(n=t[e])&&void 0!==n&&n[r.id]&&s++)}))})),{available:s,total:a}};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Station Inventory Configuration"})}),(0,yt.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,yt.jsxs)("div",{className:"col-span-3",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Select Station"}),(0,yt.jsx)("div",{className:"space-y-2",children:t.map((e=>{const t=_(e.id);return(0,yt.jsx)("button",{onClick:()=>r(e),className:"w-full text-left p-3 rounded-md transition-colors "+((null===s||void 0===s?void 0:s.id)===e.id?"bg-blue-100 border border-blue-300":"bg-gray-50 hover:bg-gray-100"),children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("div",{className:"font-medium",children:e.name}),e.location&&(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]}),(0,yt.jsxs)("div",{className:"text-xs text-gray-500",children:[t.available,"/",t.total]})]})},e.id)}))}),s&&(0,yt.jsxs)("div",{className:"mt-4",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick Actions"}),(0,yt.jsx)("div",{className:"space-y-2",children:(0,yt.jsxs)("select",{onChange:e=>{e.target.value&&(((e,t)=>{const s=k(e),a={...n,[t]:JSON.parse(JSON.stringify(s))};j(a)})(parseInt(e.target.value),s.id),e.target.value="")},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded",children:[(0,yt.jsx)("option",{value:"",children:"Copy from station..."}),t.filter((e=>e.id!==s.id)).map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name},e.id)))]})})]})]}),(0,yt.jsx)("div",{className:"col-span-9",children:s?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(ht,{className:"mr-2 text-blue-600"}),(0,yt.jsxs)("h3",{className:"text-xl font-semibold",children:["Configure ",s.name]})]}),(0,yt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,yt.jsx)("div",{className:"text-sm text-gray-500",children:(()=>{const e=_(s.id);return`${e.available} of ${e.total} items available`})()}),(0,yt.jsx)("button",{onClick:()=>{console.log("Manual sync triggered"),ts.A.forceSyncAllStations()},className:"px-3 py-1 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",title:"Sync configurations to barista stations",children:"Sync to Stations"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)(ps,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,yt.jsx)("input",{type:"text",placeholder:"Search items...",value:u,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,yt.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yt.jsx)("option",{value:"all",children:"All Categories"}),Object.entries(x).map((e=>{let[t,s]=e;return(0,yt.jsx)("option",{value:t,children:s.name},t)}))]}),(0,yt.jsxs)("select",{value:p,onChange:e=>f(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,yt.jsx)("option",{value:"all",children:"All Items"}),(0,yt.jsx)("option",{value:"available",children:"Available Only"}),(0,yt.jsx)("option",{value:"unavailable",children:"Unavailable Only"})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-md p-4 mb-4",children:[(0,yt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Category Quick Actions"}),(0,yt.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(x).map((e=>{var t;let[a,r]=e;const n=(null===(t=c[a])||void 0===t?void 0:t.filter((e=>e.enabled)))||[],i=k(s.id),o=n.filter((e=>{var t;return null===(t=i[a])||void 0===t?void 0:t[e.id]})).length;return(0,yt.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[(0,yt.jsx)("span",{className:"text-sm font-medium",children:r.name}),(0,yt.jsxs)("div",{className:"flex space-x-1",children:[(0,yt.jsxs)("span",{className:"text-xs text-gray-500",children:[o,"/",n.length]}),(0,yt.jsx)("button",{onClick:()=>S(s.id,a,!0),className:"px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600",children:"All"}),(0,yt.jsx)("button",{onClick:()=>S(s.id,a,!1),className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600",children:"None"})]})]},a)}))})]}),(0,yt.jsx)("div",{className:"space-y-2",children:C().map((e=>{var t;const a=k(s.id),r=(null===(t=a[e.category])||void 0===t?void 0:t[e.id])||!1;"Latte"!==e.name&&"Small"!==e.name&&"Medium"!==e.name||console.log(`Item ${e.name} (${e.id}) availability for station ${s.id}:`,r,"Config:",a[e.category]);const i=((e,t,s)=>{var a,r,n;const i=String(e);return(null===(a=o[i])||void 0===a||null===(r=a[t])||void 0===r||null===(n=r[s])||void 0===n?void 0:n.quantity)||0})(s.id,e.category,e.id);if(e.name.includes("Latte")||e.name.includes("Small")){var l,d,u;const t=String(s.id);console.log(`Getting quantity for ${e.name} (${e.id}) at station ${s.id}:`,{stationId:s.id,stationIdStr:t,fullInventory:o,stationInventory:o[t],categoryData:null===(l=o[t])||void 0===l?void 0:l[e.category],itemData:null===(d=o[t])||void 0===d||null===(u=d[e.category])||void 0===u?void 0:u[e.id],currentQuantity:i})}return(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md hover:bg-gray-50",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("button",{onClick:()=>((e,t,s)=>{var a;const r=String(e);console.log(`Toggling item ${s} in category ${t} for station ${r}`);const i=k(r),o=(null===(a=i[t])||void 0===a?void 0:a[s])||!1;console.log(`Current availability: ${o}, setting to: ${!o}`);const l={...i,[t]:{...i[t],[s]:!o}},d={...n,[r]:l};if(console.log("Updated config for station:",r,l),console.log("Full configs to save:",JSON.stringify(d,null,2)),j(d),!o){var u;const a=null===(u=c[t])||void 0===u?void 0:u.find((e=>e.id===s));if(a){const r="milk"===t?5:"coffee"===t?2:"cups"===t?50:10;console.log(`Setting default quantity ${r} for new item ${a.name} (${s}) in category ${t}`),N(e,t,s,r)}}})(s.id,e.category,e.id),className:"p-2 rounded-md border-2 transition-colors "+(r?"bg-green-50 border-green-500 text-green-600 hover:bg-green-100":"bg-gray-50 border-gray-300 text-gray-400 hover:bg-gray-100 hover:border-gray-400"),title:r?"Click to disable for this station":"Click to enable for this station",children:r?(0,yt.jsx)(St,{size:18}):(0,yt.jsx)(Ga,{size:18})}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),r&&(0,yt.jsxs)("div",{className:"mt-1 flex items-center space-x-2",children:[(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:"Quantity:"}),(0,yt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,yt.jsx)("button",{onClick:()=>N(s.id,e.category,e.id,i-1),disabled:i<=0,className:"w-6 h-6 flex items-center justify-center text-xs bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,yt.jsx)(qa,{size:12})}),(0,yt.jsx)("input",{type:"number",min:"0",value:i,onChange:t=>N(s.id,e.category,e.id,parseInt(t.target.value)||0),className:"w-16 px-1 py-0.5 text-xs text-center border border-gray-300 rounded"}),(0,yt.jsx)("button",{onClick:()=>N(s.id,e.category,e.id,i+1),className:"w-6 h-6 flex items-center justify-center text-xs bg-gray-200 rounded hover:bg-gray-300",children:(0,yt.jsx)(Ft,{size:12})}),(0,yt.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:e.unit||("milk"===e.category?"L":"coffee"===e.category?"kg":"units")})]})]})]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("span",{className:"px-2 py-1 text-xs rounded-full "+(x[e.category]?`bg-${x[e.category].color}-100 text-${x[e.category].color}-800`:"bg-gray-100 text-gray-800"),children:e.categoryName}),r&&(0,yt.jsx)("button",{onClick:()=>((e,t,s)=>{var a,r;const i=String(e),l=k(i),c={...l,[t]:{...l[t]}};delete c[t][s];const d={...n,[i]:c};j(d);const u={...o};null!==(a=u[i])&&void 0!==a&&null!==(r=a[t])&&void 0!==r&&r[s]&&(delete u[i][t][s],w(u))})(s.id,e.category,e.id),className:"p-1 text-red-500 hover:bg-red-100 rounded",title:"Remove from station",children:(0,yt.jsx)(sa,{size:16})}),(0,yt.jsx)("div",{className:"w-3 h-3 rounded-full "+(r?"bg-green-500":"bg-gray-300")})]})]},e.id)}))}),0===C().length&&(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(At,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"No items found"}),u&&(0,yt.jsx)("p",{className:"text-sm",children:"Try adjusting your search or filters"})]})]}):(0,yt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,yt.jsx)(gt,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"Select a station to configure its available inventory"})]})})]})]})},Ya=()=>{const[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)({staff_name:"",staff_id:"",station_id:"",start_time:"",end_time:"",date:(new Date).toISOString().split("T")[0]});(0,a.useEffect)((()=>{u(),m(),h()}),[]);const u=()=>{try{const e=localStorage.getItem("coffee_cue_stations");e&&r(JSON.parse(e))}catch(e){console.error("Error loading stations:",e)}},m=()=>{try{const e=localStorage.getItem("coffee_system_users");if(e){const t=JSON.parse(e).filter((e=>e.active&&("barista"===e.role||"organizer"===e.role)));i(t)}}catch(e){console.error("Error loading users:",e)}},h=()=>{try{const e=localStorage.getItem("event_schedules");e&&t(JSON.parse(e))}catch(e){console.error("Error loading schedules:",e)}},g=e=>{try{localStorage.setItem("event_schedules",JSON.stringify(e)),t(e),window.dispatchEvent(new CustomEvent("schedule:updated",{detail:{schedules:e}}))}catch(s){console.error("Error saving schedules:",s)}},p=e.filter((e=>e.date===(new Date).toISOString().split("T")[0])).reduce(((e,t)=>{const s=t.station_id;return e[s]||(e[s]=[]),e[s].push(t),e}),{});return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,yt.jsx)($t,{size:28,className:"mr-3 text-amber-600"}),"Schedule Management"]}),(0,yt.jsxs)("button",{onClick:()=>l(!0),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[(0,yt.jsx)(Ft,{size:20,className:"mr-2"}),"Add Shift"]})]}),o&&(0,yt.jsxs)("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add New Shift"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Barista"}),(0,yt.jsxs)("select",{value:c.staff_id,onChange:e=>{const t=n.find((t=>t.id===e.target.value));d({...c,staff_id:e.target.value,staff_name:t?t.fullName:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"",children:"Select barista"}),n.map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.fullName," (",e.experience,")",e.preferredStation&&` - Prefers Station ${e.preferredStation}`]},e.id)))]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Station"}),(0,yt.jsxs)("select",{value:c.station_id,onChange:e=>d({...c,station_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"",children:"Select station"}),s.map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name||`Station ${e.id}`},e.id)))]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,yt.jsx)("input",{type:"time",value:c.start_time,onChange:e=>d({...c,start_time:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),(0,yt.jsx)("input",{type:"time",value:c.end_time,onChange:e=>d({...c,end_time:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,yt.jsxs)("div",{className:"mt-4 flex justify-end space-x-2",children:[(0,yt.jsx)("button",{onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,yt.jsx)("button",{onClick:()=>{if(!c.staff_id||!c.station_id||!c.start_time||!c.end_time)return void alert("Please select a barista and fill in all fields");const t={id:Date.now(),...c,status:"scheduled",created_at:(new Date).toISOString()},s=[...e,t];g(s),d({staff_name:"",staff_id:"",station_id:"",start_time:"",end_time:"",date:(new Date).toISOString().split("T")[0]}),l(!1)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Add Shift"})]})]}),(0,yt.jsxs)("div",{className:"mb-6",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(Rt,{size:20,className:"mr-2 text-amber-600"}),"Today's Schedule (",(new Date).toLocaleDateString(),")"]}),Object.keys(p).length>0?(0,yt.jsx)("div",{className:"space-y-4",children:Object.entries(p).map((t=>{let[a,r]=t;const n=s.find((e=>e.id===parseInt(a)));return(0,yt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,yt.jsxs)("h4",{className:"font-medium mb-3 flex items-center",children:[(0,yt.jsx)(ht,{size:18,className:"mr-2 text-amber-600"}),(null===n||void 0===n?void 0:n.name)||`Station ${a}`]}),(0,yt.jsx)("div",{className:"space-y-2",children:r.sort(((e,t)=>e.start_time.localeCompare(t.start_time))).map((t=>(0,yt.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(zt,{size:16,className:"mr-2 text-gray-600"}),(0,yt.jsx)("span",{className:"font-medium",children:t.staff_name}),(0,yt.jsxs)("span",{className:"ml-4 text-gray-600",children:[t.start_time," - ",t.end_time]})]}),(0,yt.jsx)("button",{onClick:()=>(t=>{if(window.confirm("Are you sure you want to delete this shift?")){const s=e.filter((e=>e.id!==t));g(s)}})(t.id),className:"text-red-500 hover:text-red-700",children:(0,yt.jsx)(sa,{size:16})})]},t.id)))})]},a)}))}):(0,yt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,yt.jsx)(zt,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,yt.jsx)("p",{children:"No schedules for today"}),(0,yt.jsx)("p",{className:"text-sm mt-2",children:'Click "Add Shift" to create a schedule'})]})]}),(0,yt.jsx)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,yt.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,yt.jsx)("strong",{children:"Note:"})," Schedules created here will automatically sync to the Barista interface. Each barista will see their assigned shifts when they log into their station."]})})]})},Ka=dt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Xa="2.0",Za={espresso:{id:"espresso",name:"Espresso",category:"espresso-based",enabled:!0,description:"Single or double shot of concentrated coffee",requiresMilk:!1,sizes:{single:{enabled:!0,name:"Single",shots:1,milkRatio:0,waterRatio:0,cupSize:"small-8oz",price:3.5},double:{enabled:!0,name:"Double",shots:2,milkRatio:0,waterRatio:0,cupSize:"small-8oz",price:4}},instructions:"Grind 7-9g for single, 14-18g for double. Extract 25-30 seconds.",customizable:{extraShot:!0,decaf:!0}},"long-black":{id:"long-black",name:"Long Black",category:"espresso-based",enabled:!0,description:"Espresso with hot water",requiresMilk:!1,sizes:{small:{enabled:!0,shots:2,milkRatio:0,waterRatio:120,cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:0,waterRatio:240,cupSize:"medium-12oz"}},instructions:"Add hot water first, then float espresso on top to preserve crema.",customizable:{extraShot:!0,decaf:!0,strength:!0}},cappuccino:{id:"cappuccino",name:"Cappuccino",category:"espresso-based",enabled:!0,description:"Espresso with steamed milk and thick foam",requiresMilk:!0,sizes:{small:{enabled:!0,shots:1,milkRatio:120,foamThickness:"thick",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:180,foamThickness:"thick",cupSize:"medium-12oz"}},instructions:"1/3 espresso, 1/3 steamed milk, 1/3 foam. Dust with chocolate if requested.",customizable:{extraShot:!0,decaf:!0,milkType:!0,chocolate:!0}},latte:{id:"latte",name:"Latte",category:"espresso-based",enabled:!0,description:"Espresso with steamed milk and thin foam layer",requiresMilk:!0,sizes:{small:{enabled:!0,shots:1,milkRatio:220,foamThickness:"thin",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:340,foamThickness:"thin",cupSize:"medium-12oz"},large:{enabled:!0,shots:2,milkRatio:450,foamThickness:"thin",cupSize:"large-16oz"}},instructions:"Steam milk to 65\xb0C with microfoam. Pour steadily for latte art.",customizable:{extraShot:!0,decaf:!0,milkType:!0,temperature:!0,syrup:!0}},"flat-white":{id:"flat-white",name:"Flat White",category:"espresso-based",enabled:!0,description:"Espresso with steamed milk and microfoam",requiresMilk:!0,sizes:{small:{enabled:!0,shots:2,milkRatio:160,foamThickness:"micro",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:240,foamThickness:"micro",cupSize:"medium-12oz"}},instructions:"Double ristretto shots. Steam milk to create velvety microfoam.",customizable:{extraShot:!0,decaf:!0,milkType:!0}},macchiato:{id:"macchiato",name:"Macchiato",category:"espresso-based",enabled:!0,description:"Espresso 'marked' with a dollop of foamed milk",requiresMilk:!0,sizes:{single:{enabled:!0,name:"Single",shots:1,milkRatio:15,foamThickness:"dollop",cupSize:"small-8oz"},double:{enabled:!0,name:"Double",shots:2,milkRatio:30,foamThickness:"dollop",cupSize:"small-8oz"}},instructions:"Pull espresso, add small dollop of foamed milk on top.",customizable:{extraShot:!0,decaf:!0,milkType:!0}},piccolo:{id:"piccolo",name:"Piccolo Latte",category:"espresso-based",enabled:!0,description:"Single shot espresso with steamed milk in a small glass",requiresMilk:!0,sizes:{standard:{enabled:!0,name:"Standard",shots:1,milkRatio:90,foamThickness:"thin",cupSize:"piccolo-glass"}},instructions:"Single ristretto shot in 90ml glass, topped with steamed milk.",customizable:{decaf:!0,milkType:!0}},cortado:{id:"cortado",name:"Cortado",category:"espresso-based",enabled:!0,description:"Equal parts espresso and steamed milk",requiresMilk:!0,sizes:{standard:{enabled:!0,name:"Standard",shots:2,milkRatio:60,foamThickness:"minimal",cupSize:"cortado-glass"}},instructions:"1:1 ratio of espresso to milk. Serve in gibraltar glass.",customizable:{decaf:!0,milkType:!0}},mocha:{id:"mocha",name:"Mocha",category:"espresso-based",enabled:!0,description:"Espresso with chocolate and steamed milk",requiresMilk:!0,requiresExtra:["chocolate-powder","chocolate-syrup"],sizes:{small:{enabled:!0,shots:1,milkRatio:200,chocolateRatio:30,foamThickness:"medium",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:300,chocolateRatio:45,foamThickness:"medium",cupSize:"medium-12oz"},large:{enabled:!0,shots:2,milkRatio:400,chocolateRatio:60,foamThickness:"medium",cupSize:"large-16oz"}},instructions:"Add chocolate to cup, pull shots over chocolate, add steamed milk.",customizable:{extraShot:!0,decaf:!0,milkType:!0,whippedCream:!0,syrup:!0}},affogato:{id:"affogato",name:"Affogato",category:"espresso-based",enabled:!0,description:"Espresso poured over vanilla ice cream",requiresMilk:!1,requiresExtra:["ice-cream"],sizes:{standard:{enabled:!0,name:"Standard",shots:1,iceCreamScoops:1,cupSize:"dessert-glass"},double:{enabled:!0,name:"Double",shots:2,iceCreamScoops:2,cupSize:"dessert-glass"}},instructions:"Place ice cream in glass/cup, pour hot espresso over top. Serve immediately.",customizable:{extraShot:!0,decaf:!0,liqueur:!0}},"hot-chocolate":{id:"hot-chocolate",name:"Hot Chocolate",category:"milk-based",enabled:!0,description:"Rich chocolate drink with steamed milk",requiresMilk:!0,requiresExtra:["chocolate-powder"],sizes:{small:{enabled:!0,shots:0,milkRatio:240,chocolateRatio:30,cupSize:"small-8oz"},medium:{enabled:!0,shots:0,milkRatio:360,chocolateRatio:45,cupSize:"medium-12oz"},large:{enabled:!0,shots:0,milkRatio:480,chocolateRatio:60,cupSize:"large-16oz"}},instructions:"Mix chocolate powder with small amount of hot milk, then add remaining steamed milk.",customizable:{marshmallows:!0,whippedCream:!0,milkType:!0,temperature:!0}},babycino:{id:"babycino",name:"Babycino",category:"milk-based",enabled:!0,description:"Warm frothy milk for kids",requiresMilk:!0,sizes:{kids:{enabled:!0,name:"Kids Size",shots:0,milkRatio:120,foamThickness:"extra-thick",cupSize:"kids-cup"}},instructions:"Steam milk to 50\xb0C (cooler than adult drinks). Create extra thick foam. Dust with chocolate.",customizable:{chocolate:!0,marshmallows:!0,temperature:!0}},"turmeric-latte":{id:"turmeric-latte",name:"Turmeric Latte",category:"milk-based",enabled:!0,description:"Golden milk with turmeric and spices",requiresMilk:!0,requiresExtra:["turmeric-powder"],sizes:{small:{enabled:!0,shots:0,milkRatio:240,turmericRatio:5,cupSize:"small-8oz"},medium:{enabled:!0,shots:0,milkRatio:360,turmericRatio:7,cupSize:"medium-12oz"},large:{enabled:!0,shots:0,milkRatio:480,turmericRatio:10,cupSize:"large-16oz"}},instructions:"Mix turmeric powder with spices, add small amount of hot milk to form paste, then add remaining steamed milk.",customizable:{milkType:!0,honey:!0,ginger:!0,cinnamon:!0,temperature:!0}},"chai-latte":{id:"chai-latte",name:"Chai Latte",category:"milk-based",enabled:!0,description:"Spiced tea with steamed milk",requiresMilk:!0,requiresExtra:["chai-concentrate"],sizes:{small:{enabled:!0,shots:0,chaiRatio:120,milkRatio:120,cupSize:"small-8oz"},medium:{enabled:!0,shots:0,chaiRatio:180,milkRatio:180,cupSize:"medium-12oz"},large:{enabled:!0,shots:0,chaiRatio:240,milkRatio:240,cupSize:"large-16oz"}},instructions:"1:1 ratio chai concentrate to steamed milk. Can add espresso for 'dirty chai'.",customizable:{dirtyOption:!0,milkType:!0,honey:!0,cinnamon:!0}},"matcha-latte":{id:"matcha-latte",name:"Matcha Latte",category:"milk-based",enabled:!0,description:"Matcha green tea with steamed milk",requiresMilk:!0,requiresExtra:["matcha-powder"],sizes:{small:{enabled:!0,matchaGrams:2,milkRatio:240,cupSize:"small-8oz"},medium:{enabled:!0,matchaGrams:3,milkRatio:360,cupSize:"medium-12oz"},large:{enabled:!0,matchaGrams:4,milkRatio:480,cupSize:"large-16oz"}},instructions:"Whisk matcha with small amount of hot water, add steamed milk.",customizable:{milkType:!0,sweetener:!0,temperature:!0}},"filter-coffee":{id:"filter-coffee",name:"Filter Coffee",category:"filter-drip",enabled:!0,description:"Regular brewed coffee",requiresMilk:!1,sizes:{small:{enabled:!0,coffeeRatio:240,cupSize:"small-8oz"},medium:{enabled:!0,coffeeRatio:360,cupSize:"medium-12oz"},large:{enabled:!0,coffeeRatio:480,cupSize:"large-16oz"}},instructions:"Brew at 92-96\xb0C, ratio 1:15 to 1:17 coffee to water.",customizable:{strength:!0,milk:!0,sugar:!0}},"cold-brew":{id:"cold-brew",name:"Cold Brew",category:"filter-drip",enabled:!0,description:"Coffee steeped in cold water for 12-24 hours",requiresMilk:!1,sizes:{small:{enabled:!0,coldBrewRatio:200,waterRatio:40,cupSize:"small-8oz"},medium:{enabled:!0,coldBrewRatio:300,waterRatio:60,cupSize:"medium-12oz"},large:{enabled:!0,coldBrewRatio:400,waterRatio:80,cupSize:"large-16oz"}},instructions:"Serve over ice. Can dilute concentrate with water or milk.",customizable:{milk:!0,syrup:!0,ice:!0}},"iced-latte":{id:"iced-latte",name:"Iced Latte",category:"cold-drinks",enabled:!0,description:"Cold latte over ice",requiresMilk:!0,sizes:{small:{enabled:!0,shots:1,milkRatio:200,iceRatio:"full",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:300,iceRatio:"full",cupSize:"medium-12oz"},large:{enabled:!0,shots:2,milkRatio:400,iceRatio:"full",cupSize:"large-16oz"}},instructions:"Fill cup with ice, add espresso, top with cold milk.",customizable:{extraShot:!0,decaf:!0,milkType:!0,syrup:!0,lessIce:!0}},"iced-chocolate":{id:"iced-chocolate",name:"Iced Chocolate",category:"cold-drinks",enabled:!0,description:"Cold chocolate drink over ice",requiresMilk:!0,requiresExtra:["chocolate-powder"],sizes:{small:{enabled:!0,shots:0,milkRatio:220,chocolateRatio:30,iceRatio:"full",cupSize:"small-8oz"},medium:{enabled:!0,shots:0,milkRatio:320,chocolateRatio:45,iceRatio:"full",cupSize:"medium-12oz"},large:{enabled:!0,shots:0,milkRatio:420,chocolateRatio:60,iceRatio:"full",cupSize:"large-16oz"}},instructions:"Mix chocolate powder with small amount of hot milk to dissolve, add cold milk, pour over ice.",customizable:{whippedCream:!0,milkType:!0,marshmallows:!0,lessIce:!0,syrup:!0}},"iced-cappuccino":{id:"iced-cappuccino",name:"Iced Cappuccino",category:"cold-drinks",enabled:!0,description:"Cold cappuccino over ice with foam",requiresMilk:!0,sizes:{small:{enabled:!0,shots:1,milkRatio:180,foamRatio:60,iceRatio:"full",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:250,foamRatio:80,iceRatio:"full",cupSize:"medium-12oz"},large:{enabled:!0,shots:2,milkRatio:350,foamRatio:100,iceRatio:"full",cupSize:"large-16oz"}},instructions:"Pull shots over ice, add cold milk, top with cold foam. Dust with chocolate if desired.",customizable:{extraShot:!0,decaf:!0,milkType:!0,chocolate:!0,lessIce:!0}},"iced-mocha":{id:"iced-mocha",name:"Iced Mocha",category:"cold-drinks",enabled:!0,description:"Cold mocha over ice",requiresMilk:!0,requiresExtra:["chocolate-powder"],sizes:{small:{enabled:!0,shots:1,milkRatio:200,chocolateRatio:30,iceRatio:"full",cupSize:"small-8oz"},medium:{enabled:!0,shots:2,milkRatio:300,chocolateRatio:45,iceRatio:"full",cupSize:"medium-12oz"},large:{enabled:!0,shots:2,milkRatio:400,chocolateRatio:60,iceRatio:"full",cupSize:"large-16oz"}},instructions:"Mix chocolate with small amount of hot milk, add espresso, cold milk, pour over ice.",customizable:{extraShot:!0,decaf:!0,milkType:!0,whippedCream:!0,lessIce:!0,syrup:!0}}},er={"espresso-based":{name:"Espresso Based",color:"amber",description:"Traditional espresso drinks"},"milk-based":{name:"Milk Based Variations",color:"blue",description:"Non-coffee milk drinks"},"filter-drip":{name:"Filter & Drip Coffee",color:"brown",description:"Brewed coffee options"},"cold-drinks":{name:"Cold Drinks",color:"cyan",description:"Iced and cold options"},custom:{name:"Custom Drinks",color:"purple",description:"Your custom creations"}},tr=()=>{var e,t,s;const[r,n]=(0,a.useState)({}),[i,o]=(0,a.useState)(""),[l,c]=(0,a.useState)("all"),[d,u]=(0,a.useState)({}),[m,h]=(0,a.useState)(null),[g,p]=(0,a.useState)(!1),[f,x]=(0,a.useState)([]),[y,b]=(0,a.useState)(null);(0,a.useEffect)((()=>{v(),j()}),[]);const v=()=>{const e=localStorage.getItem("event_menu"),t=localStorage.getItem("event_menu_version");if(e&&t===Xa)try{n(JSON.parse(e))}catch(bn){console.error("Error loading menu:",bn),n(Za),localStorage.setItem("event_menu",JSON.stringify(Za)),localStorage.setItem("event_menu_version",Xa)}else console.log("Loading new menu version:",Xa),n(Za),localStorage.setItem("event_menu",JSON.stringify(Za)),localStorage.setItem("event_menu_version",Xa)},j=()=>{const e=localStorage.getItem("event_inventory");if(e)try{const t=JSON.parse(e).cups||[],s=[{id:"small-8oz",name:"Small (8oz)",enabled:!0},{id:"medium-12oz",name:"Medium (12oz)",enabled:!0},{id:"large-16oz",name:"Large (16oz)",enabled:!0},{id:"extra-large-20oz",name:"Extra Large (20oz)",enabled:!0}];x(t.length>0?t.filter((e=>e.enabled)):s)}catch(bn){console.error("Error loading cups:",bn)}},w=e=>{localStorage.setItem("event_menu",JSON.stringify(e)),localStorage.setItem("event_menu_version",Xa),n(e)},N=(e,t)=>{const s={...r,[e]:{...r[e],...t}};w(s)},k=(e,t,s)=>{const a={...r,[e]:{...r[e],sizes:{...r[e].sizes,[t]:{...r[e].sizes[t],...s}}}};w(a)};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Menu Management"}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsxs)("button",{onClick:()=>{window.confirm("This will restore the default menu and overwrite any custom drinks. Are you sure?")&&(n(Za),localStorage.setItem("event_menu",JSON.stringify(Za)),localStorage.setItem("event_menu_version",Xa),j())},className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 flex items-center",title:"Restore default menu",children:[(0,yt.jsx)(gt,{size:20,className:"mr-2"}),"Restore Defaults"]}),(0,yt.jsxs)("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center",children:[(0,yt.jsx)(Ft,{size:20,className:"mr-2"}),"Add Custom Drink"]})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)(ps,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,yt.jsx)("input",{type:"text",placeholder:"Search drinks...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"})]}),(0,yt.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[(0,yt.jsx)("option",{value:"all",children:"All Categories"}),Object.entries(er).map((e=>{let[t,s]=e;return(0,yt.jsx)("option",{value:t,children:s.name},t)}))]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:Object.keys(r).length}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Total Drinks"})]}),(0,yt.jsxs)("div",{className:"bg-green-50 p-4 rounded-md",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:Object.values(r).filter((e=>e.enabled)).length}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Active Drinks"})]}),(0,yt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-md",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:Object.values(r).filter((e=>e.requiresMilk)).length}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Milk-Based"})]}),(0,yt.jsxs)("div",{className:"bg-purple-50 p-4 rounded-md",children:[(0,yt.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Object.values(r).filter((e=>"custom"===e.category)).length}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Custom Drinks"})]})]}),Object.entries((()=>{const e=Object.values(r).filter((e=>{const t=e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()),s="all"===l||e.category===l;return t&&s})),t={};return e.forEach((e=>{t[e.category]||(t[e.category]=[]),t[e.category].push(e)})),t})()).map((e=>{var t,s;let[a,n]=e;return(0,yt.jsxs)("div",{className:"mb-8",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 text-gray-700 flex items-center",children:[(0,yt.jsx)(ht,{className:`mr-2 text-${(null===(t=er[a])||void 0===t?void 0:t.color)||"gray"}-600`}),(null===(s=er[a])||void 0===s?void 0:s.name)||a,(0,yt.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:["(",n.length," drinks)"]})]}),(0,yt.jsx)("div",{className:"space-y-2",children:n.map((e=>(0,yt.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[(0,yt.jsxs)("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,yt.jsx)("button",{onClick:()=>(e=>{const t={...r,[e]:{...r[e],enabled:!r[e].enabled}};w(t)})(e.id),className:"p-2 rounded-md border-2 transition-colors "+(e.enabled?"bg-green-50 border-green-500 text-green-600":"bg-gray-50 border-gray-300 text-gray-400"),children:e.enabled?(0,yt.jsx)(St,{size:18}):(0,yt.jsx)(Ga,{size:18})}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium "+(e.enabled?"text-gray-900":"text-gray-400"),children:e.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),e.requiresMilk&&(0,yt.jsx)("span",{className:"text-xs text-blue-600",children:"Requires milk"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("button",{onClick:()=>u({...d,[e.id]:!d[e.id]}),className:"p-2 text-gray-500 hover:bg-gray-100 rounded",children:d[e.id]?(0,yt.jsx)(It,{size:20}):(0,yt.jsx)(ja,{size:20})}),(0,yt.jsx)("button",{onClick:()=>(e=>{if(window.confirm(`Are you sure you want to delete ${r[e].name}? This cannot be undone.`)){const t={...r};delete t[e],w(t)}})(e.id),className:"p-2 text-red-500 hover:bg-red-100 rounded",title:"Delete this drink",children:(0,yt.jsx)(sa,{size:18})})]})]}),d[e.id]&&(0,yt.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:[(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsxs)("label",{className:"text-sm font-medium text-gray-700 flex items-center mb-2",children:[(0,yt.jsx)(Ka,{size:16,className:"mr-1"}),"Preparation Instructions"]}),(0,yt.jsx)("textarea",{value:e.instructions,onChange:t=>N(e.id,{instructions:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",rows:"2",placeholder:"Enter preparation instructions..."})]}),(0,yt.jsxs)("div",{className:"mb-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yt.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Size Configurations"}),(0,yt.jsxs)("button",{onClick:()=>b(e.id),className:"px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600 flex items-center",children:[(0,yt.jsx)(Ft,{size:14,className:"mr-1"}),"Add Size"]})]}),(0,yt.jsx)("div",{className:"space-y-3",children:Object.entries(e.sizes).map((t=>{let[s,a]=t;return(0,yt.jsxs)("div",{className:"bg-white p-3 rounded border border-gray-200",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{onClick:()=>((e,t)=>{const s={...r,[e]:{...r[e],sizes:{...r[e].sizes,[t]:{...r[e].sizes[t],enabled:!r[e].sizes[t].enabled}}}};w(s)})(e.id,s),className:"p-1 rounded border-2 mr-2 transition-colors "+(a.enabled?"bg-green-50 border-green-500 text-green-600":"bg-gray-50 border-gray-300 text-gray-400"),children:a.enabled?(0,yt.jsx)(St,{size:14}):(0,yt.jsx)(Ga,{size:14})}),(0,yt.jsx)("input",{type:"text",value:a.name||s.charAt(0).toUpperCase()+s.slice(1),onChange:t=>k(e.id,s,{name:t.target.value}),className:"font-medium bg-transparent border-b border-transparent hover:border-gray-300 focus:border-blue-500 focus:outline-none"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,yt.jsx)("select",{value:a.cupSize,onChange:t=>k(e.id,s,{cupSize:t.target.value}),className:"text-sm px-2 py-1 border border-gray-300 rounded",children:f.map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name},e.id)))}),Object.keys(e.sizes).length>1&&(0,yt.jsx)("button",{onClick:()=>((e,t)=>{if(Object.keys(r[e].sizes).length<=1)alert("Cannot delete the only size. Each drink must have at least one size option.");else if(window.confirm("Are you sure you want to delete this size?")){const s={...r,[e]:{...r[e],sizes:Object.fromEntries(Object.entries(r[e].sizes).filter((e=>{let[s]=e;return s!==t})))}};w(s)}})(e.id,s),className:"p-1 text-red-500 hover:bg-red-100 rounded",children:(0,yt.jsx)(sa,{size:14})})]})]}),a.enabled&&(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[void 0!==a.shots&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"text-gray-600",children:"Shots"}),(0,yt.jsx)("input",{type:"number",min:"0",max:"4",value:a.shots,onChange:t=>k(e.id,s,{shots:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded"})]}),void 0!==a.milkRatio&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"text-gray-600",children:"Milk (ml)"}),(0,yt.jsx)("input",{type:"number",min:"0",value:a.milkRatio,onChange:t=>k(e.id,s,{milkRatio:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded"})]}),void 0!==a.waterRatio&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"text-gray-600",children:"Water (ml)"}),(0,yt.jsx)("input",{type:"number",min:"0",value:a.waterRatio,onChange:t=>k(e.id,s,{waterRatio:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded"})]}),void 0!==a.price&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"text-gray-600",children:"Price ($)"}),(0,yt.jsx)("input",{type:"number",min:"0",step:"0.50",value:a.price,onChange:t=>k(e.id,s,{price:parseFloat(t.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded"})]})]})]},s)}))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Customization Options"}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(e.customizable||{}).filter((e=>{let[t]=e;return!["sweetener","sugar","honey"].includes(t)})).map((t=>{let[s,a]=t;return(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",checked:a,onChange:t=>N(e.id,{customizable:{...e.customizable,[s]:t.target.checked}}),className:"mr-2"}),(0,yt.jsx)("span",{className:"text-sm text-gray-700",children:s.replace(/([A-Z])/g," $1").trim()})]},s)}))})]})]})]},e.id)))})]},a)})),y&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Add Size to ",null===(e=r[y])||void 0===e?void 0:e.name]}),(0,yt.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=new FormData(e.target);((e,t)=>{const s=t.name.toLowerCase().replace(/\s+/g,"-"),a=r[e],n={enabled:!0,name:t.name,shots:t.shots||(a.requiresMilk?2:1),cupSize:t.cupSize,...a.requiresMilk&&{milkRatio:t.milkRatio||300},..."long-black"===a.id&&{waterRatio:t.waterRatio||200}},i={...r,[e]:{...r[e],sizes:{...r[e].sizes,[s]:n}}};w(i),b(null)})(y,{name:t.get("name"),cupSize:t.get("cupSize"),shots:parseInt(t.get("shots"))||1,milkRatio:parseInt(t.get("milkRatio"))||0,waterRatio:parseInt(t.get("waterRatio"))||0})},children:[(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size Name"}),(0,yt.jsx)("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., Extra Large"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cup Size"}),(0,yt.jsx)("select",{name:"cupSize",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:f.map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Shots"}),(0,yt.jsx)("input",{name:"shots",type:"number",min:"0",max:"4",defaultValue:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(null===(t=r[y])||void 0===t?void 0:t.requiresMilk)&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Milk Amount (ml)"}),(0,yt.jsx)("input",{name:"milkRatio",type:"number",min:"0",defaultValue:"400",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),"long-black"===(null===(s=r[y])||void 0===s?void 0:s.id)&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Water Amount (ml)"}),(0,yt.jsx)("input",{name:"waterRatio",type:"number",min:"0",defaultValue:"300",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,yt.jsx)("button",{type:"button",onClick:()=>b(null),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,yt.jsx)("button",{type:"submit",className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Add Size"})]})]})]})}),g&&(0,yt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,yt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,yt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Custom Drink"}),(0,yt.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=new FormData(e.target);(e=>{const t=e.name.toLowerCase().replace(/\s+/g,"-"),s={id:t,name:e.name,category:"custom",enabled:!0,description:e.description,requiresMilk:e.requiresMilk,sizes:{small:{enabled:!0,shots:e.defaultShots||1,milkRatio:e.requiresMilk?220:0,cupSize:"small-8oz"}},instructions:e.instructions||"",customizable:{extraShot:!0,decaf:!0,milkType:e.requiresMilk}},a={...r,[t]:s};w(a),p(!1)})({name:t.get("name"),description:t.get("description"),requiresMilk:"true"===t.get("requiresMilk"),defaultShots:parseInt(t.get("defaultShots"))||1,instructions:t.get("instructions")})},children:[(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Drink Name"}),(0,yt.jsx)("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., Turmeric Latte"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,yt.jsx)("input",{name:"description",type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"e.g., Golden milk with turmeric and spices"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requires Milk?"}),(0,yt.jsxs)("select",{name:"requiresMilk",className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"false",children:"No"}),(0,yt.jsx)("option",{value:"true",children:"Yes"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Shots (if coffee-based)"}),(0,yt.jsx)("input",{name:"defaultShots",type:"number",min:"0",max:"4",defaultValue:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions (optional)"}),(0,yt.jsx)("textarea",{name:"instructions",rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"How to prepare this drink..."})]})]}),(0,yt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,yt.jsx)("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,yt.jsx)("button",{type:"submit",className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Add Drink"})]})]})]})})]})},sr=()=>{const{appMode:e}=(0,Ut.q)(),{stations:t,loading:s}=Xt(),[r,n]=(0,a.useState)("dashboard"),[i,o]=(0,a.useState)((()=>("2.0"!==localStorage.getItem("organiser_interface_version")&&(localStorage.setItem("organiser_interface_version","2.0"),localStorage.removeItem("organiser_active_section"),localStorage.removeItem("organiser_station_tab")),"settings"))),[l,c]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{console.log("Organiser Interface mounted"),ts.A.initializeStockServiceIntegration()}),[]),(0,yt.jsxs)("div",{className:"min-h-screen bg-gray-100 flex",children:[(0,yt.jsxs)("div",{className:`bg-white shadow-lg ${l?"w-64":"w-20"} transition-all duration-300 flex flex-col`,children:[(0,yt.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{className:"mr-2 p-1 rounded hover:bg-gray-200",onClick:()=>window.history.back(),title:"Back to Home",children:(0,yt.jsx)(Tt,{size:20})}),(0,yt.jsx)("h1",{className:"font-bold text-gray-800 "+(l?"text-xl":"text-sm"),children:l?Nt.adminPanelTitle:Nt.shortName.split(" ").map((e=>e[0])).join("")})]}),(0,yt.jsx)("button",{onClick:()=>c(!l),className:"text-gray-500 hover:text-gray-800",children:l?"\u25c0":"\u25b6"})]})}),(0,yt.jsx)("nav",{className:"flex-1 px-2 py-4",children:(0,yt.jsxs)("div",{className:"space-y-1",children:[(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("dashboard"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("dashboard"),children:[(0,yt.jsx)(qs,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"\ud83d\ude80 Live Ops"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("stations"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>{n("stations"),o("settings")},children:[(0,yt.jsx)(ht,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Stations"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("queuePsychology"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("queuePsychology"),children:[(0,yt.jsx)(Pt,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Queue AI"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("eventLifecycle"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("eventLifecycle"),children:[(0,yt.jsx)(Es,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Event Phases"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("orders"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("orders"),children:[(0,yt.jsx)(Rt,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Orders"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("groupOrders"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("groupOrders"),children:[(0,yt.jsx)(aa,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Group Orders"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("users"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("users"),children:[(0,yt.jsx)(zt,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Users"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("schedule"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("schedule"),children:[(0,yt.jsx)($t,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Schedule"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("analytics"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("analytics"),children:[(0,yt.jsx)(na,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Analytics"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("communication"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("communication"),children:[(0,yt.jsx)(ia,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Comms Hub"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("predictive"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("predictive"),children:[(0,yt.jsx)(oa,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"AI Predict"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("messages"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("messages"),children:[(0,yt.jsx)(la,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Messages"})]}),(0,yt.jsxs)("button",{className:"w-full flex items-center px-3 py-2 rounded-md "+("settings"===r?"bg-amber-100 text-amber-800":"text-gray-700 hover:bg-gray-100"),onClick:()=>n("settings"),children:[(0,yt.jsx)(gt,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Settings"})]})]})}),(0,yt.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,yt.jsxs)("button",{className:"flex items-center text-gray-700 w-full",children:[(0,yt.jsx)(xt,{size:20,className:"mr-3"}),l&&(0,yt.jsx)("span",{children:"Log out"})]})})]}),(0,yt.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,yt.jsxs)("header",{className:"bg-white shadow-sm p-4 flex justify-between items-center",children:[(0,yt.jsxs)("h1",{className:"text-xl font-bold text-gray-800",children:["dashboard"===r&&"\ud83d\ude80 Live Operations Command Center","stations"===r&&"Station Management","queuePsychology"===r&&"Queue Psychology & Customer Intelligence","eventLifecycle"===r&&"Event Lifecycle Management","analytics"===r&&"\ud83d\udcca Real-Time Analytics Dashboard","communication"===r&&"\ud83d\udce1 Communication Hub","predictive"===r&&"\ud83e\udd16 Predictive Intelligence & Resilience","orders"===r&&"All Orders Overview","users"===r&&"User Management","schedule"===r&&"Event Schedule","messages"===r&&"Message Center","settings"===r&&"System Settings"]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("button",{className:"text-gray-500 hover:text-gray-800 relative",children:[(0,yt.jsx)(ca,{size:20}),(0,yt.jsx)("span",{className:"absolute top-0 right-0 bg-red-500 rounded-full w-2 h-2"})]}),(0,yt.jsx)("div",{className:"h-8 w-8 rounded-full bg-amber-200 flex items-center justify-center",children:(0,yt.jsx)("span",{className:"text-amber-800 font-medium",children:"A"})})]})]}),(0,yt.jsxs)("main",{className:"p-6",children:["dashboard"===r&&(0,yt.jsx)(wa,{}),"queuePsychology"===r&&(0,yt.jsx)(Na,{}),"eventLifecycle"===r&&(0,yt.jsx)(Ca,{}),"stations"===r&&(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"mb-6 bg-white p-2 rounded-lg shadow flex",children:[(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md "+("settings"===i?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>o("settings"),children:[(0,yt.jsx)(gt,{size:16,className:"inline-block mr-1"}),"Station Settings"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md "+("inventory"===i?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>o("inventory"),children:[(0,yt.jsx)(At,{size:16,className:"inline-block mr-1"}),"Event Inventory"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md "+("stock"===i?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>o("stock"),children:[(0,yt.jsx)(At,{size:16,className:"inline-block mr-1"}),"Event Stock"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md "+("config"===i?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>o("config"),children:[(0,yt.jsx)(ht,{size:16,className:"inline-block mr-1"}),"Station Inventory"]}),(0,yt.jsxs)("button",{className:"flex-1 py-2 px-4 rounded-md "+("menu"===i?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>o("menu"),children:[(0,yt.jsx)(ht,{size:16,className:"inline-block mr-1"}),"Menu Items"]})]}),"settings"===i&&(0,yt.jsx)(Va,{stations:t,onStationUpdate:async(e,t)=>{try{return console.log("Updating station:",e,t),!0}catch(s){return console.error("Error updating station:",s),!1}},onAddStation:async e=>{try{return console.log("Adding station:",e),!0}catch(t){return console.error("Error adding station:",t),!1}},onDeleteStation:async e=>{try{return console.log("Deleting station:",e),!0}catch(t){return console.error("Error deleting station:",t),!1}}}),"inventory"===i&&(0,yt.jsx)(Ba,{}),"stock"===i&&(0,yt.jsx)(Ha,{}),"config"===i&&(0,yt.jsx)(Qa,{stations:t}),"menu"===i&&(0,yt.jsx)(tr,{})]}),"orders"===r&&(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,yt.jsx)(ua,{})}),"groupOrders"===r&&(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,yt.jsx)(ra,{onSubmitGroupOrders:e=>Bt.A.submitGroupOrder(e)})}),"analytics"===r&&(0,yt.jsx)(Vs,{}),"communication"===r&&(0,yt.jsx)(Ia,{}),"predictive"===r&&(0,yt.jsx)(Oa,{}),"users"===r&&(0,yt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,yt.jsx)(pa,{})}),"settings"===r&&(0,yt.jsx)(Ma,{}),"schedule"===r&&(0,yt.jsx)(Ya,{}),"dashboard"!==r&&"stations"!==r&&"groupOrders"!==r&&"queuePsychology"!==r&&"eventLifecycle"!==r&&"analytics"!==r&&"communication"!==r&&"predictive"!==r&&"settings"!==r&&"schedule"!==r&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:r.charAt(0).toUpperCase()+r.slice(1)}),(0,yt.jsx)("p",{className:"text-gray-600",children:"This section is under development."})]})]})]})]})},ar=()=>{localStorage.removeItem("use_enhanced_organizer");return(0,yt.jsx)(sr,{})},rr=()=>{const[e,t]=(0,a.useState)(!0),[s,r]=(0,a.useState)({useFallbackData:!1,authErrorRefreshNeeded:!1,connectionStatus:"online"});if((0,a.useEffect)((()=>{const e=()=>{r({useFallbackData:"true"===localStorage.getItem("use_fallback_data"),authErrorRefreshNeeded:"true"===localStorage.getItem("auth_error_refresh_needed"),connectionStatus:localStorage.getItem("coffee_connection_status")||"online"})};e();const t=setInterval(e,5e3),s=()=>{r((e=>({...e,authErrorRefreshNeeded:!1,useFallbackData:!1})))},a=()=>{e()};return window.addEventListener("app:authRecovered",s),window.addEventListener("app:refreshOrders",a),()=>{clearInterval(t),window.removeEventListener("app:authRecovered",s),window.removeEventListener("app:refreshOrders",a)}}),[]),!e||!s.useFallbackData&&!s.authErrorRefreshNeeded&&"offline"!==s.connectionStatus)return null;let n,i,o,l;return s.authErrorRefreshNeeded?(n="Authentication Error",i="Could not connect to backend service. Using sample data instead.",o="Reconnect",l={container:"bg-red-600 text-white",button:"bg-white text-red-600 hover:bg-red-100"}):s.useFallbackData?(n="Fallback Mode Active",i="Using sample data. Could not connect to backend service.",o="Try Reconnect",l={container:"bg-yellow-500 text-white",button:"bg-white text-yellow-700 hover:bg-yellow-100"}):"offline"===s.connectionStatus&&(n="Connection Issue",i="Connection to server lost. Using cached data.",o="Refresh",l={container:"bg-orange-500 text-white",button:"bg-white text-orange-700 hover:bg-orange-100"}),(0,yt.jsx)("div",{className:`fixed top-0 left-0 right-0 ${l.container} p-3 z-50 shadow-md`,children:(0,yt.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"font-semibold",children:n}),(0,yt.jsx)("p",{className:"text-sm opacity-90",children:i})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{onClick:()=>{s.authErrorRefreshNeeded?(localStorage.removeItem("jwt_error_endpoints"),localStorage.setItem("auth_error_count","0"),localStorage.removeItem("auth_error_refresh_needed"),localStorage.setItem("use_fallback_data","false"),window.location.reload()):Bt.A.checkConnection().then((e=>{e&&(window.dispatchEvent(new CustomEvent("app:refreshOrders")),s.useFallbackData&&(localStorage.setItem("use_fallback_data","false"),r((e=>({...e,useFallbackData:!1})))))}))},className:`${l.button} px-3 py-1 rounded-md text-sm font-medium mr-3 transition-colors`,children:o}),(0,yt.jsx)("button",{onClick:()=>t(!1),className:"text-white opacity-75 hover:opacity-100 transition-opacity","aria-label":"Dismiss",children:(0,yt.jsx)("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,yt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})})},nr=()=>{const[e]=nt(),t=e.get("station"),{settings:s}=ws(),[r,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(null),m=(null===s||void 0===s?void 0:s.displaySettings)||{eventName:"ANZCA ASM 2025",organizationName:"Australian and New Zealand College of Anaesthetists",headerColor:"#1e40af",customMessage:"Enjoy your coffee!",smsNumber:"+61 123 456 789",showSponsor:!1,sponsorName:"",sponsorMessage:""},[h,g]=(0,a.useState)({system_name:"Coffee Cue",event_name:m.eventName,sms_number:m.smsNumber,sponsor:{enabled:m.showSponsor,name:m.sponsorName,message:m.sponsorMessage},wait_time:(null===s||void 0===s?void 0:s.waitTimeWarning)||15,header_color:m.headerColor,custom_message:m.customMessage}),[p,f]=(0,a.useState)({inProgress:[],ready:[]}),[x,y]=(0,a.useState)(!1),[b,v]=(0,a.useState)(new Date);(0,a.useEffect)((()=>{s&&s.displaySettings&&g({system_name:"Coffee Cue",event_name:s.displaySettings.eventName,sms_number:s.displaySettings.smsNumber,sponsor:{enabled:s.displaySettings.showSponsor,name:s.displaySettings.sponsorName,message:s.displaySettings.sponsorMessage},wait_time:s.waitTimeWarning||15,header_color:s.displaySettings.headerColor,custom_message:s.displaySettings.customMessage})}),[s]),(0,a.useEffect)((()=>{(async()=>{try{console.log("Loading stations for display screen");const e=await Kt.getStations();if(!(e&&e.length>0))throw new Error("No stations found");if(console.log("Loaded stations:",e),c(e),t)if("all"===t){console.log('Using "all stations" view');u({id:"all",name:"All Stations",status:"active"})}else{console.log(`Looking for station with ID ${t} in URL param`),console.log("Available stations:",e.map((e=>`${e.name} (ID: ${e.id}, type: ${typeof e.id})`)));const s="string"===typeof t?parseInt(t,10):t,a=e.find((e=>e.id===s||e.id===t||"number"===typeof e.id&&"string"===typeof t&&e.id.toString()===t));a?(console.log("Found station from URL parameter:",a),u(a)):(console.warn(`Station with ID ${t} not found, using first station`),u(e[0]))}else console.log("No station ID provided, using first station:",e[0]),u(e[0]);y(!0)}catch(e){console.error("Error loading stations:",e),o("Failed to load stations: "+(e.message||"Unknown error")),y(!1)}})()}),[t]),(0,a.useEffect)((()=>{if(!d)return;const e=async()=>{n(!0);try{let e,t;if(console.log(`Loading orders for station: ${d.name} (ID: ${d.id}, Type: ${typeof d.id})`),"all"===d.id)e=await Bt.A.getInProgressOrders(),t=await Bt.A.getCompletedOrders();else{const s="string"===typeof d.id&&"all"!==d.id?parseInt(d.id,10):d.id;console.log(`Fetching orders for station ID: ${s} (original: ${d.id}, type: ${typeof d.id})`),e=await Bt.A.getInProgressOrders(s),t=await Bt.A.getCompletedOrders(s)}console.log("In-progress orders:",e),console.log("Completed orders:",t);const s={inProgress:e.map((e=>({id:e.id,order_number:e.orderNumber||e.id,customerName:e.customerName||"Customer",displayPhone:e.phoneNumber?e.phoneNumber.slice(-4):"xxxx",coffeeType:e.coffeeType||"Coffee",milkType:e.milkType||"Regular milk",status:"in-progress",stationId:e.stationId||e.station_id}))),ready:t.map((e=>({id:e.id,order_number:e.orderNumber||e.id,customerName:e.customerName||"Customer",displayPhone:e.phoneNumber?e.phoneNumber.slice(-4):"xxxx",coffeeType:e.coffeeType||"Coffee",milkType:e.milkType||"Regular milk",status:"completed",stationId:e.stationId||e.station_id})))};f(s),v(new Date),y(!0),n(!1)}catch(e){console.error("Error loading orders for station:",e),o("Failed to load orders: "+(e.message||"Unknown error")),y(!1),n(!1)}};e();const t=setInterval((()=>{e()}),2e4);return()=>clearInterval(t)}),[d]);return(0,yt.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[(0,yt.jsx)("header",{style:{backgroundColor:h.header_color||"#1e40af"},className:"text-white p-4",children:(0,yt.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{onClick:()=>{window.location.href="/"},className:"mr-4 p-2 rounded-full hover:bg-opacity-80 transition-colors",style:{backgroundColor:`${h.header_color}99`||"#1e40af99"},children:(0,yt.jsx)(Tt,{size:24})}),(0,yt.jsx)(ht,{size:32,className:"mr-2"}),(0,yt.jsx)("h1",{className:"text-3xl font-bold",children:h.system_name})]}),(0,yt.jsx)("div",{className:"text-2xl font-light flex items-center",children:h.event_name})]})}),!x&&(0,yt.jsx)("div",{className:"bg-red-500 text-white p-2 text-center",children:(0,yt.jsxs)("div",{className:"container mx-auto flex items-center justify-center",children:[(0,yt.jsx)(gs,{size:20,className:"mr-2"}),(0,yt.jsx)("span",{children:"Not connected to backend API. Order data may be outdated."})]})}),(0,yt.jsx)("div",{className:"bg-white border-b shadow-sm",children:(0,yt.jsx)("div",{className:"container mx-auto py-4 px-4",children:(0,yt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,yt.jsxs)("div",{className:"flex flex-col",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(Ja,{size:24,className:"text-gray-500 mr-2"}),(0,yt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:d?`${d.name} ${d.location?`- ${d.location}`:""}`:"Select a station"})]}),l.length>1&&(0,yt.jsxs)("div",{className:"mt-2",children:[(0,yt.jsx)("label",{htmlFor:"station-select",className:"text-sm text-gray-500 mr-2",children:"Select Station:"}),(0,yt.jsxs)("select",{id:"station-select",value:(null===d||void 0===d?void 0:d.id)||"",onChange:t=>(t=>{if(console.log(`Station change requested: ${t} (type: ${typeof t})`),"all"===t){u({id:"all",name:"All Stations",status:"active"});const t=new URLSearchParams(e);return t.set("station","all"),void window.history.pushState({},"",`${window.location.pathname}?${t.toString()}`)}const s="string"===typeof t?parseInt(t,10):t;console.log(`Looking for station with ID ${s} (converted from ${t})`),console.log("Available stations:",l.map((e=>`${e.name} (ID: ${e.id}, type: ${typeof e.id})`)));const a=l.find((e=>e.id===s||e.id===t||"number"===typeof e.id&&"string"===typeof t&&e.id.toString()===t));if(a){console.log(`Found matching station: ${a.name} (ID: ${a.id})`),u(a);const t=new URLSearchParams(e);t.set("station",a.id.toString()),window.history.pushState({},"",`${window.location.pathname}?${t.toString()}`)}else console.error(`No station found with ID: ${t}`)})(t.target.value),className:"border rounded px-2 py-1 text-gray-700",children:[(0,yt.jsx)("option",{value:"all",children:"All Stations"}),l.map((e=>(0,yt.jsxs)("option",{value:e.id,children:[e.name," ",e.location?`(${e.location})`:""]},e.id)))]})]})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsxs)("div",{className:"text-lg mr-4",children:[(0,yt.jsx)("span",{className:"text-gray-500",children:"Last Updated:"})," ",(0,yt.jsx)("span",{className:"font-bold",children:b.toLocaleTimeString()})]}),(0,yt.jsx)("button",{onClick:async()=>{if(d){n(!0);try{let e,t;if("all"===d.id)e=await Bt.A.getInProgressOrders(),t=await Bt.A.getCompletedOrders();else{const s="string"===typeof d.id&&"all"!==d.id?parseInt(d.id,10):d.id;console.log(`Manual refresh for station ID: ${s} (original type: ${typeof d.id})`),e=await Bt.A.getInProgressOrders(s),t=await Bt.A.getCompletedOrders(s)}const s={inProgress:e.map((e=>({id:e.id,order_number:e.orderNumber||e.id,customerName:e.customerName||"Customer",displayPhone:e.phoneNumber?e.phoneNumber.slice(-4):"xxxx",coffeeType:e.coffeeType||"Coffee",milkType:e.milkType||"Regular milk",status:"in-progress",stationId:e.stationId||e.station_id}))),ready:t.map((e=>({id:e.id,order_number:e.orderNumber||e.id,customerName:e.customerName||"Customer",displayPhone:e.phoneNumber?e.phoneNumber.slice(-4):"xxxx",coffeeType:e.coffeeType||"Coffee",milkType:e.milkType||"Regular milk",status:"completed",stationId:e.stationId||e.station_id})))};f(s),v(new Date),y(!0),n(!1)}catch(e){console.error("Error manually refreshing orders:",e),y(!1),n(!1)}}},className:"p-2 rounded-full bg-blue-50 text-blue-500 hover:bg-blue-100",disabled:r||!d,children:(0,yt.jsx)(Ot,{size:20,className:r?"animate-spin":""})})]})]})})}),(0,yt.jsxs)("main",{className:"flex-grow container mx-auto p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(i||!x)&&(0,yt.jsx)("div",{className:"md:col-span-2 mb-2",children:(0,yt.jsx)(rr,{title:"Display Screen API Connection Issue",message:i||"Unable to connect to the backend API. The display screen requires a connection to show real-time order data."})}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,yt.jsx)("div",{className:"bg-amber-500 text-white p-4",children:(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(Rt,{size:24,className:"mr-2"}),(0,yt.jsx)("h2",{className:"text-xl font-bold",children:"In Progress"})]})}),(0,yt.jsx)("div",{className:"divide-y divide-gray-200",children:r?(0,yt.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center text-gray-500",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-600 mb-4"}),(0,yt.jsx)("p",{children:"Loading orders..."})]}):p.inProgress.length>0?p.inProgress.map((e=>(0,yt.jsxs)("div",{className:"p-4 flex justify-between items-center animate-pulse",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(ht,{size:20,className:"text-amber-500 mr-2"}),(0,yt.jsx)("span",{className:"font-bold text-xl",children:e.order_number})]}),(0,yt.jsxs)("div",{className:"mt-1 text-gray-600",children:["For: ",e.customerName," (xx",e.displayPhone,")"]}),(0,yt.jsx)("div",{className:"text-gray-500",children:e.coffeeType})]}),(0,yt.jsx)("div",{className:"bg-amber-100 text-amber-800 px-4 py-2 rounded-full font-medium",children:"Preparing"})]},e.id))):(0,yt.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center text-gray-500",children:[(0,yt.jsx)(ht,{size:48,className:"mb-4 text-gray-300"}),(0,yt.jsx)("p",{className:"text-lg font-medium mb-2",children:"No orders in progress"}),(0,yt.jsx)("p",{className:"text-sm",children:"Orders being prepared will appear here"})]})})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,yt.jsx)("div",{className:"bg-green-600 text-white p-4",children:(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(Mt,{size:24,className:"mr-2"}),(0,yt.jsx)("h2",{className:"text-xl font-bold",children:"Ready for Pickup"})]})}),(0,yt.jsx)("div",{className:"divide-y divide-gray-200",children:r?(0,yt.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center text-gray-500",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-600 mb-4"}),(0,yt.jsx)("p",{children:"Loading orders..."})]}):p.ready.length>0?p.ready.map((e=>(0,yt.jsxs)("div",{className:"p-4 flex justify-between items-center",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(ht,{size:20,className:"text-green-500 mr-2"}),(0,yt.jsx)("span",{className:"font-bold text-xl",children:e.order_number})]}),(0,yt.jsxs)("div",{className:"mt-1 text-gray-600",children:["For: ",e.customerName," (xx",e.displayPhone,")"]}),(0,yt.jsx)("div",{className:"text-gray-500",children:e.coffeeType})]}),(0,yt.jsx)("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-full font-medium",children:"Ready"})]},e.id))):(0,yt.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center text-gray-500",children:[(0,yt.jsx)(Mt,{size:48,className:"mb-4 text-gray-300"}),(0,yt.jsx)("p",{className:"text-lg font-medium mb-2",children:"No orders ready for pickup"}),(0,yt.jsx)("p",{className:"text-sm",children:"Ready orders will appear here"})]})})]})]}),(0,yt.jsx)("footer",{style:{backgroundColor:h.header_color||"#1e40af"},className:"text-white py-4",children:(0,yt.jsx)("div",{className:"container mx-auto px-4",children:(0,yt.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,yt.jsxs)("div",{className:"mb-4 md:mb-0 text-center md:text-left",children:[(0,yt.jsx)("h3",{className:"text-xl font-bold",children:"Order your coffee via SMS!"}),(0,yt.jsxs)("p",{className:"text-blue-100",children:["Text your order to: ",h.sms_number]})]}),(0,yt.jsxs)("div",{className:"text-center md:text-right",children:[h.sponsor.enabled?(0,yt.jsxs)("div",{className:"text-xl font-bold",children:[h.sponsor.name,": ",h.sponsor.message]}):(0,yt.jsx)("div",{className:"text-xl font-bold",children:"Coffee service proudly provided"}),(0,yt.jsx)("div",{className:"text-blue-100 text-lg",children:h.custom_message||"Enjoy your coffee!"})]})]})})})]})},ir=dt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),or=()=>{const e=ee(),[t,s]=(0,a.useState)([]),[r,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{n(!0);const e=await Kt.getStations();e&&e.length>0?(console.log("Loaded stations for display selector:",e),s(e)):o("No stations found. Please create stations first in the Organiser interface.")}catch(e){console.error("Error loading stations:",e),o("Failed to load stations: "+(e.message||"Unknown error"))}finally{n(!1)}})()}),[]);const l=t=>{e(`/display?station=${t}`)};return(0,yt.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[(0,yt.jsx)("header",{className:"bg-blue-600 text-white p-4",children:(0,yt.jsxs)("div",{className:"container mx-auto flex items-center",children:[(0,yt.jsx)("button",{onClick:()=>{e("/")},className:"mr-4 p-2 rounded-full hover:bg-blue-700 transition-colors",children:(0,yt.jsx)(Tt,{size:24})}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)(pt,{size:32,className:"mr-2"}),(0,yt.jsx)("h1",{className:"text-2xl font-bold",children:"Display Screen Selector"})]})]})}),(0,yt.jsx)("main",{className:"flex-grow container mx-auto p-6",children:(0,yt.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Select a Station Display"}),(0,yt.jsx)("p",{className:"text-gray-600 mb-6",children:"Choose a barista station to view its display screen. Each display shows the orders in progress and ready for pickup at that station."}),i&&(0,yt.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:(0,yt.jsx)("p",{children:i})}),r?(0,yt.jsxs)("div",{className:"flex justify-center items-center p-12",children:[(0,yt.jsx)(ir,{size:40,className:"animate-spin text-blue-600"}),(0,yt.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading stations..."})]}):(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.map((e=>(0,yt.jsx)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>l(e.id),children:(0,yt.jsxs)("div",{className:"flex items-start",children:[(0,yt.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:(0,yt.jsx)(ht,{size:20,className:"text-blue-600"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-bold text-gray-800",children:e.name}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.location||"No location specified"}),(0,yt.jsx)("p",{className:"mt-2 text-xs",children:(0,yt.jsx)("span",{className:"inline-block rounded-full px-2 py-1 "+("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"active"===e.status?"Active":"Inactive"})})]})]})},e.id))),(0,yt.jsx)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>l("all"),children:(0,yt.jsxs)("div",{className:"flex items-start",children:[(0,yt.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:(0,yt.jsx)(pt,{size:20,className:"text-purple-600"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-bold text-gray-800",children:"All Stations"}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Combined display of all station orders"}),(0,yt.jsx)("p",{className:"mt-2 text-xs",children:(0,yt.jsx)("span",{className:"inline-block rounded-full px-2 py-1 bg-purple-100 text-purple-800",children:"Overview"})})]})]})})]})]}),(0,yt.jsx)("div",{className:"text-center text-gray-500 text-sm",children:(0,yt.jsx)("p",{children:"Displays will automatically refresh every 20 seconds. You can also manually refresh using the button on the display screen."})})]})})]})},lr=dt("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]),cr=dt("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),dr=()=>{const[e,t]=(0,a.useState)({customerPhone:"+1234567890",customerName:"Test Customer",isVIP:!1,isGroupOrder:!1,groupSize:1,language:"en",orderType:"coffee",coffeeType:"latte",size:"medium",milkType:"almond",extras:[],quantity:1,specialInstructions:"",testDateTime:(()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`})(),simulateDelay:!0,delaySeconds:2,testStockLevels:"normal",activeStations:"all",selectedStations:[],eventName:"Test Event",eventPhase:"peak",queueLength:5,estimatedWaitTime:15}),[s,r]=(0,a.useState)({stages:[],currentStage:null,isRunning:!1,success:!1,error:null}),[n,i]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)({});(0,a.useEffect)((()=>{h()}),[]);const h=async()=>{try{const t=await Kt.getStations();l(t||[]);const s=localStorage.getItem("event_menu");if(s){const e=JSON.parse(s);i(Object.values(e).filter((e=>e.enabled)))}const a=localStorage.getItem("event_inventory");if(a){var e;const t=JSON.parse(a);d((null===(e=t.milk)||void 0===e?void 0:e.filter((e=>e.enabled)))||[])}const r=localStorage.getItem("sms_settings");r&&m(JSON.parse(r))}catch(t){console.error("Error loading test data:",t)}},g=(e,t,s)=>{r((a=>({...a,stages:[...a.stages,{stage:e,status:t,details:s,timestamp:new Date}],currentStage:e})))},p=()=>e.simulateDelay?new Promise((t=>setTimeout(t,1e3*e.delaySeconds))):Promise.resolve(),f=()=>{const{coffeeType:t,size:s,milkType:a,quantity:r,specialInstructions:n}=e;let i=`${r>1?r+" ":""}${s} ${a} ${t}`;return e.extras.length>0&&(i+=` with ${e.extras.join(", ")}`),n&&(i+=`. ${n}`),e.isGroupOrder&&(i=`GROUP ${e.groupSize}: ${i}`),i},x=t=>({customerPhone:e.customerPhone,customerName:e.customerName,items:[{type:e.coffeeType,size:e.size,milk:e.milkType,extras:e.extras,quantity:e.quantity}],isGroup:e.isGroupOrder,groupSize:e.groupSize,isVIP:e.isVIP,specialInstructions:e.specialInstructions,parsedAt:(new Date).toISOString()}),y=()=>{const t=e.testStockLevels,s={coffee:"out"===t?0:"critical"===t?.5:"low"===t?2:5,milk:{[e.milkType]:"out"===t?0:"critical"===t?.2:"low"===t?1:5},cups:{[e.size]:"out"===t?0:"critical"===t?5:"low"===t?20:100}};return{hasStock:s.coffee>0&&s.milk[e.milkType]>0&&s.cups[e.size]>0,items:s,warnings:"low"===t||"critical"===t?[`${t} stock levels`]:[]}},b=async()=>{let t=o;if("some"===e.activeStations?t=o.filter((t=>e.selectedStations.includes(t.id))):"none"===e.activeStations&&(t=[]),t=t.filter((e=>e.isActive&&!e.isMaintenance)),0===t.length)return{assigned:!1,reason:"No stations available"};const s=t[0];return{assigned:!0,stationId:s.id,stationName:s.name,currentLoad:Math.floor(10*Math.random()),estimatedPrepTime:3+Math.floor(5*Math.random())}},v=async(t,s)=>({id:`TEST-${Date.now()}`,orderNumber:`T${Math.floor(1e3*Math.random()).toString().padStart(3,"0")}`,customerPhone:t.customerPhone,customerName:t.customerName,items:t.items,status:"pending",stationId:s,isVIP:t.isVIP,isGroup:t.isGroup,groupSize:t.groupSize,createdAt:e.testDateTime,estimatedCompletionTime:new Date(Date.now()+6e4*e.estimatedWaitTime).toISOString()}),j=t=>{const s={en:`Order ${t.orderNumber} confirmed! Estimated wait: ${e.estimatedWaitTime} mins. We'll SMS when ready.`,es:`Pedido ${t.orderNumber} confirmado! Espera estimada: ${e.estimatedWaitTime} mins. Te avisaremos por SMS.`,fr:`Commande ${t.orderNumber} confirm\xe9e! Attente estim\xe9e: ${e.estimatedWaitTime} mins. SMS \xe0 la fin.`};return s[e.language]||s.en},w=()=>{const t=e.estimatedWaitTime,s=Math.round(t*{opening:.5,normal:1,peak:1.5,closing:.8}[e.eventPhase]);return{queueLength:e.queueLength,position:e.queueLength+1,estimatedWaitTime:s,eventPhase:e.eventPhase,rushStatus:"peak"===e.eventPhase?"high":"normal"}};return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,yt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,yt.jsx)(la,{className:"mr-3 text-blue-600"}),"SMS Order Test Simulator"]}),(0,yt.jsx)("button",{onClick:async()=>{r({stages:[],currentStage:null,isRunning:!0,success:!1,error:null});try{g("SMS Reception","running","Simulating incoming SMS..."),await p();const t=f();g("SMS Reception","success",{from:e.customerPhone,message:t,timestamp:e.testDateTime}),g("SMS Parsing","running","Parsing order details..."),await p();const s=x(t);g("SMS Parsing","success",{parsed:s,confidence:"95%"}),g("Customer Verification","running","Checking customer status..."),await p(),g("Customer Verification","success",{isVIP:e.isVIP,previousOrders:Math.floor(50*Math.random()),loyaltyPoints:Math.floor(1e3*Math.random())}),g("Stock Check","running","Verifying inventory levels..."),await p();const a=y();g("Stock Check",a.hasStock?"success":"warning",a),g("Station Assignment","running","Finding available stations..."),await p();const n=await b();if(g("Station Assignment",n.assigned?"success":"error",n),!n.assigned)throw new Error("No stations available to handle order");g("Order Creation","running","Creating order in system..."),await p();const i=await v(s,n.stationId);g("Order Creation","success",{orderId:i.id,orderNumber:i.orderNumber,status:"pending"}),g("SMS Confirmation","running","Sending confirmation to customer..."),await p();const o=j(i);g("SMS Confirmation","success",{to:e.customerPhone,message:o,language:e.language}),g("Station Notification","running","Notifying assigned station..."),await p(),g("Station Notification","success",{stationId:n.stationId,stationName:n.stationName,notificationType:"websocket",priority:e.isVIP?"high":"normal"}),g("Queue Management","running","Calculating wait time..."),await p();const l=w();g("Queue Management","success",l),r((e=>({...e,isRunning:!1,success:!0,currentStage:null})))}catch(t){console.error("Test failed:",t),g("Test Failed","error",t.message),r((e=>({...e,isRunning:!1,success:!1,error:t.message,currentStage:null})))}},disabled:s.isRunning,className:"px-6 py-2 rounded-md flex items-center "+(s.isRunning?"bg-gray-300 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"),children:s.isRunning?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Ot,{className:"mr-2 animate-spin",size:20}),"Running Test..."]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(ba,{className:"mr-2",size:20}),"Run Test"]})})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(zt,{className:"mr-2 text-gray-600",size:20}),"Customer Configuration"]}),(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,yt.jsx)("input",{type:"tel",value:e.customerPhone,onChange:s=>t({...e,customerPhone:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),(0,yt.jsx)("input",{type:"text",value:e.customerName,onChange:s=>t({...e,customerName:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.isVIP,onChange:s=>t({...e,isVIP:s.target.checked}),className:"mr-2"}),(0,yt.jsx)(cr,{className:"mr-1 text-yellow-500",size:16}),"VIP Customer"]}),(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.isGroupOrder,onChange:s=>t({...e,isGroupOrder:s.target.checked}),className:"mr-2"}),"Group Order"]})]}),e.isGroupOrder&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Group Size"}),(0,yt.jsx)("input",{type:"number",min:"2",value:e.groupSize,onChange:s=>t({...e,groupSize:parseInt(s.target.value)||2}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yt.jsx)(Ys,{className:"inline mr-1",size:16}),"Language"]}),(0,yt.jsxs)("select",{value:e.language,onChange:s=>t({...e,language:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"en",children:"English"}),(0,yt.jsx)("option",{value:"es",children:"Spanish"}),(0,yt.jsx)("option",{value:"fr",children:"French"})]})]})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(ht,{className:"mr-2 text-gray-600",size:20}),"Order Details"]}),(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coffee Type"}),(0,yt.jsx)("select",{value:e.coffeeType,onChange:s=>t({...e,coffeeType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:n.map((e=>(0,yt.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),(0,yt.jsxs)("select",{value:e.size,onChange:s=>t({...e,size:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"small",children:"Small"}),(0,yt.jsx)("option",{value:"medium",children:"Medium"}),(0,yt.jsx)("option",{value:"large",children:"Large"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),(0,yt.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:s=>t({...e,quantity:parseInt(s.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Milk Type"}),(0,yt.jsx)("select",{value:e.milkType,onChange:s=>t({...e,milkType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:c.map((e=>(0,yt.jsx)("option",{value:e.name.toLowerCase(),children:e.name},e.id)))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Instructions"}),(0,yt.jsx)("textarea",{value:e.specialInstructions,onChange:s=>t({...e,specialInstructions:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"2",placeholder:"e.g., Extra hot, no foam..."})]})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(gt,{className:"mr-2 text-gray-600",size:20}),"System Configuration"]}),(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yt.jsx)($t,{className:"inline mr-1",size:16}),"Test Date/Time (Local)"]}),(0,yt.jsx)("input",{type:"datetime-local",value:(()=>{const t=new Date(e.testDateTime);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}T${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`})(),onChange:s=>{const a=s.target.value;t({...e,testDateTime:a})},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,yt.jsx)(At,{className:"inline mr-1",size:16}),"Stock Levels"]}),(0,yt.jsxs)("select",{value:e.testStockLevels,onChange:s=>t({...e,testStockLevels:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"normal",children:"Normal"}),(0,yt.jsx)("option",{value:"low",children:"Low"}),(0,yt.jsx)("option",{value:"critical",children:"Critical"}),(0,yt.jsx)("option",{value:"out",children:"Out of Stock"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Active Stations"}),(0,yt.jsxs)("select",{value:e.activeStations,onChange:s=>t({...e,activeStations:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"all",children:"All Stations"}),(0,yt.jsx)("option",{value:"some",children:"Selected Stations"}),(0,yt.jsx)("option",{value:"none",children:"No Stations"})]})]}),"some"===e.activeStations&&(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Stations"}),(0,yt.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded p-2",children:o.map((s=>(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",checked:e.selectedStations.includes(s.id),onChange:a=>{a.target.checked?t({...e,selectedStations:[...e.selectedStations,s.id]}):t({...e,selectedStations:e.selectedStations.filter((e=>e!==s.id))})},className:"mr-2"}),s.name]},s.id)))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Phase"}),(0,yt.jsxs)("select",{value:e.eventPhase,onChange:s=>t({...e,eventPhase:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,yt.jsx)("option",{value:"opening",children:"Opening (Low Traffic)"}),(0,yt.jsx)("option",{value:"normal",children:"Normal"}),(0,yt.jsx)("option",{value:"peak",children:"Peak Hours"}),(0,yt.jsx)("option",{value:"closing",children:"Closing"})]})]}),(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",id:"simulateDelay",checked:e.simulateDelay,onChange:s=>t({...e,simulateDelay:s.target.checked}),className:"mr-2"}),(0,yt.jsxs)("label",{htmlFor:"simulateDelay",className:"text-sm text-gray-700",children:["Simulate Processing Delays (",e.delaySeconds,"s per stage)"]})]})]})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,yt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,yt.jsx)(qs,{className:"mr-2 text-gray-600",size:20}),"Test Results"]}),0===s.stages.length?(0,yt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,yt.jsx)(la,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,yt.jsx)("p",{children:'Configure test parameters and click "Run Test" to begin'})]}):(0,yt.jsxs)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:[s.stages.map(((e,t)=>(0,yt.jsx)("div",{className:"p-3 rounded-md border "+("running"===e.status?"bg-blue-50 border-blue-200":"success"===e.status?"bg-green-50 border-green-200":"warning"===e.status?"bg-yellow-50 border-yellow-200":"error"===e.status?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"),children:(0,yt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-start",children:["running"===e.status&&(0,yt.jsx)(Ot,{className:"mr-2 mt-0.5 animate-spin text-blue-500",size:16}),"success"===e.status&&(0,yt.jsx)(St,{className:"mr-2 mt-0.5 text-green-500",size:16}),"warning"===e.status&&(0,yt.jsx)(ds,{className:"mr-2 mt-0.5 text-yellow-500",size:16}),"error"===e.status&&(0,yt.jsx)(ds,{className:"mr-2 mt-0.5 text-red-500",size:16}),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium text-gray-800",children:e.stage}),"string"===typeof e.details?(0,yt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.details}):(0,yt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:(0,yt.jsx)("pre",{className:"whitespace-pre-wrap font-mono text-xs bg-white bg-opacity-50 p-2 rounded mt-1",children:JSON.stringify(e.details,null,2)})})]})]}),(0,yt.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleTimeString()})]})},t))),s.success&&(0,yt.jsxs)("div",{className:"mt-4 p-4 bg-green-100 border border-green-300 rounded-md",children:[(0,yt.jsxs)("h4",{className:"font-semibold text-green-800 flex items-center",children:[(0,yt.jsx)(St,{className:"mr-2",size:20}),"Test Completed Successfully"]}),(0,yt.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"All stages passed. The order would be successfully processed."})]}),s.error&&(0,yt.jsxs)("div",{className:"mt-4 p-4 bg-red-100 border border-red-300 rounded-md",children:[(0,yt.jsxs)("h4",{className:"font-semibold text-red-800 flex items-center",children:[(0,yt.jsx)(ds,{className:"mr-2",size:20}),"Test Failed"]}),(0,yt.jsx)("p",{className:"text-sm text-red-700 mt-1",children:s.error})]})]})]})]}),s.stages.length>0&&!s.isRunning&&(0,yt.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,yt.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Test Summary"}),(0,yt.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-600",children:"Total Stages:"}),(0,yt.jsx)("span",{className:"ml-2 font-medium",children:s.stages.length})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-600",children:"Successful:"}),(0,yt.jsx)("span",{className:"ml-2 font-medium text-green-600",children:s.stages.filter((e=>"success"===e.status)).length})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-600",children:"Warnings:"}),(0,yt.jsx)("span",{className:"ml-2 font-medium text-yellow-600",children:s.stages.filter((e=>"warning"===e.status)).length})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("span",{className:"text-gray-600",children:"Errors:"}),(0,yt.jsx)("span",{className:"ml-2 font-medium text-red-600",children:s.stages.filter((e=>"error"===e.status)).length})]})]})]})]})},ur=e=>{let{title:t,value:s,icon:a,trend:r,trendUp:n}=e;return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a,(0,yt.jsx)("span",{className:"text-sm "+(n?"text-green-600":"text-red-600"),children:r})]}),(0,yt.jsx)("div",{className:"text-2xl font-bold",children:s}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:t})]})},mr=e=>{let{label:t,icon:s,color:a,onClick:r}=e;return(0,yt.jsxs)("button",{onClick:r,className:`p-3 rounded-lg transition-colors ${{red:"bg-red-100 hover:bg-red-200 text-red-700",blue:"bg-blue-100 hover:bg-blue-200 text-blue-700",yellow:"bg-yellow-100 hover:bg-yellow-200 text-yellow-700",green:"bg-green-100 hover:bg-green-200 text-green-700"}[a]} flex flex-col items-center space-y-2`,children:[s,(0,yt.jsx)("span",{className:"text-xs font-medium",children:t})]})},hr=()=>{console.log("DashboardTab component loaded");const{pendingOrders:e,inProgressOrders:t,completedOrders:s}=Gt(),{stations:r}=Xt(),[n,i]=(0,a.useState)({totalOrders:0,activeOrders:0,avgWaitTime:0,errorRate:0,revenue:0,ordersPerHour:0,systemUptime:99.8,customerSatisfaction:4.5}),[o,l]=(0,a.useState)([{id:1,type:"warning",message:"High queue at Station 1",time:"2 min ago"},{id:2,type:"error",message:"Station 3 offline",time:"5 min ago"},{id:3,type:"success",message:"Backup completed successfully",time:"1 hour ago"}]);(0,a.useEffect)((()=>{const a=((null===e||void 0===e?void 0:e.length)||0)+((null===t||void 0===t?void 0:t.length)||0)+((null===s||void 0===s?void 0:s.length)||0),r=((null===e||void 0===e?void 0:e.length)||0)+((null===t||void 0===t?void 0:t.length)||0);i((e=>({...e,totalOrders:a,activeOrders:r})))}),[e,t,s]);const c=e=>{switch(e){case"error":return(0,yt.jsx)(Lt,{className:"w-5 h-5 text-red-500"});case"warning":return(0,yt.jsx)(gs,{className:"w-5 h-5 text-yellow-500"});case"success":return(0,yt.jsx)(St,{className:"w-5 h-5 text-green-500"});default:return(0,yt.jsx)(qs,{className:"w-5 h-5 text-blue-500"})}};return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold text-blue-800",children:"\ud83d\udcca Dashboard Tab"}),(0,yt.jsx)("p",{className:"text-blue-600",children:"System overview and real-time metrics"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6 flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"}),(0,yt.jsx)("span",{className:"font-semibold",children:"System Status: Online"})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Uptime: ",n.systemUptime,"%"]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Last Update: ",(new Date).toLocaleTimeString()]})]}),(0,yt.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,yt.jsx)(Ot,{className:"w-5 h-5"})})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,yt.jsx)(ur,{title:"Active Orders",value:n.activeOrders,icon:(0,yt.jsx)(ht,{className:"w-6 h-6 text-orange-600"}),trend:"+12%",trendUp:!0}),(0,yt.jsx)(ur,{title:"Avg Wait Time",value:`${n.avgWaitTime} min`,icon:(0,yt.jsx)(Rt,{className:"w-6 h-6 text-blue-600"}),trend:"-2 min",trendUp:!1}),(0,yt.jsx)(ur,{title:"Error Rate",value:`${n.errorRate}%`,icon:(0,yt.jsx)(gs,{className:"w-6 h-6 text-red-600"}),trend:"0%",trendUp:!1}),(0,yt.jsx)(ur,{title:"Today's Revenue",value:`$${n.revenue.toLocaleString()}`,icon:(0,yt.jsx)(Js,{className:"w-6 h-6 text-green-600"}),trend:"+8%",trendUp:!0})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[(0,yt.jsx)(gs,{className:"w-5 h-5 mr-2"}),"Recent Alerts"]}),(0,yt.jsx)("div",{className:"space-y-3",children:o.map((e=>(0,yt.jsxs)("div",{className:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded",children:[c(e.type),(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"text-sm font-medium",children:e.message}),(0,yt.jsx)("p",{className:"text-xs text-gray-500",children:e.time})]})]},e.id)))}),(0,yt.jsx)("button",{className:"mt-4 text-sm text-blue-600 hover:text-blue-800",children:"View All Alerts \u2192"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Quick Actions"}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,yt.jsx)(mr,{label:"Pause All Orders",icon:(0,yt.jsx)(qs,{className:"w-5 h-5"}),color:"red",onClick:()=>console.log("Pause all orders")}),(0,yt.jsx)(mr,{label:"Broadcast Message",icon:(0,yt.jsx)(zt,{className:"w-5 h-5"}),color:"blue",onClick:()=>console.log("Broadcast message")}),(0,yt.jsx)(mr,{label:"Restart Services",icon:(0,yt.jsx)(Ot,{className:"w-5 h-5"}),color:"yellow",onClick:()=>console.log("Restart services")}),(0,yt.jsx)(mr,{label:"Emergency Stop",icon:(0,yt.jsx)(Lt,{className:"w-5 h-5"}),color:"red",onClick:()=>console.log("Emergency stop")})]})]})]}),(0,yt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Live Order Flow"}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-orange-600",children:(null===e||void 0===e?void 0:e.length)||0}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Pending"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:(null===t||void 0===t?void 0:t.length)||0}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"In Progress"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsx)("div",{className:"text-3xl font-bold text-green-600",children:(null===s||void 0===s?void 0:s.length)||0}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:"Completed Today"})]})]})]}),(0,yt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Station Status"}),(0,yt.jsx)("div",{className:"grid grid-cols-4 gap-4",children:null===r||void 0===r?void 0:r.map((e=>(0,yt.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsxs)("span",{className:"font-medium",children:["Station ",e.id]}),(0,yt.jsx)("div",{className:"w-2 h-2 rounded-full "+("active"===e.status?"bg-green-500":"bg-red-500")})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,yt.jsxs)("div",{children:["Queue: ",e.queueLength||0]}),(0,yt.jsxs)("div",{children:["Wait: ",e.waitTime||10," min"]})]})]},e.id)))})]})]})},gr=dt("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),pr=dt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),fr=dt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),xr=dt("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),yr=e=>{let{label:t,value:s,status:a}=e;return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:t}),(0,yt.jsx)("div",{className:`text-2xl font-bold ${{healthy:"text-green-600",warning:"text-yellow-600",error:"text-red-600"}[a]}`,children:s})]})},br=e=>{let{component:t,getStatusIcon:s,getStatusColor:a,onRestart:r}=e;return(0,yt.jsxs)("div",{className:`border-2 rounded-lg p-4 ${a(t.status)}`,children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:[t.icon,(0,yt.jsx)("h3",{className:"font-semibold",children:t.name})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-2",children:[s(t.status),(0,yt.jsx)("button",{onClick:r,className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Restart component",children:(0,yt.jsx)(Ot,{className:"w-4 h-4"})})]})]}),t.warning&&(0,yt.jsx)("div",{className:"mb-3 p-2 bg-yellow-100 rounded text-sm text-yellow-800",children:t.warning}),(0,yt.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(t.metrics).map((e=>{let[t,s]=e;return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("span",{className:"text-gray-600",children:[t,":"]}),(0,yt.jsx)("span",{className:"font-medium ml-1",children:s})]},t)}))})]})},vr=e=>{let{label:t,value:s,max:a,unit:r,color:n}=e;const i=s/a*100;return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,yt.jsx)("span",{className:"text-sm font-medium",children:t}),(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:[s,r," / ",a,r]})]}),(0,yt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,yt.jsx)("div",{className:`h-full rounded-full ${{blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500"}[n]}`,style:{width:`${i}%`}})})]})},jr=e=>{let{time:t,type:s,message:a,component:r}=e;const n={success:(0,yt.jsx)(St,{className:"w-4 h-4 text-green-500"}),warning:(0,yt.jsx)(gs,{className:"w-4 h-4 text-yellow-500"}),error:(0,yt.jsx)(Lt,{className:"w-4 h-4 text-red-500"})};return(0,yt.jsxs)("div",{className:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded",children:[n[s],(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("p",{className:"text-sm",children:a}),(0,yt.jsxs)("p",{className:"text-xs text-gray-500",children:[r," \u2022 ",t]})]})]})},wr=()=>{const[e,t]=(0,a.useState)([{id:"api",name:"API Server",icon:(0,yt.jsx)(gr,{className:"w-6 h-6"}),status:"healthy",metrics:{"Response Time":"45ms","Error Rate":"0.01%",Uptime:"72h 15m","Requests/min":"342"}},{id:"database",name:"PostgreSQL Database",icon:(0,yt.jsx)(pr,{className:"w-6 h-6"}),status:"healthy",metrics:{Connections:"12/100","Query Time":"3ms",Size:"1.2GB","Cache Hit Rate":"94%"}},{id:"twilio",name:"SMS Gateway (Twilio)",icon:(0,yt.jsx)(la,{className:"w-6 h-6"}),status:"healthy",metrics:{Balance:"$123.45","Messages Today":"3,421","Delivery Rate":"99.2%","Avg Response":"1.2s"}},{id:"websocket",name:"WebSocket Server",icon:(0,yt.jsx)(fa,{className:"w-6 h-6"}),status:"healthy",metrics:{"Active Connections":"87","Messages/sec":"125","Memory Usage":"234MB","CPU Usage":"12%"}},{id:"redis",name:"Redis Cache",icon:(0,yt.jsx)(fr,{className:"w-6 h-6"}),status:"warning",metrics:{Memory:"450MB/512MB","Hit Rate":"89%",Keys:"10,234",Evictions:"42"},warning:"Memory usage high"},{id:"nginx",name:"Load Balancer",icon:(0,yt.jsx)(Ys,{className:"w-6 h-6"}),status:"healthy",metrics:{"Active Connections":"234","Requests/sec":"450",Bandwidth:"12.3 MB/s","SSL Handshakes":"98/s"}}]),[s,r]=(0,a.useState)(!0),[n,i]=(0,a.useState)(new Date);(0,a.useEffect)((()=>{if(!s)return;const e=setInterval((()=>{o(),i(new Date)}),5e3);return()=>clearInterval(e)}),[s]);const o=async()=>{console.log("Checking system health...")},l=e=>{switch(e){case"healthy":return(0,yt.jsx)(St,{className:"w-5 h-5 text-green-500"});case"warning":return(0,yt.jsx)(gs,{className:"w-5 h-5 text-yellow-500"});case"error":return(0,yt.jsx)(Lt,{className:"w-5 h-5 text-red-500"});default:return(0,yt.jsx)(qs,{className:"w-5 h-5 text-gray-500"})}},c=e=>{switch(e){case"healthy":return"border-green-500 bg-green-50";case"warning":return"border-yellow-500 bg-yellow-50";case"error":return"border-red-500 bg-red-50";default:return"border-gray-500 bg-gray-50"}};return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold",children:"System Health Monitor"}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("span",{className:"text-sm text-gray-600",children:["Last update: ",n.toLocaleTimeString()]}),(0,yt.jsxs)("label",{className:"flex items-center",children:[(0,yt.jsx)("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"mr-2"}),(0,yt.jsx)("span",{className:"text-sm",children:"Auto-refresh"})]}),(0,yt.jsx)("button",{onClick:o,className:"p-2 bg-blue-100 hover:bg-blue-200 rounded-lg transition-colors",children:(0,yt.jsx)(Ot,{className:"w-5 h-5 text-blue-600"})})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,yt.jsx)(yr,{label:"Total Health Score",value:"98%",status:"healthy"}),(0,yt.jsx)(yr,{label:"Active Incidents",value:"1",status:"warning"}),(0,yt.jsx)(yr,{label:"System Load",value:"42%",status:"healthy"}),(0,yt.jsx)(yr,{label:"Network Latency",value:"12ms",status:"healthy"})]}),(0,yt.jsx)("div",{className:"grid grid-cols-2 gap-4",children:e.map((e=>(0,yt.jsx)(br,{component:e,getStatusIcon:l,getStatusColor:c,onRestart:()=>{return t=e.id,void(window.confirm(`Are you sure you want to restart ${t}?`)&&console.log(`Restarting ${t}...`));var t}},e.id)))}),(0,yt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[(0,yt.jsx)(xr,{className:"w-5 h-5 mr-2"}),"System Resources"]}),(0,yt.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,yt.jsx)(vr,{label:"CPU Usage",value:24,max:100,unit:"%",color:"blue"}),(0,yt.jsx)(vr,{label:"Memory Usage",value:6.2,max:16,unit:"GB",color:"green"}),(0,yt.jsx)(vr,{label:"Disk Usage",value:45,max:100,unit:"GB",color:"purple"})]})]}),(0,yt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Recent Health Events"}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsx)(jr,{time:"2 min ago",type:"warning",message:"Redis memory usage exceeded 85% threshold",component:"Redis Cache"}),(0,yt.jsx)(jr,{time:"15 min ago",type:"success",message:"Database backup completed successfully",component:"PostgreSQL"}),(0,yt.jsx)(jr,{time:"1 hour ago",type:"error",message:"API server restarted due to high memory usage",component:"API Server"})]})]})]})},Nr=dt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),kr=e=>{let{icon:t,label:s,value:a}=e;return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[t,(0,yt.jsx)("span",{className:"text-2xl font-bold",children:a})]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600",children:s})]})},Sr=e=>{let{label:t,value:s,sensitive:a,editable:r=!0}=e;return(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),(0,yt.jsx)("input",{type:a?"password":"text",value:s,readOnly:!r,className:"w-full px-4 py-2 border rounded-lg bg-gray-50"})]})},Cr=e=>{let{sms:t}=e;return(0,yt.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded",children:[(0,yt.jsxs)("div",{className:"flex items-center space-x-3",children:["in"===t.direction?(0,yt.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,yt.jsx)(la,{className:"w-4 h-4 text-blue-600"})}):(0,yt.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,yt.jsx)(us,{className:"w-4 h-4 text-green-600"})}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("p",{className:"font-medium",children:t.phone}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:t.message})]})]}),(0,yt.jsxs)("div",{className:"text-right",children:[(0,yt.jsx)("p",{className:"text-sm text-gray-500",children:t.time}),(0,yt.jsx)("p",{className:"text-xs text-gray-400",children:t.status})]})]})},_r=e=>{let{template:t}=e;return(0,yt.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)("h4",{className:"font-medium",children:t.name}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("button",{className:"text-blue-600 hover:text-blue-800",children:"Edit"}),(0,yt.jsx)("button",{className:"text-red-600 hover:text-red-800",children:"Delete"})]})]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:t.content})]})},Er=()=>{const[e,t]=(0,a.useState)("overview"),[s,r]=(0,a.useState)({phoneNumber:"+61 XXX XXX XXX",accountSid:"AC***hidden***",authToken:"***hidden***",messagingServiceSid:"MG***hidden***",balance:123.45,monthlyMessages:45231,status:"active"}),[n,i]=(0,a.useState)({to:"",message:"Test message from Expresso Support"}),[o,l]=(0,a.useState)([{id:1,name:"Welcome Message",content:"Welcome to {event_name}! \u2615\nWhat's your first name?"},{id:2,name:"Order Confirmation",content:"\u2705 Order #{order_number} confirmed!\nWe're finding the shortest queue for you."},{id:3,name:"Order Ready",content:"\u2615 Your order #{order_number} is ready!\nPickup at Station {station_id}"},{id:4,name:"System Maintenance",content:"\ud83d\udd27 System maintenance in progress. Orders temporarily paused. Back soon!"}]),[c,d]=(0,a.useState)([{id:1,phone:"+61 4XX XXX 123",message:"Large oat latte",direction:"in",time:"2 min ago",status:"processed"},{id:2,phone:"+61 4XX XXX 456",message:"\u2705 Order #A123 confirmed!",direction:"out",time:"3 min ago",status:"delivered"},{id:3,phone:"+61 4XX XXX 789",message:"STATUS",direction:"in",time:"5 min ago",status:"processed"},{id:4,phone:"+61 4XX XXX 789",message:"Your order is being prepared...",direction:"out",time:"5 min ago",status:"delivered"}]);return(0,yt.jsxs)("div",{className:"p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yt.jsx)("h2",{className:"text-2xl font-bold",children:"Communications Center"}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("button",{onClick:()=>t("overview"),className:"px-4 py-2 rounded-lg "+("overview"===e?"bg-blue-600 text-white":"bg-gray-100"),children:"Overview"}),(0,yt.jsx)("button",{onClick:()=>t("twilio"),className:"px-4 py-2 rounded-lg "+("twilio"===e?"bg-blue-600 text-white":"bg-gray-100"),children:"Twilio Config"}),(0,yt.jsx)("button",{onClick:()=>t("templates"),className:"px-4 py-2 rounded-lg "+("templates"===e?"bg-blue-600 text-white":"bg-gray-100"),children:"Templates"}),(0,yt.jsx)("button",{onClick:()=>t("history"),className:"px-4 py-2 rounded-lg "+("history"===e?"bg-blue-600 text-white":"bg-gray-100"),children:"History"})]})]}),"overview"===e&&(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,yt.jsx)(kr,{icon:(0,yt.jsx)(la,{className:"w-6 h-6 text-blue-600"}),label:"Messages Today",value:"3,421"}),(0,yt.jsx)(kr,{icon:(0,yt.jsx)(St,{className:"w-6 h-6 text-green-600"}),label:"Delivery Rate",value:"99.2%"}),(0,yt.jsx)(kr,{icon:(0,yt.jsx)(Js,{className:"w-6 h-6 text-yellow-600"}),label:"Balance",value:`$${s.balance}`}),(0,yt.jsx)(kr,{icon:(0,yt.jsx)(gs,{className:"w-6 h-6 text-red-600"}),label:"Failed",value:"12"})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"font-semibold text-lg mb-4 flex items-center",children:[(0,yt.jsx)(Nr,{className:"w-5 h-5 mr-2"}),"Send Test SMS"]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsx)("input",{type:"tel",placeholder:"Phone number",value:n.to,onChange:e=>i({...n,to:e.target.value}),className:"px-4 py-2 border rounded-lg"}),(0,yt.jsx)("input",{type:"text",placeholder:"Message",value:n.message,onChange:e=>i({...n,message:e.target.value}),className:"px-4 py-2 border rounded-lg"})]}),(0,yt.jsxs)("button",{onClick:()=>{console.log("Sending test SMS:",n)},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[(0,yt.jsx)(us,{className:"w-4 h-4 mr-2"}),"Send Test Message"]})]}),(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg mb-4",children:"Recent SMS Activity"}),(0,yt.jsx)("div",{className:"space-y-2",children:c.map((e=>(0,yt.jsx)(Cr,{sms:e},e.id)))})]})]}),"twilio"===e&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("h3",{className:"font-semibold text-lg mb-6 flex items-center",children:[(0,yt.jsx)(gt,{className:"w-5 h-5 mr-2"}),"Twilio Configuration"]}),(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsx)(Sr,{label:"Phone Number",value:s.phoneNumber,editable:!1}),(0,yt.jsx)(Sr,{label:"Account SID",value:s.accountSid,sensitive:!0}),(0,yt.jsx)(Sr,{label:"Auth Token",value:s.authToken,sensitive:!0}),(0,yt.jsx)(Sr,{label:"Messaging Service SID",value:s.messagingServiceSid,sensitive:!0}),(0,yt.jsxs)("div",{className:"pt-4 border-t",children:[(0,yt.jsx)("button",{onClick:()=>{console.log("Updating Twilio config...")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Update Configuration"}),(0,yt.jsx)("button",{className:"ml-2 px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Test Connection"})]})]})]}),"templates"===e&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yt.jsxs)("h3",{className:"font-semibold text-lg flex items-center",children:[(0,yt.jsx)(aa,{className:"w-5 h-5 mr-2"}),"Message Templates"]}),(0,yt.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Template"})]}),(0,yt.jsx)("div",{className:"space-y-4",children:o.map((e=>(0,yt.jsx)(_r,{template:e},e.id)))})]}),"history"===e&&(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,yt.jsx)("h3",{className:"font-semibold text-lg",children:"SMS History"}),(0,yt.jsxs)("div",{className:"flex space-x-2",children:[(0,yt.jsx)("button",{className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:(0,yt.jsx)(ps,{className:"w-5 h-5"})}),(0,yt.jsx)("button",{className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:(0,yt.jsx)(da,{className:"w-5 h-5"})})]})]}),(0,yt.jsx)("div",{className:"overflow-x-auto",children:(0,yt.jsxs)("table",{className:"w-full",children:[(0,yt.jsx)("thead",{className:"border-b",children:(0,yt.jsxs)("tr",{children:[(0,yt.jsx)("th",{className:"text-left py-2",children:"Time"}),(0,yt.jsx)("th",{className:"text-left py-2",children:"Phone"}),(0,yt.jsx)("th",{className:"text-left py-2",children:"Message"}),(0,yt.jsx)("th",{className:"text-left py-2",children:"Direction"}),(0,yt.jsx)("th",{className:"text-left py-2",children:"Status"})]})}),(0,yt.jsx)("tbody",{children:c.map((e=>(0,yt.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,yt.jsx)("td",{className:"py-2",children:e.time}),(0,yt.jsx)("td",{className:"py-2",children:e.phone}),(0,yt.jsx)("td",{className:"py-2",children:e.message}),(0,yt.jsx)("td",{className:"py-2",children:"in"===e.direction?(0,yt.jsx)("span",{className:"text-blue-600",children:"Inbound"}):(0,yt.jsx)("span",{className:"text-green-600",children:"Outbound"})}),(0,yt.jsx)("td",{className:"py-2",children:(0,yt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("delivered"===e.status?"bg-green-100 text-green-800":"processed"===e.status?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:e.status})})]},e.id)))})]})})]})]})},Tr=e=>{let{className:t="",children:s,...a}=e;return(0,yt.jsx)("div",{className:`bg-white rounded-lg shadow-sm border ${t}`,...a,children:s})},Ir=e=>{let{className:t="",children:s,...a}=e;return(0,yt.jsx)("div",{className:`px-6 py-4 border-b ${t}`,...a,children:s})},Or=e=>{let{className:t="",children:s,...a}=e;return(0,yt.jsx)("h3",{className:`text-lg font-semibold ${t}`,...a,children:s})},Ar=e=>{let{className:t="",children:s,...a}=e;return(0,yt.jsx)("div",{className:`px-6 py-4 ${t}`,...a,children:s})},$r={default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-gray-300 bg-white hover:bg-gray-50",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300",ghost:"hover:bg-gray-100",link:"text-blue-600 underline-offset-4 hover:underline"},Mr={default:"px-4 py-2",sm:"px-3 py-1 text-sm",lg:"px-6 py-3",icon:"p-2"},Pr=e=>{let{className:t="",variant:s="default",size:a="default",disabled:r=!1,children:n,...i}=e;return(0,yt.jsx)("button",{className:`\n      inline-flex items-center justify-center rounded-md font-medium \n      transition-colors focus-visible:outline-none focus-visible:ring-2 \n      focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\n      ${$r[s]} ${Mr[a]} ${t}\n    `,disabled:r,...i,children:n})},Dr={default:"bg-gray-100 text-gray-800",secondary:"bg-gray-100 text-gray-900",success:"bg-green-100 text-green-800",destructive:"bg-red-100 text-red-800",warning:"bg-yellow-100 text-yellow-800",outline:"border border-gray-200"},zr=e=>{let{className:t="",variant:s="default",children:a,...r}=e;return(0,yt.jsx)("span",{className:`\n      inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium\n      ${Dr[s]} ${t}\n    `,...r,children:a})},Lr=e=>{let{checked:t=!1,onCheckedChange:s,disabled:a=!1,className:r=""}=e;return(0,yt.jsxs)("button",{type:"button",role:"switch","aria-checked":t,disabled:a,className:`\n        relative inline-flex h-6 w-11 items-center rounded-full transition-colors\n        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 \n        focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\n        ${t?"bg-blue-600":"bg-gray-200"}\n        ${r}\n      `,onClick:()=>s&&s(!t),children:[(0,yt.jsx)("span",{className:"sr-only",children:"Toggle"}),(0,yt.jsx)("span",{className:`\n          ${t?"translate-x-6":"translate-x-1"}\n          inline-block h-4 w-4 transform rounded-full bg-white transition\n        `})]})},Rr=e=>{let{className:t="",...s}=e;return(0,yt.jsx)("input",{className:`\n      flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 \n      text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm \n      file:font-medium placeholder:text-gray-500 focus-visible:outline-none \n      focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 \n      disabled:cursor-not-allowed disabled:opacity-50\n      ${t}\n    `,...s})},Fr=e=>{let{className:t="",...s}=e;return(0,yt.jsx)("textarea",{className:`\n      flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 \n      text-sm ring-offset-white placeholder:text-gray-500 focus-visible:outline-none \n      focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 \n      disabled:cursor-not-allowed disabled:opacity-50\n      ${t}\n    `,...s})},Ur=dt("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),Br=()=>{const{stations:e,updateStation:t}=Xt(),[s,r]=(0,a.useState)({}),[n,i]=(0,a.useState)({}),[o,l]=(0,a.useState)({});(0,a.useEffect)((()=>{const e=localStorage.getItem("coffeeMenu");if(e)try{const t=JSON.parse(e);r(t)}catch(t){console.error("Error loading coffee menu:",t)}}),[]),(0,a.useEffect)((()=>{const t=localStorage.getItem("stationMenuAssignments");if(t)try{i(JSON.parse(t))}catch(a){console.error("Error loading station menu assignments:",a)}else if(e&&e.length>0&&Object.keys(s).length>0){const t={};e.forEach((e=>{t[e.id]={},Object.keys(s).forEach((a=>{var r;t[e.id][a]={enabled:!0,availableSizes:Object.keys((null===(r=s[a])||void 0===r?void 0:r.sizes)||{})}}))})),i(t)}}),[e,s]),(0,a.useEffect)((()=>{Object.keys(n).length>0&&(localStorage.setItem("stationMenuAssignments",JSON.stringify(n)),window.dispatchEvent(new CustomEvent("stationMenus:updated",{detail:{stationMenus:n}})))}),[n]);const c=(e,t)=>{i((a=>{const r={...a};return r[e]={},Object.keys(s).forEach((a=>{var n;r[e][a]={enabled:t,availableSizes:t?Object.keys((null===(n=s[a])||void 0===n?void 0:n.sizes)||{}):[]}})),r}))},d=e=>{var t,s,a,r;const n=[];return(null===(t=e.capabilities)||void 0===t||null===(s=t.coffeeTypes)||void 0===s?void 0:s.length)>0&&n.push(`Coffee: ${e.capabilities.coffeeTypes.join(", ")}`),(null===(a=e.capabilities)||void 0===a||null===(r=a.milkOptions)||void 0===r?void 0:r.length)>0&&n.push(`Milk: ${e.capabilities.milkOptions.join(", ")}`),n},u=e=>{const t=n[e]||{};return Object.values(t).filter((e=>e.enabled)).length},m=[{id:"espresso-based",name:"Espresso Based"},{id:"milk-based",name:"Milk Based"},{id:"cold-drinks",name:"Cold Drinks"},{id:"tea",name:"Tea"},{id:"non-coffee",name:"Non-Coffee"}],h={"small-8oz":"8oz","regular-12oz":"12oz","large-16oz":"16oz"};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,yt.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Station Menu Assignment"}),(0,yt.jsx)("p",{className:"text-sm text-blue-700",children:"Configure which drinks each station can make. This affects what customers can order based on available stations and their capabilities."})]}),e&&0!==e.length?(0,yt.jsx)("div",{className:"space-y-4",children:e.map((e=>(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,yt.jsx)("div",{className:"p-4 cursor-pointer hover:bg-gray-50",onClick:()=>{return t=e.id,void l((e=>({...e,[t]:!e[t]})));var t},children:(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("h4",{className:"font-medium text-gray-900",children:[e.name,(0,yt.jsx)("span",{className:"ml-2 px-2 py-1 text-xs rounded-full "+("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:e.status})]}),(0,yt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:d(e).join(" \u2022 ")}),(0,yt.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[u(e.id)," of ",Object.keys(s).length," items enabled"]})]}),(0,yt.jsx)("svg",{className:"w-5 h-5 text-gray-400 transition-transform "+(o[e.id]?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o[e.id]&&(0,yt.jsxs)("div",{className:"border-t border-gray-200 p-4",children:[(0,yt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,yt.jsx)("h5",{className:"font-medium text-gray-700",children:"Available Menu Items"}),(0,yt.jsxs)("div",{className:"space-x-2",children:[(0,yt.jsx)("button",{onClick:()=>c(e.id,!0),className:"text-sm text-blue-600 hover:text-blue-800",children:"Enable All"}),(0,yt.jsx)("button",{onClick:()=>c(e.id,!1),className:"text-sm text-red-600 hover:text-red-800",children:"Disable All"})]})]}),(0,yt.jsx)("div",{className:"space-y-6",children:m.map((t=>{const a=(e=>Object.entries(s).filter((t=>{let[s,a]=t;return a.category===e&&a.enabled})))(t.id);return 0===a.length?null:(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h6",{className:"text-sm font-medium text-gray-600 mb-2",children:t.name}),(0,yt.jsx)("div",{className:"space-y-2",children:a.map((t=>{var a,r,o,l;let[c,d]=t;const u=null===(a=n[e.id])||void 0===a||null===(r=a[c])||void 0===r?void 0:r.enabled,m=(null===(o=n[e.id])||void 0===o||null===(l=o[c])||void 0===l?void 0:l.availableSizes)||[];return(0,yt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,yt.jsx)("div",{className:"flex items-center justify-between",children:(0,yt.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,yt.jsx)("input",{type:"checkbox",checked:u||!1,onChange:()=>((e,t)=>{i((a=>{const r={...a};var n;return r[e]||(r[e]={}),r[e][t]?r[e][t]={...r[e][t],enabled:!r[e][t].enabled}:r[e][t]={enabled:!0,availableSizes:Object.keys((null===(n=s[t])||void 0===n?void 0:n.sizes)||{})},r}))})(e.id,c),className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,yt.jsx)("span",{className:"font-medium "+(u?"text-gray-900":"text-gray-500"),children:d.name})]})}),u&&d.sizes&&Object.keys(d.sizes).length>1&&(0,yt.jsxs)("div",{className:"mt-2 ml-7",children:[(0,yt.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Available sizes:"}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(d.sizes).map((t=>{let[s,a]=t;if(!a.enabled)return null;const r=m.includes(s);return(0,yt.jsx)("button",{onClick:()=>((e,t,s)=>{i((a=>{var r;const n={...a};if(null===(r=n[e])||void 0===r||!r[t])return a;const i=n[e][t].availableSizes||[];return i.includes(s)?n[e][t].availableSizes=i.filter((e=>e!==s)):n[e][t].availableSizes=[...i,s],n}))})(e.id,c,s),className:"px-3 py-1 text-sm rounded-full transition-colors "+(r?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300"),children:h[a.cupSize]||s},s)}))})]})]},c)}))})]},t.id)}))})]})]},e.id)))}):(0,yt.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No stations available. Add stations to configure their menus."})]})},Wr=new Qt.A,qr=()=>{console.log("OperationsTab component loaded");const[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)([]),[n,i]=(0,a.useState)(5),[o,l]=(0,a.useState)("live"),[c,d]=(0,a.useState)({vipEnabled:!1,groupOrdersEnabled:!0,walkInEnabled:!0,maxOrderSize:5}),[u,m]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1);(0,a.useEffect)((()=>{p();const e=setInterval(p,3e4);return()=>clearInterval(e)}),[]);const p=async()=>{try{const a=await Kt.getStations();t(a);try{const e=await Wr.get("/api/orders/pending");r(e||[])}catch(e){console.warn("Could not load pending orders:",e),r([])}try{const e=await xs.getSettings();i(e.estimatedWaitTime||5),l(e.systemMode||"live"),d({vipEnabled:e.vipEnabled||!1,groupOrdersEnabled:e.groupOrdersEnabled||!0,walkInEnabled:e.walkInEnabled||!0,maxOrderSize:e.maxOrderSize||5})}catch(s){console.warn("Could not load settings:",s)}}catch(a){console.error("Error loading operational data:",a)}},f=async(e,t)=>{g(!0);try{switch(t){case"restart":await Wr.post(`/api/stations/${e}/restart`);break;case"toggle":await Wr.post(`/api/stations/${e}/toggle`);break;case"clear":await Wr.post(`/api/stations/${e}/clear-queue`)}await p()}catch(s){console.error(`Error performing ${t} on station ${e}:`,s)}finally{g(!1)}},x=async(e,t)=>{try{const s={...c,[e]:t};d(s),await xs.updateSettings(s)}catch(s){console.error("Error updating event setting:",s)}};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[(0,yt.jsx)("h2",{className:"text-xl font-bold text-green-800",children:"\u2699\ufe0f Operations Tab"}),(0,yt.jsx)("p",{className:"text-green-600",children:"Station management and queue control"})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(ht,{className:"h-5 w-5"}),"Station Management"]}),(0,yt.jsx)(Pr,{variant:"outline",size:"sm",onClick:async()=>{if(window.confirm("Are you sure you want to clear ALL station queues? This cannot be undone."))try{await Wr.post("/api/stations/clear-all-queues"),await p()}catch(e){console.error("Error clearing all queues:",e)}},className:"text-red-600",children:"Clear All Queues"})]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((e=>(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsx)("h3",{className:"font-medium",children:e.name}),(0,yt.jsx)(zr,{variant:e.is_active?"success":"secondary",children:e.is_active?"Active":"Inactive"})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600 mb-3",children:[(0,yt.jsxs)("p",{children:["Queue: ",e.queue_count||0," orders"]}),(0,yt.jsxs)("p",{children:["Current: ",e.current_order||"None"]}),(0,yt.jsxs)("p",{children:["Barista: ",e.barista_name||"Unassigned"]})]}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Pr,{size:"sm",variant:"outline",onClick:()=>f(e.id,"toggle"),disabled:h,children:e.is_active?(0,yt.jsx)(va,{className:"h-4 w-4"}):(0,yt.jsx)(ba,{className:"h-4 w-4"})}),(0,yt.jsx)(Pr,{size:"sm",variant:"outline",onClick:()=>f(e.id,"restart"),disabled:h,children:(0,yt.jsx)(Ur,{className:"h-4 w-4"})}),(0,yt.jsx)(Pr,{size:"sm",variant:"outline",onClick:()=>f(e.id,"clear"),disabled:h,className:"text-red-600",children:"Clear"})]})]},e.id)))})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(zt,{className:"h-5 w-5"}),"Queue Management"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium mb-2",children:"Current Wait Time"}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,yt.jsx)(Rr,{type:"number",value:n,onChange:e=>i(parseInt(e.target.value)||5),className:"w-20",min:"1",max:"60"}),(0,yt.jsx)("span",{children:"minutes"}),(0,yt.jsx)(Pr,{size:"sm",onClick:async()=>{try{await xs.updateWaitTime(n)}catch(e){console.error("Error updating wait time:",e)}},children:"Update"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("h3",{className:"font-medium mb-2",children:"Queue Status"}),(0,yt.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,yt.jsxs)("p",{children:["Total Orders: ",s.length]}),(0,yt.jsxs)("p",{children:["VIP Orders: ",s.filter((e=>e.is_vip)).length]}),(0,yt.jsxs)("p",{children:["Group Orders: ",s.filter((e=>"group"===e.order_type)).length]})]})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(gt,{className:"h-5 w-5"}),"Event Settings"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"VIP Orders"}),(0,yt.jsx)(Lr,{checked:c.vipEnabled,onCheckedChange:e=>x("vipEnabled",e)})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"Group Orders"}),(0,yt.jsx)(Lr,{checked:c.groupOrdersEnabled,onCheckedChange:e=>x("groupOrdersEnabled",e)})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"Walk-in Orders"}),(0,yt.jsx)(Lr,{checked:c.walkInEnabled,onCheckedChange:e=>x("walkInEnabled",e)})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"Max Order Size"}),(0,yt.jsx)(Rr,{type:"number",value:c.maxOrderSize,onChange:e=>x("maxOrderSize",parseInt(e.target.value)||5),className:"w-20",min:"1",max:"10"})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(ca,{className:"h-5 w-5"}),"System Announcements"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsx)(Fr,{placeholder:"Type your announcement here...",value:u,onChange:e=>m(e.target.value),rows:3}),(0,yt.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,yt.jsx)(Pr,{variant:"outline",onClick:()=>m(""),children:"Clear"}),(0,yt.jsxs)(Pr,{onClick:async()=>{if(u.trim())try{await Wr.post("/api/messages/announcement",{message:u,type:"system_announcement"}),m("")}catch(e){console.error("Error sending announcement:",e)}},disabled:!u.trim(),children:[(0,yt.jsx)(us,{className:"h-4 w-4 mr-2"}),"Send to All Stations"]})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(ht,{className:"h-5 w-5"}),"Menu Management"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)(tr,{})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(gt,{className:"h-5 w-5"}),"Station Menu Configuration"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)(Br,{})})]})]})},Hr=dt("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),Jr=dt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Vr=dt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Gr=new Qt.A,Qr=()=>{const[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)([]),[n,i]=(0,a.useState)(["admin","organizer","barista","support"]),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)("all"),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[p,f]=(0,a.useState)(!1),[x,y]=(0,a.useState)({username:"",email:"",role:"barista",password:""});(0,a.useEffect)((()=>{b()}),[]),(0,a.useEffect)((()=>{v()}),[e,o,c]);const b=async()=>{try{const e=await Gr.get("/api/users");t(e.data||[])}catch(e){console.error("Error loading users:",e)}},v=()=>{let t=e;o&&(t=t.filter((e=>{var t;return e.username.toLowerCase().includes(o.toLowerCase())||(null===(t=e.email)||void 0===t?void 0:t.toLowerCase().includes(o.toLowerCase()))}))),"all"!==c&&(t=t.filter((e=>e.role===c))),r(t)};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(zt,{className:"h-5 w-5"}),"User Management"]}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:()=>{const e=[["Username","Email","Role","Status","Last Login"],...s.map((e=>[e.username,e.email||"",e.role,e.is_active?"Active":"Inactive",e.last_login||"Never"]))].map((e=>e.join(","))).join("\n"),t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="users_export.csv",r.click()},children:[(0,yt.jsx)(Ws,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,yt.jsxs)(Pr,{size:"sm",onClick:()=>m(!0),children:[(0,yt.jsx)(ma,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]})}),(0,yt.jsxs)(Ar,{children:[(0,yt.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,yt.jsxs)("div",{className:"flex-1 relative",children:[(0,yt.jsx)(ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,yt.jsx)(Rr,{placeholder:"Search users...",value:o,onChange:e=>l(e.target.value),className:"pl-10"})]}),(0,yt.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-2 border rounded-md",children:[(0,yt.jsx)("option",{value:"all",children:"All Roles"}),n.map((e=>(0,yt.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))]})]}),(0,yt.jsx)("div",{className:"overflow-x-auto",children:(0,yt.jsxs)("table",{className:"w-full",children:[(0,yt.jsx)("thead",{className:"border-b",children:(0,yt.jsxs)("tr",{children:[(0,yt.jsx)("th",{className:"text-left p-2",children:"Username"}),(0,yt.jsx)("th",{className:"text-left p-2",children:"Email"}),(0,yt.jsx)("th",{className:"text-left p-2",children:"Role"}),(0,yt.jsx)("th",{className:"text-left p-2",children:"Status"}),(0,yt.jsx)("th",{className:"text-left p-2",children:"Last Login"}),(0,yt.jsx)("th",{className:"text-left p-2",children:"Actions"})]})}),(0,yt.jsx)("tbody",{children:s.map((s=>(0,yt.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,yt.jsx)("td",{className:"p-2",children:h===s.id?(0,yt.jsx)(Rr,{value:s.username,onChange:a=>{const r=e.map((e=>e.id===s.id?{...e,username:a.target.value}:e));t(r)},className:"w-32"}):s.username}),(0,yt.jsx)("td",{className:"p-2",children:h===s.id?(0,yt.jsx)(Rr,{value:s.email||"",onChange:a=>{const r=e.map((e=>e.id===s.id?{...e,email:a.target.value}:e));t(r)},className:"w-48"}):s.email||"-"}),(0,yt.jsx)("td",{className:"p-2",children:h===s.id?(0,yt.jsx)("select",{value:s.role,onChange:a=>{const r=e.map((e=>e.id===s.id?{...e,role:a.target.value}:e));t(r)},className:"px-2 py-1 border rounded",children:n.map((e=>(0,yt.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))}):(0,yt.jsx)(zr,{variant:"secondary",children:s.role})}),(0,yt.jsx)("td",{className:"p-2",children:(0,yt.jsx)(zr,{variant:s.is_active?"success":"secondary",children:s.is_active?"Active":"Inactive"})}),(0,yt.jsx)("td",{className:"p-2 text-sm text-gray-600",children:s.last_login?new Date(s.last_login).toLocaleDateString():"Never"}),(0,yt.jsx)("td",{className:"p-2",children:(0,yt.jsx)("div",{className:"flex gap-1",children:h===s.id?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>(async(e,t)=>{f(!0);try{await Gr.put(`/api/users/${e}`,t),await b(),g(null)}catch(s){console.error("Error updating user:",s)}finally{f(!1)}})(s.id,{username:s.username,email:s.email,role:s.role}),disabled:p,children:"Save"}),(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>{g(null),b()},children:"Cancel"})]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>g(s.id),children:(0,yt.jsx)(Ct,{className:"h-4 w-4"})}),(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>(async e=>{if(window.confirm("Reset password for this user?")){f(!0);try{const t=await Gr.post(`/api/users/${e}/reset-password`);alert(`New password: ${t.data.newPassword}`)}catch(t){console.error("Error resetting password:",t)}finally{f(!1)}}})(s.id),disabled:p,children:(0,yt.jsx)(Hr,{className:"h-4 w-4"})}),(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>(async(e,t)=>{f(!0);try{await Gr.post(`/api/users/${e}/toggle-status`,{is_active:!t}),await b()}catch(s){console.error("Error toggling user status:",s)}finally{f(!1)}})(s.id,s.is_active),disabled:p,children:s.is_active?(0,yt.jsx)(Jr,{className:"h-4 w-4"}):(0,yt.jsx)(Vr,{className:"h-4 w-4"})}),(0,yt.jsx)(Pr,{size:"sm",variant:"ghost",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?")){f(!0);try{await Gr.delete(`/api/users/${e}`),await b()}catch(t){console.error("Error deleting user:",t)}finally{f(!1)}}})(s.id),disabled:p,className:"text-red-600",children:(0,yt.jsx)(sa,{className:"h-4 w-4"})})]})})})]},s.id)))})]})})]})]}),u&&(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:["Add New User",(0,yt.jsx)(Pr,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:"\xd7"})]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Username"}),(0,yt.jsx)(Rr,{value:x.username,onChange:e=>y({...x,username:e.target.value}),placeholder:"Enter username"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,yt.jsx)(Rr,{type:"email",value:x.email,onChange:e=>y({...x,email:e.target.value}),placeholder:"Enter email (optional)"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Password"}),(0,yt.jsx)(Rr,{type:"password",value:x.password,onChange:e=>y({...x,password:e.target.value}),placeholder:"Enter password"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Role"}),(0,yt.jsx)("select",{value:x.role,onChange:e=>y({...x,role:e.target.value}),className:"w-full px-3 py-2 border rounded-md",children:n.map((e=>(0,yt.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,yt.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,yt.jsx)(Pr,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),(0,yt.jsx)(Pr,{onClick:async()=>{if(x.username&&x.password){f(!0);try{await Gr.post("/api/users",x),await b(),m(!1),y({username:"",email:"",role:"barista",password:""})}catch(e){console.error("Error adding user:",e)}finally{f(!1)}}},disabled:p||!x.username||!x.password,children:"Add User"})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(oa,{className:"h-5 w-5"}),"Access Control"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"space-y-4",children:(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((t=>(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsx)("h3",{className:"font-medium mb-2 capitalize",children:t}),(0,yt.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,yt.jsxs)("p",{children:["Active Users: ",e.filter((e=>e.role===t&&e.is_active)).length]}),(0,yt.jsxs)("p",{children:["Total Users: ",e.filter((e=>e.role===t)).length]})]})]},t)))})})})]})]})},Yr=(new Qt.A,()=>{const[e,t]=(0,a.useState)({eventName:"",organizationName:"",primaryColor:"#4F46E5",secondaryColor:"#10B981",logoUrl:"",welcomeMessage:"",orderConfirmationMessage:"",orderReadyMessage:"",autoLogoutMinutes:30,maxOrdersPerCustomer:5,orderTimeout:120,enableSounds:!0,enableNotifications:!0,coffeeTypes:[],milkOptions:[],defaultCoffeeType:"latte",defaultMilkType:"full",twilioPhoneNumber:"",smsEnabled:!0,smsPrefix:"Coffee Cue:",maxSmsLength:160}),[s,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1);(0,a.useEffect)((()=>{o()}),[]);const o=async()=>{try{const s=await xs.getSettings();t({...e,...s})}catch(s){console.error("Error loading configuration:",s)}},l=(e,s,a)=>{t((e=>({...e,[s]:a}))),r(!0)},c=(s,a,n)=>{const i=[...e[s]];i[a]=n,t((e=>({...e,[s]:i}))),r(!0)},d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t((t=>({...t,[e]:[...t[e],s]}))),r(!0)},u=(e,s)=>{t((t=>({...t,[e]:t[e].filter(((e,t)=>t!==s))}))),r(!0)};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsx)(Tr,{children:(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(gt,{className:"h-5 w-5"}),"System Configuration"]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,yt.jsx)(zr,{variant:"warning",children:"Unsaved Changes"}),(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:()=>{const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`coffeecue_config_${(new Date).toISOString().split("T")[0]}.json`,a.click()},children:[(0,yt.jsx)(Ws,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,yt.jsxs)("label",{className:"cursor-pointer",children:[(0,yt.jsx)("input",{type:"file",accept:".json",onChange:e=>{const s=e.target.files[0];if(!s)return;const a=new FileReader;a.onload=e=>{try{const s=JSON.parse(e.target.result);t((e=>({...e,...s}))),r(!0)}catch(s){alert("Invalid configuration file")}},a.readAsText(s)},className:"hidden"}),(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",as:"span",children:[(0,yt.jsx)(Ks,{className:"h-4 w-4 mr-2"}),"Import"]})]}),(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:()=>{window.confirm("Are you sure you want to reset to default configuration?")&&(o(),r(!1))},children:[(0,yt.jsx)(Xs,{className:"h-4 w-4 mr-2"}),"Reset"]}),(0,yt.jsxs)(Pr,{size:"sm",onClick:async()=>{i(!0);try{await xs.updateSettings(e),r(!1),alert("Configuration saved successfully!")}catch(t){console.error("Error saving configuration:",t),alert("Failed to save configuration")}finally{i(!1)}},disabled:n||!s,children:[(0,yt.jsx)(bs,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(Gs,{className:"h-5 w-5"}),"Branding & Appearance"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Event Name"}),(0,yt.jsx)(Rr,{value:e.eventName,onChange:e=>l(0,"eventName",e.target.value),placeholder:"TechConf 2024"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Organization"}),(0,yt.jsx)(Rr,{value:e.organizationName,onChange:e=>l(0,"organizationName",e.target.value),placeholder:"Coffee Cue Inc."})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Primary Color"}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Rr,{type:"color",value:e.primaryColor,onChange:e=>l(0,"primaryColor",e.target.value),className:"w-20"}),(0,yt.jsx)(Rr,{value:e.primaryColor,onChange:e=>l(0,"primaryColor",e.target.value),placeholder:"#4F46E5"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Secondary Color"}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Rr,{type:"color",value:e.secondaryColor,onChange:e=>l(0,"secondaryColor",e.target.value),className:"w-20"}),(0,yt.jsx)(Rr,{value:e.secondaryColor,onChange:e=>l(0,"secondaryColor",e.target.value),placeholder:"#10B981"})]})]}),(0,yt.jsxs)("div",{className:"md:col-span-2",children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Logo URL"}),(0,yt.jsx)(Rr,{value:e.logoUrl,onChange:e=>l(0,"logoUrl",e.target.value),placeholder:"https://example.com/logo.png"})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(la,{className:"h-5 w-5"}),"Message Templates"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Welcome Message"}),(0,yt.jsx)(Fr,{value:e.welcomeMessage,onChange:e=>l(0,"welcomeMessage",e.target.value),placeholder:"Welcome to Coffee Cue! Text your coffee order to get started.",rows:2})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Order Confirmation"}),(0,yt.jsx)(Fr,{value:e.orderConfirmationMessage,onChange:e=>l(0,"orderConfirmationMessage",e.target.value),placeholder:"Thanks! Your order #{orderNumber} has been received. Estimated wait: {waitTime} minutes.",rows:2})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Order Ready"}),(0,yt.jsx)(Fr,{value:e.orderReadyMessage,onChange:e=>l(0,"orderReadyMessage",e.target.value),placeholder:"Your coffee is ready! Please collect order #{orderNumber} from {stationName}.",rows:2})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(ht,{className:"h-5 w-5"}),"Menu Configuration"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Coffee Types"}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(e.coffeeTypes||[]).map(((e,t)=>(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Rr,{value:e,onChange:e=>c("coffeeTypes",t,e.target.value),placeholder:"e.g., Latte"}),(0,yt.jsx)(Pr,{variant:"outline",size:"sm",onClick:()=>u("coffeeTypes",t),children:"Remove"})]},t))),(0,yt.jsx)(Pr,{variant:"outline",size:"sm",onClick:()=>d("coffeeTypes"),children:"Add Coffee Type"})]})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Milk Options"}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(e.milkOptions||[]).map(((e,t)=>(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Rr,{value:e,onChange:e=>c("milkOptions",t,e.target.value),placeholder:"e.g., Oat"}),(0,yt.jsx)(Pr,{variant:"outline",size:"sm",onClick:()=>u("milkOptions",t),children:"Remove"})]},t))),(0,yt.jsx)(Pr,{variant:"outline",size:"sm",onClick:()=>d("milkOptions"),children:"Add Milk Option"})]})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Default Coffee"}),(0,yt.jsx)("select",{value:e.defaultCoffeeType,onChange:e=>l(0,"defaultCoffeeType",e.target.value),className:"w-full px-3 py-2 border rounded-md",children:(e.coffeeTypes||[]).map((e=>(0,yt.jsx)("option",{value:e.toLowerCase(),children:e},e)))})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Default Milk"}),(0,yt.jsx)("select",{value:e.defaultMilkType,onChange:e=>l(0,"defaultMilkType",e.target.value),className:"w-full px-3 py-2 border rounded-md",children:(e.milkOptions||[]).map((e=>(0,yt.jsx)("option",{value:e.toLowerCase(),children:e},e)))})]})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(Ys,{className:"h-5 w-5"}),"System Settings"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Auto Logout (minutes)"}),(0,yt.jsx)(Rr,{type:"number",value:e.autoLogoutMinutes,onChange:e=>l(0,"autoLogoutMinutes",parseInt(e.target.value)||30),min:"5",max:"120"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Max Orders per Customer"}),(0,yt.jsx)(Rr,{type:"number",value:e.maxOrdersPerCustomer,onChange:e=>l(0,"maxOrdersPerCustomer",parseInt(e.target.value)||5),min:"1",max:"20"})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Order Timeout (seconds)"}),(0,yt.jsx)(Rr,{type:"number",value:e.orderTimeout,onChange:e=>l(0,"orderTimeout",parseInt(e.target.value)||120),min:"30",max:"600"})]})]}),(0,yt.jsxs)("div",{className:"space-y-2",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"Enable Sound Effects"}),(0,yt.jsx)(Lr,{checked:e.enableSounds,onCheckedChange:e=>l(0,"enableSounds",e)})]}),(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"Enable Notifications"}),(0,yt.jsx)(Lr,{checked:e.enableNotifications,onCheckedChange:e=>l(0,"enableNotifications",e)})]})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(_a,{className:"h-5 w-5"}),"SMS Configuration"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,yt.jsx)("label",{className:"text-sm font-medium",children:"SMS Enabled"}),(0,yt.jsx)(Lr,{checked:e.smsEnabled,onCheckedChange:e=>l(0,"smsEnabled",e)})]}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Twilio Phone Number"}),(0,yt.jsx)(Rr,{value:e.twilioPhoneNumber,onChange:e=>l(0,"twilioPhoneNumber",e.target.value),placeholder:"+1234567890",disabled:!e.smsEnabled})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"SMS Prefix"}),(0,yt.jsx)(Rr,{value:e.smsPrefix,onChange:e=>l(0,"smsPrefix",e.target.value),placeholder:"Coffee Cue:",disabled:!e.smsEnabled})]}),(0,yt.jsxs)("div",{children:[(0,yt.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Max SMS Length"}),(0,yt.jsx)(Rr,{type:"number",value:e.maxSmsLength,onChange:e=>l(0,"maxSmsLength",parseInt(e.target.value)||160),min:"50",max:"320",disabled:!e.smsEnabled})]})]})]})})]})]})}),Kr=dt("Bug",[["rect",{width:"8",height:"14",x:"8",y:"6",rx:"4",key:"hq8nra"}],["path",{d:"m19 7-3 2",key:"fmg8ec"}],["path",{d:"m5 7 3 2",key:"dkxqes"}],["path",{d:"m19 19-3-2",key:"1hbhi4"}],["path",{d:"m5 19 3-2",key:"dvt2ee"}],["path",{d:"M20 13h-4",key:"1agfp2"}],["path",{d:"M4 13h4",key:"1bwh8b"}],["path",{d:"m10 4 1 2",key:"1pot59"}],["path",{d:"m14 4-1 2",key:"m8sn0o"}]]),Xr=new Qt.A,Zr=()=>{const[e,t]=(0,a.useState)({api:{status:"checking",message:""},database:{status:"checking",message:""},websocket:{status:"checking",message:""},sms:{status:"checking",message:""},storage:{status:"checking",message:""},network:{status:"checking",message:""}}),[s,r]=(0,a.useState)([]),[n,i]=(0,a.useState)({apiResponseTime:0,dbQueryTime:0,memoryUsage:0,cpuUsage:0}),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)("all");(0,a.useEffect)((()=>{h(),g();const e=setInterval((()=>{p()}),5e3);return()=>clearInterval(e)}),[]);const h=async()=>{try{const e=Date.now();await Xr.get("/api/health");const s=Date.now()-e;t((e=>({...e,api:{status:s<1e3?"healthy":"warning",message:`Response time: ${s}ms`}})))}catch(a){t((e=>({...e,api:{status:"error",message:a.message}})))}try{const e=await Xr.get("/api/diagnostics/database");t((t=>({...t,database:{status:(null===e||void 0===e?void 0:e.status)||"error",message:(null===e||void 0===e?void 0:e.message)||"Unknown status"}})))}catch(a){t((e=>({...e,database:{status:"error",message:"Database unreachable"}})))}try{"undefined"!==typeof WebSocket?t((e=>({...e,websocket:{status:"warning",message:"WebSocket available but not tested"}}))):t((e=>({...e,websocket:{status:"error",message:"WebSocket not supported"}})))}catch(a){t((e=>({...e,websocket:{status:"error",message:a.message}})))}try{const e=await Xr.get("/api/diagnostics/sms");t((t=>({...t,sms:{status:(null===e||void 0===e?void 0:e.status)||"error",message:(null===e||void 0===e?void 0:e.message)||"SMS status unknown"}})))}catch(a){t((e=>({...e,sms:{status:"warning",message:"SMS service check failed"}})))}const e=JSON.stringify(localStorage).length,s=e<4e6?"healthy":"warning";t((t=>({...t,storage:{status:s,message:`Using ${(e/1024).toFixed(2)} KB`}}))),t((e=>({...e,network:{status:navigator.onLine?"healthy":"error",message:navigator.onLine?"Online":"Offline"}})))},g=async()=>{try{const e=await Xr.get("/api/diagnostics/logs?limit=50");r(Array.isArray(e)?e:[])}catch(e){console.error("Error loading logs:",e),r([])}},p=async()=>{try{const e=await Xr.get("/api/diagnostics/performance");i(e||{apiResponseTime:0,dbQueryTime:0,memoryUsage:0,cpuUsage:0})}catch(e){console.error("Error loading performance metrics:",e)}},f=e=>{switch(e){case"healthy":case"passed":return(0,yt.jsx)(St,{className:"h-5 w-5 text-green-500"});case"warning":return(0,yt.jsx)(gs,{className:"h-5 w-5 text-yellow-500"});case"error":case"failed":return(0,yt.jsx)(Lt,{className:"h-5 w-5 text-red-500"});default:return(0,yt.jsx)(Rt,{className:"h-5 w-5 text-gray-400 animate-spin"})}},x=e=>({healthy:"success",warning:"warning",error:"destructive",checking:"secondary",passed:"success",failed:"destructive"}[e]||"secondary");return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(qs,{className:"h-5 w-5"}),"System Status"]}),(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:h,children:[(0,yt.jsx)(Ot,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(e).map((e=>{let[t,s]=e;return(0,yt.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:["api"===t&&(0,yt.jsx)(gr,{className:"h-4 w-4"}),"database"===t&&(0,yt.jsx)(pr,{className:"h-4 w-4"}),"websocket"===t&&(0,yt.jsx)(fa,{className:"h-4 w-4"}),"sms"===t&&(0,yt.jsx)(la,{className:"h-4 w-4"}),"storage"===t&&(0,yt.jsx)(fr,{className:"h-4 w-4"}),"network"===t&&(0,yt.jsx)(fa,{className:"h-4 w-4"}),(0,yt.jsx)("span",{className:"font-medium capitalize",children:t})]}),f(s.status)]}),(0,yt.jsx)(zr,{variant:x(s.status),className:"mb-2",children:s.status}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:s.message})]},t)}))})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(qs,{className:"h-5 w-5"}),"Performance Metrics"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("p",{className:"text-2xl font-bold",children:[n.apiResponseTime,"ms"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"API Response"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("p",{className:"text-2xl font-bold",children:[n.dbQueryTime,"ms"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"DB Query"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("p",{className:"text-2xl font-bold",children:[n.memoryUsage,"%"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"Memory Usage"})]}),(0,yt.jsxs)("div",{className:"text-center",children:[(0,yt.jsxs)("p",{className:"text-2xl font-bold",children:[n.cpuUsage,"%"]}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:"CPU Usage"})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(Kr,{className:"h-5 w-5"}),"System Tests"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded-md",disabled:c,children:[(0,yt.jsx)("option",{value:"all",children:"All Tests"}),(0,yt.jsx)("option",{value:"api",children:"API Tests"}),(0,yt.jsx)("option",{value:"database",children:"Database Tests"}),(0,yt.jsx)("option",{value:"authentication",children:"Auth Tests"}),(0,yt.jsx)("option",{value:"orders",children:"Order Flow Tests"}),(0,yt.jsx)("option",{value:"stations",children:"Station Tests"})]}),(0,yt.jsxs)(Pr,{onClick:()=>(async e=>{d(!0),l([]);try{const t=await Xr.post("/api/diagnostics/test",{type:e});l((null===t||void 0===t?void 0:t.results)||[])}catch(t){l([{test:"Error",status:"failed",message:t.message}])}finally{d(!1)}})(u),disabled:c,children:[(0,yt.jsx)(ba,{className:"h-4 w-4 mr-2"}),c?"Running...":"Run Tests"]})]}),o.length>0&&(0,yt.jsxs)("div",{className:"border rounded-lg p-4 max-h-96 overflow-y-auto",children:[(0,yt.jsx)("h3",{className:"font-medium mb-2",children:"Test Results"}),(0,yt.jsx)("div",{className:"space-y-2",children:o.map(((e,t)=>(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"text-sm",children:(null===e||void 0===e?void 0:e.test)||"Unknown test"}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[f((null===e||void 0===e?void 0:e.status)||"error"),(0,yt.jsx)(zr,{variant:x((null===e||void 0===e?void 0:e.status)||"error"),children:(null===e||void 0===e?void 0:e.status)||"error"})]})]},t)))})]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(lr,{className:"h-5 w-5"}),"System Logs"]}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:g,children:[(0,yt.jsx)(Ot,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,yt.jsxs)(Pr,{variant:"outline",size:"sm",onClick:()=>{const e=s.map((e=>`[${(null===e||void 0===e?void 0:e.timestamp)||"Unknown"}] ${(null===e||void 0===e?void 0:e.level)||"INFO"}: ${(null===e||void 0===e?void 0:e.message)||"No message"}`)).join("\n"),t=new Blob([e],{type:"text/plain"}),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`system_logs_${(new Date).toISOString().split("T")[0]}.txt`,r.click(),window.URL.revokeObjectURL(a)},children:[(0,yt.jsx)(Ws,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"bg-gray-900 text-gray-100 p-4 rounded-lg font-mono text-sm max-h-96 overflow-y-auto",children:0===s.length?(0,yt.jsx)("p",{className:"text-gray-400",children:"No logs available"}):s.map(((e,t)=>(0,yt.jsxs)("div",{className:"mb-1 "+("ERROR"===(null===e||void 0===e?void 0:e.level)?"text-red-400":"WARN"===(null===e||void 0===e?void 0:e.level)?"text-yellow-400":"text-gray-300"),children:["[",(null===e||void 0===e?void 0:e.timestamp)||"Unknown","] ",(null===e||void 0===e?void 0:e.level)||"INFO",": ",(null===e||void 0===e?void 0:e.message)||"No message"]},t)))})})]})]})},en=dt("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),tn=dt("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),sn=dt("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),an=dt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),rn=dt("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]),nn=new Qt.A,on=()=>{const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)({}),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),u=(e,t)=>{const s=`confirm_${Date.now()}`;return i((a=>({...a,[s]:{action:e,callback:t,timestamp:Date.now()}}))),s},m=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l((a=>[{action:e,status:t,details:s,timestamp:(new Date).toISOString(),user:"support_admin"},...a.slice(0,49)]))};return(0,yt.jsxs)("div",{className:"space-y-6",children:[(0,yt.jsxs)(Tr,{className:e?"border-red-500":"",children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center justify-between",children:[(0,yt.jsxs)("span",{className:"flex items-center gap-2",children:[(0,yt.jsx)(gs,{className:"h-5 w-5 text-red-500"}),"Emergency Controls"]}),(0,yt.jsxs)("div",{className:"flex items-center gap-2",children:[e&&(0,yt.jsx)(zr,{variant:"destructive",className:"animate-pulse",children:"EMERGENCY MODE ACTIVE"}),s&&(0,yt.jsx)(zr,{variant:"warning",children:"SYSTEM LOCKED"})]})]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,yt.jsxs)("p",{className:"text-sm text-red-800",children:[(0,yt.jsx)("strong",{children:"WARNING:"})," These controls can significantly impact system operations. Use only in emergency situations. All actions are logged and require confirmation."]})})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsx)(Or,{children:"Quick Emergency Actions"})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,yt.jsx)(Pr,{variant:"destructive",className:"h-20",onClick:e?()=>{u("Resume Operations",(async()=>{await nn.post("/api/emergency/resume"),t(!1)}))}:()=>{u("Stop All Operations",(async()=>{await nn.post("/api/emergency/stop-all"),t(!0)}))},disabled:Object.keys(n).length>0,children:e?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(en,{className:"h-6 w-6 mr-2"}),"Resume All Operations"]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(tn,{className:"h-6 w-6 mr-2"}),"Stop All Operations"]})}),(0,yt.jsx)(Pr,{variant:"destructive",className:"h-20",onClick:s?()=>{u("Unlock System",(async()=>{await nn.post("/api/emergency/unlock-system"),r(!1)}))}:()=>{u("Lock System",(async()=>{await nn.post("/api/emergency/lock-system"),r(!0)}))},disabled:Object.keys(n).length>0,children:s?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(sn,{className:"h-6 w-6 mr-2"}),"Unlock System"]}):(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(an,{className:"h-6 w-6 mr-2"}),"Lock System"]})})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(Ot,{className:"h-5 w-5"}),"System Reset Options"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsxs)(Pr,{variant:"outline",className:"w-full justify-start text-red-600",onClick:()=>{u("Clear ALL Order Queues",(async()=>{await nn.post("/api/emergency/clear-queues")}))},disabled:Object.keys(n).length>0,children:[(0,yt.jsx)(ht,{className:"h-4 w-4 mr-2"}),"Clear All Order Queues"]}),(0,yt.jsxs)(Pr,{variant:"outline",className:"w-full justify-start text-red-600",onClick:()=>{u("Reset All Stations",(async()=>{await nn.post("/api/emergency/reset-stations")}))},disabled:Object.keys(n).length>0,children:[(0,yt.jsx)(rn,{className:"h-4 w-4 mr-2"}),"Reset All Stations"]}),(0,yt.jsxs)(Pr,{variant:"outline",className:"w-full justify-start text-red-600",onClick:()=>{u("Purge Old Data (>30 days)",(async()=>{await nn.post("/api/emergency/purge-data",{olderThan:30})}))},disabled:Object.keys(n).length>0,children:[(0,yt.jsx)(sa,{className:"h-4 w-4 mr-2"}),"Purge Old Data (>30 days)"]}),(0,yt.jsxs)(Pr,{variant:"destructive",className:"w-full justify-start",onClick:()=>{u("RESET ENTIRE DATABASE",(async()=>{if("RESET DATABASE"!==prompt('Type "RESET DATABASE" to confirm this action:'))throw new Error("Confirmation text did not match");await nn.post("/api/emergency/reset-database")}))},disabled:Object.keys(n).length>0,children:[(0,yt.jsx)(pr,{className:"h-4 w-4 mr-2"}),"RESET ENTIRE DATABASE"]})]})})]}),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(pr,{className:"h-5 w-5"}),"Backup & Restore"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsxs)("div",{className:"space-y-4",children:[(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsxs)(Pr,{onClick:async()=>{try{d("creating");const e=await nn.post("/api/emergency/backup");d("completed"),m("Create Backup","success",e.data.filename);const t=new Blob([JSON.stringify(e.data.backup)],{type:"application/json"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=e.data.filename,a.click()}catch(e){d("failed"),m("Create Backup","failed",e.message)}},disabled:"creating"===c,children:[(0,yt.jsx)(Ws,{className:"h-4 w-4 mr-2"}),"creating"===c?"Creating...":"Create Backup"]}),(0,yt.jsxs)("label",{className:"cursor-pointer",children:[(0,yt.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];t&&u("Restore from Backup",(async()=>{const e=new FormData;e.append("backup",t),await nn.post("/api/emergency/restore",e)}))},className:"hidden",disabled:Object.keys(n).length>0}),(0,yt.jsxs)(Pr,{variant:"outline",as:"span",children:[(0,yt.jsx)(Ks,{className:"h-4 w-4 mr-2"}),"Restore from Backup"]})]})]}),"completed"===c&&(0,yt.jsx)("p",{className:"text-sm text-green-600",children:"Backup created successfully"}),"failed"===c&&(0,yt.jsx)("p",{className:"text-sm text-red-600",children:"Backup failed"})]})})]}),Object.entries(n).map((e=>{let[t,s]=e;return(0,yt.jsxs)(Tr,{className:"border-yellow-500",children:[(0,yt.jsx)(Ir,{children:(0,yt.jsx)(Or,{className:"text-yellow-700",children:"Confirm Action"})}),(0,yt.jsxs)(Ar,{children:[(0,yt.jsxs)("p",{className:"mb-4",children:["Are you sure you want to: ",(0,yt.jsx)("strong",{children:s.action}),"?"]}),(0,yt.jsxs)("div",{className:"flex gap-2",children:[(0,yt.jsx)(Pr,{variant:"destructive",onClick:()=>(async e=>{const t=n[e];if(t)try{await t.callback(),m(t.action,"success")}catch(s){m(t.action,"failed",s.message)}finally{i((t=>{const s={...t};return delete s[e],s}))}})(t),children:"Yes, Proceed"}),(0,yt.jsx)(Pr,{variant:"outline",onClick:()=>{return e=t,void i((t=>{const s={...t};return delete s[e],s}));var e},children:"Cancel"})]})]})]},t)})),(0,yt.jsxs)(Tr,{children:[(0,yt.jsx)(Ir,{children:(0,yt.jsxs)(Or,{className:"flex items-center gap-2",children:[(0,yt.jsx)(oa,{className:"h-5 w-5"}),"Emergency Action Log"]})}),(0,yt.jsx)(Ar,{children:(0,yt.jsx)("div",{className:"max-h-64 overflow-y-auto",children:0===o.length?(0,yt.jsx)("p",{className:"text-sm text-gray-500",children:"No emergency actions taken"}):(0,yt.jsx)("div",{className:"space-y-2",children:o.map(((e,t)=>(0,yt.jsxs)("div",{className:"border-b pb-2 last:border-0",children:[(0,yt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,yt.jsx)("span",{className:"font-medium",children:e.action}),(0,yt.jsx)(zr,{variant:"success"===e.status?"success":"destructive",children:e.status})]}),(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,yt.jsx)("p",{children:new Date(e.timestamp).toLocaleString()}),(0,yt.jsxs)("p",{children:["By: ",e.user]}),e.details&&(0,yt.jsxs)("p",{children:["Details: ",e.details]})]})]},t)))})})})]})]})},ln=()=>{const[e,t]=(0,a.useState)("dashboard"),[s,r]=(0,a.useState)({appVersion:"1.2.0",lastUpdated:new Date});(0,a.useEffect)((()=>{localStorage.removeItem("coffee_system_errors"),localStorage.removeItem("supportErrors"),localStorage.removeItem("errorLog");(async()=>{try{const e=await xs.getSettings();console.log("Settings loaded:",e)}catch(e){console.error("Error loading system settings:",e)}})()}),[]);const n=[{id:"dashboard",label:"Dashboard",icon:Ts,component:hr},{id:"operations",label:"Operations",icon:gt,component:qr},{id:"health",label:"Health",icon:qs,component:wr},{id:"communications",label:"Comms",icon:la,component:Er},{id:"sms-test",label:"SMS Test",icon:Ta,component:dr},{id:"users",label:"Users",icon:zt,component:Qr},{id:"config",label:"Config",icon:gt,component:Yr},{id:"diagnostics",label:"Diagnose",icon:lr,component:Zr},{id:"emergency",label:"Emergency",icon:gs,component:on}],i=n.find((t=>t.id===e))||n[0],o=i.component;return(0,yt.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,yt.jsxs)("div",{className:"w-20 bg-indigo-800 text-white flex flex-col items-center py-6 shadow-lg",children:[(0,yt.jsxs)("div",{className:"mb-8",children:[(0,yt.jsx)(ht,{size:32,className:"text-white"}),(0,yt.jsx)("div",{className:"text-xs mt-1 font-medium",children:"Support"})]}),(0,yt.jsx)("nav",{className:"flex flex-col items-center space-y-4 flex-grow",children:n.map((s=>{const a=s.icon,r=e===s.id,n="emergency"===s.id?r?"bg-red-700":"bg-red-600 hover:bg-red-700":r?"bg-indigo-700":"hover:bg-indigo-700";return(0,yt.jsxs)("button",{className:`p-3 rounded-xl transition-colors ${n}`,onClick:()=>{console.log("Switching to tab:",s.id),t(s.id)},title:s.label,children:[(0,yt.jsx)(a,{size:24}),(0,yt.jsx)("span",{className:"text-xs mt-1 block",children:s.label})]},s.id)}))})]}),(0,yt.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,yt.jsxs)("div",{className:"bg-white shadow-sm px-6 py-4 flex items-center justify-between",children:[(0,yt.jsxs)("div",{className:"flex items-center",children:[(0,yt.jsx)("button",{className:"mr-4 p-2 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>window.location.href="/",title:"Back to Home",children:(0,yt.jsx)(Tt,{size:20})}),(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("h1",{className:"text-2xl font-bold text-gray-800",children:["Support Interface - ",i.label]}),(0,yt.jsxs)("p",{className:"text-sm text-gray-600",children:["System monitoring and management tools (Active: ",e,")"]})]})]}),(0,yt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,yt.jsxs)("div",{className:"text-sm text-gray-600",children:["Last update: ",s.lastUpdated.toLocaleTimeString()]}),(0,yt.jsx)("button",{onClick:()=>window.location.reload(),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh",children:(0,yt.jsx)(Ot,{size:20})})]})]}),(0,yt.jsx)("div",{className:"flex-1 overflow-auto",children:(0,yt.jsx)("div",{children:(0,yt.jsx)(o,{})},e)})]})]})},cn={prepareOfflineData:()=>{console.log("Preparing offline fallback data"),localStorage.getItem("fallback_pending_orders")||localStorage.setItem("fallback_pending_orders",JSON.stringify([{id:"fb-p-1",orderNumber:"O-1001",customerName:"Alex Johnson",phoneNumber:"+61412345678",coffeeType:"Latte",milkType:"Regular",sugar:"1 sugar",extraHot:!1,status:"pending",createdAt:new Date(Date.now()-6e5).toISOString(),waitTime:10,stationId:1},{id:"fb-p-2",orderNumber:"O-1002",customerName:"Jamie Smith",phoneNumber:"+61423456789",coffeeType:"Cappuccino",milkType:"Almond",sugar:"No sugar",extraHot:!0,status:"pending",createdAt:new Date(Date.now()-3e5).toISOString(),waitTime:5,stationId:1},{id:"fb-p-3",orderNumber:"O-1003",customerName:"Taylor Wilson",phoneNumber:"+61434567890",coffeeType:"Flat White",milkType:"Skim",sugar:"2 sugars",extraHot:!1,status:"pending",createdAt:new Date(Date.now()-12e4).toISOString(),waitTime:2,stationId:1}])),localStorage.getItem("fallback_in_progress_orders")||localStorage.setItem("fallback_in_progress_orders",JSON.stringify([{id:"fb-ip-1",orderNumber:"O-1000",customerName:"Sam Taylor",phoneNumber:"+61445678901",coffeeType:"Mocha",milkType:"Regular",sugar:"No sugar",extraHot:!1,status:"in-progress",createdAt:new Date(Date.now()-9e5).toISOString(),startedAt:new Date(Date.now()-18e4).toISOString(),waitTime:15,stationId:1}])),localStorage.getItem("fallback_completed_orders")||localStorage.setItem("fallback_completed_orders",JSON.stringify([{id:"fb-c-1",orderNumber:"O-999",customerName:"Jordan Lee",phoneNumber:"+61456789012",coffeeType:"Espresso",milkType:"None",sugar:"No sugar",extraHot:!1,status:"completed",createdAt:new Date(Date.now()-15e5).toISOString(),startedAt:new Date(Date.now()-12e5).toISOString(),completedAt:new Date(Date.now()-108e4).toISOString(),stationId:1},{id:"fb-c-2",orderNumber:"O-998",customerName:"Casey Jones",phoneNumber:"+61467890123",coffeeType:"Americano",milkType:"Regular",sugar:"1 sugar",extraHot:!0,status:"completed",createdAt:new Date(Date.now()-21e5).toISOString(),startedAt:new Date(Date.now()-18e5).toISOString(),completedAt:new Date(Date.now()-168e4).toISOString(),stationId:1}])),localStorage.getItem("fallback_stock_data")||localStorage.setItem("fallback_stock_data",JSON.stringify({milk:[{id:"milk_regular",name:"Regular Milk",amount:3.5,capacity:5,unit:"L",status:"good"},{id:"milk_skim",name:"Skim Milk",amount:2,capacity:3,unit:"L",status:"good"},{id:"milk_almond",name:"Almond Milk",amount:1.2,capacity:2,unit:"L",status:"low"}],coffee:[{id:"coffee_house",name:"House Blend",amount:1.2,capacity:2,unit:"kg",status:"good"},{id:"coffee_decaf",name:"Decaf Blend",amount:.5,capacity:1,unit:"kg",status:"low"}],cups:[{id:"cups_small",name:"Small Cups",amount:25,capacity:50,unit:"pcs",status:"good"},{id:"cups_medium",name:"Medium Cups",amount:30,capacity:50,unit:"pcs",status:"good"},{id:"cups_large",name:"Large Cups",amount:15,capacity:50,unit:"pcs",status:"low"}]})),localStorage.setItem("fallback_data_available","true"),console.log("Fallback data prepared and ready for offline use")},isFallbackModeEnabled:()=>"true"===localStorage.getItem("use_fallback_data"),enableFallbackMode:()=>{localStorage.setItem("use_fallback_data","true"),localStorage.setItem("auth_error_refresh_needed","true"),localStorage.setItem("demo_mode_enabled","true"),localStorage.removeItem("auth_error_count"),localStorage.setItem("coffee_connection_status","offline"),"true"!==localStorage.getItem("fallback_data_available")&&cn.prepareOfflineData(),cn.createValidDummyToken(),window.dispatchEvent(new CustomEvent("fallback_mode_enabled")),console.log("Fallback mode enabled with sample data")},disableFallbackMode:()=>{localStorage.removeItem("use_fallback_data"),localStorage.removeItem("auth_error_refresh_needed"),localStorage.removeItem("demo_mode_enabled"),localStorage.setItem("coffee_connection_status","online"),localStorage.removeItem("coffee_system_token"),localStorage.removeItem("coffee_auth_token"),localStorage.removeItem("jwt_token"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_error_count"),window.dispatchEvent(new CustomEvent("fallback_mode_disabled")),console.log("Fallback mode disabled")},getFallbackOrders:e=>{const t=`fallback_${e}_orders`;try{return JSON.parse(localStorage.getItem(t))||[]}catch(s){return console.error(`Error parsing fallback ${e} orders:`,s),[]}},saveFallbackOrders:(e,t)=>{const s=`fallback_${e}_orders`;localStorage.setItem(s,JSON.stringify(t))},createValidDummyToken:()=>{const e=Math.floor(Date.now()/1e3),t={sub:"demo_user",name:"Demo User",role:"barista",stations:[1,2,3],iat:e,exp:e+86400,permissions:["manage_orders","view_stations"]},s=`${btoa(JSON.stringify({alg:"HS256",typ:"JWT"})).replace(/=/g,"")}.${btoa(JSON.stringify(t)).replace(/=/g,"")}.valid_signature_for_offline_demo_mode`;return localStorage.setItem("coffee_system_token",s),localStorage.setItem("coffee_auth_token",s),localStorage.setItem("jwt_token",s),localStorage.setItem("auth_token",s),console.log("Created and stored valid dummy token for offline/demo mode"),s},hasValidTokenSubject:()=>{const e=localStorage.getItem("coffee_system_token");if(!e)return!1;try{const t=e.split(".");if(3!==t.length)return!1;return"string"===typeof JSON.parse(atob(t[1])).sub}catch(t){return console.error("Error validating token subject:",t),!1}},fixTokenSubjectIfNeeded:()=>(cn.hasValidTokenSubject()||cn.createValidDummyToken(),!0)},dn=cn,un=e=>{let{onLoginSuccess:t}=e;const[s,r]=(0,a.useState)(""),[n,i]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),p=ee(),f=K(),x=(()=>{var e;if(null!==(e=f.state)&&void 0!==e&&e.from)return f.state.from;const t=new URLSearchParams(window.location.search).get("redirect");return t||"/barista"})();(0,a.useEffect)((()=>{(async()=>{if(ft.A.getToken()){const e=ft.A.validateToken();e.isValid||(g(e.error),m(!0),l(`Token error detected: ${e.error}`))}})()}),[]);return(0,yt.jsxs)("div",{className:"login-container",children:[(0,yt.jsxs)("div",{className:"login-card",children:[(0,yt.jsxs)("div",{className:"login-header",children:[(0,yt.jsx)("h2",{children:"Coffee Cue System"}),(0,yt.jsx)("p",{children:"ANZCA ASM 2025 Cairns"})]}),(0,yt.jsxs)("div",{className:"login-body",children:[(0,yt.jsx)("h3",{children:"Log In"}),o&&(0,yt.jsxs)("div",{className:"error-message",children:[o,u&&(0,yt.jsxs)("div",{className:"fallback-option",children:[(0,yt.jsx)("p",{children:"Would you like to use offline mode with sample data?"}),(0,yt.jsx)("button",{onClick:()=>{dn.enableFallbackMode(),p("/barista",{replace:!0})},className:"fallback-button",children:"Enable Fallback Mode"})]})]}),(0,yt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),d(!0);try{await ft.A.login(s,n),t&&t(),p(x,{replace:!0})}catch(a){console.error("Login failed:",a);const e=a.message||"Login failed. Please check your credentials.";l(e),(e.toLowerCase().includes("token")||e.toLowerCase().includes("signature")||e.toLowerCase().includes("authentication"))&&(g(e),m(!0))}finally{d(!1)}},children:[(0,yt.jsxs)("div",{className:"form-group",children:[(0,yt.jsx)("label",{htmlFor:"username",children:"Username"}),(0,yt.jsx)("input",{id:"username",type:"text",placeholder:"Username",autoComplete:"username",value:s,onChange:e=>r(e.target.value),required:!0})]}),(0,yt.jsxs)("div",{className:"form-group",children:[(0,yt.jsx)("label",{htmlFor:"password",children:"Password"}),(0,yt.jsx)("input",{id:"password",type:"password",placeholder:"Password",autoComplete:"current-password",value:n,onChange:e=>i(e.target.value),required:!0})]}),(0,yt.jsxs)("div",{className:"form-actions",children:[(0,yt.jsx)("button",{type:"submit",className:"login-button "+(c?"loading":""),disabled:c,children:c?"Logging in...":"Sign In"}),(0,yt.jsx)("a",{className:"forgot-password",href:"#",onClick:e=>{e.preventDefault(),alert("Please contact an administrator to reset your password.")},children:"Forgot Password?"})]})]})]})]}),(0,yt.jsx)("style",{children:"\n        .login-container {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          min-height: 100vh;\n          background-color: #f5f5f5;\n        }\n        \n        .login-card {\n          width: 100%;\n          max-width: 400px;\n          background: white;\n          border-radius: 8px;\n          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n          overflow: hidden;\n        }\n        \n        .login-header {\n          background-color: #8B4513;\n          color: white;\n          padding: 20px;\n          text-align: center;\n        }\n        \n        .login-header h2 {\n          margin: 0;\n          font-size: 24px;\n        }\n        \n        .login-header p {\n          margin: 5px 0 0;\n          opacity: 0.8;\n        }\n        \n        .login-body {\n          padding: 20px;\n        }\n        \n        .login-body h3 {\n          margin-top: 0;\n          margin-bottom: 20px;\n          color: #333;\n        }\n        \n        .error-message {\n          background-color: #FEE;\n          border: 1px solid #F88;\n          color: #C00;\n          padding: 10px;\n          border-radius: 4px;\n          margin-bottom: 15px;\n        }\n        \n        .form-group {\n          margin-bottom: 15px;\n        }\n        \n        .form-group label {\n          display: block;\n          margin-bottom: 5px;\n          font-weight: bold;\n          color: #555;\n        }\n        \n        .form-group input {\n          width: 100%;\n          padding: 10px;\n          border: 1px solid #DDD;\n          border-radius: 4px;\n          font-size: 16px;\n        }\n        \n        .form-actions {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-top: 20px;\n        }\n        \n        .login-button {\n          background-color: #8B4513;\n          color: white;\n          border: none;\n          padding: 10px 20px;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 16px;\n          font-weight: bold;\n        }\n        \n        .login-button:hover {\n          background-color: #704214;\n        }\n        \n        .login-button.loading {\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n        \n        .forgot-password {\n          color: #8B4513;\n          text-decoration: none;\n          font-size: 14px;\n        }\n        \n        .forgot-password:hover {\n          text-decoration: underline;\n        }\n        \n        .fallback-option {\n          margin-top: 10px;\n          padding-top: 10px;\n          border-top: 1px solid #FAA;\n        }\n        \n        .fallback-button {\n          background-color: #F90;\n          color: white;\n          border: none;\n          padding: 8px 12px;\n          border-radius: 4px;\n          cursor: pointer;\n          font-size: 14px;\n          margin-top: 8px;\n          font-weight: bold;\n          width: 100%;\n        }\n        \n        .fallback-button:hover {\n          background-color: #E80;\n        }\n      "})]})},mn=e=>{let{requiredRoles:t=[],children:s,redirectPath:r="/login"}=e;const n=K(),[i,o]=(0,a.useState)({isChecking:!0,isAuthenticated:!1,hasRequiredRole:!1});return(0,a.useEffect)((()=>{(async()=>{try{const e=await ft.A.handleAuthentication();if(!e)return void o({isChecking:!1,isAuthenticated:!1,hasRequiredRole:!1});const s=ft.A.getCurrentUser();let a=!0;t.length>0&&(a=s&&t.includes(s.role)),o({isChecking:!1,isAuthenticated:e,hasRequiredRole:a})}catch(e){console.error("Auth check error:",e),o({isChecking:!1,isAuthenticated:!1,hasRequiredRole:!1})}})()}),[t,n.pathname]),i.isChecking?(0,yt.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Verifying access..."}):i.isAuthenticated?i.hasRequiredRole?s:(0,yt.jsx)(pe,{to:"/unauthorized",state:{requiredRoles:t},replace:!0}):(0,yt.jsx)(pe,{to:r,state:{from:n.pathname},replace:!0})},hn=()=>{var e;const t=K(),s=ee(),a=ft.A.getCurrentUser(),r=(null===(e=t.state)||void 0===e?void 0:e.requiredRoles)||[];return(0,yt.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,yt.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full",children:[(0,yt.jsxs)("div",{className:"text-center mb-6",children:[(0,yt.jsx)("div",{className:"bg-red-100 text-red-600 p-3 rounded-full inline-flex items-center justify-center w-16 h-16 mb-4",children:(0,yt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,yt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,yt.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,yt.jsx)("p",{className:"text-gray-600 mt-2",children:"You don't have permission to access this page."})]}),r.length>0&&(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,yt.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:"Required roles:"}),(0,yt.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e=>(0,yt.jsx)("span",{className:"bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm",children:e},e)))})]}),a&&(0,yt.jsxs)("div",{className:"text-center text-gray-700 mb-6",children:[(0,yt.jsx)("p",{children:"You are signed in as:"}),(0,yt.jsx)("p",{className:"font-medium",children:a.username}),(0,yt.jsxs)("p",{className:"text-sm",children:["Role: ",a.role]})]}),(0,yt.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,yt.jsx)(tt,{to:(()=>{if(!a)return"/";switch(a.role){case"admin":return"/admin";case"staff":case"event_organizer":return"/organiser";case"barista":return"/barista";case"support":return"/support";default:return"/"}})(),className:"bg-amber-600 text-white py-2 px-4 rounded hover:bg-amber-700 text-center",children:"Go to Dashboard"}),(0,yt.jsx)("button",{onClick:()=>{s(-1)},className:"bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300",children:"Go Back"}),(0,yt.jsx)(bt,{showIcon:!0,showText:!0,className:"justify-center py-2 px-4 w-full",confirmLogout:!1})]})]})})};class gn extends a.Component{constructor(e){super(e),this.logError=(e,t)=>{const s={timestamp:(new Date).toISOString(),component:this.props.componentName||"Unknown Component",error:{message:e.message,stack:e.stack,name:e.name},errorInfo:t,userAgent:navigator.userAgent,url:window.location.href,userId:localStorage.getItem("coffee_system_user")||"anonymous",retryCount:this.state.retryCount};try{const e=JSON.parse(localStorage.getItem("coffee_system_errors")||"[]");e.push(s),e.length>50&&e.splice(0,e.length-50),localStorage.setItem("coffee_system_errors",JSON.stringify(e)),console.error("Error Boundary caught error:",s),window.errorTrackingService&&window.errorTrackingService.logError(s)}catch(a){console.error("Failed to store error data:",a)}},this.handleDismiss=()=>{this.setState({isDismissed:!0})},this.handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null,isDismissed:!1,retryCount:this.state.retryCount+1})},this.handleReload=()=>{window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null,isDismissed:!1,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.logError(e,t),this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError&&!this.state.isDismissed){var e;const{fallbackComponent:t,componentName:s}=this.props;return(0,yt.jsxs)("div",{className:"relative",children:[(0,yt.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4 relative",children:(0,yt.jsxs)("div",{className:"flex items-start",children:[(0,yt.jsx)("div",{className:"flex-shrink-0",children:(0,yt.jsx)(gs,{className:"h-5 w-5 text-red-400"})}),(0,yt.jsxs)("div",{className:"ml-3 flex-1",children:[(0,yt.jsxs)("h3",{className:"text-sm font-medium text-red-800",children:["Component Error: ",s||"Unknown Component"]}),(0,yt.jsxs)("div",{className:"mt-2 text-sm text-red-700",children:[(0,yt.jsxs)("p",{children:["Something went wrong with this part of the interface.",this.state.retryCount>0&&` (Retry attempt: ${this.state.retryCount})`]}),this.props.showErrorDetails&&(0,yt.jsxs)("details",{className:"mt-2 bg-red-100 p-2 rounded text-xs",children:[(0,yt.jsx)("summary",{className:"cursor-pointer font-medium",children:"Technical Details"}),(0,yt.jsx)("pre",{className:"mt-1 whitespace-pre-wrap",children:null===(e=this.state.error)||void 0===e?void 0:e.message})]})]}),(0,yt.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,yt.jsxs)("button",{onClick:this.handleRetry,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 flex items-center",children:[(0,yt.jsx)(Ot,{size:14,className:"mr-1"}),"Try Again"]}),(0,yt.jsx)("button",{onClick:this.handleReload,className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700",children:"Reload Page"})]})]}),(0,yt.jsx)("div",{className:"ml-auto pl-3",children:(0,yt.jsx)("button",{onClick:this.handleDismiss,className:"bg-red-200 rounded-md p-1.5 text-red-500 hover:bg-red-300 focus:outline-none",children:(0,yt.jsx)(Fa,{size:16})})})]})}),t?(0,yt.jsx)(t,{error:this.state.error,onRetry:this.handleRetry}):(0,yt.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:[(0,yt.jsx)(ht,{size:48,className:"mx-auto mb-4 text-amber-600"}),(0,yt.jsx)("h3",{className:"text-lg font-medium text-amber-800 mb-2",children:"Service Temporarily Unavailable"}),(0,yt.jsx)("p",{className:"text-amber-700 mb-4",children:"This part of the coffee ordering system is experiencing issues. Other features should still work normally."}),(0,yt.jsx)("button",{onClick:this.handleRetry,className:"bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700",children:"Try Again"})]})]})}return this.props.children}}const pn=gn,fn=e=>{let{error:t,onRetry:s}=e;const[r,n]=(0,a.useState)([]),[i,o]=(0,a.useState)({customer:"",coffee:"",notes:""});return(0,yt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,yt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,yt.jsx)(gs,{className:"text-amber-500 mr-2",size:24}),(0,yt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Emergency Barista Mode"}),(0,yt.jsx)("button",{onClick:s,className:"ml-auto bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600",children:"Try Full Interface"})]}),(0,yt.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded p-3 mb-6",children:(0,yt.jsx)("p",{className:"text-amber-800 text-sm",children:"The main barista interface is temporarily unavailable. Use this basic interface to continue taking orders manually."})}),(0,yt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yt.jsxs)("h3",{className:"font-semibold mb-3 flex items-center",children:[(0,yt.jsx)(mt,{size:18,className:"mr-2"}),"New Order"]}),(0,yt.jsxs)("div",{className:"space-y-3",children:[(0,yt.jsx)("input",{type:"text",placeholder:"Customer Name",value:i.customer,onChange:e=>o({...i,customer:e.target.value}),className:"w-full p-2 border rounded"}),(0,yt.jsxs)("select",{value:i.coffee,onChange:e=>o({...i,coffee:e.target.value}),className:"w-full p-2 border rounded",children:[(0,yt.jsx)("option",{value:"",children:"Select Coffee Type"}),(0,yt.jsx)("option",{value:"Espresso",children:"Espresso"}),(0,yt.jsx)("option",{value:"Americano",children:"Americano"}),(0,yt.jsx)("option",{value:"Latte",children:"Latte"}),(0,yt.jsx)("option",{value:"Cappuccino",children:"Cappuccino"}),(0,yt.jsx)("option",{value:"Flat White",children:"Flat White"}),(0,yt.jsx)("option",{value:"Mocha",children:"Mocha"})]}),(0,yt.jsx)("input",{type:"text",placeholder:"Special requests (optional)",value:i.notes,onChange:e=>o({...i,notes:e.target.value}),className:"w-full p-2 border rounded"}),(0,yt.jsx)("button",{onClick:()=>{if(i.customer&&i.coffee){const e={id:Date.now(),customer:i.customer,coffee:i.coffee,notes:i.notes,status:"pending",timestamp:(new Date).toLocaleTimeString()};n([...r,e]),o({customer:"",coffee:"",notes:""})}},className:"w-full bg-green-600 text-white p-2 rounded hover:bg-green-700",children:"Add to Queue"})]})]}),(0,yt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,yt.jsxs)("h3",{className:"font-semibold mb-3 flex items-center",children:[(0,yt.jsx)(Rt,{size:18,className:"mr-2"}),"Order Queue (",r.length,")"]}),0===r.length?(0,yt.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No pending orders"}):(0,yt.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map((e=>(0,yt.jsx)("div",{className:"bg-white p-3 rounded border",children:(0,yt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,yt.jsxs)("div",{className:"flex-1",children:[(0,yt.jsx)("h4",{className:"font-medium",children:e.customer}),(0,yt.jsx)("p",{className:"text-sm text-gray-600",children:e.coffee}),e.notes&&(0,yt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.notes}),(0,yt.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.timestamp})]}),(0,yt.jsx)("button",{onClick:()=>{return t=e.id,void n(r.filter((e=>e.id!==t)));var t},className:"bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600",children:"Complete"})]})},e.id)))})]})]}),(0,yt.jsxs)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded p-4",children:[(0,yt.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Emergency Mode Instructions:"}),(0,yt.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,yt.jsx)("li",{children:"\u2022 Use this interface to manually track orders"}),(0,yt.jsx)("li",{children:"\u2022 Check with support staff for system status updates"}),(0,yt.jsx)("li",{children:"\u2022 Consider backup procedures for payment processing"}),(0,yt.jsx)("li",{children:'\u2022 Click "Try Full Interface" periodically to check if system is restored'})]})]})]})},xn=e=>{let{apiStatus:t,onFallbackToggle:s}=e;const[r,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null!==t&&void 0!==t&&t.isConnected?"connected":null!==t&&void 0!==t&&t.fallbackEnabled?"fallback":"unknown");return(0,yt.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,yt.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API Test Page"}),(0,yt.jsxs)("div",{className:"bg-white rounded shadow-md p-4 mb-6",children:[(0,yt.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Connection Status"}),(0,yt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,yt.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 "+("connected"===l?"bg-green-500":"fallback"===l?"bg-amber-500":"auth_error"===l?"bg-yellow-500":"disconnected"===l?"bg-red-500":"bg-gray-500")}),(0,yt.jsx)("span",{children:"connected"===l?"Connected to API":"fallback"===l?"Using fallback data":"auth_error"===l?"Authentication error":"disconnected"===l?"Disconnected from API":"Status unknown"}),t&&(0,yt.jsx)("span",{className:"ml-3 text-sm text-gray-600",children:t.fallbackEnabled?"(Fallback mode active)":""})]}),(0,yt.jsxs)("div",{className:"flex space-x-3",children:[(0,yt.jsx)("button",{onClick:async()=>{o(!0),c("checking");try{const e=await fetch("/api/test");if(e.ok){const t=await e.json();n(t),c("connected")}else 422===e.status?(n({error:`Failed with status: ${e.status}`,details:"Token signature verification failed",suggestion:"Try enabling fallback mode or clearing your authentication token"}),c("auth_error")):(n({error:`Failed with status: ${e.status}`}),c("disconnected"))}catch(e){if(n({error:e.message}),c("disconnected"),null===t||void 0===t||!t.fallbackEnabled){window.confirm("Connection to the API server failed. Would you like to enable fallback mode?")&&s()}}finally{o(!1)}},disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Testing...":"Test API Connection"}),(0,yt.jsx)("button",{onClick:async()=>{o(!0);try{const e=await fetch("/api/orders/pending");if(e.ok){const t=await e.json();n({pendingOrders:t})}else 422===e.status?n({error:`Failed with status: ${e.status}`,details:"Token signature verification failed",suggestion:"Try enabling fallback mode or clearing your authentication token"}):n({error:`Failed with status: ${e.status}`})}catch(e){n({error:e.message,suggestion:"Try enabling fallback mode to use sample data"})}finally{o(!1)}},disabled:i,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Test Pending Orders"}),(0,yt.jsx)("button",{onClick:s,className:`px-4 py-2 ${null!==t&&void 0!==t&&t.fallbackEnabled?"bg-green-600 hover:bg-green-700":"bg-amber-600 hover:bg-amber-700"} text-white rounded`,children:null!==t&&void 0!==t&&t.fallbackEnabled?"Disable Fallback Mode":"Enable Fallback Mode"})]})]}),r&&(0,yt.jsxs)("div",{className:"bg-white rounded shadow-md p-4",children:[(0,yt.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Test Results"}),r.suggestion&&(0,yt.jsxs)("div",{className:"bg-amber-100 text-amber-800 p-3 rounded mb-3",children:[(0,yt.jsx)("p",{className:"font-bold",children:"Suggestion:"}),(0,yt.jsx)("p",{children:r.suggestion})]}),(0,yt.jsx)("pre",{className:"bg-gray-100 p-4 rounded overflow-x-auto",children:JSON.stringify(r,null,2)})]})]})};const yn=function(){const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!0),[o,l]=(0,a.useState)({isConnected:!0,message:null,fallbackEnabled:!1}),c=(0,a.useCallback)((()=>{dn.prepareOfflineData(),l((e=>({...e,isConnected:!1,fallbackEnabled:!0,message:"Operating in offline mode with fallback data"})))}),[]),d=(0,a.useCallback)((()=>{if(console.log("Browser reports offline status"),l((e=>({...e,isConnected:!1,message:"Network connection lost"}))),!dn.isFallbackModeEnabled()){window.confirm("Network connection has been lost. Would you like to enable fallback mode?")&&dn.enableFallbackMode()}}),[]),u=(0,a.useCallback)((async()=>{console.log("Browser reports online status");try{(await fetch("/api/heartbeat",{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(5e3)})).ok&&l((e=>({...e,isConnected:!0,message:"Connection to API restored"})))}catch(e){console.error("API check failed despite browser being online:",e),l((e=>({...e,isConnected:!1,message:"Browser is online but API is unreachable"})))}}),[]),m=(0,a.useCallback)((()=>{console.log("Fallback mode disabled, returning to online mode"),l((e=>({...e,isConnected:!0,fallbackEnabled:!1,message:"Reconnected to online services"})))}),[]);(0,a.useEffect)((()=>{const e="true"===localStorage.getItem("use_fallback_data");!e&&ft.A.isLoggedIn()||(dn.prepareOfflineData(),e&&l({isConnected:!1,fallbackEnabled:!0,message:"Operating in offline mode with fallback data"}));try{const t=localStorage.getItem("coffee_system_token");if(t){if(3!==t.split(".").length&&(console.warn("Invalid token format detected during initialization"),!e)){window.confirm("Invalid authentication token detected. Would you like to enable fallback mode?")&&dn.enableFallbackMode()}}}catch(bn){console.error("Error checking token during initialization:",bn)}t(!0),window.addEventListener("fallback_mode_enabled",c),window.addEventListener("fallback_mode_disabled",m),window.addEventListener("online",u),window.addEventListener("offline",d);return(()=>{console.log("Purging hardcoded schedule data on app start"),localStorage.removeItem("coffee_cue_schedule"),Object.keys(localStorage).forEach((e=>{(e.includes("schedule")||e.includes("demo_"))&&localStorage.removeItem(e)}));localStorage.setItem("coffee_cue_schedule",JSON.stringify({shifts:[],breaks:[],rushPeriods:[]})),console.log("All schedule data reset to empty state")})(),()=>{window.removeEventListener("fallback_mode_enabled",c),window.removeEventListener("fallback_mode_disabled",m),window.removeEventListener("online",u),window.removeEventListener("offline",d)}}),[c,m,u,d]);const h=(0,a.useCallback)((async()=>{if(o.fallbackEnabled)return console.log("In fallback mode, skipping API test"),!1;try{const s=await fetch("http://localhost:5001/api/auth/status",{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${ft.A.getToken()}`},signal:AbortSignal.timeout(5e3)});let a=null;try{a=await s.json()}catch(bn){}if(s.ok)return l((e=>({...e,isConnected:!0,message:null}))),!0;if(422===s.status){var e;console.warn("Token signature verification failed");const t=(null===(e=a)||void 0===e?void 0:e.message)||"Invalid token signature";if(t.toLowerCase().includes("signature")||t.toLowerCase().includes("invalid token")){l((e=>({...e,isConnected:!1,message:`Authentication error: ${t}`})));window.confirm(`Authentication error: ${t}. Would you like to enable fallback mode?`)&&dn.enableFallbackMode()}else l((e=>({...e,isConnected:!1,message:`Authentication error: ${t}`})));return!1}{var t;console.warn("API auth check failed with status:",s.status);const e=(null===(t=a)||void 0===t?void 0:t.message)||(401===s.status?"Authentication required":"API error");return l((t=>({...t,isConnected:!0,message:e}))),!1}}catch(s){return console.error("API auth check failed:",s),l((e=>({...e,isConnected:!1,message:"Cannot connect to API server"}))),!1}}),[o.fallbackEnabled]);return(0,a.useEffect)((()=>{(async()=>{try{if(ft.A.getToken())try{const e=ft.A.getToken().split(".");if(3!==e.length)throw new Error("Invalid token format");try{const t=JSON.parse(atob(e[1]));t.exp&&1e3*t.exp<Date.now()&&console.warn("Token is expired")}catch(bn){throw console.error("Invalid token payload",bn),new Error("Invalid token payload")}if(!await h()&&!dn.isFallbackModeEnabled()){window.confirm("Cannot connect to the API server. Would you like to enable fallback mode?")&&dn.enableFallbackMode()}}catch(e){if(console.error("Token validation error:",e),l((t=>({...t,isConnected:!1,message:`Authentication error: ${e.message}`}))),!dn.isFallbackModeEnabled()){window.confirm(`Authentication error: ${e.message}. Would you like to enable fallback mode?`)&&dn.enableFallbackMode()}}const t=await ft.A.handleAuthentication();r(t)}catch(t){if(console.error("Auth check failed:",t),r(!1),!dn.isFallbackModeEnabled()){window.confirm("Authentication failed. Would you like to enable fallback mode?")&&dn.enableFallbackMode()}}finally{i(!1)}})();const e=e=>{"coffee_system_token"===e.key&&(e.newValue?!localStorage.getItem("coffee_system_token")&&e.newValue&&r(!0):r(!1)),"use_fallback_data"===e.key&&("true"===e.newValue?l((e=>({...e,isConnected:!1,fallbackEnabled:!0,message:"Fallback mode enabled in another tab"}))):"false"===e.newValue&&(l((e=>({...e,isConnected:!0,fallbackEnabled:!1,message:"Fallback mode disabled in another tab"}))),setTimeout((()=>h()),1e3)))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}),[h]),(0,a.useEffect)((()=>{if(e&&!n){const e=window.location.pathname;["/barista","/organiser","/admin","/support"].includes(e)&&!s&&(console.log("Not authenticated, redirecting to login page"),window.location.href=`/login?redirect=${encodeURIComponent(e)}`)}}),[e,n,s]),!e||n?(0,yt.jsxs)("div",{className:"flex justify-center items-center h-screen",children:[(0,yt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-amber-600"}),(0,yt.jsx)("p",{className:"ml-3 text-lg text-amber-800",children:"Loading Expresso..."})]}):(0,yt.jsx)(Ut.Dv,{children:(0,yt.jsxs)(Ze,{children:[(0,yt.jsx)(rr,{}),(0,yt.jsxs)(ye,{children:[(0,yt.jsx)(fe,{path:"/",element:(0,yt.jsx)(kt,{})}),(0,yt.jsx)(fe,{path:"/direct-login",element:(0,yt.jsx)(pe,{to:"/login",replace:!0})}),(0,yt.jsx)(fe,{path:"/login",element:(0,yt.jsx)(un,{onLoginSuccess:()=>r(!0)})}),(0,yt.jsx)(fe,{path:"/auth/login",element:(0,yt.jsx)(un,{onLoginSuccess:()=>r(!0)})}),(0,yt.jsx)(fe,{path:"/display",element:(0,yt.jsx)(nr,{})}),(0,yt.jsx)(fe,{path:"/displays",element:(0,yt.jsx)(or,{})}),(0,yt.jsx)(fe,{path:"/barista",element:(0,yt.jsx)(mn,{requiredRoles:["barista","admin","staff"],children:(0,yt.jsx)(pn,{componentName:"Barista Interface",fallbackComponent:fn,showErrorDetails:!0,children:(0,yt.jsx)(Us,{})})})}),(0,yt.jsx)(fe,{path:"/organiser",element:(0,yt.jsx)(mn,{requiredRoles:["staff","admin","event_organizer"],children:(0,yt.jsx)(pn,{componentName:"Organiser Interface",showErrorDetails:!0,children:(0,yt.jsx)(ar,{})})})}),(0,yt.jsx)(fe,{path:"/support",element:(0,yt.jsx)(mn,{requiredRoles:["support","admin"],children:(0,yt.jsx)(pn,{componentName:"Support Interface",showErrorDetails:!0,children:(0,yt.jsx)(ln,{})})})}),(0,yt.jsx)(fe,{path:"/unauthorized",element:(0,yt.jsx)(hn,{})}),(0,yt.jsx)(fe,{path:"/api-test",element:(0,yt.jsx)(xn,{apiStatus:o,onFallbackToggle:o.fallbackEnabled?()=>dn.disableFallbackMode():()=>dn.enableFallbackMode()})}),(0,yt.jsx)(fe,{path:"*",element:(0,yt.jsx)(pe,{to:"/",replace:!0})})]})]})})};r.createRoot(document.getElementById("root")).render((0,yt.jsx)(a.StrictMode,{children:(0,yt.jsx)(yn,{})}))})();
//# sourceMappingURL=main.657a008d.js.map